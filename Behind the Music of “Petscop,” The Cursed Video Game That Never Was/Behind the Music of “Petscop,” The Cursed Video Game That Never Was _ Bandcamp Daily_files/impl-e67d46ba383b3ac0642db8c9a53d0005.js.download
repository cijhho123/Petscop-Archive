!function(){"use strict";function e(e,t,i){this.recordURL=e,this.sendDelay=t,this.enabled=i,this.queue=[],this.pageViewCallbacks=[],this.pageViewSent=!1;var n=this;function r(){var e={referrer_url:document.referrer,screen:{width:window.screen.width,height:window.screen.height,density:window.devicePixelRatio}};window.MediaView&&window.MediaView.mode&&(e.media_mode=window.MediaView.mode);for(var t=document.head.querySelectorAll('meta[name="bc-page-properties"]'),i=0;i<t.length;i++){var r=t[i];Object.assign(e,JSON.parse(r.content))}n.pageViewSent=!0,n.record("page_view",e),n.pageViewCallbacks.forEach((function(t){t.call(e)})),n.pageViewCallbacks=null}document.addEventListener("visibilitychange",(function(){"visible"!==document.visibilityState||n.pageViewSent||r(),"visible"!==document.visibilityState&&n.send()})),window.addEventListener("pagehide",(function(){n.send()})),"visible"===document.visibilityState&&r()}e.prototype.record=function(e,t){this.queue.push({type:e,timestamp:Date.now()/1e3,properties:Object.assign({page_url:location.href},t)}),this.timeout||(this.timeout=setTimeout(this.send.bind(this),this.sendDelay))},e.prototype.send=function(){if(this.timeout&&(clearTimeout(this.timeout),this.timeout=null),0!==this.queue.length){if(!this.enabled)return console.log("Tracker disabled; not sending events:",this.queue),void(this.queue.length=0);console.log("sending "+this.queue.length+" tracking events");var e=JSON.stringify({send_time:Date.now()/1e3,events:this.queue});navigator.sendBeacon(this.recordURL,e)?this.queue.length=0:console.warn("failed to queue sendBeacon for events",this.queue)}else console.log("no events to send")},e.prototype.afterPageView=function(e){this.pageViewSent?e.call():this.pageViewCallbacks.push(e)};var t=new e(JSON.parse(document.currentScript.dataset.recordUrl),1e3*JSON.parse(document.currentScript.dataset.sendDelay),JSON.parse(document.currentScript.dataset.enabled)),i=window.BCTracker&&window.BCTracker.preloadQueue;i&&i.forEach((function(e){t.record.apply(t,e)}));var n=window.BCTracker&&window.BCTracker.prePageViewCallbacks;n&&n.forEach((function(e){t.afterPageView(e)})),window.BCTracker=t}(),function(){"use strict";if(JSON.parse(document.currentScript.dataset.autoTrackClicks)){JSON.parse(document.currentScript.dataset.autoTrackFilters);document.addEventListener("click",(function(e){var t=e.target;"a"===t.localName&&t.host&&t.host!==location.host&&!t.host.endsWith("bandcamp.com")&&BCTracker.record("click",{tag:"external_link",link_url:e.target.href})}),{capture:!0,passive:!0})}}(),function(){"use strict";function e(e){this.intersectionObserver=new IntersectionObserver(this.observeIntersections.bind(this),e),this.elemProps={}}e.prototype.observeIntersections=function(e){var t=this;e.forEach((function(e){if(e.isIntersecting){var i=e.target,n=t.elemProps[i];BCTracker.record("scroll",n),delete t.elemProps[i],t.intersectionObserver.unobserve(i)}}))},e.prototype.track=function(e,t){this.elemProps[e]=t,this.intersectionObserver.observe(e)};var t;e.track=function(i,n){t||(t=new e({threshold:.25})),t.track(i,n)},window.ScrollDepthTracker=e}(),function(){"use strict";const e=/\.?bandcamp\.com$|\.bcbits.com$|\.bcdevs.com$/i;let t=!1;document.addEventListener("DOMContentLoaded",(()=>t=!0)),window.addEventListener("error",(i=>{try{const n=i.filename&&new URL(i.filename);if(n.hostname&&!e.test(n.hostname))return;BCTracker.record("performance",{subtype:"js_error",message:i.message,filename:i.filename,lineno:i.lineno,colno:i.colno,dom_ready:t})}catch(e){console.error(e)}}))}();
