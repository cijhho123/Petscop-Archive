!function(e,t){function n(t,n){var a,s,o,r=t.nodeName.toLowerCase();return"area"===r?(s=(a=t.parentNode).name,!(!t.href||!s||"map"!==a.nodeName.toLowerCase())&&(!!(o=e("img[usemap=#"+s+"]")[0])&&i(o))):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r&&t.href||n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().andSelf().filter((function(){return"hidden"===e.css(this,"visibility")})).length}var a=0,s=/^ui-id-\d+$/;e.ui=e.ui||{},e.ui.version||(e.extend(e.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return"number"==typeof t?this.each((function(){var i=this;setTimeout((function(){e(i).focus(),n&&n.call(i)}),t)})):this._focus.apply(this,arguments)},scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter((function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))})).eq(0):this.parents().filter((function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))})).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,a,s=e(this[0]);s.length&&s[0]!==document;){if(("absolute"===(i=s.css("position"))||"relative"===i||"fixed"===i)&&(a=parseInt(s.css("zIndex"),10),!isNaN(a)&&0!==a))return a;s=s.parent()}return 0},uniqueId:function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++a)}))},removeUniqueId:function(){return this.each((function(){s.test(this.id)&&e(this).removeAttr("id")}))}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo((function(t){return function(n){return!!e.data(n,t)}})):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),a=isNaN(i);return(a||i>=0)&&n(t,!a)}}),e((function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));n.offsetHeight,e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=100===n.offsetHeight,e.support.selectstart="onselectstart"in n,t.removeChild(n).style.display="none"})),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],(function(n,i){function a(t,n,i,a){return e.each(s,(function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(n-=parseFloat(e.css(t,"margin"+this))||0)})),n}var s="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),r={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?r["inner"+i].call(this):this.each((function(){e(this).css(o,a(this,n)+"px")}))},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?r["outer"+i].call(this,t):this.each((function(){e(this).css(o,a(this,t,!0,n)+"px")}))}})),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),function(){var t=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];e.ui.ie=!!t.length,e.ui.ie6=6===parseFloat(t[1],10)}(),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",(function(e){e.preventDefault()}))},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var a,s=e.ui[t].prototype;for(a in i)s.plugins[a]=s.plugins[a]||[],s.plugins[a].push([n,i[a]])},call:function(e,t,n){var i,a=e.plugins[t];if(a&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<a.length;i++)e.options[a[i][0]]&&a[i][1].apply(e.element,n)}},contains:e.contains,hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",a=!1;return t[i]>0||(t[i]=1,a=t[i]>0,t[i]=0,a)},isOverAxis:function(e,t,n){return e>t&&e<t+n},isOver:function(t,n,i,a,s,o){return e.ui.isOverAxis(t,i,s)&&e.ui.isOverAxis(n,a,o)}}))}(jQuery),function(e,t){function n(e,t,n){return[parseInt(e[0],10)*(p.test(e[0])?t/100:1),parseInt(e[1],10)*(p.test(e[1])?n/100:1)]}function i(t,n){return parseInt(e.css(t,n),10)||0}e.ui=e.ui||{};var a,s=Math.max,o=Math.abs,r=Math.round,l=/left|center|right/,c=/top|center|bottom/,d=/[\+\-]\d+%?/,u=/^\w+/,p=/%$/,h=e.fn.position;e.position={scrollbarWidth:function(){if(a!==t)return a;var n,i,s=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return e("body").append(s),n=o.offsetWidth,s.css("overflow","scroll"),n===(i=o.offsetWidth)&&(i=s[0].clientWidth),s.remove(),a=n-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),i=t.isWindow?"":t.element.css("overflow-y"),a="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,s="scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),i=e.isWindow(n[0]);return{element:n,isWindow:i,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:i?n.width():n.outerWidth(),height:i?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return h.apply(this,arguments);t=e.extend({},t);var a,p,m,f,g,_=e(t.of),b=e.position.getWithinInfo(t.within),v=e.position.getScrollInfo(b),y=_[0],w=(t.collision||"flip").split(" "),k={};return 9===y.nodeType?(p=_.width(),m=_.height(),f={top:0,left:0}):e.isWindow(y)?(p=_.width(),m=_.height(),f={top:_.scrollTop(),left:_.scrollLeft()}):y.preventDefault?(t.at="left top",p=m=0,f={top:y.pageY,left:y.pageX}):(p=_.outerWidth(),m=_.outerHeight(),f=_.offset()),g=e.extend({},f),e.each(["my","at"],(function(){var e,n,i=(t[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):c.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=c.test(i[1])?i[1]:"center",e=d.exec(i[0]),n=d.exec(i[1]),k[this]=[e?e[0]:0,n?n[0]:0],t[this]=[u.exec(i[0])[0],u.exec(i[1])[0]]})),1===w.length&&(w[1]=w[0]),"right"===t.at[0]?g.left+=p:"center"===t.at[0]&&(g.left+=p/2),"bottom"===t.at[1]?g.top+=m:"center"===t.at[1]&&(g.top+=m/2),a=n(k.at,p,m),g.left+=a[0],g.top+=a[1],this.each((function(){var l,c,d=e(this),u=d.outerWidth(),h=d.outerHeight(),y=i(this,"marginLeft"),x=i(this,"marginTop"),T=u+y+i(this,"marginRight")+v.width,C=h+x+i(this,"marginBottom")+v.height,D=e.extend({},g),M=n(k.my,d.outerWidth(),d.outerHeight());"right"===t.my[0]?D.left-=u:"center"===t.my[0]&&(D.left-=u/2),"bottom"===t.my[1]?D.top-=h:"center"===t.my[1]&&(D.top-=h/2),D.left+=M[0],D.top+=M[1],e.support.offsetFractions||(D.left=r(D.left),D.top=r(D.top)),l={marginLeft:y,marginTop:x},e.each(["left","top"],(function(n,i){e.ui.position[w[n]]&&e.ui.position[w[n]][i](D,{targetWidth:p,targetHeight:m,elemWidth:u,elemHeight:h,collisionPosition:l,collisionWidth:T,collisionHeight:C,offset:[a[0]+M[0],a[1]+M[1]],my:t.my,at:t.at,within:b,elem:d})})),e.fn.bgiframe&&d.bgiframe(),t.using&&(c=function(e){var n=f.left-D.left,i=n+p-u,a=f.top-D.top,r=a+m-h,l={target:{element:_,left:f.left,top:f.top,width:p,height:m},element:{element:d,left:D.left,top:D.top,width:u,height:h},horizontal:i<0?"left":n>0?"right":"center",vertical:r<0?"top":a>0?"bottom":"middle"};p<u&&o(n+i)<p&&(l.horizontal="center"),m<h&&o(a+r)<m&&(l.vertical="middle"),s(o(n),o(i))>s(o(a),o(r))?l.important="horizontal":l.important="vertical",t.using.call(this,e,l)}),d.offset(e.extend(D,{using:c}))}))},e.ui.position={fit:{left:function(e,t){var n,i=t.within,a=i.isWindow?i.scrollLeft:i.offset.left,o=i.width,r=e.left-t.collisionPosition.marginLeft,l=a-r,c=r+t.collisionWidth-o-a;t.collisionWidth>o?l>0&&c<=0?(n=e.left+l+t.collisionWidth-o-a,e.left+=l-n):e.left=c>0&&l<=0?a:l>c?a+o-t.collisionWidth:a:l>0?e.left+=l:c>0?e.left-=c:e.left=s(e.left-r,e.left)},top:function(e,t){var n,i=t.within,a=i.isWindow?i.scrollTop:i.offset.top,o=t.within.height,r=e.top-t.collisionPosition.marginTop,l=a-r,c=r+t.collisionHeight-o-a;t.collisionHeight>o?l>0&&c<=0?(n=e.top+l+t.collisionHeight-o-a,e.top+=l-n):e.top=c>0&&l<=0?a:l>c?a+o-t.collisionHeight:a:l>0?e.top+=l:c>0?e.top-=c:e.top=s(e.top-r,e.top)}},flip:{left:function(e,t){var n,i,a=t.within,s=a.offset.left+a.scrollLeft,r=a.width,l=a.isWindow?a.scrollLeft:a.offset.left,c=e.left-t.collisionPosition.marginLeft,d=c-l,u=c+t.collisionWidth-r-l,p="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,h="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,m=-2*t.offset[0];d<0?((n=e.left+p+h+m+t.collisionWidth-r-s)<0||n<o(d))&&(e.left+=p+h+m):u>0&&((i=e.left-t.collisionPosition.marginLeft+p+h+m-l)>0||o(i)<u)&&(e.left+=p+h+m)},top:function(e,t){var n,i,a=t.within,s=a.offset.top+a.scrollTop,r=a.height,l=a.isWindow?a.scrollTop:a.offset.top,c=e.top-t.collisionPosition.marginTop,d=c-l,u=c+t.collisionHeight-r-l,p="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,h="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];d<0?(i=e.top+p+h+m+t.collisionHeight-r-s,e.top+p+h+m>d&&(i<0||i<o(d))&&(e.top+=p+h+m)):u>0&&(n=e.top-t.collisionPosition.marginTop+p+h+m-l,e.top+p+h+m>u&&(n>0||o(n)<u)&&(e.top+=p+h+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,i,a,s,o=document.getElementsByTagName("body")[0],r=document.createElement("div");for(s in t=document.createElement(o?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"}),i)t.style[s]=i[s];t.appendChild(r),(n=o||document.documentElement).insertBefore(t,n.firstChild),r.style.cssText="position: absolute; left: 10.7432222px;",a=e(r).offset().left,e.support.offsetFractions=a>10&&a<11,t.innerHTML="",n.removeChild(t)}(),!1!==e.uiBackCompat&&function(e){var n=e.fn.position;e.fn.position=function(i){if(!i||!i.offset)return n.call(this,i);var a=i.offset.split(" "),s=i.at.split(" ");return 1===a.length&&(a[1]=a[0]),/^\d/.test(a[0])&&(a[0]="+"+a[0]),/^\d/.test(a[1])&&(a[1]="+"+a[1]),1===s.length&&(/left|center|right/.test(s[0])?s[1]="center":(s[1]=s[0],s[0]="center")),n.call(this,e.extend(i,{at:s[0]+a[0]+" "+s[1]+a[1],offset:t}))}}(jQuery)}(jQuery),function(e,t){var n=0,i=Array.prototype.slice,a=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(e){}a(t)},e.widget=function(t,n,i){var a,s,o,r,l=t.split(".")[0];t=t.split(".")[1],a=l+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][a.toLowerCase()]=function(t){return!!e.data(t,a)},e[l]=e[l]||{},s=e[l][t],o=e[l][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),(r=new n).options=e.widget.extend({},r.options),e.each(i,(function(t,a){e.isFunction(a)&&(i[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,s=this._superApply;return this._super=e,this._superApply=i,t=a.apply(this,arguments),this._super=n,this._superApply=s,t}}())})),o.prototype=e.widget.extend(r,{widgetEventPrefix:s?r.widgetEventPrefix:t},i,{constructor:o,namespace:l,widgetName:t,widgetBaseClass:a,widgetFullName:a}),s?(e.each(s._childConstructors,(function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,o,n._proto)})),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){for(var a,s,o=i.call(arguments,1),r=0,l=o.length;r<l;r++)for(a in o[r])s=o[r][a],o[r].hasOwnProperty(a)&&s!==t&&(e.isPlainObject(s)?n[a]=e.isPlainObject(n[a])?e.widget.extend({},n[a],s):e.widget.extend({},s):n[a]=s);return n},e.widget.bridge=function(n,a){var s=a.prototype.widgetFullName||n;e.fn[n]=function(o){var r="string"==typeof o,l=i.call(arguments,1),c=this;return o=!r&&l.length?e.widget.extend.apply(null,[o].concat(l)):o,r?this.each((function(){var i,a=e.data(this,s);return a?e.isFunction(a[o])&&"_"!==o.charAt(0)?(i=a[o].apply(a,l))!==a&&i!==t?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0:e.error("no such method '"+o+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+o+"'")})):this.each((function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new a(o,this))})),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetName,this),e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var a,s,o,r=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(r={},a=n.split("."),n=a.shift(),a.length){for(s=r[n]=e.widget.extend({},this.options[n]),o=0;o<a.length-1;o++)s[a[o]]=s[a[o]]||{},s=s[a[o]];if(n=a.pop(),i===t)return s[n]===t?null:s[n];s[n]=i}else{if(i===t)return this.options[n]===t?null:this.options[n];r[n]=i}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var a,s=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=a=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,a=this.widget()),e.each(i,(function(i,o){function r(){if(t||!0!==s.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof o?s[o]:o).apply(s,arguments)}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+s.eventNamespace,d=l[2];d?a.delegate(d,c,r):n.bind(c,r)}))},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){var n=this;return setTimeout((function(){return("string"==typeof e?n[e]:e).apply(n,arguments)}),t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var a,s,o=this.options[t];if(i=i||{},(n=e.Event(n)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent)for(a in s)a in n||(n[a]=s[a]);return this.element.trigger(n,i),!(e.isFunction(o)&&!1===o.apply(this.element[0],[n].concat(i))||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},(function(t,n){e.Widget.prototype["_"+t]=function(i,a,s){"string"==typeof a&&(a={effect:a});var o,r=a?!0===a||"number"==typeof a?n:a.effect||n:t;"number"==typeof(a=a||{})&&(a={duration:a}),o=!e.isEmptyObject(a),a.complete=s,a.delay&&i.delay(a.delay),o&&e.effects&&(e.effects.effect[r]||!1!==e.uiBackCompat&&e.effects[r])?i[t](a):r!==t&&i[r]?i[r](a.duration,a.easing,s):i.queue((function(n){e(this)[t](),s&&s.call(i[0]),n()}))}})),!1!==e.uiBackCompat&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})}(jQuery),function(e,t){var n=!1;e(document).mouseup((function(e){n=!1})),e.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,(function(e){return t._mouseDown(e)})).bind("click."+this.widgetName,(function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!n){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,a=1===t.which,s=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&e(t.target).closest(this.options.cancel).length;return!(a&&!s&&this._mouseCapture(t))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){i.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0))}},_mouseMove:function(t){return!e.ui.ie||document.documentMode>=9||t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(e){return this.mouseDelayMet},_mouseStart:function(e){},_mouseDrag:function(e){},_mouseStop:function(e){},_mouseCapture:function(e){return!0}})}(jQuery),function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return!(this.helper||n.disabled||e(t.target).is(".ui-resizable-handle"))&&(this.handle=this._getHandle(t),!!this.handle&&(e(!0===n.iframeFix?"iframe":n.iframeFix).each((function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")})),!0))},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(!1===this._trigger("drag",t,i))return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1);for(var i=this.element[0],a=!1;i&&(i=i.parentNode);)i==document&&(a=!0);if(!a&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!n||"valid"==this.options.revert&&n||!0===this.options.revert||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)){var s=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),(function(){!1!==s._trigger("stop",t)&&s._clear()}))}else!1!==this._trigger("stop",t)&&this._clear();return!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each((function(){this.parentNode.removeChild(this)})),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var n=!this.options.handle||!e(this.options.handle,this.element).length;return e(this.options.handle,this.element).find("*").andSelf().each((function(){this==t.target&&(n=!0)})),n},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"==n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"==n.appendTo?this.element[0].parentNode:n.appendTo),i[0]!=this.element[0]&&!/(fixed|absolute)/.test(i.css("position"))&&i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;if("parent"==t.containment&&(t.containment=this.helper[0].parentNode),"document"!=t.containment&&"window"!=t.containment||(this.containment=["document"==t.containment?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==t.containment?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==t.containment?0:e(window).scrollLeft())+e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==t.containment?0:e(window).scrollTop())+(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(t.containment)||t.containment.constructor==Array)t.containment.constructor==Array&&(this.containment=t.containment);else{var n=e(t.containment),i=n[0];if(!i)return;n.offset();var a="hidden"!=e(i).css("overflow");this.containment=[(parseInt(e(i).css("borderLeftWidth"),10)||0)+(parseInt(e(i).css("paddingLeft"),10)||0),(parseInt(e(i).css("borderTopWidth"),10)||0)+(parseInt(e(i).css("paddingTop"),10)||0),(a?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e(i).css("borderLeftWidth"),10)||0)-(parseInt(e(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(a?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e(i).css("borderTopWidth"),10)||0)-(parseInt(e(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"==t?1:-1,a=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),s=/(html|body)/i.test(a[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():s?0:a.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():s?0:a.scrollLeft())*i}},_generatePosition:function(t){var n=this.options,i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(i[0].tagName),s=t.pageX,o=t.pageY;if(this.originalPosition){var r;if(this.containment){if(this.relative_container){var l=this.relative_container.offset();r=[this.containment[0]+l.left,this.containment[1]+l.top,this.containment[2]+l.left,this.containment[3]+l.top]}else r=this.containment;t.pageX-this.offset.click.left<r[0]&&(s=r[0]+this.offset.click.left),t.pageY-this.offset.click.top<r[1]&&(o=r[1]+this.offset.click.top),t.pageX-this.offset.click.left>r[2]&&(s=r[2]+this.offset.click.left),t.pageY-this.offset.click.top>r[3]&&(o=r[3]+this.offset.click.top)}if(n.grid){var c=n.grid[1]?this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1]:this.originalPageY;o=r&&(c-this.offset.click.top<r[1]||c-this.offset.click.top>r[3])?c-this.offset.click.top<r[1]?c+n.grid[1]:c-n.grid[1]:c;var d=n.grid[0]?this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0]:this.originalPageX;s=r&&(d-this.offset.click.left<r[0]||d-this.offset.click.left>r[2])?d-this.offset.click.left<r[0]?d+n.grid[0]:d-n.grid[0]:d}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():a?0:i.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():a?0:i.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i]),"drag"==t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(e){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var i=e(this).data("draggable"),a=i.options,s=e.extend({},n,{item:i.element});i.sortables=[],e(a.connectToSortable).each((function(){var n=e.data(this,"sortable");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))}))},stop:function(t,n){var i=e(this).data("draggable"),a=e.extend({},n,{item:i.element});e.each(i.sortables,(function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"==i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,a))}))},drag:function(t,n){var i=e(this).data("draggable"),a=this;e.each(i.sortables,(function(s){var o=!1,r=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(i.sortables,(function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!=r&&this.instance._intersectsWith(this.instance.containerCache)&&e.ui.contains(r.instance.element[0],this.instance.element[0])&&(o=!1),o}))),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(a).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)}))}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n){var i=e("body"),a=e(this).data("draggable").options;i.css("cursor")&&(a._cursor=i.css("cursor")),i.css("cursor",a.cursor)},stop:function(t,n){var i=e(this).data("draggable").options;i._cursor&&e("body").css("cursor",i._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var i=e(n.helper),a=e(this).data("draggable").options;i.css("opacity")&&(a._opacity=i.css("opacity")),i.css("opacity",a.opacity)},stop:function(t,n){var i=e(this).data("draggable").options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(t,n){var i=e(this).data("draggable");i.scrollParent[0]!=document&&"HTML"!=i.scrollParent[0].tagName&&(i.overflowOffset=i.scrollParent.offset())},drag:function(t,n){var i=e(this).data("draggable"),a=i.options,s=!1;i.scrollParent[0]!=document&&"HTML"!=i.scrollParent[0].tagName?(a.axis&&"x"==a.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-t.pageY<a.scrollSensitivity?i.scrollParent[0].scrollTop=s=i.scrollParent[0].scrollTop+a.scrollSpeed:t.pageY-i.overflowOffset.top<a.scrollSensitivity&&(i.scrollParent[0].scrollTop=s=i.scrollParent[0].scrollTop-a.scrollSpeed)),a.axis&&"y"==a.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-t.pageX<a.scrollSensitivity?i.scrollParent[0].scrollLeft=s=i.scrollParent[0].scrollLeft+a.scrollSpeed:t.pageX-i.overflowOffset.left<a.scrollSensitivity&&(i.scrollParent[0].scrollLeft=s=i.scrollParent[0].scrollLeft-a.scrollSpeed))):(a.axis&&"x"==a.axis||(t.pageY-e(document).scrollTop()<a.scrollSensitivity?s=e(document).scrollTop(e(document).scrollTop()-a.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<a.scrollSensitivity&&(s=e(document).scrollTop(e(document).scrollTop()+a.scrollSpeed))),a.axis&&"y"==a.axis||(t.pageX-e(document).scrollLeft()<a.scrollSensitivity?s=e(document).scrollLeft(e(document).scrollLeft()-a.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<a.scrollSensitivity&&(s=e(document).scrollLeft(e(document).scrollLeft()+a.scrollSpeed)))),!1!==s&&e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n){var i=e(this).data("draggable"),a=i.options;i.snapElements=[],e(a.snap.constructor!=String?a.snap.items||":data(draggable)":a.snap).each((function(){var t=e(this),n=t.offset();this!=i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})}))},drag:function(t,n){for(var i=e(this).data("draggable"),a=i.options,s=a.snapTolerance,o=n.offset.left,r=o+i.helperProportions.width,l=n.offset.top,c=l+i.helperProportions.height,d=i.snapElements.length-1;d>=0;d--){var u=i.snapElements[d].left,p=u+i.snapElements[d].width,h=i.snapElements[d].top,m=h+i.snapElements[d].height;if(u-s<o&&o<p+s&&h-s<l&&l<m+s||u-s<o&&o<p+s&&h-s<c&&c<m+s||u-s<r&&r<p+s&&h-s<l&&l<m+s||u-s<r&&r<p+s&&h-s<c&&c<m+s){if("inner"!=a.snapMode){var f=Math.abs(h-c)<=s,g=Math.abs(m-l)<=s,_=Math.abs(u-r)<=s,b=Math.abs(p-o)<=s;f&&(n.position.top=i._convertPositionTo("relative",{top:h-i.helperProportions.height,left:0}).top-i.margins.top),g&&(n.position.top=i._convertPositionTo("relative",{top:m,left:0}).top-i.margins.top),_&&(n.position.left=i._convertPositionTo("relative",{top:0,left:u-i.helperProportions.width}).left-i.margins.left),b&&(n.position.left=i._convertPositionTo("relative",{top:0,left:p}).left-i.margins.left)}var v=f||g||_||b;if("outer"!=a.snapMode){f=Math.abs(h-l)<=s,g=Math.abs(m-c)<=s,_=Math.abs(u-o)<=s,b=Math.abs(p-r)<=s;f&&(n.position.top=i._convertPositionTo("relative",{top:h,left:0}).top-i.margins.top),g&&(n.position.top=i._convertPositionTo("relative",{top:m-i.helperProportions.height,left:0}).top-i.margins.top),_&&(n.position.left=i._convertPositionTo("relative",{top:0,left:u}).left-i.margins.left),b&&(n.position.left=i._convertPositionTo("relative",{top:0,left:p-i.helperProportions.width}).left-i.margins.left)}!i.snapElements[d].snapping&&(f||g||_||b||v)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[d].item})),i.snapElements[d].snapping=f||g||_||b||v}else i.snapElements[d].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[d].item})),i.snapElements[d].snapping=!1}}}),e.ui.plugin.add("draggable","stack",{start:function(t,n){var i=e(this).data("draggable").options,a=e.makeArray(e(i.stack)).sort((function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)}));if(a.length){var s=parseInt(a[0].style.zIndex)||0;e(a).each((function(e){this.style.zIndex=s+e})),this[0].style.zIndex=s+a.length}}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var i=e(n.helper),a=e(this).data("draggable").options;i.css("zIndex")&&(a._zIndex=i.css("zIndex")),i.css("zIndex",a.zIndex)},stop:function(t,n){var i=e(this).data("draggable").options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}})}(jQuery),function(e,t){e.widget("ui.sortable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===e.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display"))),this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){"disabled"===t?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var i=this;if(this.reverting)return!1;if(this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(t);var a=null;e(t.target).parents().each((function(){if(e.data(this,i.widgetName+"-item")==i)return a=e(this),!1}));if(e.data(t.target,i.widgetName+"-item")==i&&(a=e(t.target)),!a)return!1;if(this.options.handle&&!n){var s=!1;if(e(this.options.handle,a).find("*").andSelf().each((function(){this==t.target&&(s=!0)})),!s)return!1}return this.currentItem=a,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,i){var a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",a.cursor)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(var s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll){var n=this.options,i=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-this.overflowOffset.top<n.scrollSensitivity&&(this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop-n.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-this.overflowOffset.left<n.scrollSensitivity&&(this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft-n.scrollSpeed)):(t.pageY-e(document).scrollTop()<n.scrollSensitivity?i=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(i=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed)),t.pageX-e(document).scrollLeft()<n.scrollSensitivity?i=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(i=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed))),!1!==i&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)}this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px");for(var a=this.items.length-1;a>=0;a--){var s=this.items[a],o=s.item[0],r=this._intersectsWithPointer(s);if(r&&(s.instance===this.currentContainer&&!(o==this.currentItem[0]||this.placeholder[1==r?"next":"prev"]()[0]==o||e.contains(this.placeholder[0],o)||"semi-dynamic"==this.options.type&&e.contains(this.element[0],o)))){if(this.direction=1==r?"down":"up","pointer"!=this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,a=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:a.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:a.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,(function(){i._clear(t)}))}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(n).each((function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);n&&i.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))})),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n.each((function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")})),i},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,i=this.positionAbs.top,a=i+this.helperProportions.height,s=e.left,o=s+e.width,r=e.top,l=r+e.height,c=this.offset.click.top,d=this.offset.click.left,u=i+c>r&&i+c<l&&t+d>s&&t+d<o;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?u:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&r<i+this.helperProportions.height/2&&a-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var n="x"===this.options.axis||e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i="y"===this.options.axis||e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),a=n&&i,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return!!a&&(this.floating?o&&"right"==o||"down"==s?2:1:s&&("down"==s?2:1))},_intersectsWithSides:function(t){var n=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),a=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?"right"==s&&i||"left"==s&&!i:a&&("down"==a&&n||"up"==a&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!=e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!=e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n=[],i=[],a=this._connectWith();if(a&&t)for(var s=a.length-1;s>=0;s--)for(var o=e(a[s]),r=o.length-1;r>=0;r--){var l=e.data(o[r],this.widgetName);l&&l!=this&&!l.options.disabled&&i.push([e.isFunction(l.options.items)?l.options.items.call(l.element):e(l.options.items,l.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),l])}i.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(s=i.length-1;s>=0;s--)i[s][0].each((function(){n.push(this)}));return e(n)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,(function(e){for(var n=0;n<t.length;n++)if(t[n]==e.item[0])return!1;return!0}))},_refreshItems:function(t){this.items=[],this.containers=[this];var n=this.items,i=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],a=this._connectWith();if(a&&this.ready)for(var s=a.length-1;s>=0;s--)for(var o=e(a[s]),r=o.length-1;r>=0;r--){var l=e.data(o[r],this.widgetName);l&&l!=this&&!l.options.disabled&&(i.push([e.isFunction(l.options.items)?l.options.items.call(l.element[0],t,{item:this.currentItem}):e(l.options.items,l.element),l]),this.containers.push(l))}for(s=i.length-1;s>=0;s--)for(var c=i[s][1],d=i[s][0],u=(r=0,d.length);r<u;r++){var p=e(d[r]);p.data(this.widgetName+"-item",c),n.push({item:p,instance:c,width:0,height:0,left:0,top:0})}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var n=this.items.length-1;n>=0;n--){var i=this.items[n];if(i.instance==this.currentContainer||!this.currentContainer||i.item[0]==this.currentItem[0]){var a=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item;t||(i.width=a.outerWidth(),i.height=a.outerHeight());var s=a.offset();i.left=s.left,i.top=s.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--){s=this.containers[n].element.offset();this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight()}return this},_createPlaceholder:function(t){var n=(t=t||this).options;if(!n.placeholder||n.placeholder.constructor==String){var i=n.placeholder;n.placeholder={element:function(){var n=e(document.createElement(t.currentItem[0].nodeName)).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return i||(n.style.visibility="hidden"),n},update:function(e,a){i&&!n.forcePlaceholderSize||(a.height()||a.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),a.width()||a.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}}t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_contactContainers:function(t){for(var n=null,i=null,a=this.containers.length-1;a>=0;a--)if(!e.contains(this.currentItem[0],this.containers[a].element[0]))if(this._intersectsWith(this.containers[a].containerCache)){if(n&&e.contains(this.containers[a].element[0],n.element[0]))continue;n=this.containers[a],i=a}else this.containers[a].containerCache.over&&(this.containers[a]._trigger("out",t,this._uiHash(this)),this.containers[a].containerCache.over=0);if(n)if(1===this.containers.length)this.containers[i]._trigger("over",t,this._uiHash(this)),this.containers[i].containerCache.over=1;else{for(var s=1e4,o=null,r=this.containers[i].floating?"left":"top",l=this.containers[i].floating?"width":"height",c=this.positionAbs[r]+this.offset.click[r],d=this.items.length-1;d>=0;d--)if(e.contains(this.containers[i].element[0],this.items[d].item[0])&&this.items[d].item[0]!=this.currentItem[0]){var u=this.items[d].item.offset()[r],p=!1;Math.abs(u-c)>Math.abs(u+this.items[d][l]-c)&&(p=!0,u+=this.items[d][l]),Math.abs(u-c)<s&&(s=Math.abs(u-c),o=this.items[d],this.direction=p?"up":"down")}if(!o&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[i],o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[i].element,!0),this._trigger("change",t,this._uiHash()),this.containers[i]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[i]._trigger("over",t,this._uiHash(this)),this.containers[i].containerCache.over=1}},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"==n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||e("parent"!=n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(""==i[0].style.width||n.forceHelperSize)&&i.width(this.currentItem.width()),(""==i[0].style.height||n.forceHelperSize)&&i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;if("parent"==t.containment&&(t.containment=this.helper[0].parentNode),"document"!=t.containment&&"window"!=t.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),!/^(document|window|parent)$/.test(t.containment)){var n=e(t.containment)[0],i=e(t.containment).offset(),a="hidden"!=e(n).css("overflow");this.containment=[i.left+(parseInt(e(n).css("borderLeftWidth"),10)||0)+(parseInt(e(n).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(n).css("borderTopWidth"),10)||0)+(parseInt(e(n).css("paddingTop"),10)||0)-this.margins.top,i.left+(a?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e(n).css("borderLeftWidth"),10)||0)-(parseInt(e(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(a?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e(n).css("borderTopWidth"),10)||0)-(parseInt(e(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"==t?1:-1,a=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),s=/(html|body)/i.test(a[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():s?0:a.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():s?0:a.scrollLeft())*i}},_generatePosition:function(t){var n=this.options,i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(i[0].tagName);"relative"==this.cssPosition&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var s=t.pageX,o=t.pageY;if(this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid)){var r=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1];o=this.containment&&(r-this.offset.click.top<this.containment[1]||r-this.offset.click.top>this.containment[3])?r-this.offset.click.top<this.containment[1]?r+n.grid[1]:r-n.grid[1]:r;var l=this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0];s=this.containment&&(l-this.offset.click.left<this.containment[0]||l-this.offset.click.left>this.containment[2])?l-this.offset.click.left<this.containment[0]?l+n.grid[0]:l-n.grid[0]:l}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():a?0:i.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():a?0:i.scrollLeft())}},_rearrange:function(e,t,n,i){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var a=this.counter;this._delay((function(){a==this.counter&&this.refreshPositions(!i)}))},_clear:function(t,n){this.reverting=!1;var i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]==this.currentItem[0]){for(var a in this._storedCSS)"auto"!=this._storedCSS[a]&&"static"!=this._storedCSS[a]||(this._storedCSS[a]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!n&&i.push((function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))})),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!n&&i.push((function(e){this._trigger("update",e,this._uiHash())})),this!==this.currentContainer&&(n||(i.push((function(e){this._trigger("remove",e,this._uiHash())})),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))));for(a=this.containers.length-1;a>=0;a--)n||i.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[a])),this.containers[a].containerCache.over&&(i.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[a])),this.containers[a].containerCache.over=0);if(this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!n){this._trigger("beforeStop",t,this._uiHash());for(a=0;a<i.length;a++)i[a].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(n||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null,!n){for(a=0;a<i.length;a++)i[a].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===e.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),function(e,t){var n=!1;e.widget("ui.menu",{version:"1.9.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy((function(e){this.options.disabled&&e.preventDefault()}),this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var i=e(t.target).closest(".ui-menu-item");!n&&i.not(".ui-state-disabled").length&&(n=!0,this.select(t),i.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay((function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)}))},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),n=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each((function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()})),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var i,a,s,o,r,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1,a=this.previousFilter||"",s=String.fromCharCode(t.keyCode),o=!1,clearTimeout(this.filterTimer),s===a?o=!0:s=a+s,r=new RegExp("^"+n(s),"i"),i=this.activeMenu.children(".ui-menu-item").filter((function(){return r.test(e(this).children("a").text())})),(i=o&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i).length||(s=String.fromCharCode(t.keyCode),r=new RegExp("^"+n(s),"i"),i=this.activeMenu.children(".ui-menu-item").filter((function(){return r.test(e(this).children("a").text())}))),i.length?(this.focus(t,i),i.length>1?(this.previousFilter=s,this.filterTimer=this._delay((function(){delete this.previousFilter}),1e3)):delete this.previousFilter):delete this.previousFilter}l&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,i=this.element.find(this.options.menus);i.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each((function(){var t=e(this),i=t.prev("a"),a=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(a),t.attr("aria-labelledby",i.attr("id"))})),(t=i.add(this.element)).children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each((function(){var t=e(this);/[^\-\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")})),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(e,t){var n,i;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),i=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay((function(){this._close()}),this.delay),(n=t.children(".ui-menu")).length&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,i,a,s,o,r;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,a=t.offset().top-this.activeMenu.offset().top-n-i,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=t.height(),a<0?this.activeMenu.scrollTop(s+a):a+r>o&&this.activeMenu.scrollTop(s+a-o+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay((function(){this._close(),this._open(e)}),this.delay))},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay((function(){var i=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(t),this.activeMenu=i}),this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay((function(){this.focus(e,t)})))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var i;this.active&&(i="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),i&&i.length&&this.active||(i=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(n,i)},nextPage:function(t){var n,i,a;this.active?this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,a=this.element.height(),this.active.nextAll(".ui-menu-item").each((function(){return(n=e(this)).offset().top-i-a<0})),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())):this.next(t)},previousPage:function(t){var n,i,a;this.active?this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,a=this.element.height(),this.active.prevAll(".ui-menu-item").each((function(){return(n=e(this)).offset().top-i+a>0})),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first())):this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery),function(e,t){e.widget("ui.slider",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var t,n,i=this.options,a=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s=[];for(this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(i.disabled?" ui-slider-disabled ui-disabled":"")),this.range=e([]),i.range&&(!0===i.range&&(i.values||(i.values=[this._valueMin(),this._valueMin()]),i.values.length&&2!==i.values.length&&(i.values=[i.values[0],i.values[0]])),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===i.range||"max"===i.range?" ui-slider-range-"+i.range:""))),n=i.values&&i.values.length||1,t=a.length;t<n;t++)s.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=a.add(e(s.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click((function(e){e.preventDefault()})).mouseenter((function(){i.disabled||e(this).addClass("ui-state-hover")})).mouseleave((function(){e(this).removeClass("ui-state-hover")})).focus((function(){i.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))})).blur((function(){e(this).removeClass("ui-state-focus")})),this.handles.each((function(t){e(this).data("ui-slider-handle-index",t)})),this._on(this.handles,{keydown:function(t){var n,i,a,s=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),!1===this._start(t,s)))return}switch(a=this.options.step,n=i=this.options.values&&this.options.values.length?this.values(s):this.value(),t.keyCode){case e.ui.keyCode.HOME:i=this._valueMin();break;case e.ui.keyCode.END:i=this._valueMax();break;case e.ui.keyCode.PAGE_UP:i=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/5);break;case e.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/5);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(n===this._valueMax())return;i=this._trimAlignValue(n+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n===this._valueMin())return;i=this._trimAlignValue(n-a)}this._slide(t,s,i)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,i,a,s,o,r,l,c=this,d=this.options;return!d.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(n),a=this._valueMax()-this._valueMin()+1,this.handles.each((function(t){var n=Math.abs(i-c.values(t));a>n&&(a=n,s=e(this),o=t)})),!0===d.range&&this.values(1)===d.min&&(o+=1,s=e(this.handles[o])),!1!==this._start(t,o)&&(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),r=s.offset(),l=!e(t.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-r.left-s.width()/2,top:t.pageY-r.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,i,a,s;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(i=n/t)>1&&(i=1),i<0&&(i=0),"vertical"===this.orientation&&(i=1-i),a=this._valueMax()-this._valueMin(),s=this._valueMin()+i*a,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var i,a,s;this.options.values&&this.options.values.length?(i=this.values(t?0:1),2===this.options.values.length&&!0===this.options.range&&(0===t&&n>i||1===t&&n<i)&&(n=i),n!==this.values(t)&&((a=this.values())[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:a}),i=this.values(t?0:1),!1!==s&&this.values(t,n,!0))):n!==this.value()&&(!1!==(s=this._trigger("slide",e,{handle:this.handles[t],value:n}))&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,n){var i,a,s;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(i=this.options.values,a=arguments[0],s=0;s<i.length;s+=1)i[s]=this._trimAlignValue(a[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var i,a=0;switch(e.isArray(this.options.values)&&(a=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"disabled":n?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;i<a;i+=1)this._change(null,i);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,i;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);for(n=this.options.values.slice(),i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(n[i]);return n},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,i=e-n;return 2*Math.abs(n)>=t&&(i+=n>0?t:-t),parseFloat(i.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,i,a,s,o=this.options.range,r=this.options,l=this,c=!this._animateOff&&r.animate,d={};this.options.values&&this.options.values.length?this.handles.each((function(i){n=(l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())*100,d["horizontal"===l.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[c?"animate":"css"](d,r.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[c?"animate":"css"]({left:n+"%"},r.animate),1===i&&l.range[c?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:r.animate})):(0===i&&l.range.stop(1,1)[c?"animate":"css"]({bottom:n+"%"},r.animate),1===i&&l.range[c?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:r.animate}))),t=n})):(i=this.value(),a=this._valueMin(),s=this._valueMax(),n=s!==a?(i-a)/(s-a)*100:0,d["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[c?"animate":"css"](d,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:n+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:n+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:r.animate}))}})}(jQuery),jQuery.effects||function(e,t){var n=!1!==e.uiBackCompat,i="ui-effects-";e.effects={effect:{}},function(t,n){function i(e,t,n){var i=p[t.type]||{};return null==e?n||!t.def?null:t.def:(e=i.floor?~~e:parseFloat(e),isNaN(e)?t.def:i.mod?(e+i.mod)%i.mod:0>e?0:i.max<e?i.max:e)}function a(e){var n=d(),i=n._rgba=[];return e=e.toLowerCase(),f(c,(function(t,a){var s,o=a.re.exec(e),r=o&&a.parse(o),l=a.space||"rgba";if(r)return s=n[l](r),n[u[l].cache]=s[u[l].cache],i=n._rgba=s._rgba,!1})),i.length?("0,0,0,0"===i.join()&&t.extend(i,o.transparent),n):o[e]}function s(e,t,n){return 6*(n=(n+1)%1)<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}var o,r="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),l=/^([\-+])=\s*(\d+\.?\d*)/,c=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],d=t.Color=function(e,n,i,a){return new t.Color.fn.parse(e,n,i,a)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},p={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},h=d.support={},m=t("<p>")[0],f=t.each;m.style.cssText="background-color:rgba(1,1,1,.5)",h.rgba=m.style.backgroundColor.indexOf("rgba")>-1,f(u,(function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}})),d.fn=t.extend(d.prototype,{parse:function(s,r,l,c){if(s===n)return this._rgba=[null,null,null,null],this;(s.jquery||s.nodeType)&&(s=t(s).css(r),r=n);var p=this,h=t.type(s),m=this._rgba=[];return r!==n&&(s=[s,r,l,c],h="array"),"string"===h?this.parse(a(s)||o._default):"array"===h?(f(u.rgba.props,(function(e,t){m[t.idx]=i(s[t.idx],t)})),this):"object"===h?(f(u,s instanceof d?function(e,t){s[t.cache]&&(p[t.cache]=s[t.cache].slice())}:function(t,n){var a=n.cache;f(n.props,(function(e,t){if(!p[a]&&n.to){if("alpha"===e||null==s[e])return;p[a]=n.to(p._rgba)}p[a][t.idx]=i(s[e],t,!0)})),p[a]&&e.inArray(null,p[a].slice(0,3))<0&&(p[a][3]=1,n.from&&(p._rgba=n.from(p[a])))}),this):void 0},is:function(e){var t=d(e),n=!0,i=this;return f(u,(function(e,a){var s,o=t[a.cache];return o&&(s=i[a.cache]||a.to&&a.to(i._rgba)||[],f(a.props,(function(e,t){if(null!=o[t.idx])return n=o[t.idx]===s[t.idx]}))),n})),n},_space:function(){var e=[],t=this;return f(u,(function(n,i){t[i.cache]&&e.push(n)})),e.pop()},transition:function(e,t){var n=d(e),a=n._space(),s=u[a],o=0===this.alpha()?d("transparent"):this,r=o[s.cache]||s.to(o._rgba),l=r.slice();return n=n[s.cache],f(s.props,(function(e,a){var s=a.idx,o=r[s],c=n[s],d=p[a.type]||{};null!==c&&(null===o?l[s]=c:(d.mod&&(c-o>d.mod/2?o+=d.mod:o-c>d.mod/2&&(o-=d.mod)),l[s]=i((c-o)*t+o,a)))})),this[a](l)},blend:function(e){if(1===this._rgba[3])return this;var n=this._rgba.slice(),i=n.pop(),a=d(e)._rgba;return d(t.map(n,(function(e,t){return(1-i)*a[t]+i*e})))},toRgbaString:function(){var e="rgba(",n=t.map(this._rgba,(function(e,t){return null==e?t>2?1:0:e}));return 1===n[3]&&(n.pop(),e="rgb("),e+n.join()+")"},toHslaString:function(){var e="hsla(",n=t.map(this.hsla(),(function(e,t){return null==e&&(e=t>2?1:0),t&&t<3&&(e=Math.round(100*e)+"%"),e}));return 1===n[3]&&(n.pop(),e="hsl("),e+n.join()+")"},toHexString:function(e){var n=this._rgba.slice(),i=n.pop();return e&&n.push(~~(255*i)),"#"+t.map(n,(function(e){return 1===(e=(e||0).toString(16)).length?"0"+e:e})).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),d.fn.parse.prototype=d.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,i=e[0]/255,a=e[1]/255,s=e[2]/255,o=e[3],r=Math.max(i,a,s),l=Math.min(i,a,s),c=r-l,d=r+l,u=.5*d;return t=l===r?0:i===r?60*(a-s)/c+360:a===r?60*(s-i)/c+120:60*(i-a)/c+240,n=0===u||1===u?u:u<=.5?c/d:c/(2-d),[Math.round(t)%360,n,u,null==o?1:o]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],i=e[2],a=e[3],o=i<=.5?i*(1+n):i+n-i*n,r=2*i-o;return[Math.round(255*s(r,o,t+1/3)),Math.round(255*s(r,o,t)),Math.round(255*s(r,o,t-1/3)),a]},f(u,(function(e,a){var s=a.props,o=a.cache,r=a.to,c=a.from;d.fn[e]=function(e){if(r&&!this[o]&&(this[o]=r(this._rgba)),e===n)return this[o].slice();var a,l=t.type(e),u="array"===l||"object"===l?e:arguments,p=this[o].slice();return f(s,(function(e,t){var n=u["object"===l?e:t.idx];null==n&&(n=p[t.idx]),p[t.idx]=i(n,t)})),c?((a=d(c(p)))[o]=p,a):d(p)},f(s,(function(n,i){d.fn[n]||(d.fn[n]=function(a){var s,o=t.type(a),r="alpha"===n?this._hsla?"hsla":"rgba":e,c=this[r](),d=c[i.idx];return"undefined"===o?d:("function"===o&&(a=a.call(this,d),o=t.type(a)),null==a&&i.empty?this:("string"===o&&((s=l.exec(a))&&(a=d+parseFloat(s[2])*("+"===s[1]?1:-1))),c[i.idx]=a,this[r](c)))})}))})),f(r,(function(e,n){t.cssHooks[n]={set:function(e,i){var s,o,r="";if("string"!==t.type(i)||(s=a(i))){if(i=d(s||i),!h.rgba&&1!==i._rgba[3]){for(o="backgroundColor"===n?e.parentNode:e;(""===r||"transparent"===r)&&o&&o.style;)try{r=t.css(o,"backgroundColor"),o=o.parentNode}catch(e){}i=i.blend(r&&"transparent"!==r?r:"_default")}i=i.toRgbaString()}try{e.style[n]=i}catch(e){}}},t.fx.step[n]=function(e){e.colorInit||(e.start=d(e.elem,n),e.end=d(e.end),e.colorInit=!0),t.cssHooks[n].set(e.elem,e.start.transition(e.end,e.pos))}})),t.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],(function(n,i){t["border"+i+"Color"]=e})),t}},o=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function n(){var t,n,i=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,a={};if(i&&i.length&&i[0]&&i[i[0]])for(n=i.length;n--;)"string"==typeof i[t=i[n]]&&(a[e.camelCase(t)]=i[t]);else for(t in i)"string"==typeof i[t]&&(a[t]=i[t]);return a}function i(t,n){var i,a,o={};for(i in n)a=n[i],t[i]!==a&&!s[i]&&(e.fx.step[i]||!isNaN(parseFloat(a)))&&(o[i]=a);return o}var a=["add","remove","toggle"],s={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],(function(t,n){e.fx.step[n]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,n,e.end),e.setAttr=!0)}})),e.effects.animateClass=function(t,s,o,r){var l=e.speed(s,o,r);return this.queue((function(){var s,o=e(this),r=o.attr("class")||"",c=l.children?o.find("*").andSelf():o;c=c.map((function(){return{el:e(this),start:n.call(this)}})),(s=function(){e.each(a,(function(e,n){t[n]&&o[n+"Class"](t[n])}))})(),c=c.map((function(){return this.end=n.call(this.el[0]),this.diff=i(this.start,this.end),this})),o.attr("class",r),c=c.map((function(){var t=this,n=e.Deferred(),i=jQuery.extend({},l,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,i),n.promise()})),e.when.apply(e,c.get()).done((function(){s(),e.each(arguments,(function(){var t=this.el;e.each(this.diff,(function(e){t.css(e,"")}))})),l.complete.call(o[0])}))}))},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,i,a){return n?e.effects.animateClass.call(this,{add:t},n,i,a):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,i,a){return n?e.effects.animateClass.call(this,{remove:t},n,i,a):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,i,a,s,o){return"boolean"==typeof i||i===t?a?e.effects.animateClass.call(this,i?{add:n}:{remove:n},a,s,o):this._toggleClass(n,i):e.effects.animateClass.call(this,{toggle:n},i,a,s)},switchClass:function(t,n,i,a,s){return e.effects.animateClass.call(this,{add:n,remove:t},i,a,s)}})}(),function(){function a(t,n,i,a){return e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},null==n&&(n={}),e.isFunction(n)&&(a=n,i=null,n={}),("number"==typeof n||e.fx.speeds[n])&&(a=i,i=n,n={}),e.isFunction(i)&&(a=i,i=null),n&&e.extend(t,n),i=i||n.duration,t.duration=e.fx.off?0:"number"==typeof i?i:i in e.fx.speeds?e.fx.speeds[i]:e.fx.speeds._default,t.complete=a||n.complete,t}function s(t){return!(t&&"number"!=typeof t&&!e.fx.speeds[t])||"string"==typeof t&&!e.effects.effect[t]&&(!n||!e.effects[t])}e.extend(e.effects,{version:"1.9.2",save:function(e,t){for(var n=0;n<t.length;n++)null!==t[n]&&e.data(i+t[n],e[0].style[t[n]])},restore:function(e,n){var a,s;for(s=0;s<n.length;s++)null!==n[s]&&((a=e.data(i+n[s]))===t&&(a=""),e.css(n[s],a))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,i;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":i=0;break;case"center":i=.5;break;case"right":i=1;break;default:i=e[1]/t.width}return{x:i,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),float:t.css("float")},i=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),a={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(e){s=document.body}return t.wrap(i),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),i=t.parent(),"static"===t.css("position")?(i.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],(function(e,i){n[i]=t.css(i),isNaN(parseInt(n[i],10))&&(n[i]="auto")})),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(a),i.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,i,a){return a=a||{},e.each(n,(function(e,n){var s=t.cssUnit(n);s[0]>0&&(a[n]=s[0]*i+s[1])})),a}}),e.fn.extend({effect:function(){function t(t){function n(){e.isFunction(s)&&s.call(a[0]),e.isFunction(t)&&t()}var a=e(this),s=i.complete,o=i.mode;(a.is(":hidden")?"hide"===o:"show"===o)?n():r.call(a[0],i,n)}var i=a.apply(this,arguments),s=i.mode,o=i.queue,r=e.effects.effect[i.effect],l=!r&&n&&e.effects[i.effect];return e.fx.off||!r&&!l?s?this[s](i.duration,i.complete):this.each((function(){i.complete&&i.complete.call(this)})):r?!1===o?this.each(t):this.queue(o||"fx",t):l.call(this,{options:i,duration:i.duration,callback:i.complete,mode:i.mode})},_show:e.fn.show,show:function(e){if(s(e))return this._show.apply(this,arguments);var t=a.apply(this,arguments);return t.mode="show",this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(s(e))return this._hide.apply(this,arguments);var t=a.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(s(t)||"boolean"==typeof t||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=a.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)},cssUnit:function(t){var n=this.css(t),i=[];return e.each(["em","px","%","pt"],(function(e,t){n.indexOf(t)>0&&(i=[parseFloat(n),t])})),i}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],(function(e,n){t[n]=function(t){return Math.pow(t,e+2)}})),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,(function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?n(2*e)/2:1-n(-2*e+2)/2}}))}()}(jQuery),function(e,t){var n="ui-dialog ui-widget ui-widget-content ui-corner-all ",i={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},a={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.9.2",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;n<0&&e(this).css("top",t.top-n)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),"string"!=typeof this.originalTitle&&(this.originalTitle=""),this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.options.title=this.options.title||this.originalTitle;var t,i,a,s,o,r=this,l=this.options,c=l.title||"&#160;";t=(this.uiDialog=e("<div>")).addClass(n+l.dialogClass).css({display:"none",outline:0,zIndex:l.zIndex}).attr("tabIndex",-1).keydown((function(t){l.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE&&(r.close(t),t.preventDefault())})).mousedown((function(e){r.moveToTop(!1,e)})).appendTo("body"),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(t),i=(this.uiDialogTitlebar=e("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").bind("mousedown",(function(){t.focus()})).prependTo(t),a=e("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click((function(e){e.preventDefault(),r.close(e)})).appendTo(i),(this.uiDialogTitlebarCloseText=e("<span>")).addClass("ui-icon ui-icon-closethick").text(l.closeText).appendTo(a),s=e("<span>").uniqueId().addClass("ui-dialog-title").html(c).prependTo(i),o=(this.uiDialogButtonPane=e("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),(this.uiButtonSet=e("<div>")).addClass("ui-dialog-buttonset").appendTo(o),t.attr({role:"dialog","aria-labelledby":s.attr("id")}),i.find("*").add(i).disableSelection(),this._hoverable(a),this._focusable(a),l.draggable&&e.fn.draggable&&this._makeDraggable(),l.resizable&&e.fn.resizable&&this._makeResizable(),this._createButtons(l.buttons),this._isOpen=!1,e.fn.bgiframe&&t.bgiframe(),this._on(t,{keydown:function(n){if(l.modal&&n.keyCode===e.ui.keyCode.TAB){var i=e(":tabbable",t),a=i.filter(":first"),s=i.filter(":last");return n.target!==s[0]||n.shiftKey?n.target===a[0]&&n.shiftKey?(s.focus(1),!1):void 0:(a.focus(1),!1)}}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var e,t=this.oldPosition;this.overlay&&this.overlay.destroy(),this.uiDialog.hide(),this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(e=t.parent.children().eq(t.index)).length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(t){var n,i,a=this;if(this._isOpen&&!1!==this._trigger("beforeClose",t))return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this._hide(this.uiDialog,this.options.hide,(function(){a._trigger("close",t)})):(this.uiDialog.hide(),this._trigger("close",t)),e.ui.dialog.overlay.resize(),this.options.modal&&(n=0,e(".ui-dialog").each((function(){this!==a.uiDialog[0]&&(i=e(this).css("z-index"),isNaN(i)||(n=Math.max(n,i)))})),e.ui.dialog.maxZ=n),this},isOpen:function(){return this._isOpen},moveToTop:function(t,n){var i,a=this.options;return a.modal&&!t||!a.stack&&!a.modal?this._trigger("focus",n):(a.zIndex>e.ui.dialog.maxZ&&(e.ui.dialog.maxZ=a.zIndex),this.overlay&&(e.ui.dialog.maxZ+=1,e.ui.dialog.overlay.maxZ=e.ui.dialog.maxZ,this.overlay.$el.css("z-index",e.ui.dialog.overlay.maxZ)),i={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},e.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",e.ui.dialog.maxZ),this.element.attr(i),this._trigger("focus",n),this)},open:function(){if(!this._isOpen){var t,n=this.options,i=this.uiDialog;return this._size(),this._position(n.position),i.show(n.show),this.overlay=n.modal?new e.ui.dialog.overlay(this):null,this.moveToTop(!0),(t=this.element.find(":tabbable")).length||((t=this.uiDialogButtonPane.find(":tabbable")).length||(t=i)),t.eq(0).focus(),this._isOpen=!0,this._trigger("open"),this}},_createButtons:function(t){var n=this,i=!1;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),"object"==typeof t&&null!==t&&e.each(t,(function(){return!(i=!0)})),i?(e.each(t,(function(t,i){var a,s;i=e.isFunction(i)?{click:i,text:t}:i,i=e.extend({type:"button"},i),s=i.click,i.click=function(){s.apply(n.element[0],arguments)},a=e("<button></button>",i).appendTo(n.uiButtonSet),e.fn.button&&a.button()})),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var n=this,i=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(i,a){e(this).addClass("ui-dialog-dragging"),n._trigger("dragStart",i,t(a))},drag:function(e,i){n._trigger("drag",e,t(i))},stop:function(a,s){i.position=[s.position.left-n.document.scrollLeft(),s.position.top-n.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),n._trigger("dragStop",a,t(s)),e.ui.dialog.overlay.resize()}})},_makeResizable:function(t){function n(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}t=undefined===t?this.options.resizable:t;var i=this,a=this.options,s=this.uiDialog.css("position"),o="string"==typeof t?t:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:a.maxWidth,maxHeight:a.maxHeight,minWidth:a.minWidth,minHeight:this._minHeight(),handles:o,start:function(t,a){e(this).addClass("ui-dialog-resizing"),i._trigger("resizeStart",t,n(a))},resize:function(e,t){i._trigger("resize",e,n(t))},stop:function(t,s){e(this).removeClass("ui-dialog-resizing"),a.height=e(this).height(),a.width=e(this).width(),i._trigger("resizeStop",t,n(s)),e.ui.dialog.overlay.resize()}}).css("position",s).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(t){var n,i=[],a=[0,0];t?(("string"==typeof t||"object"==typeof t&&"0"in t)&&(1===(i=t.split?t.split(" "):[t[0],t[1]]).length&&(i[1]=i[0]),e.each(["left","top"],(function(e,t){+i[e]===i[e]&&(a[e]=i[e],i[e]=t)})),t={my:i[0]+(a[0]<0?a[0]:"+"+a[0])+" "+i[1]+(a[1]<0?a[1]:"+"+a[1]),at:i.join(" ")}),t=e.extend({},e.ui.dialog.prototype.options.position,t)):t=e.ui.dialog.prototype.options.position,(n=this.uiDialog.is(":visible"))||this.uiDialog.show(),this.uiDialog.position(t),n||this.uiDialog.hide()},_setOptions:function(t){var n=this,s={},o=!1;e.each(t,(function(e,t){n._setOption(e,t),e in i&&(o=!0),e in a&&(s[e]=t)})),o&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",s)},_setOption:function(t,i){var a,s,o=this.uiDialog;switch(t){case"buttons":this._createButtons(i);break;case"closeText":this.uiDialogTitlebarCloseText.text(""+i);break;case"dialogClass":o.removeClass(this.options.dialogClass).addClass(n+i);break;case"disabled":i?o.addClass("ui-dialog-disabled"):o.removeClass("ui-dialog-disabled");break;case"draggable":(a=o.is(":data(draggable)"))&&!i&&o.draggable("destroy"),!a&&i&&this._makeDraggable();break;case"position":this._position(i);break;case"resizable":(s=o.is(":data(resizable)"))&&!i&&o.resizable("destroy"),s&&"string"==typeof i&&o.resizable("option","handles",i),!s&&!1!==i&&this._makeResizable(i);break;case"title":e(".ui-dialog-title",this.uiDialogTitlebar).html(""+(i||"&#160;"))}this._super(t,i)},_size:function(){var t,n,i,a=this.options,s=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),a.minWidth>a.width&&(a.width=a.minWidth),t=this.uiDialog.css({height:"auto",width:a.width}).outerHeight(),n=Math.max(0,a.minHeight-t),"auto"===a.height?e.support.minHeight?this.element.css({minHeight:n,height:"auto"}):(this.uiDialog.show(),i=this.element.css("height","auto").height(),s||this.uiDialog.hide(),this.element.height(Math.max(i,n))):this.element.height(Math.max(a.height-t,0)),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),e.extend(e.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(e){var t=e.attr("id");return t||(this.uuid+=1,t=this.uuid),"ui-dialog-title-"+t},overlay:function(t){this.$el=e.ui.dialog.overlay.create(t)}}),e.extend(e.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),(function(e){return e+".dialog-overlay"})).join(" "),create:function(t){0===this.instances.length&&(setTimeout((function(){e.ui.dialog.overlay.instances.length&&e(document).bind(e.ui.dialog.overlay.events,(function(t){if(e(t.target).zIndex()<e.ui.dialog.overlay.maxZ)return!1}))}),1),e(window).bind("resize.dialog-overlay",e.ui.dialog.overlay.resize));var n=this.oldInstances.pop()||e("<div>").addClass("ui-widget-overlay");return e(document).bind("keydown.dialog-overlay",(function(i){var a=e.ui.dialog.overlay.instances;0!==a.length&&a[a.length-1]===n&&t.options.closeOnEscape&&!i.isDefaultPrevented()&&i.keyCode&&i.keyCode===e.ui.keyCode.ESCAPE&&(t.close(i),i.preventDefault())})),n.appendTo(document.body).css({width:this.width(),height:this.height()}),e.fn.bgiframe&&n.bgiframe(),this.instances.push(n),n},destroy:function(t){var n=e.inArray(t,this.instances),i=0;-1!==n&&this.oldInstances.push(this.instances.splice(n,1)[0]),0===this.instances.length&&e([document,window]).unbind(".dialog-overlay"),t.height(0).width(0).remove(),e.each(this.instances,(function(){i=Math.max(i,this.css("z-index"))})),this.maxZ=i},height:function(){var t;return e.ui.ie?(t=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight))<Math.max(document.documentElement.offsetHeight,document.body.offsetHeight)?e(window).height()+"px":t+"px":e(document).height()+"px"},width:function(){var t;return e.ui.ie?(t=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth))<Math.max(document.documentElement.offsetWidth,document.body.offsetWidth)?e(window).width()+"px":t+"px":e(document).width()+"px"},resize:function(){var t=e([]);e.each(e.ui.dialog.overlay.instances,(function(){t=t.add(this)})),t.css({width:0,height:0}).css({width:e.ui.dialog.overlay.width(),height:e.ui.dialog.overlay.height()})}}),e.extend(e.ui.dialog.overlay.prototype,{destroy:function(){e.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(e,t){function n(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=i(e('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function i(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",(function(){e(this).removeClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")})).delegate(n,"mouseover",(function(){e.datepicker._isDisabledDatepicker(s.inline?t.parent()[0]:s.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}))}function a(n,i){for(var a in e.extend(n,i),i)null!=i[a]&&i[a]!=t||(n[a]=i[a]);return n}e.extend(e.ui,{datepicker:{version:"1.9.2"}});var s,o="datepicker",r=(new Date).getTime();e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return a(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var i=t.nodeName.toLowerCase(),a="div"==i||"span"==i;t.id||(this.uuid+=1,t.id="dp"+this.uuid);var s=this._newInst(e(t),a);s.settings=e.extend({},n||{},{}),"input"==i?this._connectDatepicker(t,s):a&&this._inlineDatepicker(t,s)},_newInst:function(t,n){return{id:t[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?i(e('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(t,n){var i=e(t);n.append=e([]),n.trigger=e([]),i.hasClass(this.markerClassName)||(this._attachments(i,n),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",(function(e,t,i){n.settings[t]=i})).bind("getData.datepicker",(function(e,t){return this._get(n,t)})),this._autoSize(n),e.data(t,o,n),n.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,n){var i=this._get(n,"appendText"),a=this._get(n,"isRTL");n.append&&n.append.remove(),i&&(n.append=e('<span class="'+this._appendClass+'">'+i+"</span>"),t[a?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove();var s=this._get(n,"showOn");if(("focus"==s||"both"==s)&&t.focus(this._showDatepicker),"button"==s||"both"==s){var o=this._get(n,"buttonText"),r=this._get(n,"buttonImage");n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:r,alt:o,title:o}):e('<button type="button"></button>').addClass(this._triggerClass).html(""==r?o:e("<img/>").attr({src:r,alt:o,title:o}))),t[a?"before":"after"](n.trigger),n.trigger.click((function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput==t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!=t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t=new Date(2009,11,20),n=this._get(e,"dateFormat");if(n.match(/[DM]/)){var i=function(e){for(var t=0,n=0,i=0;i<e.length;i++)e[i].length>t&&(t=e[i].length,n=i);return n};t.setMonth(i(this._get(e,n.match(/MM/)?"monthNames":"monthNamesShort"))),t.setDate(i(this._get(e,n.match(/DD/)?"dayNames":"dayNamesShort"))+20-t.getDay())}e.input.attr("size",this._formatDate(e,t).length)}},_inlineDatepicker:function(t,n){var i=e(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(n.dpDiv).bind("setData.datepicker",(function(e,t,i){n.settings[t]=i})).bind("getData.datepicker",(function(e,t){return this._get(n,t)})),e.data(t,o,n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(t),n.dpDiv.css("display","block"))},_dialogDatepicker:function(t,n,i,s,r){var l=this._dialogInst;if(!l){this.uuid+=1;var c="dp"+this.uuid;this._dialogInput=e('<input type="text" id="'+c+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),(l=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},e.data(this._dialogInput[0],o,l)}if(a(l.settings,s||{}),n=n&&n.constructor==Date?this._formatDate(l,n):n,this._dialogInput.val(n),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,!this._pos){var d=document.documentElement.clientWidth,u=document.documentElement.clientHeight,p=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[d/2-100+p,u/2-150+h]}return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),l.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],o,l),this},_destroyDatepicker:function(t){var n=e(t),i=e.data(t,o);if(n.hasClass(this.markerClassName)){var a=t.nodeName.toLowerCase();e.removeData(t,o),"input"==a?(i.append.remove(),i.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==a||"span"==a)&&n.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(t){var n=e(t),i=e.data(t,o);if(n.hasClass(this.markerClassName)){var a=t.nodeName.toLowerCase();if("input"==a)t.disabled=!1,i.trigger.filter("button").each((function(){this.disabled=!1})).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==a||"span"==a){var s=n.children("."+this._inlineClass);s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)}this._disabledInputs=e.map(this._disabledInputs,(function(e){return e==t?null:e}))}},_disableDatepicker:function(t){var n=e(t),i=e.data(t,o);if(n.hasClass(this.markerClassName)){var a=t.nodeName.toLowerCase();if("input"==a)t.disabled=!0,i.trigger.filter("button").each((function(){this.disabled=!0})).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==a||"span"==a){var s=n.children("."+this._inlineClass);s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)}this._disabledInputs=e.map(this._disabledInputs,(function(e){return e==t?null:e})),this._disabledInputs[this._disabledInputs.length]=t}},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]==e)return!0;return!1},_getInst:function(t){try{return e.data(t,o)}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(n,i,s){var o=this._getInst(n);if(2==arguments.length&&"string"==typeof i)return"defaults"==i?e.extend({},e.datepicker._defaults):o?"all"==i?e.extend({},o.settings):this._get(o,i):null;var r=i||{};if("string"==typeof i&&((r={})[i]=s),o){this._curInst==o&&this._hideDatepicker();var l=this._getDateDatepicker(n,!0),c=this._getMinMaxDate(o,"min"),d=this._getMinMaxDate(o,"max");a(o.settings,r),null!==c&&r.dateFormat!==t&&r.minDate===t&&(o.settings.minDate=this._formatDate(o,c)),null!==d&&r.dateFormat!==t&&r.maxDate===t&&(o.settings.maxDate=this._formatDate(o,d)),this._attachments(e(n),o),this._autoSize(o),this._setDate(o,l),this._updateAlternate(o),this._updateDatepicker(o)}},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n=e.datepicker._getInst(t.target),i=!0,a=n.dpDiv.is(".ui-datepicker-rtl");if(n._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),i=!1;break;case 13:var s=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",n.dpDiv);s[0]&&e.datepicker._selectDay(t.target,n.selectedMonth,n.selectedYear,s[0]);var o=e.datepicker._get(n,"onSelect");if(o){var r=e.datepicker._formatDate(n);o.apply(n.input?n.input[0]:null,[r,n])}else e.datepicker._hideDatepicker();return!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(n,"stepBigMonths"):-e.datepicker._get(n,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(n,"stepBigMonths"):+e.datepicker._get(n,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),i=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),i=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,a?1:-1,"D"),i=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(n,"stepBigMonths"):-e.datepicker._get(n,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),i=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,a?-1:1,"D"),i=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(n,"stepBigMonths"):+e.datepicker._get(n,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),i=t.ctrlKey||t.metaKey;break;default:i=!1}else 36==t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):i=!1;i&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(n){var i=e.datepicker._getInst(n.target);if(e.datepicker._get(i,"constrainInput")){var a=e.datepicker._possibleChars(e.datepicker._get(i,"dateFormat")),s=String.fromCharCode(n.charCode==t?n.keyCode:n.charCode);return n.ctrlKey||n.metaKey||s<" "||!a||a.indexOf(s)>-1}},_doKeyUp:function(t){var n=e.datepicker._getInst(t.target);if(n.input.val()!=n.lastVal)try{e.datepicker.parseDate(e.datepicker._get(n,"dateFormat"),n.input?n.input.val():null,e.datepicker._getFormatConfig(n))&&(e.datepicker._setDateFromField(n),e.datepicker._updateAlternate(n),e.datepicker._updateDatepicker(n))}catch(t){e.datepicker.log(t)}return!0},_showDatepicker:function(t){if("input"!=(t=t.target||t).nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!=t){var n=e.datepicker._getInst(t);e.datepicker._curInst&&e.datepicker._curInst!=n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0]));var i=e.datepicker._get(n,"beforeShow"),s=i?i.apply(t,[t,n]):{};if(!1!==s){a(n.settings,s),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight);var o=!1;e(t).parents().each((function(){return!(o|="fixed"==e(this).css("position"))}));var r={left:e.datepicker._pos[0],top:e.datepicker._pos[1]};if(e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),r=e.datepicker._checkOffset(n,r,o),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),!n.inline){var l=e.datepicker._get(n,"showAnim"),c=e.datepicker._get(n,"duration"),d=function(){var t=n.dpDiv.find("iframe.ui-datepicker-cover");if(t.length){var i=e.datepicker._getBorders(n.dpDiv);t.css({left:-i[0],top:-i[1],width:n.dpDiv.outerWidth(),height:n.dpDiv.outerHeight()})}};n.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&(e.effects.effect[l]||e.effects[l])?n.dpDiv.show(l,e.datepicker._get(n,"showOptions"),c,d):n.dpDiv[l||"show"](l?c:null,d),(!l||!c)&&d(),n.input.is(":visible")&&!n.input.is(":disabled")&&n.input.focus(),e.datepicker._curInst=n}}}},_updateDatepicker:function(t){this.maxRows=4;var n=e.datepicker._getBorders(t.dpDiv);s=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i=t.dpDiv.find("iframe.ui-datepicker-cover");!i.length||i.css({left:-n[0],top:-n[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()}),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var a=this._getNumberOfMonths(t),o=a[1];if(t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),o>1&&t.dpDiv.addClass("ui-datepicker-multi-"+o).css("width",17*o+"em"),t.dpDiv[(1!=a[0]||1!=a[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t==e.datepicker._curInst&&e.datepicker._datepickerShowing&&t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&t.input[0]!=document.activeElement&&t.input.focus(),t.yearshtml){var r=t.yearshtml;setTimeout((function(){r===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),r=t.yearshtml=null}),0)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(t,n,i){var a=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(i?0:e(document).scrollLeft()),c=document.documentElement.clientHeight+(i?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?a-o:0,n.left-=i&&n.left==t.input.offset().left?e(document).scrollLeft():0,n.top-=i&&n.top==t.input.offset().top+r?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+a>l&&l>a?Math.abs(n.left+a-l):0),n.top-=Math.min(n.top,n.top+s>c&&c>s?Math.abs(s+r):0),n},_findPos:function(t){for(var n=this._getInst(t),i=this._get(n,"isRTL");t&&("hidden"==t.type||1!=t.nodeType||e.expr.filters.hidden(t));)t=t[i?"previousSibling":"nextSibling"];var a=e(t).offset();return[a.left,a.top]},_hideDatepicker:function(t){var n=this._curInst;if(n&&(!t||n==e.data(t,o))&&this._datepickerShowing){var i=this._get(n,"showAnim"),a=this._get(n,"duration"),s=function(){e.datepicker._tidyDialog(n)};e.effects&&(e.effects.effect[i]||e.effects[i])?n.dpDiv.hide(i,e.datepicker._get(n,"showOptions"),a,s):n.dpDiv["slideDown"==i?"slideUp":"fadeIn"==i?"fadeOut":"hide"](i?a:null,s),i||s(),this._datepickerShowing=!1;var r=this._get(n,"onClose");r&&r.apply(n.input?n.input[0]:null,[n.input?n.input.val():"",n]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var n=e(t.target),i=e.datepicker._getInst(n[0]);(n[0].id!=e.datepicker._mainDivId&&0==n.parents("#"+e.datepicker._mainDivId).length&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!=i)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,n,i){var a=e(t),s=this._getInst(a[0]);this._isDisabledDatepicker(a[0])||(this._adjustInstDate(s,n+("M"==i?this._get(s,"showCurrentAtPos"):0),i),this._updateDatepicker(s))},_gotoToday:function(t){var n=e(t),i=this._getInst(n[0]);if(this._get(i,"gotoCurrent")&&i.currentDay)i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear;else{var a=new Date;i.selectedDay=a.getDate(),i.drawMonth=i.selectedMonth=a.getMonth(),i.drawYear=i.selectedYear=a.getFullYear()}this._notifyChange(i),this._adjustDate(n)},_selectMonthYear:function(t,n,i){var a=e(t),s=this._getInst(a[0]);s["selected"+("M"==i?"Month":"Year")]=s["draw"+("M"==i?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(a)},_selectDay:function(t,n,i,a){var s=e(t);if(!e(a).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(s[0])){var o=this._getInst(s[0]);o.selectedDay=o.currentDay=e("a",a).html(),o.selectedMonth=o.currentMonth=n,o.selectedYear=o.currentYear=i,this._selectDate(t,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear))}},_clearDate:function(t){var n=e(t);this._getInst(n[0]);this._selectDate(n,"")},_selectDate:function(t,n){var i=e(t),a=this._getInst(i[0]);n=null!=n?n:this._formatDate(a),a.input&&a.input.val(n),this._updateAlternate(a);var s=this._get(a,"onSelect");s?s.apply(a.input?a.input[0]:null,[n,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n=this._get(t,"altField");if(n){var i=this._get(t,"altFormat")||this._get(t,"dateFormat"),a=this._getDate(t),s=this.formatDate(i,a,this._getFormatConfig(t));e(n).each((function(){e(this).val(s)}))}},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t=new Date(e.getTime());t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1},parseDate:function(t,n,i){if(null==t||null==n)throw"Invalid arguments";if(""==(n="object"==typeof n?n.toString():n+""))return null;var a=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff;a="string"!=typeof a?a:(new Date).getFullYear()%100+parseInt(a,10);for(var s=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,r=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,l=(i?i.monthNames:null)||this._defaults.monthNames,c=-1,d=-1,u=-1,p=-1,h=!1,m=function(e){var n=v+1<t.length&&t.charAt(v+1)==e;return n&&v++,n},f=function(e){var t=m(e),i=new RegExp("^\\d{1,"+("@"==e?14:"!"==e?20:"y"==e&&t?4:"o"==e?3:2)+"}"),a=n.substring(b).match(i);if(!a)throw"Missing number at position "+b;return b+=a[0].length,parseInt(a[0],10)},g=function(t,i,a){var s=e.map(m(t)?a:i,(function(e,t){return[[t,e]]})).sort((function(e,t){return-(e[1].length-t[1].length)})),o=-1;if(e.each(s,(function(e,t){var i=t[1];if(n.substr(b,i.length).toLowerCase()==i.toLowerCase())return o=t[0],b+=i.length,!1})),-1!=o)return o+1;throw"Unknown name at position "+b},_=function(){if(n.charAt(b)!=t.charAt(v))throw"Unexpected literal at position "+b;b++},b=0,v=0;v<t.length;v++)if(h)"'"!=t.charAt(v)||m("'")?_():h=!1;else switch(t.charAt(v)){case"d":u=f("d");break;case"D":g("D",s,o);break;case"o":p=f("o");break;case"m":d=f("m");break;case"M":d=g("M",r,l);break;case"y":c=f("y");break;case"@":c=(y=new Date(f("@"))).getFullYear(),d=y.getMonth()+1,u=y.getDate();break;case"!":var y;c=(y=new Date((f("!")-this._ticksTo1970)/1e4)).getFullYear(),d=y.getMonth()+1,u=y.getDate();break;case"'":m("'")?_():h=!0;break;default:_()}if(b<n.length){var w=n.substr(b);if(!/^\s+/.test(w))throw"Extra/unparsed characters found in date: "+w}if(-1==c?c=(new Date).getFullYear():c<100&&(c+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c<=a?0:-100)),p>-1)for(d=1,u=p;;){var k=this._getDaysInMonth(c,d-1);if(u<=k)break;d++,u-=k}if((y=this._daylightSavingAdjust(new Date(c,d-1,u))).getFullYear()!=c||y.getMonth()+1!=d||y.getDate()!=u)throw"Invalid date";return y},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,a=(n?n.dayNames:null)||this._defaults.dayNames,s=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,o=(n?n.monthNames:null)||this._defaults.monthNames,r=function(t){var n=p+1<e.length&&e.charAt(p+1)==t;return n&&p++,n},l=function(e,t,n){var i=""+t;if(r(e))for(;i.length<n;)i="0"+i;return i},c=function(e,t,n,i){return r(e)?i[t]:n[t]},d="",u=!1;if(t)for(var p=0;p<e.length;p++)if(u)"'"!=e.charAt(p)||r("'")?d+=e.charAt(p):u=!1;else switch(e.charAt(p)){case"d":d+=l("d",t.getDate(),2);break;case"D":d+=c("D",t.getDay(),i,a);break;case"o":d+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",t.getMonth()+1,2);break;case"M":d+=c("M",t.getMonth(),s,o);break;case"y":d+=r("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":r("'")?d+="'":u=!0;break;default:d+=e.charAt(p)}return d},_possibleChars:function(e){for(var t="",n=!1,i=function(t){var n=a+1<e.length&&e.charAt(a+1)==t;return n&&a++,n},a=0;a<e.length;a++)if(n)"'"!=e.charAt(a)||i("'")?t+=e.charAt(a):n=!1;else switch(e.charAt(a)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":i("'")?t+="'":n=!0;break;default:t+=e.charAt(a)}return t},_get:function(e,n){return e.settings[n]!==t?e.settings[n]:this._defaults[n]},_setDateFromField:function(e,t){if(e.input.val()!=e.lastVal){var n,i,a=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null;n=i=this._getDefaultDate(e);var o=this._getFormatConfig(e);try{n=this.parseDate(a,s,o)||i}catch(e){this.log(e),s=t?"":s}e.selectedDay=n.getDate(),e.drawMonth=e.selectedMonth=n.getMonth(),e.drawYear=e.selectedYear=n.getFullYear(),e.currentDay=s?n.getDate():0,e.currentMonth=s?n.getMonth():0,e.currentYear=s?n.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,i){var a=null==n||""===n?i:"string"==typeof n?function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(e){}for(var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=i.getFullYear(),s=i.getMonth(),o=i.getDate(),r=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=r.exec(n);l;){switch(l[2]||"d"){case"d":case"D":o+=parseInt(l[1],10);break;case"w":case"W":o+=7*parseInt(l[1],10);break;case"m":case"M":s+=parseInt(l[1],10),o=Math.min(o,e.datepicker._getDaysInMonth(a,s));break;case"y":case"Y":a+=parseInt(l[1],10),o=Math.min(o,e.datepicker._getDaysInMonth(a,s))}l=r.exec(n)}return new Date(a,s,o)}(n):"number"==typeof n?isNaN(n)?i:function(e){var t=new Date;return t.setDate(t.getDate()+e),t}(n):new Date(n.getTime());return(a=a&&"Invalid Date"==a.toString()?i:a)&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var i=!t,a=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(a!=e.selectedMonth||s!=e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(i?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""==e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map((function(){var t={prev:function(){window["DP_jQuery_"+r].datepicker._adjustDate(i,-n,"M")},next:function(){window["DP_jQuery_"+r].datepicker._adjustDate(i,+n,"M")},hide:function(){window["DP_jQuery_"+r].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+r].datepicker._gotoToday(i)},selectDay:function(){return window["DP_jQuery_"+r].datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+r].datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+r].datepicker._selectMonthYear(i,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])}))},_generateHTML:function(t){var n=new Date;n=this._daylightSavingAdjust(new Date(n.getFullYear(),n.getMonth(),n.getDate()));var i=this._get(t,"isRTL"),a=this._get(t,"showButtonPanel"),s=this._get(t,"hideIfNoPrevNext"),o=this._get(t,"navigationAsDateFormat"),r=this._getNumberOfMonths(t),l=this._get(t,"showCurrentAtPos"),c=this._get(t,"stepMonths"),d=1!=r[0]||1!=r[1],u=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),p=this._getMinMaxDate(t,"min"),h=this._getMinMaxDate(t,"max"),m=t.drawMonth-l,f=t.drawYear;if(m<0&&(m+=12,f--),h){var g=this._daylightSavingAdjust(new Date(h.getFullYear(),h.getMonth()-r[0]*r[1]+1,h.getDate()));for(g=p&&g<p?p:g;this._daylightSavingAdjust(new Date(f,m,1))>g;)--m<0&&(m=11,f--)}t.drawMonth=m,t.drawYear=f;var _=this._get(t,"prevText");_=o?this.formatDate(_,this._daylightSavingAdjust(new Date(f,m-c,1)),this._getFormatConfig(t)):_;var b=this._canAdjustMonth(t,-1,f,m)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+_+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"e":"w")+'">'+_+"</span></a>":s?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+_+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"e":"w")+'">'+_+"</span></a>",v=this._get(t,"nextText");v=o?this.formatDate(v,this._daylightSavingAdjust(new Date(f,m+c,1)),this._getFormatConfig(t)):v;var y=this._canAdjustMonth(t,1,f,m)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+v+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"w":"e")+'">'+v+"</span></a>":s?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+v+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"w":"e")+'">'+v+"</span></a>",w=this._get(t,"currentText"),k=this._get(t,"gotoCurrent")&&t.currentDay?u:n;w=o?this.formatDate(w,k,this._getFormatConfig(t)):w;var x=t.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(t,"closeText")+"</button>",T=a?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(i?x:"")+(this._isInRange(t,k)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+w+"</button>":"")+(i?"":x)+"</div>":"",C=parseInt(this._get(t,"firstDay"),10);C=isNaN(C)?0:C;for(var D=this._get(t,"showWeek"),M=this._get(t,"dayNames"),S=(this._get(t,"dayNamesShort"),this._get(t,"dayNamesMin")),I=this._get(t,"monthNames"),P=this._get(t,"monthNamesShort"),L=this._get(t,"beforeShowDay"),F=this._get(t,"showOtherMonths"),E=this._get(t,"selectOtherMonths"),A=(this._get(t,"calculateWeek")||this.iso8601Week,this._getDefaultDate(t)),B="",N=0;N<r[0];N++){var $="";this.maxRows=4;for(var O=0;O<r[1];O++){var H=this._daylightSavingAdjust(new Date(f,m,t.selectedDay)),U=" ui-corner-all",R="";if(d){if(R+='<div class="ui-datepicker-group',r[1]>1)switch(O){case 0:R+=" ui-datepicker-group-first",U=" ui-corner-"+(i?"right":"left");break;case r[1]-1:R+=" ui-datepicker-group-last",U=" ui-corner-"+(i?"left":"right");break;default:R+=" ui-datepicker-group-middle",U=""}R+='">'}R+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+U+'">'+(/all|left/.test(U)&&0==N?i?y:b:"")+(/all|right/.test(U)&&0==N?i?b:y:"")+this._generateMonthYearHeader(t,m,f,p,h,N>0||O>0,I,P)+'</div><table class="ui-datepicker-calendar"><thead><tr>';for(var V=D?'<th class="ui-datepicker-week-col">'+this._get(t,"weekHeader")+"</th>":"",z=0;z<7;z++){var j=(z+C)%7;V+="<th"+((z+C+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+M[j]+'">'+S[j]+"</span></th>"}R+=V+"</tr></thead><tbody>";var W=this._getDaysInMonth(f,m);f==t.selectedYear&&m==t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,W));var Y=(this._getFirstDayOfMonth(f,m)-C+7)%7,G=Math.ceil((Y+W)/7),q=d&&this.maxRows>G?this.maxRows:G;this.maxRows=q;for(var K=this._daylightSavingAdjust(new Date(f,m,1-Y)),X=0;X<q;X++){R+="<tr>";var Q=D?'<td class="ui-datepicker-week-col">'+this._get(t,"calculateWeek")(K)+"</td>":"";for(z=0;z<7;z++){var J=L?L.apply(t.input?t.input[0]:null,[K]):[!0,""],Z=K.getMonth()!=m,ee=Z&&!E||!J[0]||p&&K<p||h&&K>h;Q+='<td class="'+((z+C+6)%7>=5?" ui-datepicker-week-end":"")+(Z?" ui-datepicker-other-month":"")+(K.getTime()==H.getTime()&&m==t.selectedMonth&&t._keyEvent||A.getTime()==K.getTime()&&A.getTime()==H.getTime()?" "+this._dayOverClass:"")+(ee?" "+this._unselectableClass+" ui-state-disabled":"")+(Z&&!F?"":" "+J[1]+(K.getTime()==u.getTime()?" "+this._currentClass:"")+(K.getTime()==n.getTime()?" ui-datepicker-today":""))+'"'+(Z&&!F||!J[2]?"":' title="'+J[2]+'"')+(ee?"":' data-handler="selectDay" data-event="click" data-month="'+K.getMonth()+'" data-year="'+K.getFullYear()+'"')+">"+(Z&&!F?"&#xa0;":ee?'<span class="ui-state-default">'+K.getDate()+"</span>":'<a class="ui-state-default'+(K.getTime()==n.getTime()?" ui-state-highlight":"")+(K.getTime()==u.getTime()?" ui-state-active":"")+(Z?" ui-priority-secondary":"")+'" href="#">'+K.getDate()+"</a>")+"</td>",K.setDate(K.getDate()+1),K=this._daylightSavingAdjust(K)}R+=Q+"</tr>"}++m>11&&(m=0,f++),$+=R+="</tbody></table>"+(d?"</div>"+(r[0]>0&&O==r[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"")}B+=$}return B+=T+(e.ui.ie6&&!t.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),t._keyEvent=!1,B},_generateMonthYearHeader:function(e,t,n,i,a,s,o,r){var l=this._get(e,"changeMonth"),c=this._get(e,"changeYear"),d=this._get(e,"showMonthAfterYear"),u='<div class="ui-datepicker-title">',p="";if(s||!l)p+='<span class="ui-datepicker-month">'+o[t]+"</span>";else{var h=i&&i.getFullYear()==n,m=a&&a.getFullYear()==n;p+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var f=0;f<12;f++)(!h||f>=i.getMonth())&&(!m||f<=a.getMonth())&&(p+='<option value="'+f+'"'+(f==t?' selected="selected"':"")+">"+r[f]+"</option>");p+="</select>"}if(d||(u+=p+(!s&&l&&c?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",s||!c)u+='<span class="ui-datepicker-year">'+n+"</span>";else{var g=this._get(e,"yearRange").split(":"),_=(new Date).getFullYear(),b=function(e){var t=e.match(/c[+-].*/)?n+parseInt(e.substring(1),10):e.match(/[+-].*/)?_+parseInt(e,10):parseInt(e,10);return isNaN(t)?_:t},v=b(g[0]),y=Math.max(v,b(g[1]||""));for(v=i?Math.max(v,i.getFullYear()):v,y=a?Math.min(y,a.getFullYear()):y,e.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';v<=y;v++)e.yearshtml+='<option value="'+v+'"'+(v==n?' selected="selected"':"")+">"+v+"</option>";e.yearshtml+="</select>",u+=e.yearshtml,e.yearshtml=null}return u+=this._get(e,"yearSuffix"),d&&(u+=(!s&&l&&c?"":"&#xa0;")+p),u+="</div>"},_adjustInstDate:function(e,t,n){var i=e.drawYear+("Y"==n?t:0),a=e.drawMonth+("M"==n?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(i,a))+("D"==n?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(i,a,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"==n||"Y"==n)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max"),a=n&&t<n?n:t;return a=i&&a>i?i:a},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,n,i){var a=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,i+(t<0?t:a[0]*a[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max");return(!n||t.getTime()>=n.getTime())&&(!i||t.getTime()<=i.getTime())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,i){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var a=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(i,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),a,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick).find(document.body).append(e.datepicker.dpDiv),e.datepicker.initialized=!0);var n=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!=t&&"getDate"!=t&&"widget"!=t?"option"==t&&2==arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each((function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)})):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.9.2",window["DP_jQuery_"+r]=e}(jQuery),function(e,t){var n=0;e.widget("ui.autocomplete",{version:"1.9.2",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,n,i;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(a){if(this.element.prop("readOnly"))return t=!0,i=!0,void(n=!0);t=!1,i=!1,n=!1;var s=e.ui.keyCode;switch(a.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",a);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",a);break;case s.UP:t=!0,this._keyEvent("previous",a);break;case s.DOWN:t=!0,this._keyEvent("next",a);break;case s.ENTER:case s.NUMPAD_ENTER:this.menu.active&&(t=!0,a.preventDefault(),this.menu.select(a));break;case s.TAB:this.menu.active&&this.menu.select(a);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(a),a.preventDefault());break;default:n=!0,this._searchTimeout(a)}},keypress:function(i){if(t)return t=!1,void i.preventDefault();if(!n){var a=e.ui.keyCode;switch(i.keyCode){case a.PAGE_UP:this._move("previousPage",i);break;case a.PAGE_DOWN:this._move("nextPage",i);break;case a.UP:this._keyEvent("previous",i);break;case a.DOWN:this._keyEvent("next",i)}}},input:function(e){if(i)return i=!1,void e.preventDefault();this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:e(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay((function(){delete this.cancelBlur}));var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay((function(){var t=this;this.document.one("mousedown",(function(i){i.target!==t.element[0]&&i.target!==n&&!e.contains(n,i.target)&&t.close()}))}))},menufocus:function(t,n){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",(function(){e(t.target).trigger(t.originalEvent)}));var i=n.item.data("ui-autocomplete-item")||n.item.data("item.autocomplete");!1!==this._trigger("focus",t,{item:i})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(i.value):this.liveRegion.text(i.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item")||t.item.data("item.autocomplete"),i=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=i,this._delay((function(){this.previous=i,this.selectedItem=n}))),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),e.fn.bgiframe&&this.menu.element.bgiframe(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this.document.find(t||"body")[0]),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return!!this.element.is("textarea")||!this.element.is("input")&&this.element.prop("isContentEditable")},_initSource:function(){var t,n,i=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,i){i(e.ui.autocomplete.filter(t,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,a){i.xhr&&i.xhr.abort(),i.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){a(e)},error:function(){a([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay((function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))}),this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):!1!==this._trigger("search",t)?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,t=++n;return function(i){t===n&&e.__response(i),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,(function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)}))},_suggest:function(t){var n=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(n,t),this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var i=this;e.each(n,(function(e,n){i._renderItemData(t,n)}))},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){if(this.menu.element.is(":visible"))return this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t);this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var i=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,(function(e){return i.test(e.label||e.value||e)}))}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),$.widget("bc.bcdismissable",{options:{dismissed:null,beforeDismissed:null,triggerElements:null},_create:function(){this._captureOutsideClicks(),this._captureEscapeKey(),this._super()},_destroy:function(){this._uncaptureOutsideClicks(),this._super()},_captureMouseFn:null,_captureOutsideClicks:function(){var e=this;this._captureMouseFn=function(t){var n=t.target||t.srcElement;n&&e.element.is(":visible")&&0==$(n).closest(e.element.add(e.options.triggerElements)).length&&e._trigger("beforeDismissed",t)&&e._trigger("dismissed",t)},document.addEventListener?document.addEventListener("mousedown",this._captureMouseFn,!0):this._on(document,{mousedown:this._captureMouseFn})},_uncaptureOutsideClicks:function(){document.addEventListener&&document.removeEventListener("mousedown",this._captureMouseFn,!0),this._captureMouseFn=null},_captureEscapeKey:function(){var e=this;this._on(document,{keydown:function(t){if(t.keyCode==$.ui.keyCode.ESCAPE&&this.element.is(":visible")&&$(document.activeElement).closest(this.element).length)return e._trigger("dismissed",t),!1}})}}),$.widget("bc.bcmenu",$.ui.menu,{options:{show:$.noop,hide:$.noop,triggerElements:null},show:function(){this._show(this.element),this._trigger("show")},hide:function(){this._hide(this.element),this._trigger("hide")},_create:function(){var e=this;e._super(),e.element.bcdismissable({triggerElements:e.options.triggerElements,dismissed:function(t){e.hide()}})}}),function(e,t){var n={my:"left top",at:"left bottom"};e.widget("bc.bcmenubar",{options:{position_within:null,menu_position:null},selected_item:null,selected_menu:null,selecting:!1,highlighting:!1,rehighlightQuickly:!1,rehighlightTimeout:null,activeHilightingTimeout:null,aboutToHighlight:null,dead:!1,_create:function(){this.options.menu_position||(this.options.menu_position={}),this.options.menu_position.other||(this.options.menu_position.other=n),this._on({"mouseenter .menubar-item":function(t){var n=e(t.currentTarget);this._deselect(),this._highlight(n)},"mousedown .menubar-item":"_down","click .menubar-item":"_click"}),this._on({"mouseenter .menubar-section":function(e){this._noClearAllSoon()},"mouseleave .menubar-section":function(e){this._leave(e,!1)},"mouseover .menubar-section":function(e){e.stopPropagation()}}),this._on({mouseover:function(e){this._leave(e,!0)}}),this._on(this.document,{click:function(t){e(t.target).closest(this.element).length||this._clearAll()}}),this.refresh()},refresh:function(){var t=this;e(".menu:data(menu)",this.element).menu("refresh"),e(".menu:not(:data(menu))",this.element).menu({select:function(n,i){e(this).fadeOut({duration:200,easing:"easeOutCubic"}),t._playDead()}})},collapseAll:function(){this._clearAll()},_callHighlightHook:function(e,t){this.options.highlightHook&&this.options.highlightHook(e,t)},_select:function(e){if(!this.dead&&!e.hasClass("disabled"))if(this.selected_item=e,e.removeClass("highlighted").addClass("selected"),this._callHighlightHook(e,!0),this.selected_menu=e.children(".menu"),this.selected_menu.length){this.selected_menu.width()<e.width()&&this.selected_menu.width(e.width()-2);var t=this.options.menu_position[MediaView.mode]||this.options.menu_position.other;t.of=e,this.selected_menu.show().position(t)}else this.selected_menu=null},_deselect:function(e){this.dead||!this.selected_item||e&&this.selected_item[0]!=e[0]||(this.selected_item.removeClass("highlighted selected"),this._callHighlightHook(this.selected_item,!1),this.selected_menu&&(this.selected_menu.hide(),this.selected_menu=null),this.selected_item=null)},_highlight:function(e){this.dead||e.hasClass("disabled")||(this.selected_item=e,this.selecting||this.highlighting?this._highlightNow():this.aboutToHighlight||(this.aboutToHighlight=this._delay("_highlightNow",100)))},_highlightNow:function(){this._clearAboutToHilight(),this.highlighting=!0,this.selecting?this._select(this.selected_item):this.selected_item&&(this.selected_item.addClass("highlighted"),this._callHighlightHook(this.selected_item,!0))},_clearAboutToHilight:function(){clearTimeout(this.aboutToHighlight),this.aboutToHighlight=null},_noClearAllSoon:function(){clearTimeout(this.clearAllTimeout)},_clearAllSoon:function(e){clearTimeout(this.clearAllTimeout),this.clearAllTimeout=this._delay("_clearAll",e)},_clearAll:function(){this.dead||(this._deselect(),this._clearAboutToHilight(),clearTimeout(this.activeHilightingTimeout),this.selecting=!1,this.highlighting=!1)},_playDead:function(){this._delay((function(){this.dead=!1,this._clearAll()}),1e3)},_isInMenu:function(t){return this.selected_menu&&e(t.target).closest(this.selected_menu).length},_leave:function(e,t){this._clearAboutToHilight(),this.selecting?!t&&this.selected_menu||(this._deselect(),this._clearAllSoon(2e3)):this.highlighting&&(this._deselect(),this._clearAllSoon(3e3))},_down:function(t){if(!this._isInMenu(t)){var n=e(t.currentTarget);n.hasClass("disabled")?t.preventDefault():(this.refresh(),n.children(".menu").length?n.hasClass("selected")?(this.selecting=!1,this._deselect()):(this.selecting=!0,this._select(n)):(this.selecting=!1,n.addClass("selected"),this._callHighlightHook(n,!0)))}},_click:function(t){if(!this._isInMenu(t)){var n=e(t.currentTarget);if(n.hasClass("disabled"))t.preventDefault();else if(this.refresh(),n.children(".menu").length)t.preventDefault();else if(e(t.target).is("a")){var i=this;setTimeout((function(){n.removeClass("selected"),i._callHighlightHook(n,!1)}),100)}}},_destroy:function(){}})}(jQuery);var Dom={getText:function(e){return(e=elt(e))?e.textContent:""},setText:function(e,t){(e=elt(e))&&(e.textContent=t)},getValue:function(e){switch((e=elt(e)).type){case"checkbox":return e.checked?e.value:null;case"radio":for(var t=document.getElementsByName(e.name),n=0,i=t.length;n<i;n++)if(t[n].checked)return t[n].value;return null}return e.value},setUnselectable:function(e){(e=elt(e))&&(e.style.userSelect="none")},focus:function(e){e=elt(e);try{e.focus()}catch(e){}},select:function(e,t){e=elt(e);try{e.select(),t&&e.focus()}catch(e){}},getDocumentHeight:function(){return document.documentElement["gecko"==Browser.type?"offsetHeight":"scrollHeight"]},wrapElem:function(e,t){return U.isString(t)&&(t=document.createElement(t)),$(t).insertBefore(e).append(e),t},scrollToElement:function(e,t,n){if(e.charAt&&"#"!=e.charAt(0)&&(e="#"+e),(e=$(e)).length){e.parents().each((function(e,t){t.style&&"none"==t.style.display&&(t.style.display="")}));var i=document.scrollingElement;if(i||(i=document.documentElement&&null!=document.documentElement.scrollTop?document.documentElement:document.body),null==t&&(t=-10),n){var a=document.documentElement.clientHeight,s=e.height(),o=i.scrollTop,r=i.scrollTop+a,l=e.offset().top,c=e.offset().top+s;if(l>=o){if(c<r)return;t+=c-a}else t+=l}else t+=e.offset().top;$(i).animate({scrollTop:t},500)}},hideEverythingStack:[],hideEverythingThanksAndroid:function(){if("androidbrowser"==Browser.make){var e=Array.prototype.slice.call(arguments);if(0==e.length)return;var t=$(".logView")[0];t&&e.push(t),$(this.hideEverythingStack[0]).css("visibility","inherit"),$(e).css("visibility","visible"),$(e).each((function(e,t){})),this.hideEverythingStack.unshift(e),$(document.body).css("visibility","hidden")}},unhideEverythingThanksAndroid:function(){if("androidbrowser"==Browser.make){var e=Array.prototype.slice.call(arguments),t=this.hideEverythingStack[0],n=!1;if(t&&t.length>0&&$(e).each((function(e,i){$(t).each((function(e,t){n=n||i==t}))})),!n)return void Log.error("Elt not found unhiding for android fixup");this.hideEverythingStack.shift(),elems=this.hideEverythingStack[0]||document.body,$(elems).css("visibility","visible"),$(elems).each((function(e,t){}))}},hackLinkClicksThanksSafari:function(e,t){e=$(e),"iphone"==Browser.platform?e.on({touchend:function(e){var t=this.getAttribute("href");t&&"#"!=t.substring(0,1)&&this.setAttribute("href","#"+t)},click:function(e){var n=this.getAttribute("href");if(n&&"#"==n.substring(0,1)&&this.setAttribute("href",n.substring(1)),t)return t.apply(this,arguments)}}):t&&e.on("click",t)},inViewport:function(e){for(var t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,a=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+a>window.pageYOffset&&n+i>window.pageXOffset},getCursorPosition:function(e){var t,n=0;return document.selection?(e.focus(),(t=document.selection.createRange()).moveStart("character",-e.value.length),n=t.text.length):void 0!==e.selectionStart&&(n=e.selectionStart),n},setCursorPosition:function(e,t){var n;e.setSelectionRange?(e.focus(),e.setSelectionRange(t,t)):e.createTextRange&&((n=e.createTextRange()).collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select())},getXY:function(e){if("none"==window.getComputedStyle(e).display)return!1;var t=e.ownerDocument,n=t.documentElement,i=t.body,a=Math.max(n.scrollLeft,i.scrollLeft),s=Math.max(n.scrollTop,i.scrollTop),o=e.getBoundingClientRect();return xy=new Array(2),xy[0]=Math.round(o.left+a),xy[1]=Math.round(o.top+s),xy},xxx:null},Time={useIntl:"undefined"!=typeof Intl&&void 0!==Intl.DateTimeFormat,timeFormats:{en:{yyyyMd:{form:"%-m/%-d/%Y"},yyyyMMdd:{form:"%m/%d/%Y"},yyyyMMM:{form:"%b %Y"},yyyyMMMM:{form:"%B %Y"},yyyyMMMd:{form:"%b %-d, %Y"},yyyyMMMMd:{form:"%B %-d, %Y"},yyyyMMMdhmm:{form:"%b %-d, %Y %-I:%M%p"},yyyyMMMMdhmm:{form:"%B %-d, %Y %-I:%M%p"},yyyyMMMMdhmmzz:{form:"%B %-d, %Yat%-I:%M%p%Z"},yyyyMMMMdEEEEhmmzz:{form:"%A, %B %-d, %Yat%-I:%M%p%Z"},MMMMd:{form:"%B %-d"},hhmmss:{form:"%H:%M:%S"},hhmmzz:{form:"%l:%M%p%Z"},hhmm:{form:"%l:%M%p"}},fr:{yyyyMd:{form:"%d/%m/%Y"},yyyyMMdd:{form:"%d/%m/%Y"},yyyyMMM:{form:"%b %Y",localize:["month_short"]},yyyyMMMM:{form:"%B %Y",localize:["month"]},yyyyMMMd:{form:"%-d %b %Y",localize:["month_short"]},yyyyMMMMd:{form:"%-d %B %Y",localize:["month"]},yyyyMMMdhmm:{form:"%-d %b %Y%H:%M",localize:["month_short"]},yyyyMMMMdhmm:{form:"%-d %B %Y%H:%M",localize:["month"]},yyyyMMMMdhmmzz:{form:"%-d %B %Y%H:%M%Z",localize:["month"]},yyyyMMMMdEEEEhmmzz:{form:"%A %-d %B %Y%H:%M%Z",localize:["month","weekday"]},MMMMd:{form:"%-d %B",localize:["month"]},hhmmss:{form:"%H:%M:%S"},hhmmzz:{form:"%H:%M%Z"},hhmm:{form:"%H:%M"}},ja:{yyyyMd:{form:"%Y/%-m/%-d"},yyyyMMdd:{form:"%Y/%m/%d"},yyyyMMM:{form:"%Y%-m"},yyyyMMMM:{form:"%Y%-m"},yyyyMMMd:{form:"%Y%-m%-d"},yyyyMMMMd:{form:"%Y%-m%-d"},yyyyMMMdhmm:{form:"%Y%-m%-d %H:%M"},yyyyMMMMdhmm:{form:"%Y%-m%-d %H:%M"},yyyyMMMMdhmmzz:{form:"%Y%-m%-d %H:%M%Z"},yyyyMMMMdEEEEhmmzz:{form:"%Y%-m%-d (%A) %H:%M%Z",localize:["weekday"]},MMMMd:{form:"%-m%-d"},hhmmss:{form:"%H:%M:%S"},hhmmzz:{form:"%H:%M%Z"},hhmm:{form:"%H:%M"}}},localizedTimeValues:{fr:{month_short:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],month:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],weekday:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},ja:{weekday:["","","","","","",""]}},get_locale:function(e){return void 0!==e&&""!=e||(e="Translate"in window?Translate.locale:"en"),"qq"==e&&(e="ja"),e},get_local_timezone:function(){return Time.useIntl?new Intl.DateTimeFormat("en").resolvedOptions().timeZone:null},shiftDate:function(e,t,n){if(!Time.useIntl)return{date:e,tzname:"UTC"};for(var i,a,s,o,r,l,c,d=t+"-u-hc-h23",u=new Intl.DateTimeFormat(d,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1,timeZoneName:"short",timeZone:n}).formatToParts(e),p=0;p<u.length;p++)switch(u[p].type){case"year":i=parseInt(u[p].value);break;case"month":a=parseInt(u[p].value)-1;break;case"day":s=parseInt(u[p].value);break;case"hour":o=parseInt(u[p].value);break;case"minute":r=parseInt(u[p].value);break;case"second":l=parseInt(u[p].value);break;case"timeZoneName":c=u[p].value}return{date:new Date(Date.UTC(i,a,s,o,r,l)),tzname:c}},to_ui:function(e,t,n,i,a){var s;void 0===t&&(t=1),"string"==typeof e&&(e=new Date(e)),n=Time.get_locale(n),"function"==typeof e.getUTCFullYear&&(void 0===a&&(a=!0),s=new Date(e),a?(s.year=e.getUTCFullYear(),s.month=e.getUTCMonth()+1,s.mday=e.getUTCDate(),s.hour=e.getUTCHours(),s.min=e.getUTCMinutes(),s.sec=e.getUTCSeconds(),s.tz="UTC"):(s.year=e.getFullYear(),s.month=e.getMonth()+1,s.mday=e.getDate(),s.hour=e.getHours(),s.min=e.getMinutes(),s.sec=e.getSeconds(),s.tz=e.toTimeString().match(/\((.*)\)/)[1]),e=s);var o="<d'oh bad to_ui format>";if("number"==typeof t)switch(t){case 1:d=Time.to_ui(e,2)+" "+Time.to_ui(e,3);break;case 2:d=e.month+"/"+e.mday+"/"+e.year%100;break;case 3:var r;0==(r=e.hour>12?e.hour-12:e.hour)&&(r=12),d=r+":"+(e.min<10?"0"+e.min:""+e.min)+(e.hour>=12?"pm":"am");break;case 4:d=e.month+"/"+e.mday+"/"+e.year;break;case 5:d=Time.to_ui(e,4)+" "+Time.to_ui(e,3);break;case 6:d=Time.tables.B[e.month-1]+" "+e.mday+", "+e.year;break;case 7:d=Time.to_ui(e,6)+" "+Time.to_ui(e,3);break;case 8:d=Time.to_ui(e,7)+" "+e.tz;break;case 9:d=Time.strftime(e,"%Y-%m-%d");break;case 10:d=Time.strftime(e,"%d %B %Y %H:%M:%S");break;case 11:d=Time.tables.b[e.month-1]+" "+e.mday+", "+e.year;break;case 12:d=Time.strftime(e,"%Y-%m-%d %H:%M:%S");break;case 13:d=Time.strftime(e,"%B %Y");break;case 14:d=Time.strftime(e,"%m/%d/%Y");break;default:d=o}else if("string"==typeof t){var l=Time.timeFormats[n][t],c=l.form;if(void 0!==i){var d=Time.shiftDate(e,n,i);e=d.date,c=c.replace(/%(Z)/g,d.tzname)}if("localize"in l){var u=l.localize,p=Time.localizedTimeValues[n];u.forEach((function(t){var n=p[t];switch(t){case"month_short":c=c.replace(/%b/g,n[e.getMonth()]);break;case"month":c=c.replace(/%B/g,n[e.getMonth()]);break;case"weekday":c=c.replace(/%A/g,n[e.getDay()]);break;default:c=o}}))}d=Time.strftime(e,c)}else d=o;return d},toUi:function(e,t,n,i){U.isString(e)&&(e=new Date(e));var a=e[n?"getUTCHours":"getHours"](),s=e[n?"getUTCMinutes":"getMinutes"]();if(s=s<10?"0"+s:s,i){a=a<10?"0"+a:a;var o=""}else{var r=a>12?a-12:a;0==r&&(r=12);o=a>=12?"pm":"am";a=r}return Time.toUiDate(e,t,n)+" "+a+":"+s+o},toUiDate:function(e,t,n){U.isString(e)&&(e=new Date(e));var i=e[n?"getUTCFullYear":"getFullYear"]().toString();return t||(i=i.substr(2)),e[n?"getUTCMonth":"getMonth"]()+1+"/"+e[n?"getUTCDate":"getDate"]()+"/"+i},relativeTimeFormats:{en:{today:"today",yesterday:"yesterday",days_ago:"{{days_ago}} days ago",one_hour_ago:"1 hour ago",hours_ago:"{{hours_ago}} hours ago",one_minute_ago:"1 minute ago",minutes_ago:"{{minutes_ago}} minutes ago",seconds_ago:"{{seconds_ago}} seconds ago",just_now:"just now"},fr:{today:"aujourd'hui",yesterday:"hier",days_ago:"il y a {{days_ago}} jours",one_hour_ago:"il y a 1 heure",hours_ago:"il y a {{hours_ago}} heures",one_minute_ago:"il y a 1 minute",minutes_ago:"il y a {{minutes_ago}} minutes",seconds_ago:"il y a {{seconds_ago}} secondes",just_now:" l'instant"},ja:{today:"",yesterday:"",days_ago:"{{days_ago}}",one_hour_ago:"1",hours_ago:"{{hours_ago}}",one_minute_ago:"1",minutes_ago:"{{minutes_ago}}",seconds_ago:"{{seconds_ago}}",just_now:""}},timeStr:function(e){var t="";for(e=Math.floor(e);e>0;){var n=e%60,i=n.toString();i.length<2&&(i="0"+i),t=t.length>0?i+":"+t:i,e-=n,e/=60}return 0==t.length?t="00:00":t.length<3&&(t="00:"+t),t},calc_days_ago:function(e){return Math.floor((new Date-e)/864e5)},relative_day:function(e,t,n){U.isString(e)&&(e=new Date(e)),n=Time.get_locale(n);var i=Time.relativeTimeFormats[n],a=Time.calc_days_ago(e);if(0==a)return i.today;if(1==a)return i.yesterday;if(t)return Time.to_ui(e,t,n);var s=i.days_ago,o={days_ago:a};return s.replace(/\{\{(.*?)\}\}/g,(function(e,t){return o[t]}))},relative_time:function(e,t,n){U.isString(e)&&(e=new Date(e)),n=Time.get_locale(n);var i=Time.relativeTimeFormats[n];if(0!=Time.calc_days_ago(e))return Time.relative_day(e,t,n);var a=(new Date-e)/1e3,s=a/60,o=s/60;a=Math.floor(a),s=Math.floor(s),o=Math.floor(o);var r,l={};if(o>4)return i.today;if(o>1)l.hours_ago=o,r=i.hours_ago;else{if(o>0)return i.one_hour_ago;if(s>1)l.minutes_ago=s,r=i.minutes_ago;else{if(s>0)return i.one_minute_ago;if(!(a>15))return i.just_now;l.seconds_ago=a,r=i.seconds_ago}}return r.replace(/\{\{(.*?)\}\}/g,(function(e,t){return l[t]}))},relativeDurationFormats:{en:{days:"{{days}} days",day:"1 day",hours:"{{hours}} hours",hour:"1 hour",minutes:"{{minutes}} minutes",minute:"1 minute",less_than_a_minute:"under a minute"},fr:{days:"{{days}} jours",day:"Un jour",hours:"{{hours}} heures",hour:"1 heure",minutes:"{{minutes}} minutes",minute:"1 minute",less_than_a_minute:"sous une minute"},ja:{days:"{{days}}",day:"1",hours:"{{hours}}",hour:"1",minutes:"{{minutes}}",minute:"1",less_than_a_minute:""}},relative_duration:function(e,t,n){n=Time.get_locale(n),void 0===t&&(t=!1);var i=Time.relativeDurationFormats[n],a=e/60,s=e/3600,o=e<86400?0:e/86400;a=Math.floor(a),s=Math.floor(s),o=Math.round(o);var r,l={};if(t){if(o>=1)return Time.relative_duration(e,!1,n);if(s<1||a%60==0)return Time.relative_duration(e,!1,n);var c=Time.relative_duration(3600*s,!1,n),d=Time.relative_duration(a%60*60,!1,n);return"ja"==n?c+d:c+", "+d}if(o>1)l.days=o,r=i.days;else{if(1==o)return i.day;if(s>1)l.hours=s,r=i.hours;else{if(1==s)return i.hour;if(!(a>1))return 1==a?i.minute:i.less_than_a_minute;l.minutes=a,r=i.minutes}}return r.replace(/\{\{(.*?)\}\}/g,(function(e,t){return l[t]}))},toUpcomingDate:function(e,t){return U.isString(e)&&(e=new Date(e)),Time.getMonthName(e[t?"getUTCMonth":"getMonth"]())+" "+e[t?"getUTCDate":"getDate"]()},getMonthName:function(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e]},strToDate:function(e){if(!e)return null;~(e=e.replace(/-/g,"/")).indexOf("UTC")||~e.indexOf("GMT")||(e+=" UTC");var t=new Date(e),n=isNaN(new Date("3/7"));if(isNaN(t)||!n){var i=new Date;i.setMonth(i.getMonth()-3);for(var a=(new Date).getFullYear()-1,s=a;s<a+3;s++){var o=new Date(e+" "+s);if(o>i){t=o;break}}if(isNaN(t))return null}else{var r=t.getFullYear();if(r<2e3&&-1==e.indexOf(r)){var l=r.toString().substr(2,2);parseInt(l)<=parseInt(((new Date).getFullYear()+25).toString().substr(2,2))&&t.setFullYear(r+100)}}return t},tables:{a:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],A:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B:["January","February","March","April","May","June","July","August","September","October","November","December"],p:["AM","PM"],P:["A","P"]},formats:{a:function(e){return Time.tables.a[e.getUTCDay()]},A:function(e){return Time.tables.A[e.getUTCDay()]},b:function(e){return Time.tables.b[e.getUTCMonth()]},B:function(e){return Time.tables.B[e.getUTCMonth()]},"-d":function(e){return e.getUTCDate()},d:function(e){return TextFormat.pad(e.getUTCDate(),"0",10)},e:function(e){return TextFormat.pad(e.getUTCDate()," ",10)},H:function(e){return TextFormat.pad(e.getUTCHours(),"0",10)},"-I":function(e){var t=e.getUTCHours()%12;return 0===t?12:t},I:function(e){var t=e.getUTCHours()%12;return TextFormat.pad(0===t?12:t,"0",10)},l:function(e){var t=e.getUTCHours()%12;return 0===t?12:t},j:function(e){var t=e-new Date(e.getUTCFullYear()+"/1/1 GMT"),n=parseInt(t/6e4/60/24,10)+1;return TextFormat.pad(n,"0",100)},"-m":function(e){return e.getUTCMonth()+1},m:function(e){return TextFormat.pad(e.getUTCMonth()+1,"0",10)},M:function(e){return TextFormat.pad(e.getUTCMinutes(),"0",10)},p:function(e){return Time.tables.p[e.getUTCHours()>=12?1:0]},P:function(e){return Time.tables.P[e.getUTCHours()>=12?1:0]},s:function(e){return parseInt(e.getTime()/1e3)},S:function(e){return TextFormat.pad(e.getUTCSeconds(),"0",10)},u:function(e){var t=e.getUTCDay();return 0===t?7:t},U:function(e){var t=parseInt(Time.formats.j(e),10),n=6-e.getUTCDay(),i=parseInt((t+n)/7,10);return TextFormat.pad(i,"0",10)},w:function(e){return e.getUTCDay().toString()},W:function(e){var t=parseInt(Time.formats.j(e),10),n=7-Time.formats.u(e),i=parseInt((t+n)/7,10);return TextFormat.pad(i,"0",10)},y:function(e){return TextFormat.pad(e.getUTCFullYear()%100,"0",10)},Y:function(e){return e.getUTCFullYear().toString()},Z:function(e){return"UTC"},"%":function(e){return"%"}},aggregates:{c:"%a %b %e %X %Y",x:"%m/%d/%y",X:"%H:%M:%S"},strftime:function(e,t){for(;t.match(/%[cDhnrRtTxX]/);)t=t.replace(/%([cDhnrRtTxX])/g,(function(e,t){return Time.aggregates[t]}));return(t=t.replace(/%(\-[dmI])/g,(function(t,n){return Time.formats[n](e)}))).replace(/%([aAbBCdegGHIjlmMpPsSuUVwWyYzZ%])/g,(function(t,n){return Time.formats[n](e)}))}},TextFormat={currency:function(e,t,n,i,a){e.is_money&&(window.CurrencyData||Log.server("Missing CurrencyData for TextFormat.currency on "+window.location.pathname,"error"),t=window.CurrencyData.info[e.currency],e=e.amount/100);var s=t||{prefix:"$",symbol:"USD",places:2},o=e>=1||0==e?s.places:2;i&&e>=1&&Math.round(e)==e&&(o=0);var r=e.toFixed(o);return n?r:(r=TextFormat.commafyNumber(r),s.symbol&&!a&&(r+=" "+s.symbol),s.prefix_utf8+r)},money:function(e,t,n){"use strict";window.CurrencyData||Log.server("Missing CurrencyData for TextFormat.money on "+window.location.pathname,"error"),e&&e.is_money&&("number"==typeof t&&(n=t),t=e.currency,e=e.amount/100),e=e||0,t=t||"USD",n=n||1;var i=CurrencyData.info[t],a=i.places;e===Math.round(e)?2!==n&&7!==n&&9!==n||(a=0):0===a&&(a=2);var s=e.toFixed(a);return 5!==n&&8!==n&&9!==n&&(s=this.commafyNumber(s)),4===n&&"-"===s[0]&&(s="("+s.substr(1)+")"),1===n||2===n?s=i.prefix_utf8+s:6!==n&&7!==n||(s=i.prefix_utf8+" "+s),5===n&&(s=Array(8-s.length).join(" ")+s),s},million_usd:function(e,t){"use strict";var n="";switch(t){case"ja":n=e>=100?(e/100).toFixed(1)+"":(100*e).toFixed(0)+"";break;case"fr":n=(n=e>=100?e.toFixed(0)+" millions de dollars":e.toFixed(1)+" millions de dollars").replace(".",",");break;default:n=e>=100?"$"+e.toFixed(0)+" million":"$"+e.toFixed(1)+" million"}return n},toMb:function(e,t){var n=t?1e3:1024,i=1,a=n,s=Iter.find([" bytes","K","MB","GB","TB","PB"],(function(){return e<a||(i=a,a*=n,!1)}));if(!s)return e.toString();var o=Math.round(e/i*10);return o%10==0?o/10+s:(o/10).toFixed(1)+s},pad:function(e,t,n){for(e=e.toString();parseInt(e,10)<n&&n>1;n/=10)e=t+e;return e},_determine_locale_separators:function(){1.2.toFixed(1).indexOf(".")>=0?TextFormat._separators={decimal:".",thousands:","}:TextFormat._separators={decimal:",",thousands:"."}},commafyNumber:function(e){TextFormat._separators||TextFormat._determine_locale_separators();var t=e.split(TextFormat._separators.decimal),n=t[0],i=t[1]?TextFormat._separators.decimal+t[1]:"",a=!1;if(0==n&&!i)return"0";"-"===n.substr(0,1)&&(n=n.substr(1),a=!0);for(var s=n.length,o="",r=0;(s-r)%3>0;)o+=n.substr(r,1),r++;for(o.length>0&&s-r>0&&(o+=TextFormat._separators.thousands);s-r>3;)o+=n.substr(r,3)+TextFormat._separators.thousands,r+=3;return s-r>0&&(o+=n.substr(r)),(a?"-":"")+o+i},noOrphan:function(e){return e.replace(/([^ ]+) +([^ ]+)$/,"$1$2")}};function addExpandEventListeners(e){$(e).off(".bcExpand").on("paste.bcExpand keyup.bcExpand focus.bcExpand",updateFieldHeight)}function updateFieldHeight(e){var t=e.target,n=parseInt(t.clientHeight),i=parseInt(t.scrollHeight);i>n&&(i>250&&(i=250),t.style.height=i+"px")}function addShrinkEventListeners(e,t){$(e).blur((function(e){shrinkFieldHeight(e,t)}))}function shrinkFieldHeight(e,t){var n=e.target;parseInt(n.scrollHeight)>t&&(n.style.height=t+"px")}function addCharacterCountdownEventListeners(e,t,n){function i(i){var a=n-$(e).val().length;$(t).toggleClass("notable",a<=0),a<0&&i&&($(e).val($(e).val().substr(0,n)),a=0),$(t).find(".counter").text(""+a)}$(e).on("input",(function(){i(!0)})),(!("oninput"in e)||"ie"===Browser.make&&Browser.version[0]<=9)&&$(e).on("paste cut keyup",(function(){setTimeout(i,0,!0)})),i(!1)}function InterruptibleTimer(){this._timer=null}InterruptibleTimer.prototype={start:function(e,t){this.stop(),this._timer=setTimeout(e,t)},stop:function(){clearTimeout(this._timer)}};var WatchInput={watchInput:function(e,t,n){$assert("string"==typeof e),null==this.__watching&&(this.__watching={});var i=this.__watching[e]={};i.__watchInput_elt=e,i.__watchInput_default=t,i.__watchInput_type=n||"float";var a=this;setTimeout((function(){a.__watchInput(e)}),500)},__watchInput:function(e){var t=this.__watching[e];if(t){var n,i=elt(t.__watchInput_elt);if(i){var a=null==i.value?i.innerHTML:i.value;switch(t.__watchInput_type){case"float":var s=parseFloat(a);isNaN(s)&&(s=t.__watchInput_default);break;case"integer":s=parseInt(a);isNaN(s)&&(s=t.__watchInput_default);break;default:s=a}if(s!=t.__watchInput_Last&&this.inputChanged)try{this.inputChanged(s,t.__watchInput_elt)}catch(n){Log.error(n)}t.__watchInput_Last=s;var o=this;setTimeout((function(){o.__watchInput(e)}),500)}else this.__watching[e]=null}}},Expression={eval:function(e,t,n){var i=this.init(e,t,n),a=this.parse_top(i);if("end"!=this.next_token(i).kind)throw"Expression error: '"+i.expr+"' -- end expected";return a},dump:function(e,t,n){for(var i=this.init(e,t,n);;){var a=this.next_token(i);if(console.log(a.kind+" "+a.value),"end"==a.kind)break}},init:function(e,t,n){var i={};return i.expr=e,i.handle_constants=n,i.eval_lambda=t,i.return_prev_token=!1,i.short_circuit=!1,i},OPERATORS:["||","&&","<=","==","!=",">=","<",">","+","-","*","/","%","!","(",")"],next_token:function(e){if(e.return_prev_token)return e.return_prev_token=!1,e.previous_token;var t={};if(e.expr=e.expr.replace(/^\s+/,""),""==e.expr)t.kind="end";else{for(var n=0;n<this.OPERATORS.length;++n){var i=this.OPERATORS[n];if(e.expr.substr(0,i.length)==i){t.kind=i,e.expr=e.expr.slice(i.length);break}}var a;if(!t.kind)(a=e.expr.match(/^(\'[^\']*\')/)||e.expr.match(/^(\"[^\"]*\")/)||e.expr.match(/([^\s\+\-\*\/\%\(\)\<\=\>\!\&\|\'\"]+)/))&&(t.value=a[1],t.kind="term",e.expr=e.expr.slice(t.value.length))}return e.previous_token=t,t},backup:function(e){e.return_prev_token=!0},is_true:function(e){return!1!==e&&null!=e},parse_top:function(e){return this.parse_boolean_op(e)},parse_boolean_op:function(e){for(var t=this.parse_comparison_op(e);;)switch(this.next_token(e).kind){case"||":if(this.is_true(t)){var n=e.short_circuit;e.short_circuit=!0,this.parse_boolean_op(e),e.short_circuit=n}else t=this.parse_comparison_op(e);break;case"&&":if(this.is_true(t))t=this.parse_comparison_op(e);else{n=e.short_circuit;e.short_circuit=!0,this.parse_boolean_op(e),e.short_circuit=n}break;default:return this.backup(e),t}},parse_comparison_op:function(e){for(var t,n=this.parse_additive_op(e);;)switch(t=this.next_token(e).kind){case"<":case"<=":case"==":case"!=":case">=":case">":n=this.evaluate_comparison(t,n,this.parse_additive_op(e));break;default:return this.backup(e),n}},evaluate_comparison:function(e,t,n){if("=="===e)return t&&t.is_money?n&&n.is_money&&t.currency===n.currency&&t.amount===n.amount:t==n;if("!="===e)return!this.evaluate_comparison("==",t,n);if(void 0!==t&&void 0!==n||Log.error("Expression: inequality comparison with an undefined operand will always return false"),t&&t.is_money){if(!n||!n.is_money)throw"money cannot be compared with non-money";if(t.currency!==n.currency)throw"money comparison currency mismatch";t=t.amount,n=n.amount}switch(e){case"<":return t<n;case">":return t>n;case"<=":return t<=n;case">=":return t>=n;default:throw"invalid comparison operator: "+e}},parse_additive_op:function(e){for(var t=this.parse_multiplicative_op(e);;)switch(this.next_token(e).kind){case"+":t+=this.parse_multiplicative_op(e);break;case"-":t-=this.parse_multiplicative_op(e);break;default:return this.backup(e),t}},parse_multiplicative_op:function(e){for(var t=this.parse_term(e);;)switch(this.next_token(e).kind){case"*":t*=this.parse_term(e);break;case"/":t/=this.parse_term(e);break;case"%":t%=this.parse_term(e);break;default:return this.backup(e),t}},parse_term:function(e){var t,n=this.next_token(e);switch(n.kind){case"(":if(t=this.parse_top(e),")"!=this.next_token(e).kind)throw"Expression error: '"+e.expr+"' -- unbalanced parentheses";break;case"+":t=this.parse_term(e);break;case"-":t=-this.parse_term(e);break;case"!":t=!this.is_true(this.parse_term(e));break;case"term":if(!e.short_circuit){var i=e.handle_constants;if(i&&(i=this.constant(n.value))&&(t=i.v),!i){if(!e.eval_lambda)throw"Expression error: '"+e.expr+"' -- not a term";t=e.eval_lambda(n.value)}}}return e.short_circuit?1:t},constant:function(e){var t;return e.match(/^\d/)?e.match(/e|E|\./)?{v:parseFloat(e)}:{v:parseInt(e)}:(t=e.match(/^\'(.*)\'$/)||e.match(/^\"(.*)\"$/))?{v:t[1]}:"true"==e?{v:!0}:"false"==e?{v:!1}:"nil"==e?{v:null}:null}},StatusSpinny={spinnyID:"status-spinny",spinningClass:"spinning",timeouts:[],showQueue:[],showingQueue:!1,isShown:!1,spinny:function(e){var t=$("#"+StatusSpinny.spinnyID);return 0===t.length&&(t=$('<div id="'+StatusSpinny.spinnyID+'"></div>').appendTo(document.body)),"boolean"==typeof e&&t[e?"addClass":"removeClass"](StatusSpinny.spinningClass),t},show:function(e,t,n,i){void 0!==n&&null!=n||(n=""),StatusSpinny.resetTimeouts();var a=function(){StatusSpinny.isShown=!0,StatusSpinny.spinny(t).html(n).fadeIn(e),"number"==typeof i&&StatusSpinny.timeout(i)};StatusSpinny.isShown?StatusSpinny.scheduleShow(n,a):a()},scheduleShow:function(e,t){if(StatusSpinny.showQueue.push({message:e,fn:t}),!StatusSpinny.showingQueue){StatusSpinny.showingQueue=!0;var n=function(){StatusSpinny.hide(100,null,(function(){if(StatusSpinny.showQueue.length>2){for(var e=StatusSpinny.showQueue.shift();StatusSpinny.showQueue.length>1&&e.message==StatusSpinny.showQueue[1].message;)StatusSpinny.showQueue=StatusSpinny.showQueue.slice(2);e.fn()}else{if(!(StatusSpinny.showQueue.length>0))return StatusSpinny.showingQueue=!1,null;StatusSpinny.showQueue.shift().fn()}window.setTimeout(n,1500)}))};n()}},wouldShowAfter:function(e,t,n,i,a){var s=StatusSpinny.timeoutId(),o=StatusSpinny.spinny();return o.on(s,(function(){StatusSpinny.show(t,n,i,a)})),window.setTimeout((function(){o.trigger(s)}),e),s},hide:function(e,t,n){void 0!==t&&"string"==typeof t&&StatusSpinny.spinny().off(t),void 0===e&&(e="fast"),StatusSpinny.spinny().fadeOut(e,n),StatusSpinny.isShown=!1},timeout:function(e){var t=StatusSpinny.timeoutId(),n=StatusSpinny.spinny();n.on(t,StatusSpinny.hide),StatusSpinny.timeouts.push(t),window.setTimeout((function(){n.trigger(t)}),e)},resetTimeouts:function(){for(;StatusSpinny.timeouts.length>0;)StatusSpinny.spinny().off(StatusSpinny.timeouts.shift())},timeoutId:function(){return(new Date).getTime()+""+Math.random()},zzz:null},TaskQueue=function(){this.queue=[]};TaskQueue.prototype.addTask=function(e,t){this.queue.push({task:e,delay:t})},TaskQueue.prototype.run=function(){var e=this.queue.shift(),t=this;e&&setTimeout((function(){e.task(),t.run()}),e.delay)};var PromiseQueue=function(){this._queue=[]};PromiseQueue.prototype.add=function(e){this._queue.push(e),1===this._queue.length&&this.execute()},PromiseQueue.prototype.execute=function(){var e=this;if(0!==this._queue.length){var t=this._queue[0];t().then((function(){e._queue.splice(e._queue.indexOf(t),1),e.execute()}))}},function(){"use strict";var e=function(){this.handlers={};try{var e=window.location&&window.location.href&&new URL(window.location.href);this.debug=e&&e.searchParams&&e.searchParams.has("debugEvents")}catch(e){Log.server("url params error - "+e+" ua: "+navigator.userAgent,"error")}};e.prototype.subscribe=function(e,t){this.handlers[e]=this.handlers[e]||[],this.handlers[e].push(t)},e.prototype.publish=function(e,t){this.debug&&Log.debug("event: "+e),this.handlers[e]&&this.handlers[e].forEach((function(e){e(t)}))},window.EventBus=e,window.BCEvents=new e}();var Identities=function(e){"use strict";var t=new function(t){var o=this;this.initialData=t,this.user=ko.observable(t.user),this.fan=ko.observable(t.fan),this.partner=ko.observable(t.partner),this.isAdmin=ko.observable(t.is_admin),this.ip_country_code=t.ip_country_code,this.pageBand=t.page_band&&new n(t.page_band),this.bmgr=new i(t.bands),this.lmgr=new s(t.labels),this.labels=this.lmgr.labels,this.labelIds=ko.computed((function(){return Iter.collect(o.labels(),(function(e){return e.id}))})),this.linkedNonLabelMemberBands=ko.computed((function(){return Iter.findAll(o.bmgr.bands(),(function(e){return!o.lmgr.isLabelMemberBand(e.id)}))})),this.linkedNonLabelBands=ko.computed((function(){return Iter.findAll(o.linkedNonLabelMemberBands(),(function(t){return-1===e.inArray(t.id,o.labelIds())}))})),this.hasLabels=ko.computed((function(){return o.labels().length>0})),this.pageBandParentLabel=ko.computed((function(){return Iter.find(o.labels(),(function(e){return e.id===t.page_band_parent_label_id}))}));var r=t.page_label&&new a(t.page_label);this.pageLabel=ko.computed((function(){return o.pageBandParentLabel()||o.pageBand&&o.labels()&&Iter.find(o.labels(),(function(e){return e.id===o.pageBand.id}))||r})),this.isPageBandMember=ko.observable(t.is_page_band_member),this.isPageBandNonLabelMember=ko.computed((function(){return o.pageBand&&Iter.find(o.bmgr.bands(),(function(e){return e.id==o.pageBand.id}))})),this.isParentLabel=ko.computed((function(){return!!o.pageBandParentLabel()})),this.hasFullAccess=ko.computed((function(){return o.isPageBandMember()||o.isAdmin()})),this.hasLimitedAccess=ko.computed((function(){return o.isParentLabel()&&t.page_band&&!t.page_band.authed})),this.isPageBand=function(e){return o.pageBand&&e===o.pageBand.id},this.isMemberOfBand=function(e){return o.bmgr.bandByID(e)||o.lmgr.isMemberBandAuthed(e)},this.activeLicenses=ko.observableArray(t.active_licenses),this.subscribedToPageBand=ko.observable(t.subscribed_to_page_band||!1),this.updateFromHash=function(e){e.bands&&o.bmgr.updateBands(Iter.collect(e.bands,(function(e){return new n(e)}))),e.page_band&&o.pageBand&&(e.page_band.name&&o.pageBand.name(e.page_band.name),e.page_band.photo&&o.pageBand.photo(e.page_band.photo),e.page_band.trackpipe_local_url&&o.pageBand.trackpipeLocalUrl(e.page_band.trackpipe_local_url)),o.isPageBandMember(e.is_page_band_member)},this.add=function(e){e.bands&&e.bands.length>0&&o.bmgr.addBands(e.bands),e.labels&&e.labels.length>0&&o.lmgr.addLabels(e.labels)},this.remove=function(e){e.bands&&e.bands.length>0&&o.bmgr.removeBands(e.bands),e.labels&&e.labels.length>0&&(o.lmgr.removeLabels(e.labels),o.bmgr.removeBands(e.labels))}}(U.pagedataBlob().identities||{});return t.BandVM=n,t.BandsMgr=i,window.ko&&window.ko.options.bindingGlobals&&(window.ko.options.bindingGlobals.Identities=t),t;function n(e){var t=this;this.id=e.id,this.name=ko.observable(e.name),this.photo=ko.observable(e.photo||e.bio&&e.bio.image_id),this.trackpipeUrl=ko.observable(e.trackpipe_url||e.url),this.trackpipeLocalUrl=ko.observable(e.trackpipe_local_url||e.url||e.trackpipe_url),this.trackpipeUrlHttps=ko.observable(e.trackpipe_url_https),this.dashboardUrl=ko.computed((function(){return t.trackpipeLocalUrl()+"/dashboard"})),this.isPro=ko.observable(e.is_pro),this.hasService=ko.observable(e.has_service),this.serviceName=ko.observable(e.service_name),this.serviceUrlFragment=ko.observable(e.service_url_fragment),this.isLabel=ko.observable(e.is_label),this.isLabelMemberBand=ko.observable(!1)}function i(e){var t,i=this;this.addBands=function(e){var i,a;i=Iter.collect(e,(function(e){return e instanceof n?e:new n(e)})),a=[Number.MAX_VALUE,0].concat(i),t.splice.apply(t,a)},this.bandByID=function(e){return Iter.find(t(),(function(t){return t.id===e}))},this.removeBands=function(e){var n=Iter.findAll(t(),(function(t){return!!Iter.find(e,(function(e){return e===t.id}))}));t.removeAll(n)},this.updateBandName=function(e,t){var n=i.bandByID(e);n&&n.name(t)},this.updateBands=function(e){t(e)},t=ko.observableArray(Iter.collect(e||[],(function(e){return new n(e)}))),this.bands=ko.computed((function(){var e=t.slice(0);return e.sort((function(e,t){return(e=e.name().toLowerCase())<(t=t.name().toLowerCase())?-1:e>t?1:0})),e})).extend({throttle:1}),this.anyPro=ko.computed((function(){return!!Iter.find(t(),(function(e){return e.isPro()}))}))}function a(e){var t=this;this.id=e.id,this.name=ko.observable(e.name),this.url=ko.observable(e.url),this.memberBands=ko.observableArray(Iter.collect(e.member_bands,(function(e){var t=new n(e);return t.isLabelMemberBand(!0),t.isAuthed=ko.observable(e.authed),t.hasItems=ko.observable(e.band_has_items),t}))),this.memberBandIds=ko.computed((function(){return Iter.collect(t.memberBands(),(function(e){return e.id}))}))}function s(e){var t=this;this.labels=ko.observableArray(Iter.collect(e||[],(function(e){return new a(e)})));var n=ko.computed((function(){var e={};return Iter.each(t.labels(),(function(t){Iter.each(t.memberBands(),(function(t){e[t.id]=e[t.id]||t.isAuthed()}))})),e}));this.isMemberBandAuthed=function(e){return n()[e]},this.isLabelMemberBand=function(e){return e in n()},this.labelByID=function(e){return Iter.find(t.labels(),(function(t){return t.id===e}))},this.addLabels=function(e){var n=Iter.collect(e,(function(e){return new a(e)})),i=[Number.MAX_VALUE,0].concat(n);t.labels.splice.apply(t.labels,i)},this.removeLabels=function(e){Iter.each(e,(function(e){var n=t.labelByID(e);t.labels.remove(n)}))}}}(jQuery);!function(e){"use strict";var t={logoutAndRedirect:function(e){Crumb.ajax({url:"/api/login/1/logout",type:"POST",dataAs:"JSON",success:function(t){e?window.location.href=e:t.ok&&t.redirect_url?window.location.href=t.redirect_url:window.location.href=siteroot_https},error:function(t,n,i){window.location.href=e||siteroot_https}})},initialize:function(){e(".logout-action").click((function(){e(this).parents()[4]!=e("#menubar")[0]&&e(this).parents()[6]!=e("#menubar")[0]||Stats.record({kind:"click",click:"menubar_logout"});var n=null;return"corp_home"===e(this).data("logout-override")&&(n=siteroot_https),t.logoutAndRedirect(n),!1}))}};window.Logout=t,t.initialize()}(jQuery);var AutocompleteVM=function(e,t){"use strict";return e((function(){var e=function(){if(0==document.getElementsByClassName("autocomplete-form").length)return!1;var e=(JSON.parse(document.getElementById("pagedata").dataset.blob)||{}).cfg||{};return e&&e.BALLS_disable_autocomplete||e&&!e.menubar_autocomplete_enabled?void 0:new n(e)};window.AutocompleteVM=e(),window.initializeAutocomplete=e}));function n(n){var c=this,d=n&&n.search_tracking&&window.ClientID;c.isMobile=t.observable(!1),c.isDesktop=t.computed((function(){return!c.isMobile()})),c.rootEls=function(){return document.getElementsByClassName("autocomplete-form")},c.autocompleteIsInFocus=function(){for(var e,t=c.rootEls(),n=0;n<t.length;n++)t[n].contains(document.activeElement)&&(e=!0);return e},c.documentScrollHandler=function(){if(c.autocompleteIsInFocus())return c.hidden(!0),document.activeElement.blur()},c.documentClickFocusHandler=function(){return!!c.autocompleteIsInFocus()||(c.hidden(!0),!1)};var u=function(){var e=window.innerHeight-50;c.mobileScroll({maxHeight:e+"px",overflowY:"scroll"}),c.tagName(),null!==c.tagName()&&(e=window.innerHeight-50-50,c.mobileScroll({maxHeight:e+"px",overflowY:"scroll"}),c.mobileTag({position:"absolute",width:"100vw",bottom:"-50px"}))};c.addDesktopEventListeners=function(){document.addEventListener("scroll",c.documentScrollHandler),document.addEventListener("click",c.documentClickFocusHandler),document.addEventListener("focusin",c.documentClickFocusHandler),window.removeEventListener("resize",u)},c.removeDesktopEventListeners=function(){document.removeEventListener("scroll",c.documentScrollHandler),document.removeEventListener("click",c.documentClickFocusHandler),document.removeEventListener("focusin",c.documentClickFocusHandler),window.addEventListener("resize",u)},c.isDesktop()&&c.addDesktopEventListeners(),c.isMobile()&&c.removeDesktopEventListeners(),c.isDesktop.subscribe((function(e){1==e&&c.addDesktopEventListeners()})),c.isMobile.subscribe((function(e){1==e&&c.removeDesktopEventListeners()})),c.isLoading=t.observable(!1),c.hidden=t.observable(!0),c.show=t.computed((function(){return!c.hidden()&&c.searchText()&&(!c.isLoading()||c.searchInitiated())})),c.searchHasFocus=t.observable(!1),c.searchText=t.observable(null).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}}),c.searchInitiated=t.observable(!1),c.genreResult=t.observable(null),c.genreName=t.computed((function(){var e=null;return c.genreResult()&&c.searchText()&&(e=c.searchText().charAt(0).toUpperCase()+c.searchText().slice(1).toLowerCase()),e})),c.hasGenreResult=t.observable(!1),c.tagResult=t.observable(),c.hasTagResult=!1,c.tagName=t.pureComputed((function(){return c.tagResult()?c.tagResult().name:null})),c.tagUrl=t.pureComputed((function(){return c.tagResult()?c.tagResult().url:null})),c.mobileTag=t.observable(),c.mobileScroll=t.observable(),c.tagName.subscribe((function(){if(c.isMobile()){var e=window.innerHeight-50-50;null!==c.tagName()?(c.mobileScroll({maxHeight:e+"px",overflowY:"scroll"}),c.mobileTag({position:"absolute",width:"100vw",bottom:"-50px"})):(e=window.innerHeight-50,c.mobileScroll({maxHeight:e+"px",overflowY:"scroll"}))}})),c.autocompleteResults=t.observableArray([]).extend({deferred:!0}),c.hasAutocompleteResults=t.computed((function(){return c.autocompleteResults()&&c.autocompleteResults().length>0})),c.showNoResultsMessage=t.observable(!1),c.currentFilter=t.observable(null).extend({deferred:!0}),c.filters={data:[{label:TM("all"),code:null},{label:TM("artists & labels"),code:"b"},{label:TM("albums"),code:"a"},{label:TM("tracks"),code:"t"}]},c.toggleFilter=function(e,t){if(c.currentFilter()!=e&&(c.currentFilter(e),t&&"click"==t.type&&c.searchHasFocus(!0),d)){var n="click";"keydown"==t.type&&(n="enter");var i=t.target.innerText;r("click",c,"filter-"+i,n)}},c.handleParentFocus=function(e){return e.target.children[0].focus(),!0},c.handleKeyboardNav=function(e,t){var n=document.activeElement,i=t.key;if(!["Escape","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Enter"," ","Home","End"].includes(i))return!0;if("Escape"==i)return c.hidden(!0),document.activeElement.blur(),!1;if(n.classList.contains("search-field")&&"ArrowDown"==i){var a=n.parentElement.getElementsByClassName("menubar-autocomplete-results");if(a[0])return(a[0].querySelector("li[tabindex='0']")||a[0].querySelector("a[tabindex='0']")).focus(),!1}if(n.classList.contains("filter-link")){var s=n.parentElement.getElementsByClassName("filter-link"),o=s[0],r=s[s.length-1],l=parseInt(n.dataset.filterIndex);return"Home"==i?o.focus():"End"==i?r.focus():"ArrowRight"==i?l==s.length-1?o.focus():s[l+1].focus():"ArrowLeft"==i?0==l?r.focus():s[l-1].focus():(c.toggleFilter(n.dataset.filterCode,t),t.target.focus())}if("A"==n.tagName){var d,u=(d=n.classList.contains("tag-link")||n.classList.contains("discover-link")?n.parentNode.children:n.parentNode.parentNode.children)[0],p=d[d.length-1],h=parseInt(n.dataset.itemIndex),m=c.genreName()&&!c.currentFilter()&&!c.isLoading()&&c.hasGenreResult(),f=document.getElementsByClassName("results-genre"),g=c.tagUrl()&&!c.currentFilter(),_=document.getElementsByClassName("autocomplete-tags");if("ArrowDown"==i)return h<d.length-1?d[h+1].children[0].focus()||d[h+1].focus():h===d.length-1&&(m||g)?m?f[0].focus():_[0].focus():(m||g)&&(n.className,1)?d[1].children[0].focus():m||g||"see-all"!=n.className?void 0:u.children[0].focus()||u.focus();if("ArrowUp"==i){if(h>0)return d[h-1].children[0].focus()||d[h-1].focus();if(0==h||(n.className,0))return n.closest("form").q.focus();d[1].children[d[1].children.length-1].focus()}if("Home"==i)return u.children[0].focus()||u.focus();if("End"==i)return p.children[0].focus()||p.focus();if("Enter"==i){if("results-genre"==n.className)return c.discoverGenre();"autocomplete-tags"==n.className&&(window.location.href=encodeURI(c.tagUrl()))}}return!0},c.handleFocusIn=function(e,t){c.hidden(!1)},c.resetSearch=function(){c.genreResult(null),c.hasAutocompleteResults()&&c.autocompleteResults.removeAll(),c.showNoResultsMessage(!1),c.tagResult(null),c.currentFilter(null),c.searchText(null),c.hidden(!1),c.isLoading(!1),c.searchInitiated(!1)};var p=null;c.handleClearSelection=function(){p=document.getSelection().toString(),document.addEventListener("scroll",c.handleHighlightedText),document.addEventListener("mouseup",c.handleHighlightedText),document.addEventListener("keyup",c.handleHighlightedText)},c.handleHighlightedText=function(e){if("filter-link"!==e.target.className&&"keyup"===e.type&&p!==document.getSelection().toString()){if(document.removeEventListener("scroll",c.handleHighlightedText),document.removeEventListener("mouseup",c.handleHighlightedText),document.removeEventListener("keyup",c.handleHighlightedText),d){r("clear_selection",c,"filter-"+s(c.currentFilter(),!1),"click")}c.currentFilter(null),p=null,h=[]}else"keyup"!==e.type&&(document.removeEventListener("scroll",c.handleHighlightedText),document.removeEventListener("mouseup",c.handleHighlightedText),document.removeEventListener("keyup",c.handleHighlightedText))},c.hasResults=t.computed((function(){return c.genreResult()||c.hasAutocompleteResults()||c.tagResult()>0})).extend({deferred:!0}),c.seeAllUrl=t.computed((function(){var e="/search?from=autocomplete";return c.searchText()&&(e+="&q="+c.searchText()),c.currentFilter()&&(e+="&item_type="+c.currentFilter()),encodeURI(e)})).extend({deferred:!0}),c.showDiscover=t.computed((function(){return!c.hasResults()&&!c.hidden()&&!c.searchText()})).extend({deferred:!0}),c.discoverGenre=function(){return c.discoverJumpRedirect(c.genreResult().genre,c.genreResult().subgenre)},c.discoverJumpRedirect=function(t,n){var i=document.getElementById("discover");if(!i)return this.url=window.siteroot_https+"?g="+t+"&t="+n,Identities.user()?this.url+="&from=menubar_explore_logged_in":this.url+="&from=menubar_explore_logged_out",this.url+="#discover",window.location.href=encodeURI(this.url),l(c,t,n,"tag-link"),!1;l(c,t,n,"scroll");var a=HomeControl.discoverVM.genres.pills().filter((function(e){return e.value==t}))[0];HomeControl.discoverVM.genres.selectPill(a),e("html, body").animate({scrollTop:i.offsetTop},1e3),n&&(a=HomeControl.discoverVM.subgenres.pills().filter((function(e){return e.value==n}))[0],HomeControl.discoverVM.subgenres.selectPill(a)),HomeControl.discoverVM.setupScrollers();var s=HomeControl.discoverVM.currentPage().items();s&&s.length>0&&(HomeControl.discoverVM.player.currentItem(s[0]),HomeControl.discoverVM.player.playlist.load([HomeControl.discoverVM.player.currentItem().featuredTrack]))},c.deferredSearchQuery=t.computed((function(){return{searchText:c.searchText(),filter:c.currentFilter()}})).extend({deferred:!0}),c.deferredSearchQuery.subscribe((function(t){t&&t.searchText&&t.searchText.trim()?(c.searchInitiated(!0),c.hidden(!1),c.isLoading(!0),document.activeElement.scrollLeft=document.activeElement.scrollWidth,function(t){if(!t||!t.searchText)return!1;var n=c.searchText().trim();if(c.isRefinedSearch(t.searchText))return;var s=function(e){return function(e){if(e.auto&&"ac_error"!=e.auto){if(c.isLoading(!0),document.activeElement.scrollLeft=document.activeElement.scrollWidth,c.isRefinedSearch(t.searchText))return;c.hasAutocompleteResults()&&n===t.searchText.trim()&&(c.autocompleteResults.removeAll(),c.autocompleteResults(null));var s=e.auto.results;s.length>0?c.showNoResultsMessage(!1):c.showNoResultsMessage(!0),s=c.isDesktop()?s.slice(0,5):s,c.autocompleteResults(Iter.collect(s,(function(e){return new i(e,c.isMobile())}))),e.genre&&e.genre.match&&c.isDesktop()?(c.genreResult(e.genre.match),c.hasGenreResult(!0)):(c.genreResult(null),c.hasGenreResult(!1)),e.tag.matches&&e.tag.matches.length>0&&!c.hasGenreResult()&&function(e,t){var n=[],i=e.length,a=t.length;if(0===i)return a;if(0===a)return i;for(var s=i;s>=0;s--)n[s]=[];for(s=i;s>=0;s--)n[s][0]=s;for(var o=a;o>=0;o--)n[0][o]=o;for(s=1;s<=i;s++){var r=e.charAt(s-1);for(o=1;o<=a;o++){if(s==o&&n[s][o]>4)return i;var l=t.charAt(o-1),c=r==l?0:1,d=n[s-1][o]+1,u=n[s][o-1]+1,p=n[s-1][o-1]+c;u<d&&(d=u),p<d&&(d=p),n[s][o]=d,s>1&&o>1&&r==t.charAt(o-2)&&e.charAt(s-2)==l&&(n[s][o]=Math.min(n[s][o],n[s-2][o-2]+c))}}return n[i][a]}(e.tag.matches[0].display_name,t.searchText)<3?(c.tagResult(new a(e.tag.matches[0],e.auto.stat_params_for_tag)),c.hasTagResult=!0):(c.tagResult(null),c.hasTagResult=!1),h[0]!==n&&(h=[]).push(n),h.includes(n+c.currentFilter())||h.push(n+c.currentFilter()),c.isLoading(!1),d&&r("search_query",c)}else c.isLoading(!1),m&&c.showNoResultsMessage(!0),m||(m=!0)}},o=new Date,l=c.isMobile()?"mobile_":"",u=t.filter?"&type="+encodeURIComponent(t.filter):"";c.searchInitiated(!0),h.includes(n+c.currentFilter())?c.isLoading(!1):(c.isLoading(!0),document.activeElement.scrollLeft=document.activeElement.scrollWidth);c.hasGenreResult(!1),c.tagResult(null),c.tagName(),c.hasTagResult=!1,e.ajax({url:"/api/fuzzysearch/1/"+l+"autocomplete?q="+encodeURIComponent(t.searchText.trim())+u,type:"GET",dataAs:"JSON",success:s(o.getMilliseconds()),error:function(){c.showNoResultsMessage(!0),c.isLoading(!1),Log.error("search autocomplete failed")}})}(t)):c.resetSearch()})),c.isRefinedSearch=function(e,t){var n=t||c.searchText().trim();return!!((e=e.trim()).length<n.length&&n.includes(e))};var h=[],m=!1;c.trackNavigation=function(e,t){var n="click";if("keydown"==t.type){if("Enter"!=t.key&&" "!=t.key)return!0;n="enter"}var i=document.activeElement;if("A"==i.tagName){if(t.preventDefault(),i.classList.contains("results-item")&&r("click",e,o(e.autocompleteResults()[i.dataset.itemIndex]),n),i.classList.contains("autocomplete-tags")&&(l(e,e.tagResult().norm_name,null,"tag-link"),r("click",e,e.tagResult().norm_name,n)),i.classList.contains("results-genre")&&r("click",e,e.genreResult().genre,n),i.classList.contains("tag-link")){function e(e,t){for(;!e.classList.contains(t)&&null!=e;)e=e.parentNode;return e}var a=e(t.target,"tag-link");null!=a&&l(null,a.textContent.trim(),null,"top-level-tag-link")}if(window.location.href.includes(i.href))return!1;t.stopPropagation(),window.location.href=i.href}},c.trackSearchSubmit=function(e,t){var n=!(""==t.target.elements.q.value.trim()||""==c.searchText().trim());return n&&d&&!c.isMobile()&&r("click",e,"submit-search",null),c.isMobile()&&n&&document.activeElement.blur(),!c.isMobile()&&n}}function i(e,t){this.name=e.name,this.bandName=e.band_name,this.noImg=!1,e.img_id?this.img=ImageUtils.imageURL(e.img_id,3):e.art_id?this.img=ImageUtils.artURL(e.art_id,3):e.img?this.img=e.img:this.noImg=!0,this.url=e.url+"?from=search&"+e.stat_params,document.getElementById("menubar-vm")||document.getElementById("menubar-2018-phone")?Identities.user()?this.url+=t?"&logged_in_mobile_menubar=true":"&logged_in_menubar=true":this.url+=t?"&logged_out_mobile_menubar=true":"&logged_out_menubar=true":document.getElementById("header-wrapper")&&(this.url+="&corp_header=true"),this.artType=!1,this.typeText=s(e.type,e.is_label),this.roundArt="b"==e.type||"f"==e.type;var n=new window.URLSearchParams("?"+e.stat_params);this.id=n.get("search_item_id"),this.id&&(this.id=parseInt(this.id)),this.type=e.type,this.url=encodeURI(this.url)}function a(e,t){this.name=e.display_name,this.norm_name=e.norm_name,this.url=window.siteroot_https+"/tag/"+e.norm_name+"?from=search&"+t,document.getElementById("menubar-vm")?Identities.user()?this.url+="&logged_in_menubar=true":this.url+="&logged_out_menubar=true":document.getElementById("header-wrapper")&&(this.url+="&corp_header=true"),this.url=encodeURI(this.url)}function s(e,t){switch(e){case"t":return TM("Track");case"a":return TM("Album");case"f":return TM("Fan");case"b":return TM(t?"Label":"Artist");default:return""}}function o(e){return{type:e.type,id:e.id}}function r(e,t,n,i){var a={};switch(e){case"click":a.interaction_type=i,n&&(a.target=n);break;case"search_query":var s;t.hasAutocompleteResults()>0&&(s=t.autocompleteResults().length<=100?t.autocompleteResults():t.autocompleteResults().slice(0,99),s=Iter.collect(s,(function(e){return o(e)})),a.results=s),a.genre_result=t.hasGenreResult()?t.genreResult().genre:null,a.tag_result=t.hasTagResult?t.tagResult().norm_name:null}a.feature="search-autocomplete",a.query_text=t.searchText(),a.n_results=t.hasAutocompleteResults()?t.autocompleteResults().length:0,a.selected_filter=t.currentFilter()?t.currentFilter():"all",window.BCTracker.record(e,a)}function l(e,t,n,i){var a={feature:"search-autocomplete",genre:t,subgenre:n,interaction:"discover_"+i};e&&(a.query_text=e.searchText(),a.n_results=e.autocompleteResults().length),BCTracker.record("click",a)}}(jQuery,ko),NotificationCenterVM=function(e,t){"use strict";return e((function(){var t;window.initializeNotificationCenter=function(i){return Log.debug("initializing notifications"),t=new n,e("#notification-center-container .messages").scroll((function(){e("#notification-center-container .messages").scrollTop()>=e("#notification-center-container .message-container").height()-250&&t.paginate()})),e(document).click((function(){t.show(!1)})),window.MediaView&&"phone"==MediaView.mode||e(document).scroll((function(){t.show(!1)})),e(".notification-center-menubar-button").on("mouseover",(function(){t.firstLoad()})),e(".notification-center-menubar-button").click((function(e){return e.stopPropagation(),t.show(!t.show()),t.show()&&(i.publish("notificationCenter.open"),t.firstLoad()),!1})),t}}));function n(){var e=this;this.show=t.observable(!1),this.messages=t.observableArray([]),this.oldestId=t.pureComputed((function(){return e.messages()[e.messages().length-1]?e.messages()[e.messages().length-1].id:null})),this.newestId=t.pureComputed((function(){return e.messages()[0]?e.messages()[0].id:null})),this.markAllAsRead=function(){BCAPI.call("PushNotificationPublicAPI_1","mark_menubar_activity_read",{user_id:Identities.user().id},!0).fail((function(){console.log("oops")})).fail(BCAPI.makeFailureAlert({OopsError:TM("I made an oops.")})).done((function(){BCEvents.publish("notificationCenter.markAllAsRead"),Iter.collect(e.messages(),(function(e){e.unread(!1)}))}))},this.hasMoreOldMessages=t.observable(!0),this.loaded=t.observable(!1),this.firstLoad=function(){e.loaded()||(e.loaded(!0),Identities.user()&&BCAPI.call("PushNotificationPublicAPI_1","get_menubar_activity",{user_id:Identities.user().id},!0).fail((function(){console.log("oops")})).done((function(t){Iter.collect(t.activity,(function(t){e.messages.push(new i(t))})),e.hasMoreOldMessages(t.has_more)})))},this.paginating=t.observable(!1),this.empty=t.pureComputed((function(){return e.loaded()&&0===e.messages().length})),this.paginate=function(){!e.paginating()&&e.hasMoreOldMessages()&&(e.paginating(!0),BCAPI.call("PushNotificationPublicAPI_1","get_menubar_activity",{user_id:Identities.user().id,before_id:e.oldestId()}).fail((function(){console.log("oops"),e.hasMoreOldMessages(!1),e.paginating(!1)})).done((function(t){Iter.collect(t.activity,(function(t){e.messages.push(new i(t))})),e.hasMoreOldMessages(t.has_more),e.paginating(!1)})))},this.refreshing=t.observable(!1),this.refresh=function(){e.refreshing()||BCAPI.call("PushNotificationPublicAPI_1","get_menubar_activity",{user_id:Identities.user().id,after_id:e.newestId()}).fail((function(){console.log("oops"),e.refreshing(!1)})).done((function(t){Iter.collect(t.activity.reverse(),(function(t){e.messages.unshift(new i(t))})),e.refreshing(!1),t.has_more&&t.activity.length<5&&e.refresh()}))}}function i(e){this.id=e.id,this.fanName=e.data.fan_name,this.fanImageId=e.data.fan_image_id&&ImageUtils.imageURL(e.data.fan_image_id,3),this.messageUrl=Url.addQueryParams(e.data.message_url,{from:"com-not"}),this.recipientName=Identities.bmgr.bandByID(e.data.band_id)&&Identities.bmgr.bandByID(e.data.band_id).name,this.unread=t.observable(e.data.unread),this.relative_time=t.observable(Time.relative_time(new Date(1e3*e.date)))}}(jQuery,ko),Translate=function(){"use strict";var e=document.documentElement.lang;if(!e){var t=document.querySelector("#pagedata"),n=t&&JSON.parse(t.dataset.blob);e=n&&n.locale||"en"}function i(e,t){var n=e+t;return void 0!==window.bcStrings.md5s[n]?window.bcStrings.md5s[n]:null}function a(e,t){return void 0===t&&(t={}),e.replace(/\{\{(.*?)\}\}/g,(function(e,n){return t[n]}))}function s(e){e.indexOf("'")>=0&&(e.search(/[a-z]'[a-z]/)>=0||e.search(/s' /)>=0||e.search(/'s /)>=0)&&Log.server("single quotes used in place of apostrophe, use [] character instead!! ["+e+"]","error")}var o={};function r(e,t,n,i,a){if("pre"!==a&&"dev"!==a&&!o[n]&&!window.location.pathname.startsWith("/page")){var s={tag_type:e,locale:t,str:n,context:i,dev:a};fetch("/api/internationalization/1/missing_js_translation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).catch((function(e){Log.server("Missing translation logging fail. Error: "+e,"error")})),o[n]=!0}}return{EN_DEFAULT:"en",locale:e,translateMsg:function(t){var n,o=arguments[1];"string"==typeof o?n=2:(n=1,o=null);var l=arguments[n++]||null,c=(n++,arguments[n++]||"");s(t);var d=null;if(Translate.locale===Translate.EN_DEFAULT)d=t;else if("qq"===Translate.locale)"Pseudoloc"in window?d=Pseudoloc.str(t):(Log.server("translateMsg called before initialization, locale "+Translate.locale+", translation in JS for string: "+t,"error"),d=t);else if(void 0===window.bcStrings.translations[Translate.locale])Log.server("translateMsg called before strings initialized, locale "+Translate.locale+", translation in JS for string: "+t,"error"),d=t;else{var u=i(t,c);u&&(d=window.bcStrings.translations[Translate.locale][u]),d||(r("TM",e,t,c,o),d=t)}var p=a(d,l);return p},translatePlural:function(t,n,o){var l,c=arguments[3];"string"==typeof c?l=4:(l=3,c=null);var d,u,p=arguments[l++]||{},h=(l++,arguments[l++]||"");s(t),s(n),p.count=o,1==o?(d=t,u="s"):(d=n,u="p");var m=null;if(Translate.locale===Translate.EN_DEFAULT)m=d;else if("qq"===Translate.locale)"Pseudoloc"in window?m=Pseudoloc.str(d):(Log.server("translateMsg called before initialization, locale "+Translate.locale+", translation in JS for string: "+d,"error"),m=d);else if(void 0===window.bcStrings.translations[Translate.locale])Log.server("translateMsg called before strings initialized, locale "+Translate.locale+", translation in JS for string: "+d,"error"),m=d;else{var f=i(d,h);f&&(m=window.bcStrings.translations[Translate.locale][f]&&window.bcStrings.translations[Translate.locale][f][u]),m||(r("TP",e,d,h,c),m=d)}var g=a(m,p);return g}}}(),TM=Translate.translateMsg,TP=Translate.translatePlural;!function(e,t,n){"use strict";function i(i,a){var s=this;s.pageData=t("#pagedata").data("blob"),s.mapDictToArray=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({key:n,value:e[n]});return t},s.curr_locale=n.observable(i),s.locales=n.observableArray(s.mapDictToArray(a)),s.display_locale=n.pureComputed((function(){var e=Iter.find(s.locales(),(function(e){return s.curr_locale()===e.key}));return e&&e.value})),s.otherLocales=n.pureComputed((function(){return Iter.findAll(s.locales(),(function(e){return e.key!==s.curr_locale()}))})),s.update_locale=function(i){if(i.key!==s.curr_locale()){t("#lang-picker-content").hide();var a=null;Url.isCustomDomain(e.location.hostname)&&(Cookie.set("bc_cdloc",i.key,null,"/",e.location.hostname,!1),a=ClientID);var o=s.pageData.identities,r=o&&o.user&&o.user.id,l=o&&o.fan&&o.fan.id;t.ajax({url:"/api/internationalization/1/update_locale",type:"POST",dataType:"JSON",data:n.toJSON({locale:i.key,user_id:r,client_id:a,fan_id:l})}).success((function(t){t.error?Log.server("update locale failed. response.error: "+t.error,"error"):(s.curr_locale(i.key),Log.debug("Successful locale update; reloading page."),e.location.reload())})).fail((function(e,n){var i=[];i.push({text:TM("OK"),click:function(e){t(this).dialog("close")}}),NuDialog.alert(TM("Network Error",null,"Dialog box title."),TM("There was a network error while processing your request. Please try again."),{buttons:i})}))}},s.show_dialog_phone=function(){var e=[];Iter.each(s.locales(),(function(n){s.curr_locale()!==n.key&&e.push({text:n.value,value:n.key,click:function(e){s.update_locale(n),t(this).dialog("close")}})})),NuDialog.alertHTML(TM("Language"),"",{buttons:e,dialogClass:"nu-dialog lang-picker-m"}),t(".ui-dialog-buttonset>button").after("<br>")}}t((function(){!function(){var a=t("#pagedata").data("blob"),s=a&&a.locale||null;if(null!=s){var o="phone"===Browser.media_mode?"#lang-picker-vm-m":"#lang-picker-vm",r=t(o);if(r[0]){var l=new i(s,a.languages?a.languages:{fr:"Franais",ja:"",en:"English"});n.applyBindings(l,r[0]);var c=t(".lang-picker-content");t(".lang-picker-current-lang").click((function(){return c.bcmenu(c.is(":visible")?"hide":"show"),!1})),t(".lang-picker-content").bcmenu({show:function(){t(".pg-ft-nav:not(.lang-picker-container)").addClass("dimmed")},hide:function(){t(".pg-ft-nav").removeClass("dimmed")},triggerElements:".lang-picker-current-lang"}),e.LangPicker=l}}}()}))}(window,jQuery,ko),function(){"use strict";function e(){var e=$("#menubar-vm"),n=$("#pagedata").data("blob")||{},i=n.cfg||{};if(e[0]){var a=e.data("initial-values").admin_level,s=$("#menubar").hasClass("admin-impersonating");(a>0||s)&&(i.header_rework_2018?MenubarAdmin.addMenuItems($("#user-nav .user-menu > :first-child"),a):MenubarAdmin.addMenuItems($("#user-nav .user-menu"),a));var o=new t(!1);window.MenubarVM=o,ko.applyBindings(o,e[0]),e.removeClass("loading"),e.addClass("loaded"),i.header_rework_2018?$("#menubar").bcmenubar({menu_position:{phone:{my:"top",at:"bottom",collision:"flipfit"},other:{my:"left top",at:"left bottom-7"}}}):$("#menubar").bcmenubar({menu_position:{phone:{my:"top",at:"bottom",collision:"flipfit"},other:{my:"left top",at:"left bottom"}}}),"async"===o.unshippedOrderCount()&&(n.loadFirstResultsAsync?BCEvents.subscribe("merchOrders.searchResultsLoaded",(function(){o.loadUnshippedOrderCount()})):window.setTimeout(o.loadUnshippedOrderCount,100))}if(i.header_rework_2018){$(".artist-filter-text").keydown((function(e){e.stopPropagation()})),HiddenParams.get("launch_edit_design")&&"undefined"!=typeof Design&&$("#custom-design-rules-style").data("design")&&Design.editDesign();var r=$("#menubar-2018-phone");if(r[0]&&!r.hasClass("mbm-ko-bound")){var l=new t(!0);ko.applyBindings(l,r[0]),r.removeClass("loading"),r.addClass("mbm-ko-bound")}("desktop"===MediaView.mode&&!n.is_corp_home||"desktop"!==MediaView.mode)&&$(document).ready((function(){var e,t=!1,n=0,i=0,a="phone"===MediaView.mode?100:20;if((e="phone"===MediaView.mode?$("#menubar-2018-phone"):$(".menubar-outer"))[0]||(e=$(".hd"))[0]){var s=e.offset().top,o=e.offset().top+e.outerHeight(),r=0,l="phone"===MediaView.mode&&$(".hd-banner-mobile-2018"),c=l&&l.outerHeight(),d=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){t={passive:!0}}}))}catch(e){}window.addEventListener("scroll",(function(t){e.hasClass("fixed")&&$(window).width()<$("#menubar").width()+32?(d=!0,$("#menubar-wrapper").css("left",-$(window).scrollLeft()+"px")):d&&(d=!1,$("#menubar-wrapper").css("left","0px"));var l=Menubar.getScroll().top;r>l?n+=Math.abs(l-r):i+=Math.abs(l-r),n>a||i>20||l<200?(n=0,i=0,function(t,n){var i;if(n>=t){var a=!0;t>=s&&(i=e.hasClass("hide"),t>200?e.removeClass("hide"):(e.removeClass("hide"),a=!1),i&&BCEvents.publish("menubar.show")),a&&e.addClass("fixed")}else t>=o&&(i=e.hasClass("hide"),e.addClass("hide"),$("#menubar").bcmenubar("collapseAll"),i||BCEvents.publish("menubar.hide")),"string"==typeof document.activeElement.className&&-1!==document.activeElement.className.indexOf("you-autocomplete-me")&&$(".you-autocomplete-me").blur();"desktop"===MediaView.mode&&(scroll.top>=o&&!$("body").hasClass("prevent-header-hiding")?e.addClass("hide-tooltips"):(e.removeClass("tooltips-hidden"),e.removeClass("hide-tooltips")));(0===t||c&&t<=c+10)&&(e.removeClass("fixed"),$("#menubar-wrapper").css("left","0px"))}(l,r),r=l):r=l}),t)}})),$(window).on("resize",(function(){$("#menubar").bcmenubar("collapseAll")}))}}function t(e){var t;t=this,this.isMobile=e,this.root=t.isMobile?$("#menubar-2018-phone"):$("#menubar-vm"),this.data=this.root.data("initial-values")||{},this.forceNoControl=t.data.force_no_control,this.hideArtistMenu=t.data.hide_artist_menu,this.hide_unseen_notification_indicator=ko.observable(t.data.hide_unseen_notification_indicator),this.dashboardTooltipVM=ko.observable({showing:!1}),t.root.on("dashboardLinkTooltipReady",(function(e,n){t.dashboardTooltipVM(n)})),this.showMobileMenu=ko.observable(!1),this.showMobileAutocomplete=ko.observable(!1),Iter.each(["fan","isAdmin","pageBand","partner","user"],(function(e){t[e]=Identities[e]})),this.showBandControls=ko.computed((function(){return Identities.pageBand&&Identities.hasFullAccess()&&!t.forceNoControl})),this.showLimitedAccessControls=ko.computed((function(){return Identities.pageBand&&Identities.hasLimitedAccess()&&!t.forceNoControl})),this.artistsMenu=new n(this),this.statsLinkHref=ko.computed((function(){return t.pageBand?Identities.isParentLabel()&&!Identities.hasFullAccess()?Identities.pageBandParentLabel().url()+"/stats?band="+t.pageBand.id+"&from=menubar":t.pageBand.trackpipeLocalUrl()+"/stats?from=menubar":""})),this.statsLinkHref2018=ko.computed((function(){return t.pageBand?Identities.isParentLabel()?Identities.pageBandParentLabel().url()+"/stats?band="+t.pageBand.id+"&from=menubar":t.pageBand.trackpipeLocalUrl()+"/stats?from=menubar":""})),this.dashboardLinkHref=ko.computed((function(){return Identities.pageBand?Identities.isPageBandNonLabelMember()||Identities.isAdmin()?t.pageBand.trackpipeLocalUrl()+"/dashboard":Identities.isParentLabel()?Identities.pageBandParentLabel().url()+"/dashboard":"":""})),this.ordersLinkHref=ko.computed((function(){return t.pageBand?Identities.isParentLabel()?Identities.pageBandParentLabel().url()+"/merch_orders":t.pageBand.trackpipeLocalUrl()+"/merch_orders":""})),this.unshippedOrderCount=ko.observable(t.data.unshipped_order_count),this.unshippedOrderCountDisplay=ko.pureComputed((function(){return"async"===t.unshippedOrderCount()?TM('<span class="unshipped-orders-loading">{{count}}</span> orders',"dev",{count:""},"menu bar artist option for viewing merch orders"):0===t.unshippedOrderCount()?TM("orders","dev",null,"menu bar artist option for viewing merch orders"):TP('<span class="num order">{{count}}</span> order','<span class="num order">{{count}}</span> orders',t.unshippedOrderCount(),"dev",{count:t.unshippedOrderCount()},"menu bar artist option for viewing merch orders")})),this.loadUnshippedOrderCount=function(){Crumb.ajax({type:"POST",url:"/api/merch/1/get_unshipped_order_count",data:{user_id:t.user().id,band_id:t.pageBand.id},dataAs:"JSON",error:function(e){t.unshippedOrderCount("?")},success:function(e){e.error?t.unshippedOrderCount("?"):t.unshippedOrderCount(e.count)}})},this.addAlbumClick=function(){return Stats.record({kind:"click",click:"menubar_add_album"}),!LabelAddItemDialog.showDialog("album")},this.addTrackClick=function(){return Stats.record({kind:"click",click:"menubar_add_track"}),!LabelAddItemDialog.showDialog("track")},this.addMerchClick=function(){return Stats.record({kind:"click",click:"menubar_add_merch"}),window.EditTralbum&&window.EditTralbum.viewModel&&window.EditTralbum.viewModel.createNewMerch?(window.EditTralbum.viewModel.createNewMerch(),!1):!LabelAddItemDialog.showDialog("merch")},this.addNewArtist=function(){Stats.record({kind:"click",click:"menubar_add_new_artist"}),t.data.lapsed_or_cancelled_label?window.location=t.data.lapsed_redirect_url:AddNewArtistDialog.showDialog()},this.addExistingArtist=function(){Stats.record({kind:"click",click:"menubar_add_existing_artist"}),t.data.lapsed_or_cancelled_label?window.location=t.data.lapsed_redirect_url:AddExistingArtistDialog.showDialog()},this.numCartItemsDisplay=ko.pureComputed((function(){return"undefined"!=typeof Sidecart&&Sidecart?Sidecart.ko_num_cart_items()>99?"99+":Sidecart.ko_num_cart_items():t.data.cart_quantity})),this.hasCart=ko.pureComputed((function(){return"undefined"!=typeof Sidecart&&Sidecart?Sidecart.ko_num_cart_items()>0:t.data.cart_quantity?t.data.cart_quantity>0:($("#pagedata").data("blob")||{}).cart_quantity>0})),this.shrinkLogo=ko.pureComputed((function(){return t.data.gift_card_balance||t.hasCart()})),this.goCart=function(e,t){if(t.shiftKey||t.ctrlKey||t.metaKey)return!0;if("undefined"==typeof Sidecart||!Sidecart)return!0;if(!Sidecart.ko_num_cart_items())return!0;if(Menubar.getScroll().top>0){var n=document.scrollingElement;n||(n=document.documentElement&&null!=document.documentElement.scrollTop?document.documentElement:document.body),$(n).animate({scrollTop:-10},500).promise().done((function(){Sidecart.wiggle()}))}else Sidecart.wiggle();return!1},this.goCartMobile=function(e,t){if("undefined"==typeof Sidecart||!Sidecart)return!0;Sidecart.ko_num_cart_items()&&(Menubar.getScroll().top>0?(Dom.scrollToElement(document.body),$("#sidecart").hasClass("expanded")||Sidecart.show_cart_phone()):Sidecart.toggle_cart_phone())},this.loggedInFanPhoto=ko.computed((function(){return t.fan()&&t.fan().photo})),this.currLocale=ko.pureComputed((function(){if("undefined"!=typeof LangPicker&&LangPicker)return LangPicker.display_locale();var e=$("#pagedata").data("blob");return e&&e.locale||"English"})),this.langPickerDialog=function(){LangPicker.show_dialog_phone()},window.initializeAutocomplete&&(t.AutocompleteVM=window.AutocompleteVM,this.mobileSearchHasFocus=ko.observable(!1),this.mobileClearAutocomplete=()=>{$("#autocomplete-result-item").scrollTop(0),$(".you-autocomplete-me").val(""),t.AutocompleteVM.resetSearch(),this.mobileSearchHasFocus(!0)},this.mobileCancelAutocomplete=()=>{if($("#autocomplete-result-item").scrollTop(0),"/search"!==window.location.pathname)this.showMobileAutocomplete(!1),this.mobileSearchHasFocus(!1),t.AutocompleteVM.resetSearch(),t.AutocompleteVM.isMobile(!1);else{var e=document.referrer;window.location.href=encodeURI(e&&""!=e?document.referrer:window.location.origin)}},this.mobileShowAutocomplete=()=>{t.AutocompleteVM.resetSearch(),this.showMobileAutocomplete(!0),t.AutocompleteVM.isMobile(!0),this.mobileSearchHasFocus(!0)},this.showMobileAutocomplete.subscribe((function(e){1==e?(document.body.style.maxHeight="100%",document.body.style.overflowY="hidden"):(document.body.style.maxHeight=null,document.body.style.overflowY=null)}))),this.altSearch=ko.observable(!1),this.showAltSearch=function(){this.altSearch(!0),t.AutocompleteVM.searchHasFocus(!0)};let i=new URL(window.siteroot);e&&window.location.hostname==i.hostname&&"/search"==window.location.pathname&&this.mobileShowAutocomplete();var a=new EventBus;!e&&window.initializeNotificationCenter&&(this.NotificationCenterVM=window.initializeNotificationCenter(a)),a.subscribe("notificationCenter.open",(function(){t.hide_unseen_notification_indicator(!0),Cookie.set("hide_unseen_notification_indicator",1,5),Crumb.ajax({type:"POST",url:"/api/community/1/hide_notifications_indicator",data:{user_id:Identities.user().id},dataAs:"JSON",error:function(e){},success:function(e){}})})),BCEvents.subscribe("community.feed.allCommentsSeen",(function(){t.hide_unseen_notification_indicator(!0)})),this.initialized=!0}function n(e){var t=this;function n(){var e,n,i=t.pageLabelMemberBands().length,a=Math.ceil(i/t.columns()),s=t.otherLinkedAccounts().length,o=Math.ceil(s/t.columns());return a+o<9||!t.hasLabels()?{labelBands:i,linkedBands:s}:s<i?(i>(e=(9-o)*t.columns())&&--e,{labelBands:e,labelBandsOverflow:i-e,linkedBands:s}):(s>(n=(9-a)*t.columns())&&--n,{labelBands:i,linkedBands:n,linkedBandsOverflow:s-n})}function i(e,n){var i,a,s;for(i=(i=e.slice(0,n)).sort((function(e,t){return e.name()<t.name()?-1:e.name()>t.name()?1:0})),a=Math.ceil(i.length/t.columns()),s=[];i.length>0;)s.push({bands:i.splice(0,a)});return s}this.menubar=e,Iter.each(["bmgr","lmgr","hasLabels","isPageBand","isPageBandMember","isParentLabel","linkedNonLabelMemberBands","pageBandParentLabel","pageLabel"],(function(e){t[e]=Identities[e]})),this.toolsProfileBand=ko.computed((function(){return e.showBandControls()||e.showLimitedAccessControls()?e.pageBand:1===t.bmgr.bands().length?t.bmgr.bands()[0]:null})),this.options=ko.computed((function(){var n=t.toolsProfileBand();return{title:n?n.name():"artists",showPhoto:!!n,photo:n?n.photo():null,showPro:n?n.isPro():t.bmgr.anyPro(),toolsProfileEditable:n&&(Identities.isMemberOfBand(n.id)||e.isAdmin()),adminAccess:n&&!t.isPageBandMember()&&e.isAdmin()}})),this.pageLabelMemberBands=ko.computed((function(){if(t.pageLabel())return t.pageLabel().memberBands();if(Identities.lmgr&&Identities.lmgr.labels()){var e=[];return Iter.each(Identities.lmgr.labels(),(function(t){e=e.concat(t.memberBands())})),e}return[]})),this.otherLinkedAccounts=ko.computed((function(){return Iter.findAll(t.linkedNonLabelMemberBands(),(function(e){return!(t.pageLabel()&&e.id===t.pageLabel().id||t.toolsProfileBand()&&e.id===t.toolsProfileBand().id)}))})),this.columns=ko.computed((function(){var e=t.pageLabelMemberBands().length+t.otherLinkedAccounts().length;return t.hasLabels()?e>26?3:Math.floor((e-1)/9)+1:1})),this.liveEvents=ko.observable(e.data.live_events),this.labelBands=ko.computed((function(){return t.hasLabels()?i(t.pageLabelMemberBands(),n().labelBands):null})),this.labelBandsOverflow=ko.computed((function(){return n().labelBandsOverflow})),this.linkedBands=ko.computed((function(){return i(t.otherLinkedAccounts(),n().linkedBands)})),this.linkedBandsOverflow=ko.computed((function(){return n().linkedBandsOverflow})),this.findPageBand=function(){var e=1==Identities.linkedNonLabelMemberBands().filter((function(e){return Identities.pageBand&&e.id==Identities.pageBand.id})).length;return Identities.isAdmin()&&Identities.pageBand||e?(Cookie.set("menubar_active_band",Identities.pageBand.id,7776e3),Identities.pageBand):Cookie.get("menubar_active_band")&&Identities.bmgr.bandByID(parseInt(Cookie.get("menubar_active_band")))?Identities.bmgr.bandByID(parseInt(Cookie.get("menubar_active_band"))):Identities.linkedNonLabelMemberBands()[0]},this.loggedInBand=ko.observable(t.findPageBand()),this.optionsLoggedInBand=ko.computed((function(){var n=t.loggedInBand();return{title:n?n.name():"",showPhoto:!!n,photo:n&&n.photo()?n.photo():null,showPro:n?n.isPro():t.bmgr.anyPro(),toolsProfileEditable:n&&(Identities.isMemberOfBand(n.id)||e.isAdmin()),adminAccess:n&&!t.isPageBandMember()&&e.isAdmin()}})),this.pageDesignable=function(e){return!("undefined"==typeof Design||!$("#custom-design-rules-style").data("design"))&&t.isPageBand(e.id)},this.launchPageDesign=function(e){t.pageDesignable(e)?Design.editDesign():window.location=e.trackpipeLocalUrl()+"?launch_edit_design=1"},this.labelMemberBandsSearchTerm=ko.observable(""),this.showLinkedBands=ko.observable(!1),this.loggedInLabelMemberBandsCountStr=ko.pureComputed((function(){var e=t.loggedInLabelMemberBands().length;return TP("1 Artist","{{count}} Artists",e)})),this.loggedInLinkedBandsCountStr=ko.pureComputed((function(){var e=t.linkedNonLabelMemberBands().length-1;return TP("1 Linked Account","{{count}} Linked Accounts",e)})),this.loggedInLabelMemberBands=ko.computed((function(){var n=t.loggedInBand();if(t.lmgr&&t.lmgr.labels()){var i=[];if(Iter.each(t.lmgr.labels(),(function(e){e.id==n.id&&(i=i.concat(e.memberBands()))})),e.pageBand){var a=e.pageBand.id;i.sort((function(e,t){return e.id==a?-1:t.id==a?1:0}))}return i}return[]})),this.filteredLoggedInLabelMemberBands=ko.computed((function(){return Iter.findAll(t.loggedInLabelMemberBands(),(function(e){var n=t.labelMemberBandsSearchTerm().toLowerCase();return-1!==e.name().toLowerCase().indexOf(n)}))})),this.activeLabelMemberBand=ko.observable(e.pageBand?e.pageBand.id:null),this.setActiveLabelMemberBand=function(e){t.activeLabelMemberBand()==e?t.activeLabelMemberBand(null):t.activeLabelMemberBand(e)}}window.Menubar={initialize:e,initialValues:$("#menubar-vm")[0]?$("#menubar-vm").data("initial-values"):{},getScroll:function(){var e=document.body,t=document.documentElement;return{left:parseFloat(window.pageXOffset||e.scrollLeft||t.scrollLeft),top:parseFloat(window.pageYOffset||e.scrollTop||t.scrollTop)}}},$(document).ready((function(){e()}))}(),function(e,t){var n=e.event.add,i=e.event.remove,a=function(t,n,i){e.event.trigger(n,i,t)},s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return window.setTimeout((function(){e()}),25)},o={textarea:!0,input:!0,select:!0},r="mousemove",l="mouseup dragstart",c="mouseup",d="touchmove",u="touchend",p="touchend";function h(e){var t=e,n=!1,i=!1;function a(e){n?(t(),s(a),i=!0,n=!1):i=!1}this.kick=function(e){n=!0,i||a()},this.end=function(e){var a=t;e&&(i?(t=n?function(){a(),e()}:e,n=!0):e())}}function m(e){return!1}function f(e){e.preventDefault()}function g(e){o[e.target.tagName.toLowerCase()]||e.preventDefault()}function _(e,t){var n,i;if(e.identifiedTouch)return e.identifiedTouch(t);for(n=-1,i=e.length;++n<i;)if(e[n].identifier===t)return e[n]}function b(e,t){var n=_(e.changedTouches,t.identifier);if(n&&(n.pageX!==t.pageX||n.pageY!==t.pageY))return n}function v(e){C(e,e.data,e,w)}function y(e){w()}function w(){i(document,r,v),i(document,l,w)}function k(e){var t=e.data,n=b(e,t);n&&C(e,t,n,T)}function x(e){var t=e.data;_(e.changedTouches,t.identifier)&&T(t)}function T(e){i(document,"."+e.identifier,k),i(document,"."+e.identifier,x)}function C(t,n,i,s){var o=i.pageX-n.startX,r=i.pageY-n.startY;if(!(o*o+r*r<36))return function(t,n,i,s,o,r){var l,c,d,u=n.target;for(;u&&u!==document.documentElement;){if((l=e.data(u,"events"))&&(l.movestart||l.move||l.moveend))return c=t.targetTouches,d=t.timeStamp-n.timeStamp,n.type="movestart",n.distX=s,n.distY=o,n.deltaX=s,n.deltaY=o,n.pageX=i.pageX,n.pageY=i.pageY,n.velocityX=s/d,n.velocityY=o/d,n.targetTouches=c,n.finger=c?c.length:1,a(n.target,n,[n,t]),r(n);u=u.parentNode}}(t,n,i,o,r,s)}function D(e){var t=e.data.event,n=e.data.timer;P(t,e,e.timeStamp,n)}function M(e){var t=e.data.event,n=e.data.timer;i(document,r,D),i(document,c,M),L(t,n,(function(){setTimeout((function(){i(t.target,"click",m)}),0)}))}function S(e){var t=e.data.event,n=e.data.timer,i=b(e,t);i&&(e.preventDefault(),t.targetTouches=e.targetTouches,P(t,i,e.timeStamp,n))}function I(e){var t=e.data.event,n=e.data.timer;_(e.changedTouches,t.identifier)&&(!function(e){i(document,"."+e.identifier,S),i(document,"."+e.identifier,I)}(t),L(t,n))}function P(e,t,n,i){var a=n-e.timeStamp;e.type="move",e.distX=t.pageX-e.startX,e.distY=t.pageY-e.startY,e.deltaX=t.pageX-e.pageX,e.deltaY=t.pageY-e.pageY,e.velocityX=.3*e.velocityX+.7*e.deltaX/a,e.velocityY=.3*e.velocityY+.7*e.deltaY/a,e.pageX=t.pageX,e.pageY=t.pageY,i.kick()}function L(e,t,n){t.end((function(){return e.type="moveend",a(e.target,e),n&&n()}))}function F(e){return!!e&&(e.movestart?1:0)+(e.move?1:0)+(e.moveend?1:0)>1}function E(t,i,a){if(!F(e.data(this,"events")))return n(this,"dragstart.move drag.move",f),n(this,"mousedown.move",g),!0}function A(t){if(!F(e.data(this,"events")))return i(this,"dragstart drag",f),i(this,"mousedown touchstart",g),!0}e.event.special.movestart={setup:E,teardown:A,_default:function(e,t,i){var s={event:t,timer:new h((function(n){a(e.target,t)}))};undefined===t.identifier?(n(t.target,"click",m),n(document,r,D,s),n(document,c,M,s)):(i.preventDefault(),n(document,d+"."+t.identifier,S,s),n(document,p+"."+t.identifier,I,s))}},e.event.special.move=e.event.special.moveend={setup:E,teardown:A},n(document,"mousedown.move",(function(e){var t;(function(e){return 1===e.which&&!e.ctrlKey&&!e.altKey})(e)&&(t={target:e.target,startX:e.pageX,startY:e.pageY,pageX:e.pageX,pageY:e.pageY,timeStamp:e.timeStamp},n(document,r,v,t),n(document,l,y,t))})),n(document,"touchstart.move",(function(e){var t,i;o[e.target.tagName.toLowerCase()]||(i={target:(t=e.changedTouches[0]).target,startX:t.pageX,startY:t.pageY,pageX:t.pageX,pageY:t.pageY,timeStamp:e.timeStamp,identifier:t.identifier},n(document,d+"."+t.identifier,k,i),n(document,u+"."+t.identifier,x,i))}))}(jQuery),function(e,t){for(var n=["changedTouches","targetTouches"],i=n.length,a=e.event.props;i--;){for(var s=n[i],o=!1,r=0,l=a.length;r<l;++r)if(a[i]==s){o=!0;break}o||a.push(s)}}(jQuery);var PopupImage={_urls:[],_imgs:[],_preloading:!1,_imgSizes:{},attach:function(e){e=$(e),Dom.hackLinkClicksThanksSafari(e,PopupImage.click),this.preload(e,!0)},delegate:function(e){$(e).delegate("a.popupImage","click",PopupImage.click)},preload:function(e,t){if(!window.MediaView||"desktop"==MediaView.mode){var n=this;$(e).each((function(e,i){t&&"true"!=i.getAttribute("data-image-preload")||n._urls.push(i.getAttribute("href"))})),this._urls.length&&!this._preloading&&this._preloader()}},preload_url:function(e){this._urls.push(e),this._preloading||this._preloader()},_preloader:function(){if(this._urls.length)if(this._preloading=!0,this._imgs.push(CommUtils.loadImage(this._urls.shift())),this._urls.length){var e=this;setTimeout((function(){e._preloader(),e=null}),100)}else this._preloading=!1},click:function(e){if(!e.ctrlKey&&!e.metaKey){var t=e.currentTarget;t&&"A"!=t.tagName&&(t=$(t).parents("A")[0]),PopupImage.showFor(t,!1)&&(e.preventDefault(),e.stopPropagation())}},showFor:function(e,t){this.dismiss();var n=e&&e.href;if(!n)return!1;var i=e.getAttribute("data-statclick");if(i&&i.length>0&&Stats.record({kind:"click",click:i}),e.getAttribute("data-image-error"))return Log.debug("bailing on popup due to image load error: "+n),!1;var a=PopupImage.getCachedImageSize(e);if(a&&a.w&&a.h)return Log.debug("PopupImage.showFor: got cached image size; showing image immediately"),PopupImage.show(n,a.w,a.h,e,t),!0;Log.debug("PopupImage.showFor: no cached image size; delaying image display");var s,o=$(e).find("IMG")[0]||e,r=document.createElement("div");r.className="popupimage_loading",r.style.top=o.offsetTop+"px",r.style.left=o.offsetLeft+"px",r.style.width=o.offsetWidth+"px",r.style.height=o.offsetHeight+"px",o.offsetWidth<200||o.offsetHeight<200?r.innerHTML="<div class='popupimage_spinny_sm'></div>":r.innerHTML="<div class='popupimage_spinny_lg'></div>",r.style.opacity=0,o.offsetParent.appendChild(r),$(r).delay(500).fadeTo("fast",.5);var l=function(){r&&r.parentNode.removeChild(r),r=null},c=function(){(s=new Image).onload=function(){PopupImage._imgSizes[s.src]={w:s.width,h:s.height},PopupImage.show(s.src,s.width,s.height,e,t),s.onload=s.onerror=null,e=s=n=null,l()},s.onerror=function(){Log.debug("image load error: "+n),e.setAttribute("data-image-error","1"),s.onload=s.onerror=null,e=s=n=null,l()},s.src=n};return r.onclick=function(){s.onload=s.onerror=null,s.src=null,s=null,l()},c(),!0},show:function(e,t,n,i,a){this.show_inner(e,t,n,i,a)},show_inner:function(e,t,n,i,a){if(window.MediaView&&"phone"==window.MediaView.mode)return this.show_mobile(e,t,n,i,a);var s=this;s.dismiss();var o=document.documentElement,r=o.scrollHeight,l=o.scrollLeft,c=o.scrollTop+40;if(t&&n){var d=o.clientWidth-60,u=o.clientHeight-60;if(d/u>t/n?n>u&&(t*=u/n,n=u):t>d&&(n*=d/t,t=d),n>u-80)var p=(u-n)/2;else p=60;c=o.scrollTop+p-20}var h=!a&&null!=i;e=e.replace(/'/g,"\\'");var m=document.createElement("div");m.className="imageviewer_top",m.onclick=function(e){e.ctrlKey||e.metaKey||(e.preventDefault(),s.dismiss(this))};var f="<table align=center style='position:relative; top:"+c+"px;left:"+l+"px'><tr><td>",g=this.hasNext(i),_=this.hasPrev(i);if(m.innerHTML="<div id='popupimage_back' class='imageviewer_back' style='"+(h?"visibilityx: hidden; ":"")+"height:"+r+"px;width:100%'></div>"+f+"<div id='popupimage_dismiss' class='imageviewer_dismiss'"+(h?"style='visibility: hidden;' ":"")+"></div></td></tr><tr><td "+(t?" width='"+t+"px'":"")+(n?" height='"+n+"px'":"")+"><a target='_blank' style='position:relative;display:inline-block;' href='"+e+"'><img id='popupimage_image' class='imageviewer_image' src='"+e+"'"+(t?" width='"+t+"px'":"")+(n?" height='"+n+"px'":"")+(h?"style='position: relative; visibility: hidden; opacity: 0.5; filter: alpha(opacity=50);' ":"")+" />"+(_?"<span class='imageviewer_nav prev' "+(h?"style='display:none;'":"")+"><span class='imageviewer_navicon prev'></span></span>":"")+(g?"<span class='imageviewer_nav next' "+(h?"style='display:none;'":"")+"><span class='imageviewer_navicon next'></span></span>":"")+"</a></td></tr></table></div>",$(".imageviewer_nav.prev",m).click(PopupImage.goPrev.bind(PopupImage)),$(".imageviewer_nav.next",m).click(PopupImage.goNext.bind(PopupImage)),document.body.appendChild(m),s._current=m,s._currentSrc=i,s.globalListenersOn(),h){var b=elt("popupimage_image"),v=Dom.getXY(b),y=[t,n],w=1*t/n,k=Dom.getXY(i),x=i.offsetHeight>i.offsetWidth;start_width=i.offsetWidth,start_height=i.offsetHeight;var T=x?[start_width,start_width/w]:[start_height*w,start_height];x?k[1]+=i.offsetHeight/2-Math.round(T[0]/w/2):k[0]+=i.offsetWidth/2-Math.round(T[1]*w/2),k[0]+=Math.round((v[0]-k[0])/2),k[1]+=Math.round((v[1]-k[1])/2),T[0]+=Math.round((y[0]-T[0])/2),T[1]+=Math.round((y[1]-T[1])/2),b.width=T[0]+"px",b.height=T[1]+"px",b.left=k[0]-v[0]+"px",b.top=k[1]-v[1]+"px",b.style.visibility="visible";var C={opacity:.9,width:y[0],height:y[1],left:0,top:0};$(b).animate(C,{duration:200,easing:"linear",complete:function(){elt("popupimage_dismiss").style.visibility="visible";var e=elt("popupimage_image").style;e.position=e.opacity=e.filter="",$(".imageviewer_nav").css("display","inline-block")}}),b=i=null}return m=null,elt("popupimage_image")},show_mobile:function(e,t,n,a,s){var o=window.MediaView&&"phone"==window.MediaView.mode;if(o&&$(a).find("img").outerWidth()>$(window).width()/2&&$(a).closest(".popupImageGallery").find(".popupImage").length<=1)return!1;var r=null,l=null;function c(){var e={w:$(window).width(),h:$(window).height()};return o||(e.w-=40,e.h-=60),e}function d(e){Log.debug("PopupImage.build; goto_url: ",e);var t=$(a).closest(".popupImage"),n=$(a).closest(".popupImageGallery");if(n.length>0)var s=n.find(".popupImage");else s=$(t);var o=c();if((r=$("<div class='popupimage_gallery'></div>")).append($("<span class='popupimage_widget popupimage_nav dismiss'><span class='popupimage_navicon dismiss'></span>")).bind("click",(function(e){m()})),s.length>1){var d=$("<span class='popupimage_widget popupimage_nav navdots'></span>").appendTo(r).bind("click",(function(e){}));for(i=0;i<s.length;i++)d.append($("<span class='popupimage_dot'></span>"))}r.find(".popupimage_widget");var h=$("<ul class='popupimage_container'></ul>").css("width",101*s.length+"%").appendTo(r);e=e||t.attr("href"),s.each((function(t){var n=$(this),i=n.attr("href"),a=PopupImage.limitImageSize(PopupImage.getCachedImageSize(n)||{},o),s=i==e&&a.w&&a.h,r="<li class='popupimage_item' id='popupimage_item_"+t+"' style='width:"+o.w+"px;'><img "+(i==e?"src":"data-src")+"='"+i+"' style='display:"+(s?"block":"none")+"; width:"+(s?a.w+"px":"auto")+"; height:"+(s?a.h+"px":"auto")+";'></li>";h.append(r)}));var y=0,k=null;h.find(".popupimage_item").bind("touchstart",(function(e){k="start",p(self)})).bind("touchmove",(function(e){k="moving"})).bind("movestart",(function(e){y=$(this).closest(".popupimage_container")[0].offsetLeft,l=$(this),k="start"})).bind("move",(function(e){try{if("ignore"==k||Math.abs(e.distY)>Math.abs(e.distX))return f(e,l),k="ignore",!1;k="moving";var t=$(this).closest(".popupimage_container"),n=e.distX;(n>0&&!v($(this))||n<0&&!b($(this)))&&(n=Math.round(n/2.5)),t.css({left:y+n})}catch(e){Log.note("move error: "+e.message)}})).bind("moveend",(function(e){"moving"==k?k=function(e,t){try{return e.distX<-35&&e.velocityX<=0?(g(null,t),!0):e.distX>35&&e.velocityX>=0?(_(null,t),!0):(f(null,t),!1)}catch(e){Log.note("finishMove error: "+e.message)}}(e,this)?"moved":"revert":Log.note("moveend not moving: "+k)})).bind("click",(function(e){if(e.target!=this)switch(e.stopPropagation(),k){case"moved":case"moving":case"revert":case"ignore":break;default:k="click";$(this);e.clientX>.67*this.offsetWidth?g(e,this):e.clientX<.33*this.offsetWidth?_(e,this):m()}else m()})),h.find(".popupimage_item img").bind("load",u),$(document).on("keydown",w),$(document.body).on("orientationchange",(function(){T(!1,"orientation")})),$(window).on("resize",(function(){T(!1,"resize")})),$(document.body).append(r),Dom.hideEverythingThanksAndroid(r[0]),r.find(".popupimage_item").each((function(t,n){(n=$(n)).find("img").attr("src")==e&&(l=n)})),f(null,l,!0)}function u(e){var t=$(this),n=this;if(function(e){e=$(e),clearTimeout(e.data("loading-timer")),e.removeClass("loading"),e.addClass("loaded")}(t.closest(".popupimage_item")),n&&"auto"==n.style.width&&"auto"==n.style.height){"ie"==Browser.type&&t.css({display:"block"});var i={w:t.prop("width"),h:t.prop("height")};PopupImage._imgSizes[t.attr("src")]=i;var a=PopupImage.limitImageSize(i,c());t.css({width:a.w+"px",height:a.h+"px",display:"block"}),Log.debug("PopupImage: image loaded -- width: ",i.w,"height: ",i.h,n)}p(this)}function p(e){h((e=$(e).closest(".popupimage_item")).prev(".popupimage_item")),h(e.next(".popupimage_item"))}function h(e){var t=$(e).find("img"),n=t.attr("data-src");n&&(t.attr("src",n),t.attr("data-src",null))}function m(){$(".popupimage_gallery").remove(),$(document).off("keydown",w),$(document.body).off("orientationchange",T),$(window).off("resize",T),r&&Dom.unhideEverythingThanksAndroid(r[0]),r=l=null}function f(e,t,n){t=$(t),e&&e.preventDefault();var i=t.closest(".popupimage_container");if(i)try{t[0]&&(n?i.css({left:-t[0].offsetLeft+"px"}):i.animate({left:-t[0].offsetLeft+"px"},100,"linear"))}catch(e){Log.note("goTo error: "+e.message)}!function(e){(e=$(e)).hasClass("loaded")||e.data("loading-timer",setTimeout((function(){e.addClass("loading")}),250))}(t),y(t[0]),l=t}function g(e,t){(t=$(t||l)).is(".popupimage_container")&&(Log.note("hmmm container got event: "+e.which),t=$(e.target).closest(".popupimage_item")),y(t.next()[0]),f(e,$(t.next(".popupimage_item")[0]||t))}function _(e,t){(t=$(t||l)).is(".popupimage_container")&&(Log.note("hmmm container got event: "+e.which),t=$(e.target).closest(".popupimage_item")),y(t.prev()[0]),f(e,$(t.prev(".popupimage_item")[0]||t))}function b(e){return null!=$(e).next(".popupimage_item")[0]}function v(e){return null!=$(e).prev(".popupimage_item")[0]}function y(e){if(e){var t=e.id.match(/\d+/g),n=$(".navdots");n.children().removeClass("active"),$(n.children()[t]).addClass("active")}}function w(e){if(!e.ctrlKey&&!e.metaKey)switch(e.keyCode){case 13:case 27:case 32:m();break;case 39:case 40:g(null,l);break;case 37:case 38:_(null,l)}}var k,x=null;function T(e,t){if(!e)return x&&clearTimeout(x),void(x=setTimeout((function(){T(!0)}),500));if(r){var n=$(l).find("img").attr("src");m(),d(n)}}try{m(),d(),!o&&a&&l&&function(){var e=l.find("img"),t=e.offset(),n=e.outerWidth(),i=e.outerHeight(),s=1*n/i,o=r.find(".popupimage_container"),c=o.css("display");o.css({display:"none"});var d=$(a).offset(),u={width:$(a).outerWidth(),height:$(a).outerHeight()},p=1*u.width/u.height;center_by_width=s<p,s<p?(d.top+=Math.round(u.height/2),u.height=Math.round(u.width/s),d.top-=Math.round(u.height/2)):(d.left+=Math.round(u.width/2),u.width=Math.round(u.height*s),d.left-=Math.round(u.width/2)),d.left+=Math.round((t.left-d.left)/2),d.top+=Math.round((t.top-d.top)/2),u.width+=Math.round((n-u.width)/2),u.height+=Math.round((i-u.height)/2);var h=$("<img/>");h.attr({src:e.attr("src")}),h.css({position:"absolute","z-index":r.css("z-index")+1,opacity:.33,width:u.width+"px",height:u.height+"px",left:d.left+"px",top:d.top+"px"}),h.appendTo(document.body),h.animate({opacity:.9,width:n+"px",height:i+"px",left:t.left+"px",top:t.top+"px"},150,"swing",(function(){h.remove(),o.css({display:c})}))}()}catch(k){return Log.note("show_mobile error: "+k.message),!1}return!0},limitImageSize:function(e,t){return e&&e.w&&e.h&&(e={w:e.w,h:e.h},t.w/t.h>e.w/e.h?e.h>t.h&&(e.w*=t.h/e.h,e.h=t.h):e.w>t.w&&(e.h*=t.w/e.w,e.w=t.w)),e},getCachedImageSize:function(e){var t=(e=$(e)).attr("href"),n=PopupImage.getPresuppliedImageSize(e)||PopupImage._imgSizes[t]||null;return n&&Log.debug("PopupImage: found cached size for image: ",t,"width: ",n.w,"height: ",n.h),n},getPresuppliedImageSize:function(e){var t,n,i=(e=$(e)).attr("data-image-size"),a=null;try{i&&2==(n=i.toString().split(",")).length&&(a={w:parseInt(n[0]),h:parseInt(n[1])})}catch(t){Log.note("getPresuppliedImageSize error: "+t.message)}return a},hasNext:function(e){if(!(e=e||this._currentSrc))return!1;var t=$(e).closest(".popupImageGallery").find(".popupImage"),n=$.inArray(e,t);return n>-1&&n<t.length-1},goNext:function(e,t){if(e&&U.stopEvent(e),t=t||this._currentSrc){var n=$(t).closest(".popupImageGallery").find(".popupImage"),i=$.inArray(t,n);i>-1&&i<n.length-1&&(e&&e.preventDefault(),this.showFor(n[i+1],!0))}},hasPrev:function(e){if(!(e=e||this._currentSrc))return!1;var t=$(e).closest(".popupImageGallery").find(".popupImage");return $.inArray(e,t)>0},goPrev:function(e,t){if(e&&U.stopEvent(e),t=t||this._currentSrc){var n=$(t).closest(".popupImageGallery").find(".popupImage"),i=$.inArray(t,n);i>0&&(e&&e.preventDefault(),this.showFor(n[i-1],!0))}},dismiss:function(e){(e=e||this._current)&&e.parentNode&&e.parentNode.removeChild(e),e==this._current&&(this._current=null,this._currentSrc=null),PopupImage.globalListenersOff()},globalListenersOn:function(){$(document).on("keydown",PopupImage.popupKeys)},globalListenersOff:function(){$(document).off("keydown",PopupImage.popupKeys)},popupKeys:function(e){if(!e.ctrlKey&&!e.metaKey)switch(e.keyCode){case $.ui.keyCode.ENTER:case $.ui.keyCode.ESCAPE:case $.ui.keyCode.SPACE:U.stopEvent(e),PopupImage.dismiss();break;case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:U.stopEvent(e),PopupImage.goNext();break;case $.ui.keyCode.LEFT:case $.ui.keyCode.UP:U.stopEvent(e),PopupImage.goPrev()}},zzz:null},Crumb={ajax:function(e){var t=0,n=Url.toHash(e.url).pathname.substring(1),i="JSON"===e.dataAs,a=e.data;function s(){i?(a.crumb=_crumbs[n],e.data=ko.toJSON(a)):("string"!=typeof a&&(a=$.param(a)),_crumbs[n]&&(e.data=a+"&"+Url.joinQuery({crumb:_crumbs[n]})))}function o(i){_crumbs[n]=i,t+=1,s(),$.ajax(e)}function r(e,t){if(e){$.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)t(e[n])}}a||(a=i?{}:"");var l=e.error,c=e.success,d=e.complete;return s(),e.success=function(e,n,i){var a=jQuery.parseJSON(i.responseText);if("invalid_crumb"==a.error&&t<2)o(a.crumb);else{var s=this;r(c,(function(t){t.apply(s,[e,n,i])})),r(d,(function(e){e.apply(s,[i,n])}))}},e.error=function(e,n,i){var a=this;if(403==e.status)try{var s=jQuery.parseJSON(e.responseText);if("invalid_crumb"==s.error&&t<2)return void o(s.crumb)}catch(e){}r(l,(function(t){t.apply(a,[e,n,i])})),r(d,(function(t){t.apply(a,[e,n])}))},e.complete=null,$.ajax(e)},get:function(e){var t=Url.toHash(e).pathname.substring(1);return _crumbs[t]?_crumbs[t]:""},put:function(e){$.extend(_crumbs,e)}};U.augmentObject(Form,{_lifeBoatEnabled:!1,_formElem:null,_validateSections:null,_validateMessages:null,_onValidate:null,_customSubmitter:null,_submitOnEnter:!1,_allowSubmit:!1,_submitBlock:null,_cancellationListeners:null,_stack:new Array,_auxillaryValidationErrors:{},INTL_FLOAT_PATTERN:/^\d*,\d?\d?$/,init:function(e,t,n,i,a,s,o){if(Form._formElem&&Form._push(),e=elt(e),Form._formElem=e,window.onbeforeunload=Form._navigate,Form._cancellationListeners=$(e).find("[type='submit'][name='cancel'],[type='button'][name='cancel']"),Form._cancellationListeners.on("click.form_js"+Form._stack.length,(function(e){Form._cancelled(e,n)})),i)for(var r in i.sections){var l=i.sections[r].prefix;if(l?l+=".":l="",window.Validators){var c=Validators[r];for(var d in c){var u=c[d];"date"==u.type?Form.interpretDateFieldOnChange(l+d):"float"==u.type?Form.interpretFloatSeparatorOnChange(l+d):"url"==u.implicit_type?Form.qualifyUrlFieldOnChange(l+d):"isrc"==u.type?Form.interpretISRCFieldOnChange(l+d):"upc"==u.type&&Form.interpretUPCFieldOnChange(l+d)}}else Log.debug("Form.init: no form Validators installed")}$(e).keydown(Form.filter_returnkey).submit(Form._submitted),Form._lifeBoatEnabled=!(!t||!t.length),Form._lifeBoatMsg=t||"There are unsaved changes here. If you continue, you will lose them.";var p=Url.getQueryParam(location.toString(),"show_alert");switch(p){case null:case void 0:break;case"all":$(".alert").addClass("alertActive").each((function(){this.innerHTML="error text: "+this.id+" lorem ipsum dolor sit amet."}));break;default:(e=Form.validate.get_alert_elt(p)||elt(p))&&($(e).addClass("alertActive"),e.innerHTML="error text: "+e.id+" lorem ipsum dolor sit amet.")}i&&null==Url.getQueryParam(location.href,"novalidate")&&(Form._validateSections=i.sections,Form._validateMessages=i.messages,Form._onValidate=i.onValidate),Form._customSubmitter=a,Form._submitOnEnter=s,o||(Form._allowSubmit=!0)},extend:function(e,t,n){var i=elt(e);if(Form._formElem==i){var a=Form._validateSections[t];if(a){var s=a.prefix;if(s?s+=".":s="",window.Validators){Form._extensions=Form._extensions||{},Form._extensions[t]=Form._extensions[t]||[],-1==Iter.index(Form._extensions[t],n)&&Form._extensions[t].push(n);var o=Validators[t];for(var r in o){var l=o[r];"date"==l.type?Form.interpretDateFieldOnChange(s+r+n):"float"==l.type?Form.interpretFloatSeparatorOnChange(s+r+n):"url"==l.implicit_type?Form.qualifyUrlFieldOnChange(s+r+n):"isrc"==l.type?Form.interpretISRCFieldOnChange(s+r+n):"upc"==l.type&&Form.interpretUPCFieldOnChange(s+r+n)}}else Log.debug("Form.extend: no form Validators installed")}else Log.debug("Form.extend: sectionName not found")}else Log.debug("Form.extend: Form not initted, or wrong form is active: "+e)},allowSubmit:function(){Form._allowSubmit=!0},_push:function(){var e={lifeBoatEnabled:Form._lifeBoatEnabled,formElem:Form._formElem,validateSections:Form._validateSections,validateMessages:Form._validateMessages,onValidate:Form._onValidate,customSubmitter:Form._customSubmitter,submitOnEnter:Form._submitOnEnter,allowSubmit:Form._allowSubmit,submitBlock:Form._submitBlock,cancellationListeners:Form._cancellationListeners,extensions:Form._extensions};Form._stack.push(e)},detach:function(){Form._lifeBoatEnabled=!1,Form._validateSections=null,Form._validateMessages=null,Form._onValidate=null,Form._submitOnEnter=!1,Form._allowSubmit=!1,Form._submitBlock=null,Form._extensions=null,Form._cancellationListeners.off("click.form_js"+Form._stack.length),Form._cancellationListeners=null,Form._formElem=null,Form._pop()},setSubmitBlock:function(e){Form._submitBlock=e},interpretDateFieldOnChange:function(e){var t=Form._formElem.elements[e];$(t).on("change",(function(){var e=Time.strToDate(this.value);if(e){var t=Time.toUiDate(e,!0,!0);t!=this.value&&(this.value=t)}})),t=null},interpretFloatSeparatorOnChange:function(e){var t=Form._formElem.elements[e];$(t).on("change",Form.validate.priceOnChangeHandler),t=null},qualifyUrlFieldOnChange:function(e){var t=Form._formElem.elements[e];$(t).on("change",(function(){var e=U.trim(this.value);""!=(e=e.replace(/^(https?:)(\w)/i,"$1//$2"))&&-1==e.search(/^https?:\/\//i)&&(e="http://"+e),this.value=e})),t=null},interpretISRCFieldOnChange:function(e){var t=Form._formElem.elements[e];$(t).on("change",(function(){var e=Form.validate.isrc(U.trim(this.value));e&&(this.value=e)})),t=null},interpretUPCFieldOnChange:function(e){var t=Form._formElem.elements[e];$(t).on("change",(function(){var e=Form.validate.upc(this.value);e&&(this.value=e)})),t=null},disableLifeboat:function(){Form._lifeBoatEnabled=!1},_isCancelButton:function(e){return"cancel"==e.name},filter_returnkey:function(e){return e&&13==e.keyCode&&("TEXTAREA"!=e.target.tagName&&U.stopEvent(e),Form._submitOnEnter&&Form._submitted(e)),!0},_submitted:function(e){var t=e.target;if(t==Form._formElem||$(t).parents("form")[0]==Form._formElem){Form.validate.clear_alerts();var n=null;if(Form._validateSections&&!Form._isCancelButton(t)&&(n=Form.validateAndShowErrors()),n&&n.length>0)return U.stopEvent(e),n;Form._customSubmitter&&Form._customSubmitter(e)}},_pop:function(){if(Form._stack.length>0){var e=Form._stack.pop();Form._lifeBoatEnabled=e.lifeBoatEnabled,Form._formElem=e.formElem,Form._validateSections=e.validateSections,Form._validateMessages=e.validateMessages,Form._onValidate=e.onValidate,Form._customSubmitter=e.customSubmitter,Form._submitOnEnter=e.submitOnEnter,Form._allowSubmit=e.allowSubmit,Form._submitBlock=e.submitBlock,Form._cancellationListeners=e.cancellationListeners,Form._extensions=e.extensions}},_cancelled:function(e,t){U.stopEvent(e),Form._lifeBoatEnabled=!1,t&&(location.href=t)},validateAndShowErrors:function(e){e||(e=Form._validateSections),$assert(e);var t=[];for(var n in e){var i=e[n],a=Form._extensions?Form._extensions[n]:null;if(a&&a.length>0){for(var s=[],o=0,r=a.length;o<r;++o)s=s.concat(Form.validate.check_field_errors(n,i,a[o])||[]);0==s.length&&(s=null)}else s=Form.validate.check_field_errors(n,i);if(s)for(o=0;o<s.length;o++){var l=s[o];Log.warn('error in field "'+l.field+'": '+l.reason,l),Form.validate.show_alert(l),t.push(l)}}return t&&t.length&&this.revealError(),t},revealError:function(){try{var e=null,t=$(".alertActive")[0],n=t.id.match(/^(.*)[\_\-]alert$/);n&&(e=$("#"+n[1])[0],Log.warn(e?"using alt elt":"using err elt"));var i=e?-10:-50;Dom.scrollToElement(e||t,i)}catch(e){Log.error("validate: error scrolling to reveal error message")}},formIsDirty:function(e){if((e=elt(e)).lifeboatDirty)return!0;for(var t=e.elements,n=0;n<t.length;n++){var i=t[n];if(Form.fieldIsDirty(i))return Log.info("Form element "+i.name+" is dirty."),!0}return!1},formIsNotDirty:function(e){(e=elt(e)).lifeboatDirty&&(e.lifeboatDirty=!1);for(var t=e.elements,n=0;n<t.length;n++){var i=t[n];Form.fieldIsNotDirty(i)}$(e).triggerHandler("undirty")},dirtyForm:function(e){(e=e?elt(e):Form._formElem)&&"FORM"!=e.tagName.toUpperCase()&&(e=$(e).parents("form")[0]),e&&(e.lifeboatDirty=!0,$(e).triggerHandler("dirty"))},unDirty:function(){Form._lifeBoatEnabled&&Form.formIsNotDirty(Form._formElem)},fieldIsDirty:function(e){if(!e.name)return!1;if("button"==e.tagName.toLowerCase())return!1;switch(e.type){case"checkbox":case"radio":if(e.checked!=e.defaultChecked)return!0;break;case"submit":case"reset":case"image":case"button":return!1;case"select-one":for(var t,n=e.options,i=!1,a=0;a<n.length;a++){var s=n[a];s.defaultSelected&&(i=!0),s.defaultSelected!=s.selected&&(t=a)}if(null!=t&&(i||t>0))return!0;break;case"hidden":return!1;default:if(e.defaultValue!=e.value)return!0}return!1},fieldIsNotDirty:function(e){switch(e.type){case"checkbox":case"radio":e.defaultChecked=e.checked;break;case"submit":case"reset":case"image":case"button":break;case"select-one":for(var t=e.options,n=0;n<t.length;n++){var i=t[n];i.defaultSelected=i.selected}break;case"hidden":break;default:e.defaultValue=e.value}},_navigate:function(){if(Form._lifeBoatEnabled&&Form.formIsDirty(Form._formElem))return Form._lifeBoatMsg},validate:{check_field_errors:function(e,t,n){if(!window.Validators)return Log.debug("Form.validate: no form Validators installed"),null;n=n||"";var i=Validators[e],a=null;for(var s in i){var o=i[s];t.prefix&&(s=t.prefix+"."+s+n);var r=Form.validate.check_value_error(s,o)||Form._auxillaryValidationErrors[s];r&&(n&&(r.suffix=n),a||(a=[]),a[a.length]=r,Log.info("field failed validation: "+s))}return a},check_value_error:function(e,t){var n=Form._formElem.elements[e];if(!n)return null;if("hidden"==n.type&&!$(n).hasClass("validate-hidden"))return null;if(n.disabled)return null;if(!t)return Log.debug("no validator"),null;var i=Form.validate._check_value_error_inner(e,t,n);if(Form._onValidate){var a=Form._onValidate(n,e,t,i);void 0!==a&&(Log.debug("onValidate override for field: "+e+"; previous error: "+(i?i.reason:"none")),i=a)}return i},_check_value_error_inner:function(e,t,n,i){if(!(i=U.trim(void 0===i?n.value:i))||"checkbox"==n.type&&!n.checked)return t.req&&("function"!=typeof t.req||t.req(e))?(Log.warn("required field "+e+" empty"),{reason:"missingValue",field:e,validator:t}):null;switch(t.type){case"int":var a=parseInt(i);if(isNaN(a)||null!=t.max&&a>t.max||null!=t.min&&a<t.min||!i.match(/^\d+$/))return Log.warn("bad number: "+e),{reason:"badNumber",field:e,max:t.max,min:t.min,validator:t};break;case"float":a=parseFloat(i);if(isNaN(a)||null!=t.max&&a>t.max||null!=t.min&&a<t.min||!i.match(/^\d*(\.\d+)?$/))return Log.warn("bad float: "+e),{reason:"badNumber",field:e,max:t.max,min:t.min,validator:t};break;case"text":if(null!=t.max&&i.length>t.max||null!=t.min&&i.length<t.min)return Log.warn("string length out of range: "+e),{reason:"stringLength",field:e,max:t.max,min:t.min,validator:t};break;case"date":var s=Form.validate.validate_date(i);if(U.isString(s))return Log.warn("bad date: "+e),{reason:s,field:e,validator:t};$assert(s);var o=Time.toUiDate(s,!0,!0);o!=i&&(n.value=o);break;case"isrc":if(!Form.validate.isrc(i,t))return Log.warn("bad isrc: "+e),{reason:"badisrc",field:e,validator:t};break;case"upc":var r=Form.validate.upc(i,t);if(!r)return Log.warn("bad upc: "+e),{reason:"badupc",field:e,validator:t};n.value=r}if(t.match&&(rex=new RegExp(t.match),!rex.test(i)))return Log.warn("failed pattern match: "+e),{reason:"badFormat",field:e,customMessage:t.message,validator:t};if(t.clientproc){var l;switch(t.clientproc){case"EditTralbum.validate_tralbum_tags":l=EditTralbum.validate_tralbum_tags;break;case"EditTralbum.validate_track_about":l=EditTralbum.validate_track_about;break;case"EditTralbum.validate_track_lyrics":l=EditTralbum.validate_track_lyrics;break;case"EditTralbum.validate_track_credits":l=EditTralbum.validate_track_credits;break;case"CatNumber.validate_catalog_number":l=CatNumber.validate_catalog_number}if(!l)return Log.server("Unknown clientproc validator: "+t.clientproc,"error"),null;try{var c=l(e,i);if(c)return c.validator=t,c}catch(e){Log.error("validate: error executing clientproc: "+t.clientproc)}}return null},parsePrice:function(e){return 0==(e=U.trim(e)).search(Form.INTL_FLOAT_PATTERN)&&(e=e.replace(",",".")),parseFloat(e)},validate_date:function(e){var t=Time.strToDate(e);if(t){var n=t.getFullYear();return n>2037||n<1902?"dateOutOfRange":t}return"dateFormat"},validate_price:function(e,t,n,i,a,s,o,r){var l=i?elt(i):Form.validate.get_alert_elt(e),c=elt(e)||Form._formElem.elements[e];if(c){var d=U.trim(c.value);if(0==d.length&&l){if(t)return Log.debug("Missing required price for ",e),FormUtils.showHideAlert(l,a||"Please provide the price."),$(c).addClass("has-validation-error"),!1}else if(n&&l&&(price=Form.validate.parsePrice(d),!isNaN(price))){if(r&&0==price&&o)return Log.debug("Zero price is not allowed for ",e),FormUtils.showHideAlert(l,o),$(c).addClass("has-validation-error"),!1;if(price<n&&(r||0!=price)){Log.debug("Price out of range for ",e);var u=s||"This price is too small to process.  Please enter "+(r?"":"either zero, or ")+TextFormat.currency(n,CurrencyData.current,!1,!0,!0)+" or more.";return FormUtils.showHideAlert(l,u),$(c).addClass("has-validation-error"),!1}}}return!0},validate_price_nonzero:function(e,t,n,i,a,s,o){return Form.validate.validate_price(e,t,n,i,a,s,o,!0)},priceOnChangeHandler:function(e){var t=U.trim(this.value);""!=t&&0==t.search(Form.INTL_FLOAT_PATTERN)&&(this.value=t.replace(",","."))},check_email_typos:function(e,t,n,i){if(i)var a=console.log;else a=function(){};if(!e||""===e)return null;var s=e.split("@"),o=s[0].toLowerCase(),r=s[1].toLowerCase(),l=function(e,t,n){if(a("NAME TYPO"),!t||""==t||!n||""==n)return null;var i={:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:["A","AE"],:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:["A","AA"],:"A",:"A",:"A",:"A",:"AA",:"[AE,E]",:"AE",:"AE",:"AO",:"AU",:"AV",:"AV",:"AY",:"B",:"B",:"B",:"B",:"B",:"B",:"C",:"C",:"C",:"C",:"C",:"C",:"C",:"C",:"D",:"D",:"D",:"D",:"D",:"D",:"D",:"D",:"D",:"D",:"D",:"DZ",:"DZ",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"ET",:"F",:"F",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"H",:"H",:"H",:"H",:"H",:"H",:"H",:"H",:"H",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"D",:"F",:"G",:"R",:"S",:"T",:"IS",:"J",:"J",:"K",:"K",:"K",:"K",:"K",:"K",:"K",:"K",:"K",:"K",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"LJ",:"M",:"M",:"M",:"M",:"N",:"N",:"N",:"N",:"N",:"N",:"N",:"N",:"N",:"N",:"N",:"N",:"NJ",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:["O","OE"],:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:["O","OE"],:"O",:"O",:"O",:"O",:"O",:"OI",:"OO",:"E",:"O",:"OU",:"P",:"P",:"P",:"P",:"P",:"P",:"P",:"Q",:"Q",:"R",:"R",:"R",:"R",:"R",:"R",:"R",:"R",:"R",:"R",:"R",:"C",:"E",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"T",:"T",:"T",:"T",:"T",:"T",:"T",:"T",:"T",:"T",:"T",:"A",:"L",:"M",:"V",:"TZ",:"U",:"U",:"U",:"U",:"U",:["U","UE"],:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"V",:"V",:"V",:"V",:"VY",:"W",:"W",:"W",:"W",:"W",:"W",:"W",:"X",:"X",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Z",:"Z",:"Z",:"Z",:"Z",:"Z",:"Z",:"Z",:"Z",:"IJ",:"OE",:"A",:"AE",:"B",:"B",:"C",:"D",:"E",:"F",:"G",:"G",:"H",:"I",:"R",:"J",:"K",:"L",:"L",:"M",:"N",:"O",:"OE",:"O",:"OU",:"P",:"R",:"N",:"R",:"S",:"T",:"E",:"R",:"U",:"V",:"W",:"Y",:"Z",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:["a","ae"],:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:["a","aa"],:"a",:"a",:"a",:"a",:"aa",:"[ae,e]",:"ae",:"ae",:"ao",:"au",:"av",:"av",:"ay",:"b",:"b",:"b",:"b",:"b",:"b",:"b",:"b",:"o",:"c",:"c",:"c",:"c",:"c",:"c",:"c",:"c",:"c",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"i",:"j",:"j",:"j",:"dz",:"dz",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"et",:"f",:"f",:"f",:"f",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"h",:"h",:"h",:"h",:"h",:"h",:"h",:"h",:"h",:"h",:"h",:"hv",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"d",:"f",:"g",:"r",:"s",:"t",:"is",:"j",:"j",:"j",:"j",:"k",:"k",:"k",:"k",:"k",:"k",:"k",:"k",:"k",:"k",:"k",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"lj",:"s",:"s",:"s",:"s",:"m",:"m",:"m",:"m",:"m",:"m",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"nj",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:["o","oe"],:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:["o","oe"],:"o",:"o",:"o",:"o",:"o",:"oi",:"oo",:"e",:"e",:"o",:"o",:"ou",:"p",:"p",:"p",:"p",:"p",:"p",:"p",:"p",:"p",:"q",:"q",:"q",:"q",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"c",:"c",:"e",:"r",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"g",:"o",:"o",:"u",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"th",:"a",:"ae",:"e",:"g",:"h",:"h",:"h",:"i",:"k",:"l",:"m",:"m",:"oe",:"r",:"r",:"r",:"r",:"t",:"v",:"w",:"y",:"tz",:"u",:"u",:"u",:"u",:"u",:["u","ue"],:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"ue",:"um",:"v",:"v",:"v",:"v",:"v",:"v",:"v",:"vy",:"w",:"w",:"w",:"w",:"w",:"w",:"w",:"w",:"x",:"x",:"x",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"z",:"z",:"z",:"z",:"z",:"z",:"z",:"z",:"z",:"z",:"z",:"z",:"z",:"z",:"ff",:"ffi",:"ffl",:"fi",:"fl",:"ij",:"oe",:"st",:"a",:"e",:"i",:"j",:"o",:"r",:"u",:"v",:"x"},s=1;Object.keys(i).forEach((function(e){s=Math.max(s,Array.isArray(i[e])?i[e].length:1)})),e=e.toLowerCase();var o=d(t),r=d(n);t=o[0],n=r[0];var l=o[1],c=r[1];function d(e){var t=new RegExp("[^A-Za-z0-9\\[\\] ]","g"),n=new RegExp("(^(\\w )+)|(( \\w)+$)","g"),a=[];if(t.test(e)){a[s-1]="",a.fill("");for(var o=function(e){for(var t=0;t<a.length;t++)a[t]+=e},r=0;r<e.length;r++){var l=e[r];if(t.test(l))if(i[l]&&Array.isArray(i[l]))for(var c=0;c<i[l].length;c++)a[c]+=i[l][c];else o(i[l]?i[l]:e[r]);else o(e[r])}}else a=[e];a=a.filter((function(e,t,n){return t==n.indexOf(e)}));for(r=0;r<a.length;r++)a[r]=a[r].replace(n,"").toLowerCase().replace(/[^a-z]/g,"");return[a.pop(),a]}if(a(t),a(n),a(l),a(c),u(t,n)||u(t,t[0]+n)||u(n[0]+t,n))return null;function u(e,t){var n=e.length<t.length?e:t,i=e.length<t.length?t:e;a("checking for similarities in first and last name");for(var s=0;s<i.length-(n.length-1);s++){var o=i.substring(s,n.length+1+s);if(p(n,o)||p(o,n))return!0}}var g,_=[],b=f(e,0,t);if(b){var v=e.substring(0,b.elem.index)+b.newLeftPart;(b.elem.orig=={jenny:"jenni",peter:"pete",ann:"an",jono:"jona",joe:"jose",charlie:"charle",paul:"pabl"}[b.elem.correction]||h(b.elem.orig,l)||m(n,e)&&!m(n,v))&&(b=null)}b?b.elem.index+t.length+n.length>e.length?(g=e,C=0):(g=b.newLeftPart,C=b.startIndex):(g=e,C=0);var y=f(g,C,n);y&&h(y.elem.orig,c)&&(y=null);a(b),a(y);var w=[];b&&!b.found&&w.push(b.elem);y&&!y.found&&w.push(y.elem);var k=new RegExp("(.*)\\.\\.(.*)"),x=e;for(;k.test(x);){var T=k.exec(x);a(T),x=T[1]+"."+T[2],w.push({index:T[1].length,orig:"..",correction:"."})}if(0==w.length)return null;w.sort((function(e,t){return e.index-t.index}));for(var C=0,D=0;D<w.length;D++)_.push({orig:e.substring(C,w[D].index)}),_.push({orig:w[D].orig,correction:w[D].correction}),C=w[D].index+w[D].orig.length;return _.push({orig:e.substring(C)}),_=_.filter((function(e){return e.correction||""!=e.orig})),a(_),_}(o,t,n),c=function(e){a("DOMAIN TYPO");var t,n,i=["gmail","hotmail","outlook","yahoo","icloud","mail","mac","aol","zoho"],s=e.split("."),o=s.shift(),r=s.join("."),l=r.split("."),c=l[l.length-1],d=[],u=new RegExp("\\d+");if(u.test(c)||"con"===c){for(n=c;u.test(n);)n=n.replace(u,"");n="con"===n?"com":n}for(var h=0;h<i.length;h++){var m=i[h];if(a(m),!(o.length>m.length+1||o.length<m.length-1)){if(o==m){if(!n)return null}else(t=p(o,m,!0))&&t.orig!=o&&(t=null);if(t||n){d=[];var f={orig:o},g={orig:r};return t&&(f.correction=t.correction),n&&(l[l.length-1]=n,g.correction=l.join(".")),d.push(f),d.push({orig:"."}),d.push(g),a(d),d}}}return null}(r),d={userEmail:e};if(!l&&!c)return null;d.snippets=function(t){for(var n=[],i=e.split("@"),a=0;a<t.length;a++){if(t[a])for(var s=0;s<t[a].length;s++)n.push(t[a][s]);else n.push({orig:i[a]});0==a&&n.push({orig:"@"})}return n}([l,c]),d.correctedEmail=function(e){for(var t="",n=0;n<e.length;n++)t+=e[n].correction||e[n].orig;return t}(d.snippets),d.correctedEmail==d.userEmail&&(d.correctedEmail=null);var u=d.correctedEmail.split("@");return l&&(d.personalSection=u[0]),c&&(d.domainSection=u[1]),a(d),d;function p(e,t,n){if(a("check for close match: "+(n?"strict":"loose")),t.length<3)return null;if(n){if(t===e)return a("shortString "+t+" = longString "+e),null}else{var i=new RegExp("(.?)"+t+"(.?)");if(i.test(e))return a(e+" contains "+t),{orig:t,correction:t,before:(o=i.exec(e))[1],after:o[o.length-1]}}a(e),a(t);for(var s=1;s<=t.length;s++){var o,r=t.substring(0,s),l=t.substring(s),c=new RegExp("[a-z]");if((o=new RegExp(r+"(.)"+l).exec(e))&&(a("extra letter match"),n||!n&&/[A-Za-z0-9]/.test(o[1])))return a("extra letter: "+r+", "+l),a(o),{orig:r+o[1]+l,correction:t,before:"",after:""};if((o=new RegExp("(.?)"+r+"(.)"+l.substring(1)+"(.?)").exec(e))&&(a("wrong letter match"),c.test(o[2])))return a("wrong letter: "+r+", "+l.substring(1)),a(o),{orig:r+o[2]+l.substring(1),correction:t,before:o[1],after:o[o.length-1]};if("mail"!==l){var d=r.substring(0,r.length-1);if((o=new RegExp("(.*)"+d+l+"(.*)").exec(e))&&(a("missing letter match"),n||!n&&""!=d&&1!=r.length&&r!=t[0]))return a("missing letter: "+d+", "+l),a(o),{orig:d+l,correction:t,before:o[1],after:o[o.length-1]}}var u=t.substring(0,s-1),p=t.substring(s+1),h=t.charAt(s)+t.charAt(s-1);if(o=new RegExp("(.?)"+u+h+p+"(.?)").exec(e))return a("switched letter match"),a("switched letters: "+u+", "+p),a(o),{orig:u+h+p,correction:t,before:o[1],after:o[o.length-1]}}return null}function h(e,t){return t.indexOf(e)>-1}function m(e,t){return-1!=t.indexOf(e)}function f(e,t,n){if(a(""),a("searchForName"),a(e),a(""),e.length<n.length-1||n.length<2)return null;var i=e.substring(0,n.length+1),s=e.substring(n.length+1),o=p(i,n);if(a(o),o&&(s=e.substring(o.before.length+o.orig.length),a({orig:o.orig,theRest:s,correction:n})),o&&o.orig!==o.correction&&(o.orig===n.substring(0,o.orig.length)&&s[0]==n[n.length-1]||o.orig.substring(0,n.length-1)===n.substring(0,n.length-1))&&(a("ignoring result"),o=null),t+=o?o.before.length:0,o&&o.orig==o.correction)return{found:!0,newLeftPart:s,startIndex:t+n.length,elem:{index:t,orig:o.orig}};if(o){var r=o.orig.length-o.correction.length,l={newLeftPart:s,startIndex:t+n.length+r,elem:{index:t,orig:o.orig,correction:n}};return a("toReturn",l),l}return f(e.substring(1),t+1,n)}},isrc:function(e,t){var n;return 12!=(n=e.replace(/ |-|\//g,"").toUpperCase()).length?null:n.substr(0,2).match(/[A-Z]{2,2}/)&&n.substr(2,3).match(/[0-9A-Z]{3,3}/)&&n.substr(5,7).match(/[0-9]{7,7}/)?n.substr(0,2)+"-"+n.substr(2,3)+"-"+n.substr(5,2)+"-"+n.substr(7,5):null},upc:function(e,t){var n;return 12!=(n=e.replace(/ |-|\//g,"")).length&&13!=n.length||n.match(/[^0-9]/)?null:12==n.length?n.substr(0,6)+" "+n.substr(6,6):n.substr(0,7)+" "+n.substr(7,6)},upc_checksum:function(e,t){var n;if(12!=(n=e.replace(/ |-|\//g,"")).length&&13!=n.length)return null;if(n.match(/[^0-9]/))return null;for(var i=(12==n.length?"0"+n:n).split("").map((function(e){return parseInt(e)})),a=!1,s=0,o=0;o<12;o++)s+=a?3*i[o]:i[o],a=!a;var r=(10-s%10)%10;return i[12]!=r?null:12==n.length?n.substr(0,6)+" "+n.substr(6,6):n.substr(0,7)+" "+n.substr(7,6)},clear_alerts:function(){$(".alertActive").each((function(){FormUtils.showHideAlert(this,null)})),$(".has-validation-error",Form._formElem).removeClass("has-validation-error")},clear_alert:function(e){FormUtils.showHideAlert(e,null)},onchange_maybe_hide_alert:function(e){var t=e.target,n=e.data.err;if(n.validator&&!Form.validate.check_value_error(n.field,n.validator)){var i=Form.validate.get_alert_elt(n.field);$(t).removeClass("has-validation-error"),$(i).removeClass("alertActive"),Form.validate.remove_onchange_listeners(t)}},remove_onchange_listeners:function(e){$(e).off("keyup").off("change")},show_alerts:function(e,t){void 0===t&&(t=!0),e?U.isArray(e)||(e=[e]):e=[{field:"generic",reason:"generic"}];for(var n=0;n<e.length;n++)Form.validate.show_alert(e[n]);t&&Form.revealError()},show_alert:function(e){var t=Form.validate.get_alert_elt(e.field),n=Form.validate.get_error_text(e);if(t){FormUtils.showHideAlert(t,n);var i=Form._formElem.elements[e.field];$(i).addClass("has-validation-error").on("keyup",{err:e},Form.validate.onchange_maybe_hide_alert).on("change",{err:e},Form.validate.onchange_maybe_hide_alert)}else NuDialog.alertHTML("Oops!",n)},get_alert_elt:function(e){return elt(e+"_alert")||elt(e+"-alert")||$(Form._formElem.elements[e]).siblings(".alert")[0]||$(Form._formElem.elements[e]).siblings(".license-alert")[0]||$(Form._formElem.elements[e]).closest("label").siblings(".alert")[0]||$(Form._formElem.elements[e]).closest(".fieldHintWrapper").siblings(".alert")[0]||$(Form._formElem.elements[e]).closest(".jquery-placeholder-wrapper").siblings(".alert")[0]||$(Form._formElem.elements[e]).closest(".acWidget").siblings(".alert")[0]},get_error_text:function(e){var t=e.reason,n=e.field;e.suffix&&n.lastIndexOf(e.suffix)==n.length-e.suffix.length&&(n=n.substring(0,n.length-e.suffix.length));var i=n;if(window.Validators&&Validators._fieldNames&&Validators._fieldNames[i]&&(i=Validators._fieldNames[i]),Form._validateMessages){var a=Form._validateMessages[n];if(a){var s=a[t];if(s)return s}}if(e.customMessage)return e.customMessage;switch(t){case"missingValue":return i?"Required field: "+i+".":"Required field.";case"badNumber":return null!=e.min&&null!=e.max?"A number between "+e.min+" and "+e.max+" is required.":null!=e.min?"A number (at least "+e.min+") is required.":null!=e.max?"A number (up to "+e.max+") is required.":"A number is required.";case"stringLength":return null!=e.min&&null!=e.max?"This value must be between "+e.min+" and "+e.max+" characters.":null!=e.min?"This value is too short (minimum length: "+e.min+" characters).":($assert(null!=e.max),"This value is too long (maximum length: "+e.max+" characters).");case"badFormat":return"Invalid "+i+" format.";case"dateFormat":return"Please enter a date in the form mm/dd/yyyy.";case"dateOutOfRange":return"Please enter a date between 1902 and 2037.";case"badisrc":return"Please enter a valid ISRC code (or leave blank).";case"badupc":return"Please enter a valid UPC/EAN code (or leave blank)."}return i?"error: field="+i+", reason="+t:"error: "+t}}});var SimpleForm={submit:function(e,t,n){n=n||"post";var i=document.createElement("form");for(var a in i.setAttribute("method",n),i.setAttribute("action",e),t){var s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name",a),s.setAttribute("value",t[a]),i.appendChild(s)}document.body.appendChild(i),i.submit()}},FormUtils={showHideAlert:function(e,t){(e=U.elt(e))&&("boolean"!=typeof t&&(e.innerHTML=t||""),t?$(e).addClass("alertActive"):($(e).removeClass("alertActive"),window.Form&&window.Form.validate&&Form.validate.remove_onchange_listeners(e)))}};if(!window.Cookie)throw"expected Cookie library";Cookie.CommChannel=function(e,t){$assert(Text.notEmpty(e)),this._id=Math.round(1e9*Math.random()),t&&(e+=this._id),this._channelName=e;var n=Cookie.CommChannel.COOKIE_NAME_PREFIX+e;this._cookieName=n+"_"+this._id,this._namePattern=new RegExp("^"+Text.regexpEscape(n)+"_(\\d+)$"),this._queue={last:0,msgs:[]},this._lastSeen={},this._scanTimer=null,Cookie.clear(this._cookieName)},Cookie.CommChannel.EVENT_NAME="cookiecomm_message",Cookie.CommChannel.COOKIE_NAME_PREFIX="_comm_",Cookie.CommChannel.MAX_QUEUE_SIZE=5,Cookie.CommChannel.SCAN_TIMEOUT=250,Cookie.CommChannel.COOKIE_MAX_AGE=5,Cookie.CommChannel.prototype={getName:function(){return this._channelName},startListening:function(){if(!this._scanTimer){var e=this;this._scanTimer=setInterval((function(){e._scanAllQueues()}),Cookie.CommChannel.SCAN_TIMEOUT),Log.info("Cookie comm channel "+this.getName()+" started listening.")}},stopListening:function(){this._scanTimer&&(clearInterval(this._scanTimer),this._scanTimer=null,Log.info("Cookie comm channel "+this.getName()+" stopped listening."))},subscribe:function(e){$(document).on(Cookie.CommChannel.EVENT_NAME+"_"+this._id,e)},unsubscribe:function(e){$(document).off(Cookie.CommChannel.EVENT_NAME+"_"+this._id,e)},send:function(e){$assert(U.isString(e));var t=Iter.collect(arguments);Log.debug("Cookie comm channel "+this.getName()+" sending message "+t[0],t);for(var n=t.length-1;n>0&&null==t[n];n--)t.pop();var i=this._queue.msgs;i.push(t),this._queue.last++,i.length>Cookie.CommChannel.MAX_QUEUE_SIZE&&(this._queue.msgs=i.slice(1)),this._writeTimeout&&clearTimeout(this._writeTimeout);var a=this;this._writeTimeout=setTimeout((function(){a._writeQueue()}),0)},cleanup:function(){Cookie.clear(this._cookieName),this.stopListening(),this._lastSeen=this._queue=null},_writeQueue:function(){var e=JSON.stringify(this._queue);Cookie.set(this._cookieName,e,Cookie.CommChannel.COOKIE_MAX_AGE)},_scanAllQueues:function(){var e=Cookie.getAll();for(var t in e){var n=this._namePattern.exec(t);if(n){var i=n[1]-0;if(i!==this._id){var a=e[t];$assert(!U.isArray(a),"we expect only one cookie per name");var s=JSON.parse(a);this._scanOneQueue(i,s)}}}},_scanOneQueue:function(e,t){var n=t.last;$assert(U.isNumber(n));var i=n-(this._lastSeen[e]||0);if(i>0){var a=t.msgs.slice(-i);$assert(a.length),this._lastSeen[e]=n;for(var s=0;s<a.length;s++){var o=a[s];if(Log.debug("Cookie comm channel "+this.getName()+" received from "+e+" message "+o[0],o),o.unshift(e),$.event.trigger(Cookie.CommChannel.EVENT_NAME+"_"+this._id,[o]),!this._scanTimer)break}}}};var Player={};Player.TrackInfo=function(){function e(e){this.update(e)}e.prototype={update:function(e){for(var n=t,i=0;i<n.length;i++)this[n[i]]=e[n[i]];return this},is_playable:function(){return!!this.file},is_busy:function(){return this.encoding_pending&&!this.encoding_error},mark_as_capped:function(){this.is_capped=!0},copy:function(){for(var e={},n=t,i=0;i<n.length;i++)e[n[i]]=this[n[i]];return e}},e.is_same=function(e,n){for(var i=t,a=0;a<i.length;a++)if(e[i[a]]!=n[i[a]])return!1;return!0};var t=["tracknum","file","encoding_error","encoding_pending","title","title_link","id","track_license_id","has_lyrics","has_info","is_downloadable","free_album_download","has_free_download","duration","private","album_private","artist","album_preorder","unreleased_track","alt_link","continuous","video_source_type","video_caption","video_id","video_mobile_url","is_capped"];return e}(),Player.Playlist=function(){function e(t,n,i,a){a=a||{},this._options=a,this._player=t,this._playlist=[],this._playing_from=n,a.url_params&&a.url_params.esig&&(a.url_params.album||a.url_params.track)&&(i+="&esig="+a.url_params.esig+"&rsig="+a.url_params.rsig+(a.url_params.album?"&album="+a.url_params.album:"&track="+a.url_params.track),this._url_referrer=a.url_params.url_referrer),this._referer=i,this._track=0,this._loadedtrack=-1,this._loadpercent=0,this._duration=null,this._state="IDLE",this._unloaded=!0,this._scrubbed=!1,this._trackstate=!a.no_trackstate,this._trackchanged=EventSender.create(this,"trackchanged"),this._trackplayed=EventSender.create(this,"trackplayed"),this._trackcapped=EventSender.create(this,"trackcapped"),this._scrubbedback=EventSender.create(this,"scrubbedback"),this._completedplay=EventSender.create(this,"completedplay"),this._playlistchanged=EventSender.create(this,"playlistchanged"),this._statechanged=EventSender.create(this,"statechanged"),this._loaded=EventSender.create(this,"loaded"),this._timechanged=EventSender.create(this,"time"),this.first_playable_track=-1,this.last_playable_track=-1,this._ui_listeners=new Object,this._usecomm=!0;var s=$("#pagedata").data("blob")||{};this._stream_buffer_duration_stats=s.cfg&&s.cfg.stream_buffer_duration_stats||null,this._buffering_start_time=null;var o=this;this._player.onstate((function(e,t){o._unloaded||o._handle_state({oldstate:o._state,newstate:t.newstate})})),this._player.ontime((function(e,t){o._unloaded||o._handle_time(t)})),this._player.onloaded((function(e,t){o._unloaded||o._handle_load(t)})),e.coordinator||(e.coordinator=new Player.PlaylistCoordinator),e.coordinator.add(this)}e.prototype={getoption:function(e){return this._options[e]},add_track:function(e){e=new Player.TrackInfo(e);if(this._url_referrer&&e.file)for(var t in e.file)e.file[t]+="&urlref="+document.URL.replace(/\&/g,"/");var n=this._playlist.push(e)-1;return this._playlist[n].tracknum=n,e.is_playable()&&(-1==this.first_playable_track&&(this.first_playable_track=n,this._track=n),this.last_playable_track=n),this._playlistchanged(),n},set_initial_track:function(e){this._playlist[e]&&this._playlist[e].is_playable()&&(this._track=e)},update_trackinfo:function(e,t){if(t.tracknum=e,t=this._playlist[e].update(t),this._loadedtrack=-1,t.is_playable())(-1==this.first_playable_track||e<this.first_playable_track)&&(this.first_playable_track=e),(-1==this.last_playable_track||e>this.last_playable_track)&&(this.last_playable_track=e);else{if(e==this.first_playable_track){this.first_playable_track=-1;for(var n=e+1;n<this._playlist.length;n++)if(this._playlist[n].is_playable()){this.first_playable_track=n;break}}if(e==this.last_playable_track){this.last_playable_track=-1;for(n=e-1;n>=0;n--)if(this._playlist[n].is_playable()){this.last_playable_track=n;break}}}this._playlistchanged(),"BUSY"==this._state&&t.is_playable()&&this.play()},playpause:function(){var e=null;switch(this._state){case"IDLE":case"COMPLETED":case"PAUSED":this.play(),e=1;break;case"PLAYING":case"BUFFERING":this._player.pause(),this._comm_stop(),e=-1;break;case"BUSY":this._player.stop(),this._comm_stop(),this._handle_state({newstate:"IDLE",oldstate:this._state}),e=0}return e},play:function(){var e=this._playlist[this._track];if(e&&e.is_capped)return this._reset(),void this._trackcapped(e.id);switch(this._state){case"IDLE":case"COMPLETED":case"BUSY":if(Log.debug("playlist loading track "+this._track),!e)break;for(;!e.is_playable()&&this._track<this.last_playable_track;)this._track++,e=this._playlist[this._track];if(!e.is_playable()&&1==this._playlist.length&&e.encoding_pending)this._handle_state({newstate:"BUSY",oldstate:this._state});else if(this._playlist[this._track].file&&(this._load(),this._player.play(),this._usecomm))try{this._comm_start(),this._stop_other_players()}catch(e){}break;case"PAUSED":case"BUFFERING":if(this._player.play(),this._usecomm)try{this._comm_start(),this._stop_other_players()}catch(e){}}var t=this._track;this._trackplayed(t)},pause:function(){switch(this._state){case"PLAYING":case"BUFFERING":this._player.pause(),this._comm_stop();break;case"BUSY":this._player.stop(),this._comm_stop(),this._handle_state({newstate:"IDLE",oldstate:this._state})}},stop:function(){this._player.stop(),this._handle_state({newstate:"IDLE",oldstate:this._state})},seek:function(e){if(this._unloaded=!1,(t=this._playlist[this._track])&&t.is_capped)return this._reset(),void this._trackcapped(t.id);if(e<=2&&null==this._playstat){var t;if((t=this._playlist[this._track])&&t.is_capped)return this._reset(),void this._trackcapped(t.id);t&&this._scrubbedback(t.id),this._scrubbed=!0}this._player.seek(e)},play_track:function(e,t){var n=this.get_track_info(e);if(n&&n.is_capped)return this._reset(),void this._trackcapped(n.id);this._loadedtrack!=e&&(this._state="IDLE",this._player.stop(),this._track=e,this._load()),this._unloaded=!1,null!=t?this.seek(t):this.play()},percent_loaded:function(){return this._loadpercent||0},position:function(){return this._position},duration:function(){if(null!=this._duration)return this._duration;var e=this.get_track_info();return e?e.duration:0},init_complete:function(e){this._trackstate&&this._loadstate()||(e||this._track>0)&&this._trackchanged(this._playlist[this._track])},register_listener:function(e,t){var n=this._ui_listeners[e];n?($assert($.isArray(n),"expected array of event listeners"),n.push(t)):((n=new Array).push(t),this._ui_listeners[e]=n)},player:function(){return this._player},unload:function(){this.stop(),this._unloaded=!0,this._playlist=[],this._track=0,this._loadedtrack=-1,this._loadpercent=0,this._position=0,this.first_playable_track=-1,this.last_playable_track=-1,this._playlistchanged(),this._handle_state({newstate:"IDLE",oldstate:this._state})},load:function(e){this.unload();for(var t=0;t<e.length;t++)this.add_track(e[t])},_reset:function(){this.stop(),this._track=this.first_playable_track,this._trackchanged(this._playlist[this._track]),this._loadedtrack=-1},_handle_state:function(e){if(this._state!=e.newstate){if("PLAYING"!=e.newstate&&"BUFFERING"!=e.newstate&&("PAUSED"!=e.newstate&&(this._position=0),this._clearstate()),this._state=e.newstate,"COMPLETED"!=e.newstate||"PLAYING"!=e.oldstate&&"BUFFERING"!=e.oldstate&&"PAUSED"!=e.oldstate)this._statechanged(e);else if(!this.seeking)if(this._track+1<=this.last_playable_track){this._state="IDLE",this._player.stop();var t=this.get_track_info();t&&0==t.continuous?this._statechanged(e):this.next_track()}else this._track=0,this._loadedtrack=-1,this._statechanged(e),this._trackchanged(this._playlist[this.first_playable_track]);1==this._stream_buffer_duration_stats&&("BUFFERING"!=e.newstate||"IDLE"!=e.oldstate&&"COMPLETED"!=e.oldstate?null!=this._buffering_start_time&&"PLAYING"==e.newstate&&(buffering_duration=Date.now()-this._buffering_start_time,this._buffering_start_time=null,this._playstat&&this._playstat.report_stream_buffer_duration(buffering_duration,this._options.hq)):this._buffering_start_time=Date.now()),"PAUSED"==e.newstate&&this._playstat&&this._playstat.report_stream_end(this._position)}},_handle_load:function(e){0==e.total?this._loadpercent=0:this._loadpercent=100*e.loaded/e.total,this._loaded(this._loadpercent)},_handle_time:function(e){this._trackstate&&this._savestate(e.position),this._position=e.position,this._duration=e.duration,this._timechanged(e);var t=this._playlist[this._track];this._playstat&&e.duration>0&&(this._playstat.play_progress(e.position,e.duration)||(this._playstat=null,t&&"undefined"!=t&&this._completedplay(t.id))),Player.PlayStat.is_complete(e.position,e.duration)&&this._scrubbed&&(this._scrubbed=!1,t&&"undefined"!=t&&this._completedplay(t.id,!0))},prev_track:function(){var e=this._track;do{e--}while(e>=0&&!this._playlist[e].file);-1==e&&(e=0),this._track=e,this._isplaying()&&(this._state="IDLE",this._player.stop()),this.play()},next_track:function(){var e=this._track;do{e++}while(e<this._playlist.length&&!this._playlist[e].file);e==this._playlist.length&&(e=0),this._track=e,this._isplaying()&&(this._state="IDLE",this._player.stop()),this.play()},get_state:function(){return this._state},get_track:function(){return this._track},get_track_info:function(e){return 0==this._playlist.length?null:void 0!==e?this._playlist[e].copy():this._playlist[this._track].copy()},cap_playback_for_track:function(e){for(var t=0;this._playlist&&t<this._playlist.length;t++){var n=this._playlist[t];if(n.id==e){n.mark_as_capped();break}}},length:function(){return this._playlist.length},_notify_listeners:function(e,t){var n=this._ui_listeners[e];if(n)for(var i=n.length-1;i>=0;i--)n[i](t)},_load:function(){if(this._loadedtrack!=this._track){this._loadedtrack=this._track,this._unloaded=!1,this._player.load(this._playlist[this._track].file,this._options.hq),this._loadpercent=0;var e=this._playlist[this._track];this._trackchanged(e),this._playstat=new Player.PlayStat(e,this._playing_from,this._referer),this._scrubbed=!1}else this.seek(0)},_isplaying:function(){return"PLAYING"==this._state||"PAUSED"==this._state||"BUFFERING"==this._state},_managestate:"iphone"!=Browser.platform,_loadstate:function(){if(!this._managestate)return!1;Log.debug("reading/clearing playlist state");var e=!1;try{var n=Cookie.get(t);if(Cookie.clear(t),n=JSON.parse(n))for(var i=0;i<this._playlist.length;i++)if(this._playlist[i].id==n.track_id){Log.debug("found player state, playing track "+i+" at pos "+n.pos),this.play_track(i,n.pos),e=!0;break}}catch(e){}return e},_clearstate:function(){if(this._managestate)try{Cookie.clear(t)}catch(e){}},_savestate:function(e){if(this._managestate&&("PLAYING"==this._state||"BUFFERING"==this._state)){var a=this._playlist[this._track].id;if(Math.abs(this._saved_pos-e)>i||a!=this._saved_track_id){this._saved_track_id=a,this._saved_pos=e;var s={track_id:a,pos:e};try{var o=JSON.stringify(s);Cookie.set(t,o,n)}catch(e){}}}},_comm_start:function(){this._comm||(this._comm=new Cookie.CommChannel("playlist"),this._comm.subscribe($.proxy(this._comm_recv,this))),this._comm.startListening()},_comm_stop:function(){this._comm&&this._comm.stopListening()},_comm_recv:function(e,t){switch(t[1]){case"stop":Log.debug("received cookie comm stop command.  stopping."),this.stop()}},_stop_other_players:function(){this._comm.send("stop")}};var t="playlist_state",n=30,i=1;return e.PLAY_TRACK="play_track",e}(),Player.PlaylistCoordinator=function(){function e(){this._playlists=[],this._playingcount=0,this._playing=EventSender.create(this,"playing"),this._stopped=EventSender.create(this,"stopped")}return e.prototype.add=function(e){var t=this;e.onstatechanged((function(n){t._handle_playlist_statechanged(e,n)})),this.onplaying((function(t){e!=t&&(e.getoption("savepos")?e.pause():e.stop())}))},e.prototype._handle_playlist_statechanged=function(e,t){var n="PLAYING"==t.newstate||"BUFFERING"==t.newstate,i="PLAYING"==t.oldstate||"BUFFERING"==t.oldstate;n&&!i?this._playingcount++:i&&!n&&(this._playingcount--,0==this._playingcount&&this._stopped()),n&&this._playing(e)},e}(),Player.PlayStat=function(){function e(e,n,i){params={kind:"track play",track_id:e.id,track_license_id:e.track_license_id,from:n,from_url:i||location.toString(),stream_duration:null},t.call(this,params,"started")}var t=Stats.PhasedStat;for(var n in Stats.PhasedStat.prototype)e.prototype[n]=Stats.PhasedStat.prototype[n];return e.prototype.play_progress=function(t,n){var i=e.is_partial(t,n),a=e.is_past_30(t,n),s=e.is_complete(t,n);return!this._partial_sent&&i&&(this._partial_sent=!0,this.change_phase("partial")),!this._30_seconds_sent&&a&&(this._30_seconds_sent=!0,this.change_phase("thirty")),!(!this._complete_sent&&s)||(this._complete_sent=!0,this._params.stream_duration=n,this.change_phase("complete"),!1)},e.is_partial=function(e,t){var n=!1;return e&&t&&(partial=10*t/100,n=e>partial),n},e.is_past_30=function(e){var t=!1;return e&&(t=e>30),t},e.is_complete=function(e,t){var n=!1;return e&&t&&(complete=90*t/100,n=e>complete),n},e.prototype.report_stream_end=function(e){e>30&&this._params.stream_duration<e&&(this._params.stream_duration=e,this.change_phase("stream_end"))},e.prototype.report_stream_buffer_duration=function(e,t){return Stats.record({kind:"stream buffer duration",duration_ms:e,is_hq:t}),!0},e}();var gplaylist,TitlePlayIndicator={playing:!1,browser_supported:!("ie"==Browser.make&&Browser.version[0]<9),play:function(){this.playing||(this.playing=!0,this.browser_supported&&(document.title=" "+document.title))},stop:function(){this.playing&&(this.playing=!1,this.browser_supported&&(document.title=document.title.substring(3)))}},ImageUtils=function(){"use strict";var e={JPEG:"jpg",PNG:"png"};function t(t,i,a,s){if(!i)return TemplGlobals.static_siteroot+"/img/blank.gif";a=n(a);var o,r=ImageUtils.imageRoot(s);return o=a.anim_ok?"":a.file_format&&"original"!=a.file_format?"."+e[a.file_format]:"",r+"/img/"+t+(i=("000000000"+i).slice(-10))+"_"+a.id+o}function n(e){if("object"==typeof e)return e;var t=TemplGlobals.image_formats;if(t)for(var n=0;n<t.length;++n)if(t[n].id==e||t[n].name==e)return t[n];return Log.error("bad image format",e),null}var i={imageURL:function(e,n,i){return t("",e,n,i)},artURL:function(e,n,i){return t("a",e,n,i)},imageFormat:n,imageDimensions:function(e,t,i){var a,s;return(i=n(i))&&"original"!=i.resize_algo?"thumb"==i.resize_algo?(a=i.width,s=i.height):"fit"==i.resize_algo?e<=i.width&&t<=i.height?(a=e,s=t):e/i.width>t/i.height?(a=i.width,s=Math.round(t*(i.width/e))):(a=Math.round(e*(i.height/t)),s=i.height):(Log.error("bad image resize algo",i),a=e,s=t):(a=e,s=t),{width:a,height:s}},imageRoot:function(e){return void 0===e&&(e="https:"===window.location.protocol),e?TemplGlobals.image_siteroot_https:TemplGlobals.image_siteroot}};return"uploadImage"in window&&(i.upload=uploadImage),i}(),Templ=function(){"use strict";var e=function(){var e=document.querySelector("#pagedata");return e&&JSON.parse(e.dataset.blob)},t="en",n=e(),i=window.Translate&&Translate.locale||n&&n.locale||t,a=i!==t?"."+i:"",s="(http://|https://)?",o="(([^@\\./\\s\\/'\"><&]+)(\\.[^@\\./\\s\\/'\"><&]+)*(\\.[a-z]{2,}))",r="(?::\\d+)?",l="(/[^?\\s]*?)?",c="(\\?[^#\\s]*?)?",d="(#[^\\s]*?)?",u="(\\))?",p="([.,;](\\s|$)|\\s+|$)",h=new RegExp("(\\s+|^)(\\()?"+s+o+r+l+c+d+u+p+"|(\\s+\\(?|^\\(?)([^\\s\\(\\)\"'/><,@]+@\\w([^\\s\\(\\)\"'/><&,@]*\\w)?\\.\\w[^\\s\\(\\)\"'/><&,@]*\\w)(\\)?\\s+|\\)?$)","i"),m=new RegExp("(\\s+|^)(\\()?"+s+o+r+l+c+d+u+p),f={".com":!0,".ru":!0,".org":!0,".net":!0,".de":!0,".jp":!0,".uk":!0,".br":!0,".it":!0,".pl":!0,".fr":!0,".in":!0,".au":!0,".ir":!0,".info":!0,".nl":!0,".cn":!0,".es":!0,".cz":!0,".kr":!0,".ca":!0,".eu":!0,".ua":!0,".co":!0,".gr":!0,".za":!0,".ro":!0,".biz":!0,".ch":!0,".se":!0,".tw":!0,".mx":!0,".vn":!0,".hu":!0,".be":!0,".tr":!0,".at":!0,".dk":!0,".tv":!0,".me":!0,".ar":!0,".sk":!0,".no":!0,".us":!0,".fi":!0,".id":!0,".cl":!0,".xyz":!0,".io":!0,".pt":!0,".by":!0,".il":!0,".ie":!0,".nz":!0,".kz":!0,".hk":!0,".lt":!0,".cc":!0,".my":!0,".sg":!0,".club":!0,".bg":!0,".edu":!0,".pk":!0,".su":!0,".top":!0,".th":!0,".hr":!0,".rs":!0,".pe":!0,".pro":!0,".si":!0,".lv":!0,".az":!0,".pw":!0,".ae":!0,".ph":!0,".online":!0,".ng":!0,".ee":!0,".ws":!0,".ve":!0,".pizza":!0,".cat":!0},g=new RegExp("(^|\\.)("+["bandcamp\\.com","bigcartel\\.com","blogspot\\.com","dailymotion\\.com","facebook\\.com","instagram\\.com","myspace\\.com","patreon\\.com","soundcloud\\.com","spotify\\.com","tumblr\\.com","twitter\\.com","vimeo\\.com","wordpress\\.com","youtu\\.be","youtube\\.com"].join("|")+")$"),_=new RegExp("^www\\.(\\w+\\.("+["bandcamp\\.com","blogspot\\.com","bigcartel\\.com","tumblr\\.com","wordpress\\.com"].join("|")+"))$"),b=/(?:^|\.)bandcamp.com$/i,v=/\brel=["']([^"']*)["']/i,y=/\breferrerpolicy=["']/i,w=/(^|\s)\*(\S|\S.*?\S)\*(?=\s|$)/g;function k(e,t){e=""+e;var n="";for(w.lastIndex=0;;){var i=w.lastIndex,a=w.exec(e);if(!a){n+=e.substring(i,e.length);break}n+=e.substring(i,a.index),n+=a[1],t&&(n+="<"+t+">"),n+=a[2],t&&(n+="</"+t+">")}return n}return{cfgFlags:n&&n.cfg||{},locale:i,locale_suffix:a,templates:{},globals:null,register:function(e){Object.assign(Templ.templates,e)},getGlobals:function(){if(!Templ.globals){var t=e(),n=t&&t.templglobals,i="undefined"!=typeof TemplGlobals?TemplGlobals:null;Templ.globals=Object.assign({},i,n)}return Templ.globals},RENDER_SPEED_TEST:!1,render:function(e,t){var n=Object.assign({},Templ.getGlobals(),t),i=new Templ.Context(n),a=[];if(this.RENDER_SPEED_TEST){Log.debug(">>> start rendering "+e);for(var s=new Date,o=0;o<100;++o)a=[],Templ.renderInternal(e,i,a);var r=new Date;Log.debug(">>> end rendering "+e+" - "+(r-s)/100+"ms")}else Templ.current_context=i,Templ.renderInternal(e,i,a),Templ.current_context=null;return a.join("")},runWithContext:function(e){var t=new Templ.Context(Templ.getGlobals());Templ.current_context=t,e(),Templ.current_context=null},renderElem:function(e,t,n){(e=elt(e)).innerHTML=Templ.render(t,n)},renderTableRow:function(e,t,n){e=elt(e);var i=document.createElement("DIV");i.innerHTML="<table><tbody><tr>"+Templ.render(t,n)+"</tr></tbody></table>";for(var a=i.firstChild.firstChild.firstChild;null!=e.firstChild;)e.removeChild(e.firstChild);for(;null!=a.firstChild;)e.appendChild(a.removeChild(a.firstChild))},renderInternal:function(e,t,n){var i=Templ.templates[e+Templ.locale_suffix]?Templ.templates[e+Templ.locale_suffix]:Templ.templates[e];if(i)Templ.renderTokens(i,t,n);else{var a="[template not found: "+e+"]";n.push(a),Log.server(a,"warn")}},renderTokens:function(e,t,n){if(e)for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a)n.push(a);else try{Templ.renderOneToken(a,t,n)}catch(e){throw Log.error("Error rendering token",a,"context",t),e}}},renderOneToken:function(e,t,n){var i,a;switch(e.type){case"translate":Templ.renderTokens(e.nodelist,t,n);break;case"translatePlural":for(i=0;i<e.blocks.length;i++)if(a=e.blocks[i],Templ.evalNCondition(a,t)){Templ.renderTokens(a.attachment,t,n);break}break;case"translateVariable":Templ.renderTokens(e.nodelist,t,n);break;case"variable":if(!e.name)return;var s=Expression.eval(e.name,(function(e){return t.resolve(e)})),o=Templ.filters;Iter.each(e.filters,(function(e){var n=Iter.collect(e[1],(function(e){return t.resolve(e)})),i=e[0]?o[e[0]]:null;i?(n.unshift(s),s=i.apply(null,n)):(s="[template error: filter not found: "+e[0]+"]",Log.error(s))})),null!=s&&(Array.isArray(s)&&(s=s.join("")),n.push(s));break;case"assign":t.hash[e.to]=t.resolve(e.from);break;case"case":case"if":var r=e.blocks;for(i=0;i<r.length;i++)if(a=r[i],Templ.evalCondition(a,t)){Templ.renderTokens(a.attachment,t,n);break}break;case"for":var l=t.resolve(e.collection_name);l instanceof Templ.Range&&(l=l.expand());var c=e.nodelist,d=null!=e.attribs.offset?t.resolve(e.attribs.offset):0,u=l?l.length-d:0;null!=e.attribs.limit&&(u=Math.min(u,t.resolve(e.attribs.limit)));var p=l?l.slice(d,d+u):[];for(e.reversed&&p.reverse(),t.stashLoopvars(),i=0;i<u;i++)t.hash[e.variable_name]=p[i],t.hash.forloop={length:u,index:i+1,index0:i,rindex:u-i,rindex0:u-i-1,first:0===i,last:i===u-1},Templ.renderTokens(c,t,n);t.restoreLoopvars();break;case"include":var h=t.resolve(e.template_name);Templ.renderInternal(h,t,n);break;case"capture":var m=[];Templ.renderTokens(e.nodelist,t,m);var f="";for(i=0;i<m.length;i++)f+=m[i];t.hash[e.to]=f;break;case"ef":for(r=e.blocks,i=0;i<r.length;i++)if(a=r[i],Templ.evalNCondition(a,t)){Templ.renderTokens(a.attachment,t,n);break}break;case"let":t.hash[e.variable]=Expression.eval(e.expression,(function(e){return t.resolve(e)}))}},evalNCondition:function(e,t){return"else_ncondition"==e.type||Templ.isTrue(Expression.eval(e.expression,(function(e){return t.resolve(e)})))},evalCondition:function(e,t){if("else_condition"==e.type)return!0;var n,i=t.resolve(e.left),a=e.operator;if(a){var s=Templ.operators[a];if(!s)return Log.error("template: unrecognized operator: "+a),!1;n=s(i,t.resolve(e.right))}else n=Templ.isTrue(i);return"or"==e.child_relation?n=Templ.isTrue(n)||Templ.isTrue(Templ.evalCondition(e.child_condition,t)):"and"==e.child_relation&&(n=Templ.isTrue(n)&&Templ.isTrue(Templ.evalCondition(e.child_condition,t))),n},isTrue:function(e){return!1!==e&&null!=e},EMPTY:{equals:function(e){return e==this||(!e||""===e.toString())}},Range:function(e,t){this.start=e,this.end=t,this.expand=function(){for(var e=[],t=this.start;t<=this.end;t++)e.push(t);return e}},operators:{"==":x,"!=":function(e,t){return!x(e,t)},"<>":function(e,t){return!x(e,t)},"<":function(e,t){return Expression.evaluate_comparison("<",e,t)},">":function(e,t){return Expression.evaluate_comparison(">",e,t)},"<=":function(e,t){return Expression.evaluate_comparison("<=",e,t)},">=":function(e,t){return Expression.evaluate_comparison(">=",e,t)},contains:function(e,t){if("string"==typeof e)return e.indexOf(t)>=0;if(Array.isArray(e)){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}return e instanceof Templ.Range&&(t>=e.start&&t<=e.end)}},filters:{size:function(e){return e?e.length:0},downcase:function(e){return null!=e?e.toString().toLowerCase():""},upcase:function(e){return null!=e?e.toString().toUpperCase():""},escape:function(e){return null!=e?Text.escapeHtml(e.toString()):""},escape_html_attr:function(e){return Templ.filters.escape(e)},noblanks:function(e,t){return t?e.replace(/(\n *)+/g,"").replace(/\n--/g,"\n"):e.replace(/(\n *)+/g,"\n").replace(/\n--/g,"\n")},strip:function(e){return null!=e?e.toString().trim():""},strip_html:function(e){return null!=e?e.toString().replace(/<.*?>/g,""):""},strip_newlines:function(e){return null!=e?e.toString().replace(/\n/g,""):""},newline_to_br:function(e){return null!=e?e.toString().replace(/\n/g,"<br />\n"):""},newline_to_gap:function(e,t){var n=t?/(\n[\r\t ]*)+\n/g:/\n[\r\t ]*\n/g;return null!=e?e.toString().replace(n,'<br /><span class="lightweightBreak" /></span><br />').replace(/\n/g,"<br />\n"):""},replace:function(e,t,n){return Templ.filters.replace_regex(e,Text.regexpEscape(t),n)},replace_regex:function(e,t,n){return null==e?"":(null==n&&(n=""),(e=e.toString()).replace(new RegExp(t,"gm"),n))},replace_first:function(e,t,n){return null==n&&(n=""),null!=e?e.toString().replace(t,n):""},remove:function(e,t){return Templ.filters.replace(e,t)},remove_first:function(e,t){return Templ.filters.replace_first(e,t)},encode_uri_c:function(e){return null!=e?encodeURIComponent(e).replace(/'/g,"%27"):""},join:function(e,t){return null==t&&(t=" "),Array.isArray(e)?e.join(t):e},sort:function(e){return Array.isArray(e)?e.slice(0).sort((function(e,t){return e>t?1:e<t?-1:0})):e},first:function(e){return Array.isArray(e)?e[0]:null},last:function(e){return Array.isArray(e)&&e.length?e[e.length-1]:null},edit_if_empty:function(e,t,n,i){return e&&e.length>0?e:Templ.filters.edit_field(i,t,n)},edit_field:function(e,t,n){return'<a href="/edit?id='+t+"&focus="+n+'">'+e+"</a>"},date:function(e,t){return"string"==typeof e&&(e=new Date(Date.parse(e))),Time.strftime(e,t)},time:function(e,t,n){return Time.to_ui(e,t,i,n)},ui_datetime:function(e){return e?Time.toUi(e,!1,!0):""},ui_date:function(e,t){return e?Time.toUiDate(e,t,!0):""},to_date:function(e){return new Date(1e3*e)},relative_day:function(e,t){return e?Time.relative_day(e,t,i):""},relative_time:function(e,t){return e?Time.relative_time(e,t,i):""},relative_duration:function(e,t){return e?Time.relative_duration(e,t,i):""},json:function(e){return JSON.stringify(e)},plural:function(e,t,n){return null==n&&(n=t+"s"),"1"==e?t:n},capitalize:function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},capitalize_first_character:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},titlecase:function(e){return null!=e?e.toString().replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})):""},currency:function(e,t,n,i,a){return null==e?"":TextFormat.currency(e,window.CurrencyData?CurrencyData.info[t||"USD"]:null,n,i,a)},money:function(e,t,n){return TextFormat.money(e,t,n)},million_usd:function(e){return TextFormat.million_usd(e,i)},negate:function(e){return e&&e.is_money?{amount:-e.amount,currency:e.currency,is_money:!0}:"number"==typeof e?-e:""},abs:function(e){return e&&e.is_money?{amount:Math.abs(e.amount),currency:e.currency,is_money:!0}:"number"==typeof e?Math.abs(e):""},truncate:function(e,t,n){return n=n||"...",Text.truncate(e,t,n)},add_query_parm:function(e,t){return e?null===t||0===t.length?e:e+(e.indexOf("?")>-1?"&":"?")+t:""},mb:function(e){return TextFormat.toMb(e)},mb_si:function(e){return TextFormat.toMb(e,!0)},url:function(e,t,n){var i=t?"https_url":"url";return n&&("_"!=(n+="").charAt(n.length-1)&&(n+="_"),i=n+i),e[i]},commafy:function(e){return TextFormat.commafyNumber(""+e)},smallest_number_text:function(e,t){var n=parseInt(e),i=n.toString();if(isNaN(n)||i.length<=t)return TextFormat.commafyNumber(i);var a=Math.floor(n/1e3*10)/10;if(a>0&&(i=a+"K"),i.length<=t)return i;if((a=Math.floor(a))>0&&(i=a+"K"),i.length<=t||n<1e6)return i;var s=Math.floor(n/1e6*10)/10;return(i=s+"M").length<=t||(i=(s=Math.floor(s))+"M"),i},fan_link:function(e,t){return"<a href='"+e.trackpipe_url+"' style='"+t+"'>"+e.name+"</a>"},add_product_utm:function(e,t){var n="";if(!e)return n;for(var i,a=0,s=e;a<300&&(i=m.exec(s));)if(a++,n+=s.substring(0,i.index),s=s.substring(i.index+i[0].length),i[3]||f[i[7].toLowerCase()]){var o=[i[3]||"http://",i[4],i[8],i[9],i[10],i[11]].join(""),r="";"("===i[2]&&")"===o[o.length-1]&&(o=o.substring(0,o.length-1),r=")"),n+=(i[1]||"")+(i[2]||""),n+=o,n+=r,n+=void 0===i[12]?" ":i[12]}else n+=i[0];return n+=s},highlight_mention:function(e,t){return e.split("@"+t).join("<span class='mention-highlight'>@"+t+"</span>")},html_autolink:function(e,t,n){n=n||!0;var i="";if(!e)return i;t?" "!==t[0]&&(t=" "+t):t="",e=e.replace(/ +/g," ");for(var a,s=0,o=n?h:m,r=e;s<300&&(a=o.exec(r));){if(s++,i+=Text.escapeHtml(r.substring(0,a.index)),r=r.substring(a.index+a[0].length),a[15])i+=" ",i+=Text.escapeHtml(a[14].substring(a[14].length-1)),i+='<a href="mailto:',i+=Text.escapeHtml(a[15]),i+='">',i+=Text.escapeHtml(a[15]),i+="</a>",i+=Text.escapeHtml(void 0===a[17]?" ":a[17]);else{if(!a[3]&&!f[a[7].toLowerCase()]){i+=a[0];continue}var l="https://"==a[3]||g.test(a[4])?"https://":"http://",c=a[4].replace(_,"$1"),d=a[9]&&"?"+a[9].substr(1).split("&").filter((function(e){return"utm_"!==e.substr(0,4)})).join("&"),u=[c,"/"===a[8]?"":a[8],d,a[10],a[11]].join(""),p=[l,c,a[8],a[9],a[10],a[11]].join(""),b="";"("===a[2]&&")"===p[p.length-1]&&(p=p.substring(0,p.length-1),u=u.substring(0,u.length-1),b=")"),i+=" ",i+=Text.escapeHtml((a[1]||"")+(a[2]||"")),i+='<a href="',i+=Text.escapeHtml(p),i+='"',i+=T(u,t),i+=">",i+=Text.escapeHtml(u),i+="</a>",i+=b,i+=Text.escapeHtml(void 0===a[12]?" ":a[12])}i+=" "}return i+=Text.escapeHtml(r)},plus:function(e,t){return e+t},minus:function(e,t){return e-t},times:function(e,t){return e*t},divided_by:function(e,t){return e==Math.floor(e)&&t==Math.floor(t)?Math.floor(e/t):e/t},image:function(e,t){var n="number"==typeof e||!e,i=n?e:e.image_id,a=Templ.filters.image_url(i,t);if(n)return'src="'+a+'"';var s=ImageUtils.imageDimensions(e.width,e.height,t);return'src="'+a+'" width="'+s.width+'" height="'+s.height+'"'},image_url:function(e,t){return ImageUtils.imageURL(e,t,Templ.current_context.resolve("is_https"))},art:function(e,t){return'src="'+Templ.filters.art_url(e,t)+'"'},art_url:function(e,t){return ImageUtils.artURL(e,t,Templ.current_context.resolve("is_https"))},popup_image:function(e,t){var n="number"==typeof e,i=n?e:e.image_id,a=Templ.filters.image_url(i,t);if(n)return'href="'+a+'"';var s=ImageUtils.imageDimensions(e.width,e.height,t);return'href="'+a+'" data-image-size="'+s.width+","+s.height+'"'},image_width:function(e,t){return ImageUtils.imageDimensions(e.width,e.height,t).width},image_height:function(e,t){return ImageUtils.imageDimensions(e.width,e.height,t).height},possessify:function(e){return null===e||"string"!=typeof e||i&&i!=t?e:/s$/.test(e)?e+"'":e+"'s"},possessify_smart:function(e){return null===e||"string"!=typeof e||i&&i!=t?e:/s$/.test(e)?e+"":e+"s"},enumerate_items:function(e,t){void 0===t&&(t="and");var n=function(e){return 0===e.length||null===e?"":1===e.length?e[0]:2===e.length?e[0]+" "+t+" "+e[1]:e[0]+", "+n(e.slice(1,e.length))};return n(e)},fan_page_url:function(e){return Templ.current_context.resolve("siteroot_current")+"/"+e},band_url:function(e){if(!e)return"";var t=e.custom_domain,n=e.custom_domain_verified,i=e.subdomain,a=Templ.current_context.resolve("custom_domains_active"),s=Templ.current_context.resolve("base_port_str")||"",o=Templ.current_context.resolve("sitedomain");return a&&t&&n?"https://"+t+s:i?location.protocol+"//"+i+"."+o:""},lpad:function(e,t){void 0===t&&(t=10);var n=(e=String(e)).length,i="";return t-n>0&&(i=new Array(t-n+1).join(" ")),i+e},asterisks_to_em:function(e){return k(e,"em")},strip_asterisks:function(e){return k(e,null)},tralbum_url:function(e){if(!e)return"";var t="";switch(e.item_type){case"a":t="/album/";break;case"t":t="/track/";break;case"p":t="/merch/";break;case"c":t="/campaign/"}return Templ.filters.band_url(e)+t+e.slug},subscribe_url:function(e){if(!e)return"";var t=e.subscribe_url_fragment||"subscribe";return Templ.filters.band_url(e)+"/"+t},featured_track_url:function(e,t){return e?Templ.filters.tralbum_url(e)+"?t="+t:""},hex_to_rgb:function(e){if(!e)return null;if("#"===e[0]&&(e=e.substring(1)),!e.match(/[0-9A-Fa-f]{6}/))return null;var t=parseInt(e,16);return(t>>16&255)+", "+(t>>8&255)+", "+(255&t)},fixnum:function(e,t){return e.toFixed(t)},wrap_emojis:function(e){var t=/(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5-\uDED7\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])\uFE0F/g;return e.match(t)?"<span>"+e.replace(t,(function(e){return"<span class='emoji'>"+e+"</span>"}))+"</span>":e}},Context:function(e){this.hash=e||{},this.loopvars=null}};function x(e,t){return e==Templ.EMPTY?e.equals(t):t==Templ.EMPTY?t.equals(e):Expression.evaluate_comparison("==",e,t)}function T(e,t){var n,i=e.split("/")[0];if(b.test(i))return t;if(n=v.exec(t)){var a=n[1];-1===a.indexOf("nofollow")&&(a+=" nofollow ugc"),t=t.substring(0,n.index)+'rel="'+a+'"'+t.substring(n.index+n[0].length)}else t+=' rel="nofollow ugc"';return y.test(t)||(t+=' referrerpolicy="strict-origin-when-cross-origin"'),t}}();Templ.filters.h=Templ.filters.escape,Templ.filters.a=Templ.filters.attr=Templ.filters.escape_html_attr,Templ.filters.u=Templ.filters.encode_uri_c,Templ.Context.prototype=function(){"use strict";var e=/\[[^\]]+\]|[\w-]+\??/g,t=/^\[(.+)\]$/;return{resolve:function(e){switch(e){case null:case"nil":case"null":case"":return null;case"true":return!0;case"false":return!1;case"empty":return Templ.EMPTY}var t;return(t=/^'(.*)'$/.exec(e))||(t=/^"(.*)"$/.exec(e))?t[1]:/^\d+$/.test(e)?parseInt(e):(t=/^\((\S+)\.\.(\S+)\)$/.exec(e))?new Templ.Range(this.resolve(t[1]),this.resolve(t[2])):/^(\d[\d\.]+)$/.test(e)?parseFloat(e):this.variable(e)},variable:function(n){var i=e.lastIndex;e.lastIndex=0;var a,s,o,r=this.hash;try{for(;a=e.exec(n);)o=a[0],(s=t.exec(o))&&(o=this.resolve(s[1])),r="size"!==o&&"first"!==o&&"last"!==o||r&&"object"==typeof r&&r.hasOwnProperty(o)?r&&r[o]:Templ.filters[o](r);return r}finally{e.lastIndex=i}},stashLoopvars:function(){var e=this.hash.forloop;e&&(this.loopvars=this.loopvars||[],this.loopvars.push(e))},restoreLoopvars:function(){this.loopvars&&(this.hash.forloop=this.loopvars.pop())}}}();var gplayerviews=[];Player.init=function(e,t){Player.tralbum_data=e,Player.private_streaming="private_streaming"==Player.tralbum_data.playing_from.slice(0,17);Sound.whenloaded((function(e){var n,i=null,a=null;if(e.success&&(i=new Sound.SoundPlayer,a=new Player.Playlist(i,Player.tralbum_data.playing_from,null,{hq:Player.tralbum_data.is_purchased||Player.tralbum_data.is_private_stream||Player.tralbum_data.is_band_member})),gplaylist=a,$(".inline_player").each((function(){var e={};this.attributes.rel&&(e.onetrack=!0,n||(n=this.attributes.rel.value)),gplayerviews.push(new Player.InlinePlayerView(a,this,e))})),a&&n){var s=Url.parseQuery(n),o=Player.tralbum_data.trackinfo[s.tracknum-1],r=a.add_track(o);o.id===Player.tralbum_data.featured_track_id&&a.set_initial_track(r)}var l=!1;$(".track_row_view").each((function(){var e=Url.parseQuery(this.attributes.rel.value),t=Player.tralbum_data.trackinfo[e.tracknum-1],n=new Player.TrackRowView(a,this,t,Player.private_streaming);a&&!l&&(Player.tralbum_data.initial_track_num&&t.track_num==Player.tralbum_data.initial_track_num&&t.file?(a.set_initial_track(n._tracknum),l=!0):t.id===Player.tralbum_data.featured_track_id&&a.set_initial_track(n._tracknum))})),t&&t(a),a&&a.init_complete()}))},Player.update=function(e){if(gplaylist){Player.tralbum_data=e;for(var t=0;t<e.trackinfo.length;t++)gplaylist.update_trackinfo(t,e.trackinfo[t])}},Player.CollectionView=function(){($("#pagedata").data("blob")||{}).cfg;function e(e){this._playlist=e,this._play_status_elements=[],this._play_hilite_elements=[],this._play_elapsed_time_elements={},this._waypoints=[],this._play_elem_stash={},this._track_list_ids={},this._playing_state="STOPPED",this._setup(),e&&(e.onstatechanged(this._handle_statechange,this),e.onplaylistchanged(this._handle_playlistchange,this),e.onloaded(this._handle_loaded,this),e.ontime(this._handle_time,this))}return e.prototype={is_playing:function(){return"PLAYING"==this._playing_state||"BUFFERING"==this._playing_state},currently_playing_track:function(){return this.is_playing()?this._current_track_list_entry():null},play:function(){return this._playlist.play(),1},playpause:function(e){return null==e||""==e||e==this._current_track_list_entry().id?this._playlist.playpause():this.play_track_id(e)},play_track_num:function(e){return e=e>0?e-1:e,this._playlist.play_track(e),1},play_track_id:function(e){var t=this.get_track_info(e);return t&&void 0!==t&&t.track_num&&this.play_track_num(t.track_num),1},get_track_info:function(e){for(var t in track_list)if(track_list.hasOwnProperty(t)&&track_list[t].track_id==e)return track_list[t];return null},_setup:function(){for(var e=$(".track_play_view"),t=0,n=e.length;t<n;t++){var i=e[t];if(this._playlist&&i.attributes["data-trackid"]){var a=i.attributes["data-trackid"].value;if(!a||""==a)continue;var s=this.get_track_info(a);if(!s||"undefined"==s)continue;var o=document.createElement("table");o.setAttribute("style","border: none;");var r=document.createElement("tr");r.setAttribute("itemprop","tracks"),r.setAttribute("itemscope",null),r.setAttribute("itemtype","http://www.schema.org/MusicRecording"),(d=document.createElement("td")).className="track_play_control";var l=document.createElement("a");function c(e){return function(){playerview.playpause(e)}}l.onclick=c(a);var d,u=document.createElement("div");u.className="play_status",u.setAttribute("data-trackid",a),l.appendChild(u),d.appendChild(l),r.appendChild(d),(d=document.createElement("td")).className="track_play_name",d.innerHTML=s.title,r.appendChild(d),d.onclick=c(a),o.appendChild(r),i.parentNode.replaceChild(o,i),this._play_status_elements.push(u)}}var p=$(".track_play_auxiliary");this._setup_aux_controls(p);var h=$(".track_play_hilite");this._setup_hilites(h);var m=$(".track_play_time");this._setup_time_elems(m);var f=$(".track_play_waypoint");this._setup_waypoints(f);t=0;for(var g=track_list.length;t<g;t++)this._track_list_ids[track_list[t].track_id]=!0},_setup_aux_controls:function(e){if(null!=e&&void 0!==e)for(var t=0,n=e.length;t<n;t++){var i=e[t],a=i.attributes["data-trackid"].value;function s(e){return function(t){U.stopEvent(t);var n=e.attributes["data-trackid"].value,i=playerview.playpause(n),a=e.attributes["data-clickstat"];return!a||0!=i&&1!=i||Stats.record({kind:"click",click:a.value}),!1}}a&&""!=a&&("A"==i.tagName?Dom.hackLinkClicksThanksSafari(i,s(i)):i.onclick=s(i))}},_setup_hilites:function(e){if(null!=e&&void 0!==e)for(var t=0,n=e.length;t<n;t++){var i=e[t];if(i.attributes["data-trackid"])i.attributes["data-trackid"].value&&this._play_hilite_elements.push(i)}},_setup_time_elems:function(e){if(null!=e&&void 0!==e)for(var t=0,n=e.length;t<n;t++){var i=e[t];if(i.attributes["data-trackid"]){var a=i.attributes["data-trackid"].value;if(a){var s=this.get_track_info(a);if(s){var o=$("span.time_elapsed",i)[0];o&&(this._play_elapsed_time_elements[a]||(this._play_elapsed_time_elements[a]=[]),this._play_elapsed_time_elements[a].push(o)),total_str=Time.timeStr(s.duration>1?s.duration:1);var r=$("span.time_total",i)[0];r&&(r.innerHTML=total_str)}}}}},_setup_waypoints:function(e){null!=e&&void 0!==e&&(this._waypoints=e)},_sleepyhead:function(e,t,n,i){this._add_trackinfo(i),this._setup_aux_controls(e),this._setup_hilites(t),this._setup_time_elems(n)},_add_trackinfo:function(e){if(null!=e){var t=e.track_id;null!=this._track_list_ids[t]&&this._track_list_ids[t]||(e.track_num=track_list.length+1,e.id=e.track_id,e.file=e.file||e.streaming_url,e.continuous=!1,this._playlist.add_track(e),track_list.push(e))}},_update_track_play_elements:function(e,t,n,i){if(e&&"undefined"!=e){var a=e.track_id;if(this._add_trackinfo(e),t&&void 0!==t)for(var s=0,o=t.length;s<o;s++){t[s].attributes["data-trackid"].value=a}if(n&&void 0!==n)for(s=0,o=n.length;s<o;s++)n[s].attributes["data-trackid"].value=a;if(i&&void 0!==i)for(s=0,o=i.length;s<o;s++){var r=i[s],l=$("span.time_elapsed",r)[0];l&&(this._play_elapsed_time_elements[a]||(this._play_elapsed_time_elements[a]=[]),this._play_elapsed_time_elements[a].push(l)),total_str=Time.timeStr(this.get_track_info(a).duration);var c=$("span.time_total",r)[0];c&&(c.innerHTML=total_str)}}},_handle_loaded:function(e){},_handle_playlistchange:function(){},_handle_statechange:function(e){var t=!0;this._playing_state=e.newstate;for(var n=this._current_track_list_entry(),i=this._play_status_elements,a=0,s=i.length;a<s;a++){if((r=i[a]).attributes["data-trackid"])(o=r.attributes["data-trackid"].value)&&(o!=n.id||"PLAYING"!=e.newstate&&"BUFFERING"!=e.newstate?$(r).removeClass("playing"):$(r).addClass("playing"))}for(a=0,s=(i=this._play_hilite_elements).length;a<s;a++){var o;if((r=i[a]).attributes["data-trackid"])(o=r.attributes["data-trackid"].value)&&(o!=n.id||"PLAYING"!=e.newstate&&"BUFFERING"!=e.newstate?(o==n.id&&"PAUSED"==e.newstate&&$(r).addClass("paused"),$(r).removeClass("playing")):$(r).addClass("playing"))}for(a=0,s=(i=this._waypoints).length;a<s;a++){var r=i[a];"PLAYING"==e.newstate||"BUFFERING"==e.newstate?($(r).removeClass("done").addClass("playing"),$("#track_play_waypoint, #track-play-waypoint-wrapper").removeClass("activated")):$(r).removeClass("playing").addClass("done");var l=$("[data-trackid='"+n.id+"']");if(0!==l.length){var c=$(".collection-item-art, .tralbum-art-large, .tralbum-art-medium",l)[0],d=$(".collection-item-title",l)[0],u=$(".collection-item-artist",l)[0],p=$(l).parent()[0],h=$(p).data("iswish");$("img",r)[0].src=null!=c?c.src:"",$(".waypoint-item-title",r)[0].innerHTML=d.innerHTML,$(".waypoint-artist-title",r)[0].innerHTML=u.innerHTML,$(r).unbind("click").click((function(){window.collectionTabs&&(h&&"wishlist"!==window.collectionTabs.currentTab.name?window.collectionTabs.switch("wishlist","wishlist-grid"):h||"collection"===window.collectionTabs.currentTab.name||window.collectionTabs.switch("collection","collection-grid"),$("#track_play_waypoint, #track-play-waypoint-wrapper").removeClass("activated")),Dom.scrollToElement(l.filter(":visible"),-30)})),$.waypoints("destroy");var m=!!window.collectionTabs;$(c).waypoint((function(e){m&&(h&&"wishlist"===window.collectionTabs.currentTab.name||!h&&"collection"===window.collectionTabs.currentTab.name)||!m?$("#track_play_waypoint, #track-play-waypoint-wrapper").toggleClass("activated","down"===e):$("#track_play_waypoint, #track-play-waypoint-wrapper").addClass("activated")})).waypoint((function(e){var n=m&&(h&&"wishlist"===window.collectionTabs.currentTab.name||!h&&"collection"===window.collectionTabs.currentTab.name);t||(n||!m?$("#track_play_waypoint, #track-play-waypoint-wrapper").toggleClass("activated","up"===e):$("#track_play_waypoint, #track-play-waypoint-wrapper").addClass("activated"))}),{offset:"80%"}),window.collectionTabs&&(window.collectionTabs.nowPlayingCallback=function(){var e=h?"wishlist":"collection";Dom.inViewport(c)&&e===collectionTabs.currentTab.name?$("#track_play_waypoint, #track-play-waypoint-wrapper").removeClass("activated"):$("#track_play_waypoint, #track-play-waypoint-wrapper").addClass("activated")})}}var f=$("title").text();f="PLAYING"==e.newstate&&"PLAYING"!=e.oldstate?" "+f:f.replace(" ",""),$("title").text(f),t=!1},_handle_time:function(e){var t=this._current_track_list_entry().id;null!=this._play_elem_stash.time_elems_tid&&this._play_elem_stash.time_elems_tid==t||(this._play_elem_stash.time_elems_tid=t,this._play_elem_stash.time_elems_elapsed=this._play_elapsed_time_elements[t]);var n=this._play_elem_stash.time_elems_elapsed;if(n)for(var i=Time.timeStr(e.position),a=0,s=n.length;a<s;a++)n[a].innerHTML=i},_current_track_list_entry:function(){return this._playlist.get_track_info()}},e}(),Player.TrackRowView=function(){function e(e,n,i,a){this._elem=n,this._playlist=e,this._trackinfo=i||{},this._private_streaming=a,e?(this._tracknum=e.add_track(i),this._trackinfo=e.get_track_info(this._tracknum)):this._tracknum=t++,this._setup_elements(),e&&(e.onstatechanged(this._state_changed,this),e.onplaylistchanged(this._handle_playlistchange,this))}e.prototype={_state_changed:function(e){var t=this._playlist.get_track();if(t==this._tracknum&&("PLAYING"==e.newstate||"BUFFERING"==e.newstate||"PAUSED"==e.newstate)?$(this._elem).addClass("current_track"):$(this._elem).removeClass("current_track"),t==this._tracknum)switch(e.newstate){case"PLAYING":case"BUFFERING":this._enable_button("pause");break;case"PAUSED":this._enable_button("play")}else this._trackinfo.file&&this._enable_button("play")},findelem:function(e){return $("."+e,this._elem)[0]},play:function(){this._playlist.play_track(this._tracknum)},toString:function(){return"[TrackRowView: id="+this._elem.id+", title="+this._trackinfo.title+"]"},activeNodes:function(){return window.MediaView&&"phone"==MediaView.mode?$(this._elem):$(this._elems.playbutton)},_enable_button:function(e){var t=$(this._elems.playbutton);if(t.length)if(t.removeClass("disabled"),this._playlist){var n=this;"play"==e?(t.removeClass("playing"),this.activeNodes().off("click.player").on("click.player",(function(){return n.play(),!1}))):"pause"==e&&(t.addClass("playing"),this.activeNodes().off("click.player").on("click.player",(function(){return n._playlist.playpause(),!1})))}else t.removeClass("playing"),t.parent().attr("href",this._trackinfo.file)},_setup_elements:function(){this._elems={},Templ.renderTableRow(this._elem,"_track_row",{tracknum:this._tracknum+1,track:this._trackinfo,private_streaming:this._private_streaming}),this._elems.playbutton=this.findelem("play_status"),this._elems.title=this.findelem("title"),$(".track-encoding-error-link",this._elem).click((function(){return Tracks.encoding_error($(this).data("error")),!1})),this._trackinfo.file?this._enable_button("play"):this.activeNodes().off("click.player").on("click.player",!1),window.Fixup&&Fixup.trackRows&&Fixup.trackRows(this._elem)},_handle_playlistchange:function(){correctinfo=this._playlist.get_track_info(this._trackinfo.tracknum),Player.TrackInfo.is_same(this._trackinfo,correctinfo)||(this._trackinfo=correctinfo,this._setup_elements())}};var t=0;return e}(),Player.InlinePlayerView=function(){function e(e,t,n){this._playlist=e,this._options=n||{},this._elem=t,this._elems={},this._tracklength=this._trackpos=this._loadpercent=0;var i=this._elems;if(i.next=this.find_elem("nextbutton"),i.prev=this.find_elem("prevbutton"),i.play=this.find_elem("playbutton"),i.title=this.find_elem("title"),i.title_link=this.find_elem("title_link"),i.prog=this.find_elem("progbar"),i.progthumb=this.find_elem("thumb"),i.progfill=this.find_elem("progbar_fill"),i.message=this.find_elem("message"),this._playlist){this._playlist.onstatechanged(this._handle_playstate,this),this._playlist.ontime(this._handle_time,this),this._playlist.onloaded(this._handle_loaded,this),this._playlist.ontrackchanged(this._handle_trackchange,this),this._playlist.onplaylistchanged(this._handle_playlistchange,this);var a=this;this._playlist._player.onvolume((function(e,t){a._handle_volumechange(t)}),this);a=this;if($(i.play).click((function(e){a._handle_playclick(e)})),$(i.next).click((function(e){a._handle_nextclick(e)})),$(i.prev).click((function(e){a._handle_prevclick(e)})),$(i.progthumb).draggable({containment:"parent",axis:"x",start:function(e){a._dragging=!0,a._playlist.seeking=!0,a._dragoffset=e.offsetX},drag:function(e){var t=Dom.getXY(a._elems.prog)[0],n=a._elems.prog.offsetWidth-a._elems.progthumb.offsetWidth,i=e.clientX-t-a._dragoffset;i=i<0?0:i>n?n:i,i*=a._tracklength/n,a._trackpos=i,a._updateprog()},stop:function(e){a._playlist.seek(a._trackpos),a._dragging=!1,a._playlist.seeking=!1}}),"iphone"==Browser.platform||window.MediaView&&"phone"==MediaView.mode){(a=this)._elem&&a._elem.addEventListener("touchstart",(function(e){if(!$(e.target).closest(".playbutton, .nextbutton, .prevbutton").length){var t=e.touches[0].screenX,n=e.touches[0].screenY,i=a._trackpos||0,s=null,o=null,r=function(){switch(window.orientation){case 0:case 180:return window.screen.width;default:return window.screen.height}}(),l=Math.round(r*i/a._tracklength),c=s,d=document.createElement("div"),u=document.createElement("div");d.className="seekMask seekmask",u.className="seekText seektext",document.body.appendChild(d),document.body.appendChild(u);var p=window.pageXOffset,h=window.pageYOffset,m=window.innerHeight,f=window.innerWidth;d.style.width=f+"px",d.style.height=m+"px",d.style.left=p+"px",d.style.top=h+"px",u.style.width=f+"px",u.style.height=m+"px",u.style.left=p+"px",u.style.top=h+"px",a._playlist.seeking=!0,a._dragging=!0,a._elem.addEventListener("touchmove",_),a._elem.addEventListener("touchend",b),a._elem.addEventListener("touchcancel",v)}function g(e){a._elem.removeEventListener("touchend",b),a._elem.removeEventListener("touchcancel",v),a._elem.removeEventListener("touchmove",_),a._playlist.seeking=!1,a._dragging=!1,e&&(a._trackpos==a._tracklength?a._playlist.next_track():0==a._trackpos&&i<3?a._playlist.prev_track():a._playlist.seek(a._trackpos)),document.body.removeChild(u),document.body.removeChild(d)}function _(e){if(null==s){e.changedTouches[0].screenY;if(Math.abs(e.changedTouches[0].screenY-n)>Math.abs(e.changedTouches[0].screenX-t))return void g(!1)}e.preventDefault();var d=e.changedTouches[0].screenX;d=1.4*d-.2*r,null==s&&(s=o=d);a._tracklength;o!=l&&(Math.abs(l-d)>Math.abs(l-c)&&(o>l?o--:o++));var p=0;d<=o?(p=o<=0?0:d/o*i)<0&&(p=0):(p=(d-o)/(r-o)*(a._tracklength-i)+i)>a._tracklength&&(p=a._tracklength),a._trackpos=p,a._updateprog();var h="";h=p==a._tracklength?"&gt;&gt;":0==p&&i<3?"&lt;&lt;":Time.timeStr(a._trackpos),u.innerHTML=h,c=d}function b(e){g(!0)}function v(e){g(!1)}}))}this._showhide_nextprev()}else{var s=Player.tralbum_data.trackinfo[0];i.play.parentNode.href=s.file}}return e.prototype={_handle_playclick:function(e){U.stopEvent(e),this._playlist.playpause()},_handle_nextclick:function(e){U.stopEvent(e),$(this._elems.next).hasClass("hiddenelem")||this._playlist.next_track()},_handle_thumb_grab:function(){},_handle_prevclick:function(e){U.stopEvent(e),$(this._elems.prev).hasClass("hiddenelem")||this._playlist.prev_track()},_handle_playstate:function(e){switch(e.newstate){case"PLAYING":$(this._elems.play).removeClass("busy").addClass("playing"),TitlePlayIndicator.play();break;case"BUFFERING":case"BUSY":$(this._elems.play).removeClass("playing").addClass("busy");break;default:$(this._elems.play).removeClass("busy").removeClass("playing"),TitlePlayIndicator.stop()}},_handle_trackchange:function(e){if(this._showhide_nextprev(),this._trackinfo=e,this._options.onetrack){if(this._elems.message)if(e.encoding_error){var t=e.encoding_error;t=(t=JSON.stringify(t)).slice(1,t.length-1),t=Text.escapeHtml(t);var n=$('<a style="color:red" href="#">upload error</a>').click((function(){return Tracks.encoding_error(t),!1}));$(this._elems.message).removeClass("hiddenelem").html(n)}else e.encoding_pending?$(this._elems.message).removeClass("hiddenelem").html("processing..."):$(this._elems.message).addClass("hiddenelem")}else $(this._elem).find(".title-section").removeClass("hiddenelem"),this._elems.title.innerHTML=Text.escapeHtml(e.title);if(("iPhone"==Browser.platform||window.MediaView&&"phone"==MediaView.mode)&&$(this._elem).find(".video-link")[0])if(e.video_id){var i=$(this._elem).find(".video-link");i.attr("data-href-mobile",e.video_mobile_url),i.attr("href","#"),i.attr("data-caption",e.video_caption),i.removeClass("is-hidden")}else $(this._elem).find(".video-link").addClass("is-hidden");this._set_title_link(e.title_link),this._tracklength=this._playlist.get_track_info().duration||e.duration||0,this._zero_time()},_set_title_link:function(e){var t=this._elems.title_link;if(t){var n=this._elems.title;t.href=e,e?n.parentNode!=t&&(n.parentNode.insertBefore(t,n),t.appendChild(n)):n.parentNode==t&&(t.parentNode.insertBefore(n,t),t.parentNode.removeChild(t))}},_handle_volumechange:function(e){this._display_volume(e.volume)},_handle_playlistchange:function(){var e=this._playlist.get_track_info();e&&this._handle_trackchange(e)},_zero_time:function(){this._trackpos=0,this._updateprog()},_handle_time:function(e){this._dragging||"PLAYING"!==this._playlist.get_state()||(this._trackpos=e.position),e.duration&&this._tracklength!=e.duration&&(this._tracklength=e.duration),this._updateprog()},_showhide_nextprev:function(){var e=this._playlist.get_track(),t=this._playlist.first_playable_track,n=this._playlist.last_playable_track;this._elems.prev&&this.showhide_elem(this._elems.prev,t>=0&&e>t),this._elems.next&&this.showhide_elem(this._elems.next,n>=0&&e<n)},_handle_loaded:function(e){this._loadpercent=e,this._updateprog()},_updateprog:function(){var e=this._elems.prog.offsetWidth-this._elems.progthumb.offsetWidth,t=this._tracklength?this._trackpos/this._tracklength*e:0;this._elems.progthumb.style.left=t+"px",this._elems.progfill.style.width=this._loadpercent+"%",$(this._elem).find(".time.hiddenelem").removeClass("hiddenelem"),$(this._elem).find(".time_elapsed").text(Time.timeStr(this._trackpos)),$(this._elem).find(".time_total").text(Time.timeStr(this._tracklength>1?this._tracklength:1))},_display_volume:function(e){this._voltimer&&(clearTimeout(this._voltimer),this._voltimer=null);var t=this._elems.volbars;if(!t){(t=document.createElement("div")).className="volumebars";for(var n="",i=0;i<12;i++)n+='<div class="volumebar"></div>';n+='<img class="volumebarimg" src="/img/volbang.png">',n+='<img class="volumebarimg" src="/img/volbang.png">',n+='<img class="volumebarimg" src="/img/volbang.png">',n+='<img class="volumebarimg" src="/img/vol1.png">',t.innerHTML=n,this._elems.volbars=t,document.body.appendChild(t)}t.classList.remove("hiddenelem");var a=t.childNodes;for(i=0;i<a.length;i++)i/a.length<e?a[i].classList.remove("hiddenelem"):a[i].classList.add("hiddenelem");var s=this;this._voltimer=setTimeout((function(){s._hide_volume()}),3e3)},_hide_volume:function(){this._elems.volbars.classList.add("hiddenelem"),this._voltimer=null},find_elem:function(e){return $("."+e,this._elem)[0]},showhide_elem:function(e,t){t?e.classList.remove("hiddenelem"):e.classList.add("hiddenelem")},toString:function(){return this._trackinfo?"[InlinePlayerView: id="+this._elem.id+", title="+this._trackinfo.title+"]":"[InlinePlayerView: id="+this._elem.id+", no track]"}},e}();var FacebookUtils={_sdkLoadPromise:null,initSDK:function(){if(FacebookUtils._sdkLoadPromise)return FacebookUtils._sdkLoadPromise;var e,t=new $.Deferred;return window.fbAsyncInit=function(){Log.debug("Facebook SDK loaded"),FB.init({appId:"165661066782720",status:!0,cookie:!0,xfbml:!1}),t.resolve()},$(document.body).prepend('<div id="fb-root"></div>'),fbLocales={en:"en_US",fr:"fr_FR",ja:"ja_JP",qq:"ja_JP"},"Translate"in window&&"locale"in Translate&&(e=fbLocales[Translate.locale]),e||(e="en_US",Log.server("Facebook SDK couldn't determine FB locale","error")),$.cachedScript("//connect.facebook.net/"+e+"/all.js"),FacebookUtils._sdkLoadPromise=t.promise()},xxx:null},EmailIMUtils={alreadyStattedFromFocus:!1,onFocus:function(){return self.alreadyStattedFromFocus||(Stats.record({kind:"click",click:"email_tralbum"}),self.alreadyStattedFromFocus=!0),!1},xxx:null},SocialControls={initFromDOM:function(e){var t=this,n=$(e);n.add(".social-controls",n).filter(".social-controls").each((function(){var e=$(this);t._initControlsOfType(e.find(".facebook-like-ctrl"),"renderFacebookLike"),t._initControlsOfType(e.find(".facebook-share-ctrl"),"renderFacebookShare"),t._initControlsOfType(e.find(".facebook-share-dlg-ctrl"),"renderFacebookDialogShare"),t._initControlsOfType(e.find(".twitter-ctrl"),"renderTwitterShare"),t._initControlsOfType(e.find(".reddit-ctrl"),"renderRedditShare"),t._initControlsOfType(e.find(".tumblr-ctrl"),"renderTumblrShare"),t._initControlsOfType(e.find(".email-ctrl"),"renderEmailShare")}))},renderFacebookLike:function(e,t){var n=this,i=$(e),a={url:location.href,send:"false",layout:"button_count",width:"90","show-faces":"false"},s=(t=$.extend(a,t),$('<div class="fb-like"></div>').appendTo(i));$.each(t,(function(e,t){"url"==e&&(e="href"),s.attr("data-"+e,t)})),FacebookUtils.initSDK().done((function(){FB.XFBML.parse(i[0]),n._registerFBEventHandlers(e,t),i.data("scResolvedData",t)}))},renderFacebookDialogShare:function(e,t){!function(e,t,n){var i=e.getElementsByTagName(t)[0],a=e.createElement(t);a.id="facebook-jssdk",a.src="https://connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(a,i)}(document,"script"),window.fbAsyncInit=function(){FB.init({appId:t.appId,autoLogAppEvents:!0,xfbml:!0,version:"v3.2"})},$(e).find(".facebook-link").first().click((function(e){FB.ui({method:"share_open_graph",action_type:"og.shares",action_properties:JSON.stringify({object:{"og:url":t.url,"og:title":t.title,"og:description":t.text,"og:image":t.image,"og:image:width":100,"og:image:height":100}})},(function(e){}))}))},renderFacebookShare:function(e,t){var n=this,i=$(e),a={url:location.href},s={u:(t=$.extend(a,t)).url},o=!window.MediaView||"desktop"==MediaView.mode,r=Url.addQueryParams(o?"http://www.facebook.com/sharer.php":"http://m.facebook.com/sharer.php",s),l=i.find(".facebook-link").first();l.length||(l=$('<a class="facebook-link" title="Share on Facebook">Share</a>').appendTo(i)),l.attr({href:r,target:"_blank"}).click((function(e){n._statClick(t,"on"),o&&(window.open(r,"share_fb","toolbar=0,status=0,width=626,height=436"),e.preventDefault())}))},renderTwitterShare:function(e,t){var n=this,i=$(e),a={url:location.href},s={url:(t=$.extend(a,t)).url},o=!window.MediaView||"phone"!=MediaView.mode;t.text&&(s.text=t.text);var r,l,c=Url.addQueryParams("https://twitter.com/intent/tweet",s),d=i.find(".twitter-link").first();d.length||(void 0===TM?(r="Tweet",l="Share on Twitter"):(r=TM("Tweet"),l=TM("Share on Twitter")),d=$('<a class="twitter-link" title="'+l+'">'+r+"</a>").appendTo(i));d.attr({href:c,target:"_blank"}).click((function(e){n._statClick(t,"on"),o&&(window.open(c,"share_tw","toolbar=0,status=0,width=550,height=450"),e.preventDefault())}))},renderRedditShare:function(e,t){var n=this,i=$(e),a={url:location.href},s={url:(t=$.extend(a,t)).url,title:t.title,kind:"self"},o=!window.MediaView||"phone"!=MediaView.mode,r=Url.addQueryParams("https://www.reddit.com/submit",s),l=i.find(".reddit-link").first();if(!l.length){var c=TM("Reddit"),d=TM("Share on Reddit");l=$('<a class="reddit-link" title="'+d+'">'+c+"</a>").appendTo(i)}l.attr({href:r,target:"_blank"}).click((function(e){n._statClick(t,"on"),o&&(window.open(r,"share_rd","toolbar=0,status=0,width=550,height=450"),e.preventDefault())}))},renderTumblrShare:function(e,t){var n=this,i=$(e),a={url:location.href,type:"link"},s={};"audio"==(t=$.extend(a,t)).type?(s.external_url=t.url,t.text&&(s.caption=t.text)):(s.url=t.url,t.title&&(s.name=t.title),t.text&&(s.description=t.text));var o=Url.addQueryParams("http://www.tumblr.com/share/"+t.type,s),r=i.find(".tumblr-link").first();r.length||(r=$('<a class="tumblr-link" title="Share on Tumblr">Share on Tumblr</a>').appendTo(i)),r.attr({href:o,target:"_blank"}).click((function(e){n._statClick(t,"on")}))},renderEmailShare:function(e,t){var n=this,i=$(e),a={url:location.href},s={body:(t=$.extend(a,t)).url};t.text&&(s.body=t.text+"\r\n\r\n"+s.body),t.subject&&(s.subject=t.subject);var o="mailto:?"+Url.joinQuery(s),r=i.find(".email-link").first();r.length||(r=$('<a class="email-link" title="Share via email">Email</a>').appendTo(i)),r.attr({href:o}).click((function(e){return n._statClick(t,"on"),setTimeout((function(){location.href=o}),100),!1}))},_initControlsOfType:function(e,t){var n=this;$(e).each((function(){n[t](this,n._getData(this))}))},_getData:function(e,t){var n=$(e),i=n.data(),a=n.closest(".social-controls").data();return $.extend(t||{},a,i)},_statClick:function(e,t){var n=null;"on"==t?n=e.stat||e.statOn:"off"==t&&(n=e.statOff),n&&Stats.record({kind:"click",click:n})},_initedFBEvents:!1,_registerFBEventHandlers:function(){var e=this;this._initedFBEvents||(FacebookUtils.initSDK().done((function(){FB.Event.subscribe("edge.create",$.proxy(e,"_handleFBEvent","on")),FB.Event.subscribe("edge.remove",$.proxy(e,"_handleFBEvent","off"))})),this._initedFBEvents=!0)},_handleFBEvent:function(e,t,n){if(n&&n.dom&&n.dom.tagName){var i=$(n.dom).closest(".facebook-like-ctrl").data("scResolvedData");i&&t==i.url&&this._statClick(i,e)}else Log.error("SocialControls: can't stat FB Like/Unlike because event parameter 'widget' is missing or has changed")},xxx:null},Footer={enhance:function(){this.initViewSwitcher($("#pgFt .view-switcher"))},initViewSwitcher:function(e){var t=$(e);"client"==MediaView.initType&&"desktop"==MediaView.mode&&"d"!=Cookie.get("mvp")&&t.filter(".desktop").hide(),t.on("click",(function(){var e=$(this).hasClass("phone")?"d":"p";return Cookie.set("mvp",e,7776e3),location.href=Url.addQueryParams(location.href,{".reload":(new Date).getTime()}),!1}))},forceMobile:function(){Cookie.set("mvp","p",7776e3)},zzz:null};$(document).ready($.proxy(Footer,"enhance"));var WebappSelector=function(){"use strict";return"undefined"!=typeof $&&$(document).ready((function(){setTimeout((function(){WebappSelector.create_ui(window.siteroot,Identities.isAdmin())}),1e3)})),{backendname:"unknown app",bc_cookie_set:!1,siteroot:null,create_ui:function(e,t){if((t||Cookie.get("bc_webapp"))&&e){WebappSelector.siteroot=e;var n=WebappSelector.backendname,i=$("#webapp-selector-ui").data("bccookie"),a=$("#webapp-selector-ui").data("backendid");!i||a&&a!=i?a&&(WebappSelector.backendname=n=a):(WebappSelector.backendname=i,WebappSelector.bc_cookie_set=!0,n=WebappSelector.backendname+" (forced)"),WebappSelector.refresh_ui(n)}else $("#pgFt").one("dblclick",(function(t){if("A"!=t.target.tagName)return WebappSelector.create_ui(e,!0),!1})),$("#pgFt").on("touchend",(function(t){var n=(new Date).getTime();if(n-($(this).data("lastTap")||0)<500)return $(this).off("touchend"),WebappSelector.create_ui(e,!0),!1;$(this).data("lastTap",n)}))},refresh_ui:function(e){var t=$(".webapp-selector-link").off("click");if(!t.filter(".webapp-selector-ui .webapp-selector-link, .pg-ft-nav.connect .webapp-selector-link").length){var n=$('<a href="#" class="webapp-selector-link">').text(e);$(".webapp-selector-ui").css("display","inline-block").append(n),$(".pg-ft-nav.connect").append("<li>").append($('<li class="headroom">').append(n.clone(!0))),$(".pgft-phone .footer-extras").removeClass("hidden"),$("#pgFt-inner").addClass("webapp-selector-visible"),t=$(".webapp-selector-link")}t.text(e),t.on("click",(function(e){return WebappSelector.show_form(e),!1}))},show_form:function(){var e=[];WebappSelector.bc_cookie_set&&e.push({text:"Default webapp",click:function(){var e=WebappSelector.cookie_domain();Cookie.clear("bc_webapp","/",e,!1),WebappSelector.refresh_ui("reloading..."),$(this).dialog("close"),window.location.reload()}}),e.push({text:"OK",click:function(){var e=elt("webappselectordialog.item"),t=e.options[e.selectedIndex].value,n=WebappSelector.cookie_domain();Cookie.set("bc_webapp",t,null,"/",n,!1),WebappSelector.refresh_ui("reloading..."),$(this).dialog("close"),window.location.reload()}}),NuDialog.alertHTML("Select webapp backend",'<select id="webappselectordialog.item" style="width:100%"></select>',{buttons:e}),WebappSelector.populate_machine_list()},populate_machine_list:function(){var e=[],t=$("#webapp-selector-ui").data("webapps");Iter.each(t,(function(t){for(var n=t.hostnameRange[0];n<=t.hostnameRange[1];n++){var i=t.hostnameBase+(n<10?"0"+n:n);Iter.each(t.appNumbers,(function(t){e.push(i+"-"+t)}))}}));var n,i=elt("webappselectordialog.item");i.innerHTML="";for(var a=0;a<e.length;a++)(n=document.createElement("option")).value=e[a],n.innerHTML=Text.escapeHtml(e[a]),e[a]==WebappSelector.backendname&&(n.selected=!0),i.appendChild(n)},cookie_domain:function(){var e=window.location.hostname;return window.location.hostname.indexOf(WebappSelector.get_siteroot())>-1&&(e=WebappSelector.get_siteroot()),e},get_siteroot:function(){var e=WebappSelector.siteroot;return e?((e=e.replace("http://","").replace("https://","")).indexOf(":")>-1&&(e=e.substr(0,e.indexOf(":"))),e):""}}}(),NuDialog=function(){"use strict";return $(document).on("dialogclose",(function(){$.event.trigger("bc_dialog_close")})),$(document).on("dialogopen",(function(){$.event.trigger("bc_dialog_open")})),{DEFAULT_OPTIONS:{dialogClass:"nu-dialog",draggable:!0,width:"35em",position:"center",modal:!0,buttons:{OK:function(){$(this).dialog("close")}},close:function(){$(this).remove()},defaultFocus:function(){var e=$("div.nu-dialog").find("button");if(e)if(1==e.length)e.focus();else{var t=$("div.nu-dialog").find("button.default");t&&1==t.length&&t.focus()}else $("div.nu-dialog").focus()}},MOBILE_OPTIONS:{width:300,draggable:!1},alert:function(t,n,i,a){var s=i||NuDialog.DEFAULT_OPTIONS;return i&&i.dialogClass||((i=i||{}).dialogClass="nu-dialog no-close"),i=e($.extend({title:t,open:function(){s.defaultFocus&&s.defaultFocus()}},i)),$("<div>")[a?"html":"text"](n).dialog(i)},alertHTML:function(e,t,n){return NuDialog.alert(e,t,n,!0)},confirm:function(e,t,n){var i={buttons:[{text:"Cancel",class:"secondary",click:function(){$(this).dialog("close")}},{text:"OK",click:function(){$(this).dialog("close"),n()}}]};return NuDialog.alert(e,t,i)},showXHRError:function(e){if(window.isDebug&&Log.warn("FIXME: NuDialog.showXHRError is deprecated. Now code should use API endpoints and .showAPIError() instead."),!0===e.error){var t=e.exception&&e.exception.indexOf("ALERT: "),n={};return t&&t>=0?(e.alert_text=e.exception.slice(t+7),n.title="Note"):(e.browser=Browser,n.title="Error"),NuDialog.showTemplate("xhr_error_dialog",e,n),!0}return!1},showAPIError:function(e){return!!e.error&&(NuDialog.alert("API Error",e.error_message||"Unknown error."),!0)},showNetworkError:function(e,t,n){NuDialog.alert("Network Error","There was a network error. Please try again.\n(Status: "+t+")")},showTemplate:function(t,n,i){return i=e(i||{}),n=n||{},$("<div>").renderLiquid(t,n).dialog(i)},showViewModel:function(t){var n=t.templateName(),i="function"==typeof t.templateHash?t.templateHash():{},a="function"==typeof t.dialogOptions?t.dialogOptions():{},s=$("<div>").renderLiquid(n,i);return"function"==typeof t.$dialog&&t.$dialog(s),ko.applyBindings(t,s[0]),a=e(a),s.dialog(a),s}};function e(e){var t={};"string"==typeof e.dialogClass?t.dialogClass=NuDialog.DEFAULT_OPTIONS.dialogClass+" "+e.dialogClass:$.isArray(e.dialogClass)&&(t.dialogClass=NuDialog.DEFAULT_OPTIONS+" "+e.dialogClass.join(" "));var n=$.extend({},NuDialog.DEFAULT_OPTIONS);return"phone"===MediaView.mode&&$.extend(n,NuDialog.MOBILE_OPTIONS),$.extend(n,e,t),n}}();void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/xhr_error_dialog.liquid","warn"):Templ.register({xhr_error_dialog:['<div id="xhr-error-dialog">\r\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"alert_text ",attachment:["\r\n    <p>\r\n        ",{type:"variable",name:"alert_text",filters:[["h",[]]]},"\r\n    </p>\r\n    "]},{type:"else_ncondition",attachment:["\r\n    <h4>We regret to inform you that something odd happened.</h4>\r\n    \r\n    <p>\r\n        Please excuse the error.\r\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"member_of_current_band ",attachment:['\r\n            Artists: please  \r\n            <a href="/contact?subj=',{type:"variable",name:"error_type",filters:[["u",[]],["a",[]]]},"&amp;msg=",{type:"variable",name:"error_for_email",filters:[["a",[]]]},"\">click here</a> to let us know about the error. We'll get right on it.\r\n        "]}]},'\r\n    </p>\r\n    \r\n    <div class="dlg_errorInfo">\r\n    Some interesting stuff (to us):\r\n    <ul>\r\n        <li>url: ',{type:"variable",name:"url",filters:[["h",[]]]},"</li>\r\n        <li>error: ",{type:"variable",name:"exception",filters:[["h",[]]]},"</li>\r\n        <li>browser: ",{type:"variable",name:"browser.make",filters:[["h",[]]]}," ",{type:"variable",name:"browser.version",filters:[["join",["'.'"]],["h",[]]]}," ",{type:"variable",name:"browser.platform",filters:[["h",[]]]},"</li>\r\n        <li>date: ",{type:"variable",name:"date",filters:[["h",[]]]},"</li>\r\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"user ",attachment:["\r\n        <li>user: ",{type:"variable",name:"user",filters:[["h",[]]]},"</li>\r\n        "]}]},"\r\n        <li>host: ",{type:"variable",name:"host",filters:[["h",[]]]},"</li>\r\n    </div>\r\n    "]}]},"\r\n</div>"]}),$(document).ready((function(e){"use strict";var t=$("#pagedata").data("blob").cfg||{},n=new RegExp(TemplGlobals.siteroot+"/contact");$("a[href*='contact']:not([href*='contact_vinyl_support'])").each((function(){var e=$(this).attr("href");(e.match(n)||e.match(/^\/contact/))&&$(this).click((function(n){n.preventDefault();var i=new RegExp(TemplGlobals.sitedomain),a=null===window.location.host.match(i),s=Url.toHash(e).search,o=Url.parseQuery(s),r=Contact.message_defaults(o,t);ContactTracker("click",r.band_id,"open_dialog"),"phone"==MediaView.mode||a||"ie"==Browser.make?(e=Url.addQueryParams(e,{p:location.href}),window.open(e)):Contact.show_form_dlg(r,n)})),$("#band-contact-mailto").click((function(e){var t=JSON.parse(document.getElementById("contact-tracker-data").dataset.bandId);ContactTracker("click",t,"open_mailto")}))}))}));var RecaptchaWrapper={_sdkLoadPromise:null,_gapi:new $.Deferred,_widget_id:null,initSDK:function(){if(RecaptchaWrapper._sdkLoadPromise)return RecaptchaWrapper._sdkLoadPromise;var e=$.cachedScript("https://www.google.com/recaptcha/api.js?onload=gcaptchaDependencyOnload&render=explicit").done((function(){Log.debug("ReCaptcha bootstrap loaded")}));return RecaptchaWrapper._sdkLoadPromise=$.when(e,RecaptchaWrapper._gapi)},resolve_gapi_deferred:function(){Log.debug("ReCaptcha API loaded"),RecaptchaWrapper._gapi.resolve()},public_key:function(){var e=$("#pagedata").data("blob");return e&&e.recaptcha_public_key},is_rendered:function(){return void 0!==$("#are-you-human iframe").attr("id")},render:function(){RecaptchaWrapper.is_rendered()?(Log.debug("resetting"),RecaptchaWrapper.reset()):RecaptchaWrapper._widget_id=grecaptcha.render("are-you-human",{sitekey:RecaptchaWrapper.public_key(),theme:"white",callback:function(){Log.debug("Valid ReCaptcha response"),Form.validate.clear_alert($("#contact\\.captcha_alert")),$(document).trigger("human-detected")}}),Contact.enable_the_buttons()},reset:function(){grecaptcha.reset(RecaptchaWrapper._widget_id)},fail:function(){Form.validate.show_alerts({field:"contact.captcha",reason:"recaptcha-not-reachable"},!1)},safe_destroy:function(){Contact.use_recaptcha()&&($(".pls-container").remove(),RecaptchaWrapper.reset())},xxx:null},gcaptchaDependencyOnload=function(){RecaptchaWrapper.resolve_gapi_deferred()},Contact={show_form:function(e,t){var n=e,i=new RegExp(TemplGlobals.sitedomain),a=null===window.location.host.match(i);if("phone"==MediaView.mode||a){n.p=location.href;var s="/contact?"+Url.joinQuery(n);window.open(s)}else n=Contact.message_defaults(e),Contact.show_form_dlg(n,t)},validation:{sections:{contact:{prefix:"contact"}},messages:{"contact.generic":{generic:TM("Sorry, there was an unexpected problem. Please try that again."),badBand:TM("Sorry, there was an unexpected problem. Please refresh the page and try again.")},"contact.name":{missingValue:TM("please enter your name")},"contact.email":{missingValue:TM("please enter your email address"),badFormat:TM("thats not a valid email address"),noFacebook:TM("sorry, Facebook addresses are not supported.<br/>please enter a different email address.")},"contact.message":{missingValue:TM("please enter your message"),stringLength:TM("that message is too long")},"contact.fan_urls":{missingValue:TM("please provide your Fan Page URL"),badFormat:TM("hmm, this Fan Page URL doesnt look right..."),badFormats:TM("hmm, not all of these Fan Page URLs look right...")},"contact.codes":{missingValue:TM("please provide your track/album code"),badFormat:TM("hmm, this doesnt look like a Bandcamp track/album code..."),badFormats:TM("hmm, not all of these track/album codes look right...")},"contact.fb_urls":{missingValue:TM("please provide your Facebook Page URL"),badFormat:TM("hmm, this Facebook Page URL doesnt look right..."),badFormats:TM("hmm, not all of these Facebook Page URLs look right...")},"contact.band_urls":{missingValue:TM("please provide your Bandcamp URL"),badFormat:TM("hmm, this Bandcamp URL doesnt look right..."),badFormats:TM("hmm, not all of these Bandcamp URLs look right...")},"contact.dls":{missingValue:TM("please provide your download link"),badFormat:TM("hmm, this download link doesnt look right..."),badFormats:TM("hmm, not all of these download links look right...")},"contact.preorders":{missingValue:TM("please provide a link to the albums page"),badFormat:TM("hmm, this album link doesnt look right..."),badFormats:TM("hmm, not all of these album links look right...")},"contact.original_email":{missingValue:TM("please enter the email address currently linked to the account"),badFormat:TM("thats not a valid email address")},"contact.signup_date":{missingValue:TM("please enter the date you think you signed up")},"contact.purchased_item_url":{missingValue:TM("please provide the url of the item you purchased"),badFormat:TM("hmm, this Bandcamp URL doesnt look right...")},"contact.purchase_email":{missingValue:TM("please enter the email address you think you used to purchase the item"),badFormat:TM("thats not a valid email address")},"contact.reason_for_refund":{missingValue:TM("please provide the reason for refund")},"contact.purchase_url_or_album_title_and_artist_name":{missingValue:TM("please provide the purchase URL or album title and artist name")},"contact.bandcamp_or_paypal_transaction_id":{badFormat:TM("hmm, this id doesnt look right...")},"contact.captcha":{"incorrect-captcha-sol":TM("please try again"),"captcha-timeout":TM("please try again"),"recaptcha-not-reachable":TM("apologies  human detection service unavailable, please try again later"),"malformed-api-response":TM("apologies  human detection service malfunctioning, please try again later"),"invalid-request-cookie":TM("please try again"),"missing-response":TM("please fill out the captcha")}}},subjects:{"Help setting up my Facebook app":{band_urls:"",fb_urls:""},"Help! I cant log in!":{band_urls:"",original_email:"",signup_date:""},"Help! I never received my receipt.":{purchased_item_url:"",purchase_email:""},"Expired download":{dls:""},"Download code trouble":{codes:""},"Help with my Fan Account":{fan_urls:""},"Pre-order link not received":{preorders:""},"Fulfillment Inquiry":{band_urls:""},"Payment setup trouble":{band_urls:""},"Refund Request":{reason_for_refund:"",purchase_url_or_album_title_and_artist_name:"",bandcamp_or_paypal_transaction_id:""}},message_defaults:function(e,t){var n,i=(n=e.b)&&(n=parseInt(n))?n:1,a=null,s=t&&t.zendesk_help_docs;return(s&&location.href.match(/\/order_details\?(sig|payment_id|gift_id)=([^&]*)/)||!s&&location.href.match(/\/help\/physical_orders\/\?(sig|payment_id|gift_id)=([^&]*)/))&&(a=!0),{subj:e.subj||null,msg:e.msg||"",email:e.email||null,name:e.name||null,band_id:i,band_name:e.n||"Bandcamp Support",from_url:e.p||encodeURIComponent(location.href),prev_referrer_url:e.prev_referrer_url,from_order_details:a}},populate_support_topic:function(){var e=Contact.fields.subj;e in Contact.subjects&&$.extend(Contact.fields,Contact.subjects[e]),1==Contact.fields.band_id&&(Contact.check_for_banner(),Contact.banner_msg&&(Contact.fields.banner_msg=Contact.banner_msg))},check_for_banner:function(){$.ajax({type:"POST",url:"/contact_banner_cb",dataType:"json",async:!1,success:function(e){e.banner_msg?Contact.banner_msg=e.banner_msg:delete Contact.banner_msg},error:function(e){Log.info("check_for_banner failed: "+e.status)}})},show_form_page:function(e,t,n){window.Form.revealError=function(){},Contact.fields=e,Contact.fields.use_captcha=Contact.use_recaptcha(),Contact.popped_open=t,Contact.return_url=n,Contact.populate_support_topic(),Contact.fields.is_modal=!1,t&&1!=Contact.fields.band_id&&(Contact.validation.messages["contact.generic"].badBand=TM("Sorry, there was an unexpected problem. Please return to the artists page and try again.")),Templ.renderElem("contact-form","contact_form_2018",Contact.fields),$("#contact\\.cancel").click(Contact.cancel_button);var i=$(".toggle-edit"),a=$(".toggleable input");i.click((function(){a.removeClass("no-edit"),a.attr("readonly",!1),i.hide()})),a.focusin((function(){a.attr("readonly")||i.hide()})),Form.init("contactForm",null,null,Contact.validation,(function(e){Contact.submit_button(e)})),Contact.setup_recaptcha(),Contact.make_stretchy_textareas()},show_form_dlg:function(e,t){if(window.Form.revealError=function(){},Contact.fields=e,Contact.populate_support_topic(),Contact.fields.is_modal=!0,Contact.fields.banner_msg){var n=TM("Contact {{band_name}}",{band_name:Contact.fields.band_name},"Contact modal header title"),i=Templ.render("contact_support_alert",{modal:!0,banner_msg:Contact.fields.banner_msg,faq_url:null}),a=TM("Contact Bandcamp Support"),s=this;NuDialog.alertHTML(Text.escapeHtml(n),i,{dialogClass:"contact-dlg",buttons:[{text:a,click:function(){s.show_form_inner(t),$(this).dialog("close")}}]}),$(".mask").css("background","#000")}else this.show_form_inner(t)},show_form_inner:function(e){Contact.fields.use_captcha=Contact.use_recaptcha(),Contact.fields.language_msg=1===Contact.fields.band_id&&Translate&&Translate.locale!==Translate.EN_DEFAULT;var t=TM("Contact {{band_name}}",{band_name:Contact.fields.band_name},"Contact modal header title"),n=null;return NuDialog.showTemplate("contact_form_2018",Contact.fields,{title:Text.escapeHtml(t),width:"448px",dialogClass:"contact-dlg",buttons:[],open:function(){$(".mask").css("background","#000"),n=$(this),$("#contact\\.cancel").click((function(e){Contact.cancel_button(e,n)}));var e=$(".toggle-edit"),t=$(".toggleable input");e.click((function(){t.removeClass("no-edit"),t.attr("readonly",!1),e.hide()})),t.focusin((function(){t.attr("readonly")||e.hide()})),Form.init("contactForm",null,null,Contact.validation,(function(e){Contact.submit_button(e,n)})),Contact.setup_recaptcha(),Contact.make_stretchy_textareas()},close:function(){Form.detach(),$(this).find("form").remove(),$(this).dialog("destroy")}}),e&&e.stopPropagation(),n},use_recaptcha:function(){var e=$("#pagedata").data("blob");return!(1==Contact.fields.band_id||e.identities.user||!RecaptchaWrapper.public_key())},setup_recaptcha:function(){Contact.use_recaptcha()&&(Contact.disable_the_buttons(),RecaptchaWrapper.initSDK().then(RecaptchaWrapper.render,RecaptchaWrapper.fail))},submit_button:function(e,t){$.Event(e).preventDefault(),Contact.disable_the_buttons(),ContactTracker("click",Contact.fields.band_id,"submit_form"),Crumb.ajax({type:"POST",url:"/contact_cb",data:$("#contactForm").serialize(),dataType:"json",success:function(e,n,i){Contact.success(e,n,i,t)},error:function(e,t,n){Contact.failure(e,t,n)}})},success:function(e,t,n,i){if(e.errors||e.error){if(Contact.enable_the_buttons(),e.errors)Form.validate.show_alerts(e.errors,!1);else{NuDialog.alert("Oops!",Contact.validation.messages["contact.generic"].generic,{dialogClass:"contact-dlg"});$(".mask").css("background","#000")}RecaptchaWrapper.safe_destroy()}else if(i){RecaptchaWrapper.safe_destroy(),i.dialog("close");var a=Templ.render("contact_form_verification",{band_name:Contact.fields.band_name,ok:!0,to_support:1==Contact.fields.band_id,from_order_details:Contact.fields.from_order_details,return_url:!1}),s=TM("Contact {{band_name}}",{band_name:Contact.fields.band_name},"Contact modal verification pane"),o=TM("Done");NuDialog.alertHTML(Text.escapeHtml(s),a,{dialogClass:"contact-dlg",buttons:[{text:o,click:function(){$(this).dialog("close")}}]}),$(".mask").css("background","#000")}else if(Contact.popped_open)window.close();else{Contact.return_url||TemplGlobals.siteroot,a=Templ.render("contact_form_verification",{band_name:Contact.fields.band_name,ok:!0,to_support:1==Contact.fields.band_id,from_order_details:Contact.fields.from_order_details,return_url:Contact.return_url});if("phone"==MediaView.mode){$("#contact-banner").hide();var r=null;r=null!==$("#contact-page-info").first().offset()?$("#contact-page-info").first().offset().top:$(".vinyl-crowdfunding-contact-page-info").first().offset().top,$("html, body").animate({scrollTop:r},500)}i=$("#contact-form").replaceWith(a)}},failure:function(e,t,n){Contact.enable_the_buttons(),Form.validate.show_alerts({field:"contact.generic",reason:"generic"},!1),Log.info("contact callback failure: status: "+e.status+"; statusText: "+n)},cancel_button:function(e,t){if(e.stopPropagation(),t)RecaptchaWrapper.safe_destroy(),t.dialog("close");else if(Contact.popped_open)window.close();else{var n=Contact.return_url||TemplGlobals.siteroot;window.location=n}},disable_the_buttons:function(){$("#contact\\.send").addClass("disabled"),$("#contact\\.send").prop("disabled",!0),$("#contact\\.send").text="Sending...",$("#contact\\.cancel").addClass("disabled"),$("#contact\\.cancel").prop("disabled",!0)},enable_the_buttons:function(){$("#contact\\.send").removeClass("disabled"),$("#contact\\.send").prop("disabled",!1),$("#contact\\.send").text="Send",$("#contact\\.cancel").removeClass("disabled"),$("#contact\\.cancel").prop("disabled",!1)},make_stretchy_textareas:function(){$("#contactForm textarea").each((function(){addExpandEventListeners(this);var e=52;"contact.message"==this.name&&(e=this.value?$(this).height(0).height(this.scrollHeight):150),addShrinkEventListeners(this,e)}))},zzz:null},ContactTracker=function(e,t,n){if(window.ClientID){var i={feature:"artist-contact-form",action:n,band_id:t};BCTracker.record(e,i)}},Launder=function(e){$.post("/ectotherm/launder_cb",{laundry:e}).done((function(e){Trackpipe.showXHRError(e)||(e.ok?alert(siteroot_https+e.next_url):alert("Keep trying..."))})).fail((function(){NuDialog.alert(TM("Network Error"),TM("There was a network error. Please try again."))}))};void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/contact_form_2018.liquid","warn"):Templ.register({contact_form_2018:['<form id="contactForm" action="/no_js" method="post" accept-charset="utf-8">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"language_msg ",attachment:['\n        <div id="contact.languages">',{type:"translate",nodelist:["Our support in your language is still in progress. Please forgive us if we respond in English."]},"</div>\n    "]}]},'\n\n    <input type="hidden" name="contact.band_id" value="',{type:"variable",name:"band_id",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.band_name" value="',{type:"variable",name:"band_name",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.from_url" value="',{type:"variable",name:"from_url",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.prev_referrer_url" value="',{type:"variable",name:"prev_referrer_url",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.from_order_details" value="',{type:"variable",name:"from_order_details",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.platform" value="',{type:"variable",name:"platform",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.device" value="',{type:"variable",name:"device",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.app_version" value="',{type:"variable",name:"app_version",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.fan" value="',{type:"variable",name:"fan",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.contact_vinyl_support" value="',{type:"variable",name:"contact_vinyl_support",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.reported_tou_url" value="',{type:"variable",name:"reported_tou_url",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.reported_item_type" value="',{type:"variable",name:"reported_item_type",filters:[["a",[]]]},'"/>\n    <input type="hidden" name="contact.reported_item_id" value="',{type:"variable",name:"reported_item_id",filters:[["a",[]]]},'"/>\n\n    \n    ',{type:"ef",blocks:[{type:"ncondition",expression:"from_order_details ",attachment:["\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"subj ",attachment:['\n            <input type="hidden" name="contact.subject" value="',{type:"variable",name:"subj",filters:[["a",[]]]},'"/>\n        ']}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"name ",attachment:['\n            <input type="hidden" name="contact.name" value="',{type:"variable",name:"name",filters:[["a",[]]]},'"/>\n        ']}]},"\n    "]}]},'\n\n    <div id="contact.generic" class="alert"></div>\n\n    <dl class="tableLayout">\n        <div class="tableLayoutRow">\n            <dt>',{type:"translate",nodelist:["Email address"]},'</dt>\n            <dd>\n                <div class="toggleable">\n                    <input type="text" class="textInput ',{type:"ef",blocks:[{type:"ncondition",expression:"email ",attachment:["no-edit"]}]},'" id="contact.email" name="contact.email" value="',{type:"variable",name:"email",filters:[["a",[]]]},'" ',{type:"ef",blocks:[{type:"ncondition",expression:"email ",attachment:["readonly"]}]},"/>\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"email ",attachment:['\n                        <span class="toggle-edit">',{type:"translate",nodelist:["change"]},"</span>\n                    "]}]},'\n                </div>\n                <p id="contact.email_alert" class="alert"></p>\n            </dd>\n        </div>\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"!name || !from_order_details ",attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Name"]},'</dt>\n                <dd>\n                    <input class="textInput" id="contact.name" name="contact.name" value="',{type:"variable",name:"name",filters:[["a",[]]]},'"/>\n                    <p id="contact.name_alert" class="alert"></p>\n                </dd>\n            </div>\n        ']}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"!subj || !from_order_details ",attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Subject"]},'</dt>\n                <dd>\n                    <input class="textInput" id="contact.subject" name="contact.subject" value="',{type:"variable",name:"subj",filters:[["a",[]]]},'"/>\n                    <p id="contact.subject_alert" class="alert"></p>\n                </dd>\n            </div>\n        ']}]},'\n        <div class="tableLayoutRow">\n            <dt>',{type:"translate",nodelist:["Message"]},'</dt>\n            <dd>\n                <textarea rows="7" class="textInput" id="contact.message" name="contact.message">',{type:"variable",name:"msg",filters:[["h",[]]]},'</textarea>\n                <p id="contact.message_alert" class="alert"></p>\n            </dd>\n        </div>\n        ',{type:"if",blocks:[{type:"condition",left:"fan_urls",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Fan Account URL"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.fan_urls" name="contact.fan_urls">',{type:"variable",name:"fan_urls",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.fan_urls_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"codes",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["download code"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.codes" name="contact.codes" >',{type:"variable",name:"codes",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.codes_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"fb_urls",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["facebook URLs"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.fb_urls" name="contact.fb_urls">',{type:"variable",name:"fb_urls",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.fb_urls_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"band_urls",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["band URLs"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.band_url" name="contact.band_urls">',{type:"variable",name:"band_urls",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.band_urls_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"original_email",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["current login email"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.original_email" name="contact.original_email">',{type:"variable",name:"original_email",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.orginal_email_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"signup_date",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["approximate signup date"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.signup_date" name="contact.signup_date">',{type:"variable",name:"signup_date",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.signup_date_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"purchased_item_url",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["link to item you purchased"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.purchased_item_url" name="contact.purchased_item_url">',{type:"variable",name:"purchased_item_url",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.purchased_item_url_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"purchase_email",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["email you think you used to purchase the item"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.purchase_email" name="contact.purchase_email">',{type:"variable",name:"purchase_email",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.purchase_email_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"dls",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["download links"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.dls" name="contact.dls">',{type:"variable",name:"dls",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.dls_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"preorders",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["album page"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.preorders" name="contact.preorders">',{type:"variable",name:"preorders",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.preorder_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"reason_for_refund",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["reason for refund"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.reason_for_refund" name="contact.reason_for_refund">',{type:"variable",name:"reason_for_refund",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.reason_for_refund" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"purchase_url_or_album_title_and_artist_name",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["purchase url or album title and artist name"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.purchase_url_or_album_title_and_artist_name" name="contact.purchase_url_or_album_title_and_artist_name">',{type:"variable",name:"purchase_url_or_album_title_and_artist_name",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.purchase_url_or_album_title_and_artist_name" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n        ",{type:"if",blocks:[{type:"condition",left:"bandcamp_or_paypal_transaction_id",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Bandcamp or PayPal transaction ID <span ",{type:"translateVariable",var_name:"markup_italics",nodelist:['class="contact-form-optional"']},">optional</span>"]},'</dt>\n                <dd>\n                    <textarea rows="1" class="textInput" id="contact.bandcamp_or_paypal_transaction_id" name="contact.bandcamp_or_paypal_transaction_id">',{type:"variable",name:"bandcamp_or_paypal_transaction_id",filters:[["h",[]]]},'</textarea>\n                    <p id="contact.bandcamp_or_paypal_transaction_id" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},"\n\n        ",{type:"if",blocks:[{type:"condition",left:"use_captcha",right:null,operator:null,attachment:['\n            <div class="tableLayoutRow">\n                <dt>',{type:"translate",nodelist:["Be human"]},'</dt>\n                <dd>\n                    <div id="are-you-human"></div>\n                    <p id="contact.captcha_alert" class="alert"></p>\n                </dd>\n            </div>\n        '],child_relation:null,child_condition:null}]},'\n\n        <div id="contact.support_alert" class="alert"></div>\n\n        <dd class="contact-action-buttons">\n            <button type="submit" name="contact.send" value="OK" id="contact.send">\n                <span id="contact.send.text">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"band_id == 1 ",attachment:["\n                        ",{type:"translate",nodelist:["Send message"]},"\n                    "]},{type:"else_ncondition",attachment:["\n                        ",{type:"translate",nodelist:["Send message to ",{type:"variable",name:"band_name",filters:[["h",[]]]},""]},"\n                    "]}]},"\n                </span>\n            </button>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"from_url ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_modal ",attachment:['\n                    <button type="button" name="contact.cancel" value="Cancel" id="contact.cancel"><span>',{type:"translate",nodelist:["cancel"]},"</span></button>\n                "]},{type:"else_ncondition",attachment:['\n                    <button type="button" name="contact.cancel" value="Cancel" id="contact.cancel"><span>',{type:"translate",nodelist:["go back"]},"</span></button>\n                "]}]},"\n            "]}]},"\n        </dd>\n    </dl>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/contact_form_verification.liquid","warn"):Templ.register({contact_form_verification:['<div class="contact-verification">\n    <div class="contact-verification-img">\n        <img src="/img/blue-checkmark.svg">\n    </div>\n    <div class="contact-verification-message">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"to_support ",attachment:["\n            <h1>",{type:"translate",nodelist:["Thank you for your message!"]},"</h1>\n            <p>",{type:"translate",nodelist:["We have received it and will email you a response as soon as we can."]},"</p>\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"from_order_details ",attachment:["\n                <h1>",{type:"translate",nodelist:["Your message was sent to ",{type:"translateVariable",var_name:"band_name",nodelist:[{type:"variable",name:"band_name",filters:[["h",[]]]}]}," and a copy of it was sent to your email."]},"</h1>\n            "]},{type:"else_ncondition",attachment:["\n                <h1>",{type:"translate",nodelist:["Your message was sent to ",{type:"translateVariable",var_name:"band_name",nodelist:[{type:"variable",name:"band_name",filters:[["h",[]]]}]},"."]},"</h1>\n            "]}]},"\n            <p>\n                <span>",{type:"translate",nodelist:["Please allow 5-7 business days for a response."]},"</span>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"from_order_details ",attachment:['\n                    <br>\n                    <a href="/help/physical_orders#not-received" target="_blank" class="contact-verification-cancel">',{type:"translate",nodelist:["What to do if you dont get a response."]},"</a>\n                "]}]},"\n            </p>\n        "]}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"return_url ",attachment:['\n            <p>\n                <a href="',{type:"variable",name:"return_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["Return to Bandcamp"]},"</a>\n            </p>\n        "]}]},"\n    </div>\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/contact_support_alert.liquid","warn"):Templ.register({contact_support_alert:["\n",{type:"capture",to:"greeting",nodelist:["\n    ",{type:"case",blocks:[{type:"condition",left:"banner_msg",right:"1",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Hello from Bandcamp Support!"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"2",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Hello from Bandcamp Support!"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"3",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Hello from Bandcamp Support!"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"4",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Hey there!"]},"\n    "],child_relation:null,child_condition:null}]},"\n"]},"\n\n",{type:"capture",to:"body",nodelist:["\n    ",{type:"case",blocks:[{type:"condition",left:"banner_msg",right:"1",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Were experiencing an unusually high volume of emails."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"2",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Our support team is traveling from far and wide to meet up and work through ways to make the Bandcamp experience even better."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"3",operator:"==",attachment:["\n            &nbsp; &nbsp;",{type:"translate",nodelist:["Most of our support team is on holiday observing end-of-year festivities."]},"&nbsp; &nbsp;\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"4",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Were experiencing an unusually high volume of emails from our fundraisers this summer and our responses may take an extra few days."]},"\n    "],child_relation:null,child_condition:null}]},"\n"]},"\n\n",{type:"capture",to:"closing",nodelist:["\n    ",{type:"case",blocks:[{type:"condition",left:"banner_msg",right:"1",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["We humbly ask that you give us an extra day or two to respond to your message."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"2",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please allow us an extra day or two to reply to your message."]},"\n    "],child_relation:null,child_condition:null},{type:"condition",left:"banner_msg",right:"3",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please allow us an extra day or two to reply to your message."]},"\n    "],child_relation:null,child_condition:null}]},"\n"]},"\n\n",{type:"capture",to:"faq_text",nodelist:["\n    ",{type:"case",blocks:[{type:"condition",left:"banner_msg",right:"4",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Heres a list of <a ",{type:"translateVariable",var_name:"faq_url",nodelist:['href="https://get.bandcamp.help/hc/articles/360045411433"']},">common questions</a> that may help you in the meantime - power!"]},"\n        "],child_relation:null,child_condition:null},{type:"else_condition",attachment:["\n            ",{type:"translate",nodelist:["Check out our FAQs to see if you can <a ",{type:"translateVariable",var_name:"faq_url",nodelist:['href="',{type:"variable",name:"faq_url",filters:[["a",[]]]},'"']},">resolve any issues right now</a>. Power!"]},"\n    "]}]},"\n"]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"!popped_open && band_id == 1 && banner_msg ",attachment:["\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"modal ",attachment:['\n        <div id="contact-banner" class="modal">\n            <div class="contact-banner-img">\n                \n                <img src="/img/waving-hand.svg">\n            </div>\n            <div class="contact-banner-message">\n                <p class="contact-banner-message-header">\n                    <span>',{type:"variable",name:"greeting",filters:[]},"</span>\n                    <br>\n                    <strong>",{type:"variable",name:"body",filters:[]},"</strong>\n                </p>\n                <p>\n                    <span>",{type:"variable",name:"closing",filters:[]},"</span>\n                </p>\n            </div>\n        </div>\n    "]},{type:"else_ncondition",attachment:['\n        <div id="contact-banner" class="page">\n            <div class="contact-banner-img">\n                \n                <img src="/img/waving-hand.svg">\n            </div>\n            <div class="contact-banner-message">\n                <p>\n                    <span>',{type:"variable",name:"greeting",filters:[]},"</span>\n                    <strong>",{type:"variable",name:"body",filters:[]},"</strong>\n                    <span>",{type:"variable",name:"closing",filters:[]},"</span>\n                </p>\n            </div>\n        </div>\n    "]}]},"\n"]}]},'\n\n<p class="contact-banner-faq">\n    ',{type:"variable",name:"faq_text",filters:[]},"\n</p>\n"]});var MobileNavbar={scrollNavActive:function(){var e=$(".band-navbar-wrapper");if($("#band-navbar")[0].scrollWidth>$(e).width()){$(e).removeClass("flex");var t=$("#band-navbar").find(".active"),n=$(t).offset().left;n+t.parent().width()>$(e).width()&&$(e).scrollLeft(n)}else $(e).addClass("flex")}};$(document).ready((function(){window.MediaView&&"phone"==MediaView.mode&&$("#band-navbar").length&&MobileNavbar.scrollNavActive()}));var BubbleMessage=function(e,t){t||(t=2e3);var n=$('<div class="bubble-msg"><span class="bubble-msg-inner">'+e+"</span></div>");return n.appendTo(document.body).delay(150).fadeToggle("fast").delay(t).fadeOut("fast",null,(function(){$(this).remove()})),n.find(".bubble-msg-inner")};void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_signup_pane.liquid","warn"):Templ.register({"fan/signup/fan_signup_pane":['<form id="signup-vm" class=\'signup-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"show ",attachment:["visible"]}]},'\' data-bind=\'css: { "visible": visible, "immediate": immediate }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        <div class="item dialog-body choose-your-url" data-bind="visible: loggedIn() && !showExistingArtist()" style="display: none;">\n            \x3c!-- ko switch --\x3e\n                \x3c!-- ko case: showLiveInviteAcceptArtistMsg() --\x3e\n                    ',{type:"translate",nodelist:["In order to accept your invitation, please first choose a URL for your new fan account:"]},"\n                \x3c!-- /ko --\x3e\n\n                \x3c!-- ko case: $else --\x3e\n                    ",{type:"translate",nodelist:["Please choose a URL for your fan account:"]},'\n                \x3c!-- /ko --\x3e\n            \x3c!-- /ko --\x3e\n        </div>\n\n        <div class="item dialog-body existing-artist-standalone" data-bind="visible: showExistingArtist" style="display: none;">\n            <p>',{type:"translate",nodelist:["Greetings!"]},"</p>\n\n            <p>",{type:"translate",nodelist:["Fan accounts let you follow other artists and fans, give you instant streaming of your purchases via the free Bandcamp app, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['target="_blank" href="/fans"']},">lots more</a>."]},"</p>\n            \n            <p>",{type:"translate",nodelist:["<strong>To add a Bandcamp fan account to your artist account, enter a fan URL below.</strong> If you prefer to keep your fan account separate from your artist account, please log out and return to sign up."]},'</p>\n        </div>\n\n        <div class="item dialog-body signup-prompt" data-bind="visible: showGiftCardPrompt" style="display: none;">\n            <p>',{type:"translate",nodelist:["Please sign up to continue your gift card purchase:"]},'<p>\n        </div>\n\n        <div class="skinny">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"download_item ",attachment:['\n                <div class="download-item-small-space-saver">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"rendered ",attachment:["\n                    ",{type:"include",template_name:"'account/download_item_small'"},"\n                "]}]},"\n                </div>\n            "]}]},'\n            <div class="before-chooser" data-bind="css: { \'disabled\': chooserVisible }">\n                <div class="existing-account-wrapper" data-bind="css: { \'show-existing\': inlineLoginVisible }">\n                    <div class="item" data-bind="visible: !loggedIn()" ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:['style="display: none;"']}]},">\n                        ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['<label for="email-input" class="email-label">',{type:"translate",nodelist:["Email address"]},"</label>"]}]},'\n                        <div class="email">\n                            <div class="email-inner jquery-placeholder-wrapper">\n                                <input id="email-input" class="email-input" type="email" data-bind="\n                                    value: email,\n                                    hasfocus: email.focused,\n                                    valueUpdate: [\'input\', \'afterkeydown\'],\n                                    css: {\n                                        \'has-validation-error\': email.error_msg(),\n                                        \'error\': email.error_msg()\n                                    },\n                                    enable: !chooserVisible() && !disableEmailField()\n                                " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"translate",nodelist:["email"]},'"']}]},' disabled>\n                            </div>\n                            <span data-bind="visible: email.checking" style="display: none;">\n                                \x3c!-- <img class="email-checking" src="/img/playerbusy_transp.gif"> --\x3e\n                            </span>\n                            <div class="error-bubble log-in-error" style="display: none;" data-bind="animateVisible: email.error_key() === \'existing_fan\'"><span class="message">',{type:"translate",nodelist:["A fan with that email address already exists. Please <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: function () { openLogin(true); }"']},">log in</a>."]},'</span></div>\n                            <div class="error-bubble" style="display: none;" data-bind="animateVisible: email.error_key() === \'fan_already_linked_email\'"><span class="message">',{type:"translate",nodelist:["That address is attached to an existing fan account, but is not the primary address used for login. Please <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: function () { openLogin(true); }"']},">log in</a> with your primary address."]},'</span></div>\n                            <div class="error-bubble" style="display: none;" data-bind="animateVisible: email.error_key() === \'invalid\'"><span class="message">',{type:"translate",nodelist:["That email address doesnt look right."]},'</span></div>\n                        </div>\n                    </div>\n\n                    <div data-bind="css: { \'show\': inlineLoginVisible }" class="existing-account-login">\n                        <div class="account-message">\n                            <p>\n                            <strong>',{type:"translate",nodelist:["This address is associated with an existing artist account."]},"</strong>\n                            ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["</p><p>"]}]},"\n                            ",{type:"translate",nodelist:["To add a Bandcamp fan account to your artist account, enter your password below. If you prefer to keep your fan account separate from your artist account, enter a different email address above."]},"</p>\n                            <p>",{type:"translate",nodelist:["Fan accounts let you follow other artists and fans, give you instant streaming of your purchases via the free Bandcamp app, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['href="/fans"']},">lots more</a>."]},'</p>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="item" data-bind="visible: !loggedIn()" ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:['style="display: none;"']}]},">\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['<label for="password-input" class="password-label">\n                        <span>\n                            ',{type:"translate",nodelist:["Password"]},"\n                        </span>\n                    </label>"]}]},'\n                    <div class="password" data-bind="visible: !passwordMasked()">\n                        <div class="password-inner jquery-placeholder-wrapper">\n                            <input id="password-input" type="password" class="password-input" data-bind="\n                                value: password,\n                                errorBubble: password.error_msg,\n                                valueUpdate: \'input\',\n                                hasfocus: password.focused,\n                                css: {\n                                    \'has-validation-error\': password.error_msg()\n                                },\n                                enable: !chooserVisible()\n                            " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"translate",nodelist:["password"]},'"']}]},' disabled autocomplete="new-password">\n                        </div>\n                        <div class="error-bubble" style="display: none;">\n                            <span class="message"></span>\n                            <span data-bind=\'visible: password.error_key() === "incorrect"\' style="display: none;">\n                                \x3c!-- <a data-bind="click: function() { openForgotPassword(); }">forgot your password?</a> --\x3e\n                                <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/forgot_password">',{type:"translate",nodelist:["Forgot your password?"]},'</a>\n                            </span>\n                        </div>\n                    </div>\n                    <div class="password masked" data-bind="visible: passwordMasked" style="display: none;">\n                        &bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;\n                    </div>\n                </div>\n\n                ',{type:"capture",to:"placeholder",nodelist:[{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:[{type:"translate",nodelist:["choose your fan URL"]}]},{type:"else_ncondition",attachment:[{type:"translate",nodelist:["username"]}]}]}]},"\n\n                ",{type:"capture",to:"username_label",nodelist:[{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:[{type:"translate",nodelist:["Choose your fan URL"]}]},{type:"else_ncondition",attachment:[{type:"translate",nodelist:["Username"]}]}]}]},'\n\n                <div class="item ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:["existing-artist"]}]},'" data-bind="css: { \'existing-artist\': loggedIn }">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['<label for="username-input" class="username-label" data-bind="text: username.label, css: { \'artist-email\': inlineLoginVisible }">',{type:"variable",name:"username_label",filters:[]},"</label>"]}]},'\n                    <div class="username" data-bind="css: { \'artist-email\': inlineLoginVisible }">\n                        <div class="username-inner jquery-placeholder-wrapper">\n                            <div class="bandcamp-com"><span>bandcamp.com/</span></div><input id="username-input" type="text" class="username-input" data-bind="\n                                value: username.display,\n                                valueUpdate: \'input\',\n                                hasfocus: username.focused,\n                                css: {\n                                    \'has-validation-error\': username.error_msg(),\n                                    \'error\': username.error_msg()\n                                },\n                                enable: !chooserVisible()',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:[",\n                                attr: {\n                                    'placeholder': username.placeholder\n                                }"]}]},'\n                            " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"variable",name:"placeholder",filters:[]},'"']}]},' disabled autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">\n                        </div>\n                        <div class="error-bubble" style="display: none;" data-bind="animateVisible: usernameIsURL() && username.error_key()">\n                            <span class="message" data-bind="visible: username.error_key() === \'missing\'">\n                                ',{type:"translate",nodelist:["Please choose your URL."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'tooShort\'">\n                                ',{type:"translate",nodelist:["Your URL must be at least 3 characters."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'tooLong\'">\n                                ',{type:"translate",nodelist:["Your URL can be at most 60 characters."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'duplicate\'">\n                                ',{type:"translate",nodelist:["That URL is already taken."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'invalid\'">\n                                ',{type:"translate",nodelist:["Your URL must only contain letters, numbers, dashes, or underscores."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'undies\'">\n                                ',{type:"translate",nodelist:["Your URL must contain at least one letter, number, or dash."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'isEmail\'">\n                                ',{type:"translate",nodelist:["Your URL cannot be an email address."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'existingFanLoggedIn\'">\n                                ',{type:"translate",nodelist:["A fan with that email address already exists. Please <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout?login=1"']},">log in</a>."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'fanAlreadyLinkedEmail\'">\n                                ',{type:"translate",nodelist:["That address is attached to an existing fan account, but is not the primary address used for login. Please <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout?login=1"']},">log in</a> with your primary address."]},'\n                            </span>\n\n                            <span data-bind="visible: suggestedUsername">',{type:"translate",nodelist:["How about ",{type:"translateVariable",var_name:"suggested_username",nodelist:['<strong><a href="#" data-bind="text: suggestedUsername, click: function () { useSuggestedUsername(); }"></a></strong>']},"?"]},'</span>\n                        </div>\n                        <div class="error-bubble" style="display: none;" data-bind="animateVisible: !usernameIsURL() && username.error_key()">\n                            <span class="message" data-bind="visible: username.error_key() === \'missing\'">\n                                ',{type:"translate",nodelist:["Please choose your username."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'tooShort\'">\n                                ',{type:"translate",nodelist:["Your username must be at least 3 characters."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'tooLong\'">\n                                ',{type:"translate",nodelist:["Your username can be at most 60 characters."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'duplicate\'">\n                                ',{type:"translate",nodelist:["That username is already taken."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'invalid\'">\n                                ',{type:"translate",nodelist:["Your username must only contain letters, numbers, dashes, or underscores."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'undies\'">\n                                ',{type:"translate",nodelist:["Your username must contain at least one letter, number, or dash."]},'\n                            </span>\n                            <span class="message" data-bind="visible: username.error_key() === \'isEmail\'">\n                                ',{type:"translate",nodelist:["Your username cannot be an email address."]},'\n                            </span>\n\n                            <span data-bind="visible: suggestedUsername">',{type:"translate",nodelist:["How about ",{type:"translateVariable",var_name:"suggested_username",nodelist:['<strong><a href="#" data-bind="text: suggestedUsername, click: function () { useSuggestedUsername(); }"></a></strong>']},"?"]},'</span>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="item">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"signup_params.save_card ",attachment:["\n                    <div class=\"save-card\">\n                        <div class='save-card-inner jquery-placeholder-wrapper'>\n                            ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n                            <div class="fancy-checkbox" data-bind="css: { \'checked\': saveCard }">\n                                <input type="checkbox" value="None" id="save-card-input" data-bind="\n                                    checked: saveCard,\n                                    enable: !chooserVisible()\n                                " disabled>\n                                <label for="save-card-input"></label>\n                            </div>\n                            ']},{type:"else_ncondition",attachment:['\n                            <input id="save-card-input" type="checkbox" class="save-card-input" data-bind="\n                                checked: saveCard,\n                                enable: !chooserVisible()\n                            " disabled>\n                            ']}]},'\n                            <label for="save-card-input" class="save-card-label">\n                                <span class=\'terms-text\'>\n                                    ',{type:"translate",nodelist:["Remember my card for faster checkout."]},"\n                                </span>\n                            </label>\n                        </div>\n                    </div>\n                    "]}]},"\n\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"show_notify_me ",attachment:['\n                    <div class="notify-me-container">\n                        <div class="first">\n                            <label for="notify-me-band" class="notify-me">\n                                <input id="notify-me-band" name="notify-me-band" type="checkbox" data-bind="checked: notifyMeBand" class="notify-me-checkbox">\n                                <div class="notify-me-message">',{type:"translate",nodelist:["Add me to the mailing list for ",{type:"translateVariable",var_name:"seller",nodelist:[{type:"variable",name:"artist",filters:[["h",[]]]}]},"."]},"</div>\n                            </label>\n                        </div>\n                        ",{type:"ef",blocks:[{type:"ncondition",expression:"label ",attachment:['\n                        <div>\n                            <label for="notify-me-label" class="notify-me">\n                                <input id="notify-me-label" name="notify-me-label" type="checkbox" data-bind="checked: notifyMeLabel" class="notify-me-checkbox">\n                                <div class="notify-me-message">',{type:"translate",nodelist:["Add me to the mailing list for ",{type:"translateVariable",var_name:"seller",nodelist:[{type:"variable",name:"label",filters:[["h",[]]]}]},"."]},"</div>\n                            </label>\n                        </div>\n                        "]}]},"\n                    </div>\n                    "]}]},"\n\n                    <div class=\"tos\">\n                        <div class='tos-inner jquery-placeholder-wrapper'>\n                            ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n                            <div class="fancy-checkbox" data-bind="css: { \'checked\': tos }">\n                                <input type="checkbox" value="None" id="tos-input" data-bind="\n                                    checked: tos,\n                                    css: {\n                                        \'has-validation-error\': tos.error_msg()\n                                    },\n                                    enable: !chooserVisible()\n                                " disabled>\n                                <label for="tos-input"></label>\n                            </div>\n                            ']},{type:"else_ncondition",attachment:['\n                            <input id="tos-input" type="checkbox" class="tos-input" data-bind="\n                                checked: tos,\n                                css: {\n                                    \'has-validation-error\': tos.error_msg()\n                                },\n                                enable: !chooserVisible()\n                            " disabled>\n                            ']}]},'\n                            <label for="tos-input" class="tos-label">\n                                <span class=\'terms-text\'>\n                                    ',{type:"translate",nodelist:["I have read and agree to the <a ",{type:"translateVariable",var_name:"link",nodelist:["href='/terms_of_use' target='_blank'"]},">Terms of Use</a>."]},'\n                                </span>\n                            </label>\n                        </div>\n                        <div class="error-bubble" style="display: none;" data-bind="visible: tos.error_msg"><span class="message" data-bind="text: tos.error_msg"></span></div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="item" data-bind="animateVisible: chooserVisible, animationType: \'slide\'" style="display: none;">\n                <div class="chooser">\n                    <div class="chooser-message">',{type:"translate",nodelist:["Please choose an artist account to associate this fan account with:"]},'</div>\n                    <select data-bind="options: possibleUsers,\n                        optionsText: function(user) {\n                            return formatUser(user);\n                        },\n                        value: selectedUser\n                    "></select>\n                </div>\n            </div>\n\n            <div class="buttons" data-bind="css: { \'no-bottom-link\': !bottomLinkVisible() }">\n                <button class="submit" type=\'submit\' data-bind=\'enable: submitEnabled\'>\n                    <span data-bind="text: submitText">\n                        ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:["\n                            ",{type:"translate",nodelist:["Complete setup"]},"\n                        "]},{type:"else_ncondition",attachment:["\n                            ",{type:"translate",nodelist:["Sign up"]},"\n                        "]}]},'\n                    </span>\n                </button>\n            </div>\n\n            <div class="item" data-bind="visible: bottomLinkVisible" ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:['style="display: none;"']}]},'>\n                <div class="login-link hint">\n                    ',{type:"translate",nodelist:["Already have an account? <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: function() { openLogin(); }"']},">Log in</a>."]},"\n                </div>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['\n                <div class="artist-signup hint" data-bind="visible: artistSignupVisible" ',{type:"ef",blocks:[{type:"ncondition",expression:"pagedata && pagedata.identities && pagedata.identities.user ",attachment:['style="display: none;"']}]},">\n                    ",{type:"translate",nodelist:["Are you an artist? <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/signup"']},">Sign up for an artist account</a>."]},"\n                </div>\n                "]}]},"\n            </div>\n        </div>\n        </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_login_pane.liquid","warn"):Templ.register({"fan/signup/fan_login_pane":['<form id="signup-vm" class=\'login-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"show ",attachment:["visible"]}]},'\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        <div class="before-chooser" data-bind="css: { \'disabled\': userChooserVisible }">\n            <div class="item">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone && !portable ",attachment:['<label for="email-input" class="email-label">',{type:"translate",nodelist:["Username / email"]},"</label>"]}]},'\n                <div class="email">\n                    <div class="email-inner jquery-placeholder-wrapper">\n                        <input id="email-input" type="email" class="email-input" data-bind="\n                            value: email,\n                            errorBubble: email.error_msg,\n                            valueUpdate: \'input\',\n                            hasfocus: email.focused,\n                            css: {\n                                \'has-validation-error\': email.error_msg()\n                            }\n                        " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone || portable ",attachment:['placeholder="',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:[{type:"translate",nodelist:["username / email"]}]},{type:"else_ncondition",attachment:[{type:"translate",nodelist:["Username / email"]}]}]},'"']}]},'>\n                    </div>\n                    <div class="error-bubble" style="display: none;"><span class="message"></span></div>\n                </div>\n            </div>\n\n            <div class="item pass">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone && !portable ",attachment:['<label for="password-input" class="password-label">',{type:"translate",nodelist:["Password"]},"</label>"]}]},'\n                <div class="password">\n                    <div class="password-inner jquery-placeholder-wrapper">\n                        <input id="password-input" type="password" class="password-input" data-bind="\n                            value: password,\n                            errorBubble: password.error_msg,\n                            valueUpdate: \'input\',\n                            hasfocus: password.focused,\n                            css: {\n                                \'has-validation-error\': password.error_msg()\n                            }\n                        " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone || portable ",attachment:['placeholder="',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:[{type:"translate",nodelist:["password"]}]},{type:"else_ncondition",attachment:[{type:"translate",nodelist:["Password"]}]}]},'"']}]},'>\n                    </div>\n                    <div class="error-bubble" style="display: none;"><span class="message"></span></div>\n                </div>\n            </div>\n\n            <div class="two-factor" data-bind="animateVisible: twofactorVisible, animationType: \'slide\'" style="display: none;">\n                <div class="two-factor-heading-item">',{type:"translate",nodelist:["Please enter your two-factor authentication code below:"]},'</div>\n\n                <div class="item">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone && !portable ",attachment:['<label for="two-factor-code-input" class="two-factor-code-label">',{type:"translate",nodelist:["Code"]},"</label>"]}]},'\n                    <div class="two-factor-code">\n                        <div class="two-factor-code-inner jquery-placeholder-wrapper">\n                            <input id="two-factor-code-input" type="text" class="two-factor-code-input" data-bind="\n                                value: twofactor,\n                                errorBubble: twofactor.error_msg,\n                                valueUpdate: \'input\',\n                                hasfocus: twofactor.focused,\n                                css: {\n                                    \'has-validation-error\': twofactor.error_msg()\n                                }\n                            " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"translate",nodelist:["code"]},'"']}]},'>\n                        </div>\n                        <div class="error-bubble"><span class="message"></span></div>\n                    </div>\n                </div>\n\n                <div class="item two-factor-remember-wrapper">\n                    <div class="item-inner two-factor-remember">\n                        ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n                        <div class="fancy-checkbox">\n                            <input id="two-factor-remember-input" type="checkbox" class="two-factor-remember-input" data-bind="\n                                checked: twofactorRemember,\n                                valueUpdate: \'input\'\n                            ">\n                            <label for="two-factor-remember-input"></label>\n                        </div>\n                        ']},{type:"else_ncondition",attachment:['\n                        <input id="two-factor-remember-input" type="checkbox" class="two-factor-remember-input" data-bind="\n                            checked: twofactorRemember,\n                            valueUpdate: \'input\'\n                        ">\n                        ']}]},'\n                        <label for="two-factor-remember-input" class="two-factor-remember-label">',{type:"translate",nodelist:["Remember this computer for 30 days"]},'</label>\n                        <div class="error-bubble"><span class="message"></span></div>\n                    </div>\n                </div>\n\n                <div class="no-phone" data-bind="visible: !twofactorHelpVisible()">\n                    <a data-bind="click: showTwoFactorHelp">',{type:"translate",nodelist:["Help! I cant access my phone!"]},'</a>\n                </div>\n            </div>\n\n            <div class="item two-factor-help" data-bind="animateVisible: twofactorHelpVisible, animationType: \'slide\'" style="display: none;">\n                <h3>',{type:"translate",nodelist:["I dont have my phone on me right now"]},'</h3>\n                <div class="help-text">\n                    ',{type:"translate",nodelist:["If you dont currently have access to your phone, youll need to log in using one of your backup codes. Enter one of your backup codes in the box above and log in as usual."]},'\n                </div>\n                <div class="help-text">\n                    ',{type:"translate",nodelist:["Each backup code can only be used once, so once youve logged in, you should open your two-factor authentication settings (within your user settings) and generate a fresh set of backup codes if youre running short."]},"\n                </div>\n                \n                <h3>",{type:"translate",nodelist:["Ive lost or replaced my phone"]},'</h3>\n                <div class="help-text">\n                    ',{type:"translate",nodelist:['Once youve logged in using a backup code as above, open your two-factor authentication settings and click the "Add another authentication method" link to add your new device.']},'\n                </div>\n            </div>\n        </div>\n\n        <div class="item" data-bind="animateVisible: userChooserVisible, animationType: \'slide\'" style="display: none;">\n            <div class="chooser">\n                <div class="chooser-message">',{type:"translate",nodelist:["Please choose an account:"]},'</div>\n                <select data-bind="options: possibleUsers,\n                    optionsText: function(user) {\n                        return formatUser(user);\n                    },\n                    value: selectedUser\n                "></select>\n            </div>\n        </div>\n\n        <div class="buttons">\n            <button class="submit" type="submit" data-bind="enable: submitEnabled">\n                <div data-bind="visible: !submitting()">',{type:"translate",nodelist:["Log in"]},'</div>\n                <div data-bind="visible: submitting()" style="display: none;">',{type:"translate",nodelist:["Please wait"]},'&hellip;</div>\n            </button>\n        </div>\n\n        <div class="forgot-password-wrapper">\n            <div class="forgot-password">\n                \x3c!-- <a href="#" data-bind="click: function() { forgotPassword(); }">Forgot your password?</a> --\x3e\n                <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/forgot_password">',{type:"translate",nodelist:["Forgot your password?"]},'</a>\n            </div>\n\n            <div class="change-email">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["Sign up as <a ",{type:"translateVariable",var_name:"fan_link",nodelist:['href="#" data-bind="click: function() { backToSignup(); }"']},">a fan</a>, <a ",{type:"translateVariable",var_name:"artist_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/signup"']},">an artist</a> or <a ",{type:"translateVariable",var_name:"label_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/labels"']},">a label</a>."]},"\n                "]},{type:"ncondition",expression:"fan_signup_only ",attachment:["\n                    ",{type:"translate",nodelist:["Dont have an account? <a ",{type:"translateVariable",var_name:"fan_link",nodelist:['href="#" data-bind="click: function() { backToSignup(); }"']},">Sign up as a fan</a>."]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Dont have an account? Sign up as <a ",{type:"translateVariable",var_name:"fan_link",nodelist:['href="#" data-bind="click: function() { backToSignup(); }"']},">a fan</a>, <a ",{type:"translateVariable",var_name:"artist_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/signup"']},">an artist</a> or <a ",{type:"translateVariable",var_name:"label_link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/labels"']},">a label</a>."]},"\n                "]}]},"\n            </div>\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_forgot_password_pane.liquid","warn"):Templ.register({"fan/signup/fan_forgot_password_pane":['<form id="signup-vm" class=\'forgot-password-form modern-form signup-common-form\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        <div data-bind="visible: !sent()">\n\n            <div class="item heading-item">\n                ',{type:"translate",nodelist:["Enter your email address below to reset your password:"]},'\n            </div>\n\n            <div class="item">\n                <div class="email">\n                    <div class="email-inner jquery-placeholder-wrapper">\n                        <input id="email-input" class="email-input" type="email" data-bind="\n                            value: email,\n                            valueUpdate: \'input\',\n                            errorBubble: email.error_msg\n                        " placeholder="',{type:"translate",nodelist:["Email address"]},'">\n                    </div>\n                    <div class="error-bubble"><span class="message"></span></div>\n                </div>\n            </div>\n\n            <div class="buttons">\n                <button class="submit" type="submit" data-bind="click: submit, disable: submitDisabled" disabled>\n                    ',{type:"translate",nodelist:["Send"]},'\n                </button>\n            </div>\n\n            <div class="change-email">\n                <a href="#" data-bind="click: function() { backToSignup(); }">',{type:"translate",nodelist:["Back to signup."]},'</a>\n            </div>\n        </div>\n\n        <div data-bind="visible: sent">\n            <div class="done">\n                ',{type:"translate",nodelist:["Thanks! Weve sent a password reset email to ",{type:"translateVariable",var_name:"email_addr",nodelist:['<span data-bind="text: email"></span>']},"."]},"\n            </div>\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_reset_password_pane.liquid","warn"):Templ.register({"fan/signup/fan_reset_password_pane":['<form id="signup-vm" class=\'signup-form modern-form\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        \x3c!-- ko if: unrecoverableError() --\x3e\n            <div class="item">\n                ',{type:"translate",nodelist:["Something is wrong and we cant reset your password. Here are some ideas for what\n                might be happening:"]},"\n                <ul>\n                    <li>\n                        ",{type:"translate",nodelist:["More than twenty-four hours has passed since you requested a password reset.\n                        For security, we limit the amount of time a password reset email can\n                        be used."]},"  \n                    </li>\n                    <li>\n                        ",{type:"translate",nodelist:["You clicked on a link in the reset password email, but the entire URL\n                        didnt make it through. Try copying the URL out of your email client\n                        and pasting it in the browsers location field."]},"\n                    </li>\n                    <li>\n                        ",{type:"translate",nodelist:["Youve already reset your password using this URL, or the URL from another email."]},'\n                    </li>\n                </ul>\n            </div>\n        \x3c!-- /ko --\x3e\n\n        \x3c!-- ko if: !unrecoverableError() && !reset() --\x3e\n            <div class="item heading-item">\n                ',{type:"translate",nodelist:["Please enter a new password below."]},'\n            </div>\n\n            <div class="divider"></div>\n\n            <div class="item">\n                <label for="password-input" class="password-label">\n                    ',{type:"translate",nodelist:["Password:"]},'\n                </label>\n                <div class="password">\n                    <div class="password-inner jquery-placeholder-wrapper">\n                        <input id="password-input" class="password-input" type="password" data-bind="\n                            value: password,\n                            valueUpdate: \'input\',\n                            errorBubble: password.error_msg\n                            ">\n                    </div>\n                    <div class="error-bubble"><span class="message"></span></div>\n                </div>\n            </div>\n\n            <div class="buttons">\n                <button class="submit" type="submit" data-bind="click: submit, disable: submitDisabled">',{type:"translate",nodelist:["Reset"]},"</button>\n            </div>\n        \x3c!-- /ko --\x3e\n\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_existing_artist_pane.liquid","warn"):Templ.register({"fan/signup/fan_existing_artist_pane":['<form id="signup-vm" class=\'existing-artist-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"show ",attachment:["visible"]}]},'\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n    <div class="signup-common-inner">\n        <div class="dialog-body">\n            <p class="greetings">',{type:"translate",nodelist:["Greetings!"]},"</p>\n            <p>\n            ",{type:"case",blocks:[{type:"condition",left:"action",right:"'live_ticket'",operator:"==",attachment:["\n                ",{type:"translate",nodelist:["You have a Bandcamp artist account. To attend this live event, youll need a Bandcamp fan account."]},"\n            "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'follow'",operator:"==",attachment:["\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:'!action_item_type || action_item_type == \'b\' || action_item_type == "album" || action_item_type == "track" ',attachment:["\n                        ",{type:"translate",nodelist:["You have a Bandcamp artist account. To follow this artist, youll need a Bandcamp fan account."]},"\n                    "]},{type:"ncondition",expression:"action_item_type == 'f' ",attachment:["\n                        ",{type:"translate",nodelist:["You have a Bandcamp artist account. To follow this fan, youll need a Bandcamp fan account."]},"\n                    "]}]},"\n            "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'wishlist'",operator:"==",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!action_item_type || action_item_type == 'a' || action_item_type == 'album' ",attachment:["\n                    ",{type:"translate",nodelist:["You have a Bandcamp artist account. To complete wishlisting this album, youll need a Bandcamp fan account."]},"</p>\n                "]},{type:"ncondition",expression:"action_item_type == 't' || action_item_type == 'track' ",attachment:["\n                    ",{type:"translate",nodelist:["You have a Bandcamp artist account. To complete wishlisting this track, youll need a Bandcamp fan account."]},"\n                "]}]},"\n            "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'redeem'",operator:"==",attachment:["\n                ",{type:"translate",nodelist:["You have a Bandcamp artist account. To redeem this gift card, youll need a Bandcamp fan account."]},"\n            "],child_relation:null,child_condition:null}]},"\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"!action ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone && unsupported_device ",attachment:["\n                    ",{type:"translate",nodelist:["Fan accounts let you follow other artists and fans, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans"']},">lots more</a>."]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Fan accounts let you follow other artists and fans, give you instant streaming of your purchases via the free Bandcamp app, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans"']},">lots more</a>."]},"\n                "]}]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone && unsupported_device ",attachment:["\n                    ",{type:"translate",nodelist:["Fan accounts also let you follow other artists and fans, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans"']},">lots more</a>."]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Fan accounts also let you follow other artists and fans, give you instant streaming of your purchases via the free Bandcamp app, and <a ",{type:"translateVariable",var_name:"fanslink",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans"']},">lots more</a>."]},"\n                "]}]},"\n            "]}]},"\n            </p>\n\n            <p>",{type:"translate",nodelist:["Would you like your artist and fan account to be one and the same, or would you prefer to keep your fan account separate from your artist account?"]},"</p>\n        </div>\n\n        ",{type:"capture",to:"band_list",nodelist:[{type:"for",collection_name:"bands",nodelist:[{type:"variable",name:"band.band_name",filters:[["h",[]]]},{type:"ef",blocks:[{type:"ncondition",expression:"!forloop.last ",attachment:[", "]}]}],variable_name:"band",reversed:null,attribs:{}}]},'\n\n        <div class="buttons">\n            <button class="create-account" type="submit">\n                ',{type:"translate",nodelist:["Create my fan account as part of the <br>",{type:"variable",name:"user_name",filters:[["h",[]]]}," (",{type:"variable",name:"band_list",filters:[]},") artist account"]},"\n            </button>\n\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n            <button class="log-me-out" data-bind="click: logout">\n                ',{type:"translate",nodelist:["Log out of ",{type:"variable",name:"user_name",filters:[["h",[]]]}," and log in to an existing fan account, or create a new one"]},"\n            </button>\n            "]}]},"\n        </div>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['\n        <div class="or">',{type:"translate",nodelist:["or"]},'</div>\n\n        <div class="change-email">\n            <a href="#" data-bind="click: logout">',{type:"translate",nodelist:["Log out of ",{type:"variable",name:"user_name",filters:[["h",[]]]}," and log in to an existing fan account, or create a new one"]},"</a>\n        </div>\n        "]}]},"\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_almost_there_pane.liquid","warn"):Templ.register({"fan/signup/fan_almost_there_pane":['<form id="signup-vm" class=\'existing-artist-form modern-form signup-common-form\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        <div class="dialog-body">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"!portable && is_phone ",attachment:['\n                <div class="almost-there">',{type:"translate",nodelist:["Youre almost there!"]},"</div>\n            "]}]},'\n            <div class="almost-there-confirm">',{type:"translate",nodelist:["Please check ",{type:"translateVariable",var_name:"new_fan_email",nodelist:["<i>",{type:"variable",name:"email",filters:[["h",[]]]},"</i>"]},"<br> to activate your account."]},'</div>\n            <button class="almost-there-button">',{type:"translate",nodelist:["Got it"]},"</button>\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_welcome_pane.liquid","warn"):Templ.register({"fan/signup/fan_welcome_pane":[{type:"ef",blocks:[{type:"ncondition",expression:"is_phone && !portable ",attachment:["\n",{type:"include",template_name:"'svg_shared'"},'\n<form id="signup-vm" class=\'modern-form signup-common-form welcome-form',{type:"ef",blocks:[{type:"ncondition",expression:"signup_params.pane == 'welcome' ",attachment:[" visible"]}]},'\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <img class="welcome-banner" src="/img/bandcamp-mobile-banner-first-time2x.jpg">\n\n    <div class="signup-common-inner">\n        <div class="dialog-body">\n            <div class="welcome-fan">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"is_activation_view || signup_params.pane == 'welcome' ",attachment:["\n                    ",{type:"translate",nodelist:["Thanks. Your account is active!"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"is_band_member ",attachment:["\n                        ",{type:"translate",nodelist:["Welcome to your new, improved artist and fan account."]},"\n                    "]},{type:"else_ncondition",attachment:["\n                        ",{type:"translate",nodelist:["Welcome ",{type:"translateVariable",var_name:"fan_name",nodelist:[{type:"variable",name:"username",filters:[["h",[]]]}]},"!"]},"\n                    "]}]},"\n                "]}]},"\n            </div>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"unsupported_device ",attachment:['\n                <button class="welcome-collection-button">',{type:"translate",nodelist:["View your public collection"]},"</button>\n            "]},{type:"else_ncondition",attachment:['\n                <div class="welcome-message">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"action ",attachment:["\n                    ",{type:"translate",nodelist:["Get the free Bandcamp app, sign in and listen to your music now!"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Be sure to grab the free Bandcamp app:"]},"\n                "]}]},'\n                </div>\n                <div class="button-container">\n                    <a class="download-button blue-button" href=\'',{type:"variable",name:"platform_app_url",filters:[["a",[]]]},'\'>\n                        <div class="button-inner">\n                            <svg class="icon app-phone-logo" width="87px" height="76px" viewBox="0 0 43 37"><use xlink:href="#grab-app-opensignup"></svg>\n                            <div class="missing-app">',{type:"translate",nodelist:["Get the Bandcamp app!"]},"</div>\n                        </div>\n                    </a>\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"!action ",attachment:['\n                    <a class="listen-button no-action" href=\'',{type:"variable",name:"mobile_app_url",filters:[["a",[]]]},'\'>\n                        <div class="button-inner">\n                            <div class="app-play-text">',{type:"translate",nodelist:["I have the app! Launch now."]},"</div>\n                        </div>\n                    </a>\n                    "]},{type:"else_ncondition",attachment:['\n                    <a class="listen-button" href=\'',{type:"variable",name:"mobile_app_url",filters:[["a",[]]]},'\'>\n                        <div class="button-inner">\n                            <svg class="icon app-play-logo" width="44px" height="60px" viewBox="0 0 44 60"><use xlink:href="#play-app"></svg>\n                            <div class="app-play-text">',{type:"translate",nodelist:["I have the app! Listen now."]},"</div>\n                        </div>\n                    </a>\n                    "]}]},"\n                </div>\n            "]}]},"\n        </div>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"!action ",attachment:['\n        <div class="no-action-links">\n            ',{type:"translate",nodelist:["\n            Alternatively, <a ",{type:"translateVariable",var_name:"profile_href",nodelist:['href="/',{type:"variable",name:"username",filters:[["h",[]]]},'"']},">view your profile</a><br>\n            or<br>\n            go to the <a ",{type:"translateVariable",var_name:"bandcamp_href",nodelist:['href="/"']},">Bandcamp homepage</a>.\n            "]},"\n        </div>\n        "]}]},"\n    </div>\n</form>\n"]},{type:"ncondition",expression:"portable && is_phone ",attachment:['\n<form id="signup-vm" class=\'modern-form signup-common-form welcome-form\' data-bind=\'css: { "visible": visible }\' novalidate>\n    <div class="modal-welcome-message">\n        <div>\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"is_band_member ",attachment:["\n                ",{type:"translate",nodelist:["Welcome to your new, improved artist<br> and fan account!"]},"\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!unsupported_device ",attachment:["\n                    ",{type:"translate",nodelist:["Be sure to get the free Bandcamp app:"]},"\n                "]}]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Welcome to your new fan account!"]},"<br>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!unsupported_device ",attachment:["\n                    ",{type:"translate",nodelist:["Grab the free Bandcamp app:"]},"\n                "]}]},"\n            "]}]},'\n        </div>\n    </div>\n    <div class="buttons">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"!unsupported_device ",attachment:['\n        <button class="login get-app" type="submit" data-bind="click: getApp">\n            ',{type:"translate",nodelist:["Get app"]},"\n        </button>\n        "]}]},'\n        <button class="ok-button ',{type:"ef",blocks:[{type:"ncondition",expression:"unsupported_device ",attachment:["unsupported"]}]},'" data-bind="click: submit">\n            ',{type:"translate",nodelist:["Close"]},"\n        </button>\n    </div>\n</form>\n"]},{type:"ncondition",expression:"portable ",attachment:['\n<form id="signup-vm" class=\'modern-form signup-common-form welcome-form\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <div class="modal-welcome-message">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"is_band_member ",attachment:["\n            ",{type:"translate",nodelist:["\n            Welcome to your new, improved artist and fan account!\n            "]},"\n\n            <br>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:'action == "follow" ',attachment:["\n                ",{type:"translate",nodelist:["\n                Click the feed link in the menu bar to view the latest releases from the artists you follow, and more.\n                "]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["\n                To view your wishlist, click the wishlist link in the menu bar.\n                "]},"\n            "]}]},"\n\n            <br>\n\n            ",{type:"translate",nodelist:["\n            Also, be sure to grab the free Bandcamp app for <a ",{type:"translateVariable",var_name:"ios_link",nodelist:['href="',{type:"variable",name:"app_store_url",filters:[["a",[]]]},'" target="_blank" ']},">iOS</a> or <a ",{type:"translateVariable",var_name:"android_link",nodelist:['href="',{type:"variable",name:"play_store_url",filters:[["a",[]]]},'"']},">Android</a>.\n            "]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["\n            Welcome to your new fan account!\n            "]},"\n\n            <br>\n            ",{type:"translate",nodelist:["\n            Be sure to grab the free Bandcamp app for <a ",{type:"translateVariable",var_name:"ios_link",nodelist:['href="',{type:"variable",name:"app_store_url",filters:[["a",[]]]},'" target="_blank" ']},">iOS</a> or <a ",{type:"translateVariable",var_name:"android_link",nodelist:['href="',{type:"variable",name:"play_store_url",filters:[["a",[]]]},'"']},">Android</a>.\n            "]},"\n            <br>\n        "]}]},'\n    </div>\n    <button class="almost-there-button">',{type:"translate",nodelist:["OK"]},"</button>\n</form>\n"]},{type:"else_ncondition",attachment:['\n<form id="signup-vm" class=\'welcome-form modern-form signup-common-form visible\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <div class="signup-common-inner">\n        <div class="welcome-inner">\n            <div class="welcome-phone">\n                <img src="img/phone-app-collection-welcome-1%402x.gif"></img>\n            </div>\n            <div class="welcome-app-promo">\n                <div>\n                    ',{type:"translate",nodelist:["\n                    We suggest you grab the free Bandcamp app from the App Store or Google Play Store.\n                    "]},'\n                </div>\n                <div class="welcome-app-button-container">\n                    <a href="',{type:"variable",name:"app_store_url",filters:[["a",[]]]},'" target="_blank"><div class="store-button app-store"></div></a>\n                    <a href="',{type:"variable",name:"play_store_url",filters:[["a",[]]]},'" target="_blank"><div class="store-button google-play-store"></div></a>\n                </div>\n                <div>\n                    ',{type:"translate",nodelist:["\n                    It gives you powerful ways to browse the music on Bandcamp, and unlimited streaming of your purchases. <a ",{type:"translateVariable",var_name:"email_href",nodelist:['data-bind="click: appLinkModal" href="#"']},">Email yourself a link</a> to the app (to open on your phone).\n                    "]},'\n                </div>\n                <button data-bind="enable: buttonEnabled">',{type:"translate",nodelist:["Right, whats next?"]},"</button>\n            </div>\n        </div>\n    </div>\n</form>\n"]}]},"\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_email_link.liquid","warn"):Templ.register({"fan/signup/fan_email_link":['<div class="welcome-email-app-link" data-bind="visible: appLinkSent()">\n    ',{type:"translate",nodelist:["\n    A link to download the Bandcamp app has been sent to ",{type:"translateVariable",var_name:"address",nodelist:['<strong><span data-bind="text: appLinkEmail"></span></strong>']},".\n    "]},'\n</div>\n<div class="welcome-app-email-buttons" data-bind="visible: !appLinkSent()">\n    <button data-bind="click: closeAppLinkModal" class="no-thanks" type="button">',{type:"translate",nodelist:["No Thanks"]},'</button>\n    <button data-bind="click: sendAppLinkEmail" class="send" type="button">',{type:"translate",nodelist:["Send"]},'</button>\n</div>\n<div class="welcome-app-email-buttons okay" data-bind="visible: appLinkSent()">\n    <button data-bind="click: closeAppLinkModal" class="okay" type="button" display="display: none">',{type:"translate",nodelist:["OK"]},"</button>\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_verify_nag_pane.liquid","warn"):Templ.register({"fan/signup/fan_verify_nag_pane":['<form id="nag-vm" class=\'modern-form signup-common-form action-form verify-nag visible\' data-bind=\'submit: submit\' novalidate>\n    <div data-bind="visible: !submitted()">\n        <div data-bind="visible: !changingEmail()">\n            <div class="nag-verify-text">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"email ",attachment:["\n                    ",{type:"translate",nodelist:["\n                    Please check ",{type:"translateVariable",var_name:"email",nodelist:['<div class="nag-fan-email" data-bind="text: fanEmail"></div><br>']}," to activate your account.\n                    "]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["\n                    Please check your email to activate your account.\n                    "]},"\n                "]}]},"\n            </div>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"email ",attachment:['\n            <a class="nag-email-change" data-bind="click: changeEmail">',{type:"translate",nodelist:["change email / send again"]},"</a>\n            "]}]},'\n            <div class="nag-buttons',{type:"ef",blocks:[{type:"ncondition",expression:"!email ",attachment:[" no-email"]}]},'">\n                <button class="nag-got-it">',{type:"translate",nodelist:["Got it"]},'</button>\n            </div>\n        </div>\n        <div data-bind="visible: changingEmail()">\n             <div class="nag-verify-text">\n                ',{type:"translate",nodelist:["\n                Please enter your email address:\n                "]},'\n            </div>\n            <div class="nag-email-input">\n                <input type="text" data-bind="css: {\'error\': emailError}, value: fanEmail"></input>\n                <div class="error-bubble" style="display: none" data-bind="visible: alreadyAFanError">',{type:"translate",nodelist:["A fan with that email address already exists."]},'</div>\n                <div class="error-bubble" style="display: none" data-bind="visible: fanAlreadyLinkedEmailError">',{type:"translate",nodelist:["That address is attached to an existing fan account, but is not the primary address used for login."]},'</div>\n                <div class="error-bubble" style="display: none" data-bind="visible: invalidEmailError">',{type:"translate",nodelist:["That email address doesnt look right."]},'</div>\n            </div>\n            <div class="nag-buttons">\n                <button class="nag-send-again">',{type:"translate",nodelist:["Send again"]},'</button>\n                <button class="nag-cancel login" data-bind="click: cancel">',{type:"translate",nodelist:["Cancel"]},'</button>\n            </div>\n        </div>\n    </div>\n    <div data-bind="visible: submitted()" style="display: none">\n        <div class="nag-email-sent">\n            ',{type:"translate",nodelist:["\n            Email sent!\n            "]},'\n        </div>\n        <button class="nag-done">',{type:"translate",nodelist:["Done"]},"</button>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_dupe_fan_pane.liquid","warn"):Templ.register({"fan/signup/fan_dupe_fan_pane":['<form id="signup-vm" class=\'dupe-fan-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"show ",attachment:["visible"]}]},'\' data-bind=\'css: { "visible": visible }, submit: submit\' novalidate>\n    <a id="signup-anchor"></a>\n    <div class="signup-common-inner">\n        <div class="dialog-body">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan ",attachment:["\n            <p>",{type:"translate",nodelist:["Hello! Your email address <strong>",{type:"variable",name:"email",filters:[["h",[]]]},"</strong><br> is already linked to a fan account."]},"</p>\n\n            <p>",{type:"translate",nodelist:["Please either <a ",{type:"translateVariable",var_name:"logout_link",nodelist:[' href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout?login=1"']},">log out and log in as the fan linked to this address</a> or <a ",{type:"translateVariable",var_name:"change_link",nodelist:[' href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/settings"']},">change your address</a> to create a new fan account."]},"</p>\n        "]},{type:"ncondition",expression:"fan_already_linked_email ",attachment:["\n            <p>",{type:"translate",nodelist:["Hello! Your email address <strong>",{type:"variable",name:"email",filters:[["h",[]]]},"</strong> is attached to an existing fan account, but is not the primary address used for login."]},"</p>\n\n            <p>",{type:"translate",nodelist:["Please either <a ",{type:"translateVariable",var_name:"logout_link",nodelist:[' href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout?login=1"']},">log out and log in as the fan linked to this address</a> or <a ",{type:"translateVariable",var_name:"change_link",nodelist:[' href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/settings"']},">change your address</a> to create a new fan account."]},"</p>\n        "]}]},"\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_choose_account_pane.liquid","warn"):Templ.register({"fan/signup/fan_choose_account_pane":['<form id="signup-vm" class=\'choose-account-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"signup_params.standalone ",attachment:["standalone"]}]},'\' data-bind=\'css: { "visible": visible }\' novalidate>\n    <ul class="accounts-list">\n        <li class="fan account">\n            <div class="icon"></div>\n            <div class="description">\n                <a class="signup-button open-fan-signup" \n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"signup_params.standalone ",attachment:['\n                        href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/fan_signup?from=",{type:"variable",name:"fans_from",filters:[["h",[]]]},'">\n                    ']},{type:"else_ncondition",attachment:['\n                        href="#" data-bind="click: openFanSignup">\n                    ']}]},"\n                    ",{type:"translate",nodelist:["Sign up as a fan"]},'\n                </a>\n                <div class="text">\n                    ',{type:"translate",nodelist:["Follow your favorite artists, keep a wishlist, get instant streaming of your purchases, showcase your collection, and explore the music of like-minded fans. <a ",{type:"translateVariable",var_name:"link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/fans?from=",{type:"variable",name:"fans_from",filters:[["h",[]]]},'"']},">learn more</a>"]},'\n                </div>\n            </div>\n        </li>\n        <li class="artist account">\n            <div class="icon"></div>\n            <div class="description">\n                <a class="signup-button" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/artists?from=",{type:"variable",name:"artists_from",filters:[["h",[]]]},'">',{type:"translate",nodelist:["Sign up as an artist"]},'</a>\n                <div class="text">\n                    ',{type:"translate",nodelist:["Sell directly to your fans with total control over your music and pricing. Easy access to your customers data, real-time stats, music chart reporting, and more. <a ",{type:"translateVariable",var_name:"link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/artists?from=",{type:"variable",name:"artists_from",filters:[["h",[]]]},'"']},">learn more</a>"]},'\n                </div>\n            </div>\n        </li>\n        <li class="label account">\n            <div class="icon"></div>\n            <div class="description">\n                <a class="signup-button" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/labels?from=",{type:"variable",name:"labels_from",filters:[["h",[]]]},'">',{type:"translate",nodelist:["Sign up as a label"]},'</a>\n                <div class="text">\n                    ',{type:"translate",nodelist:["Unified accounting and stats across all your artists, a single fulfillment interface for all your merch, direct payments on a per-release basis, and a whole lot more. <a ",{type:"translateVariable",var_name:"link",nodelist:['href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/labels?from=",{type:"variable",name:"labels_from",filters:[["h",[]]]},'"']},">learn more</a>"]},"\n                </div>\n            </div>\n        </li>\n    </ul>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_genre_picker_pane.liquid","warn"):Templ.register({"fan/signup/fan_genre_picker_pane":['<form id="signup-vm" class=\'genre-picker-form modern-form signup-common-form ',{type:"ef",blocks:[{type:"ncondition",expression:"skinny ",attachment:["skinny"]}]},'\' data-bind=\'css: { "visible": visible, "has-selected-genres": selectedGenres().length > 0 }, click: deselectClick\' novalidate>\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"!from_newsletter_invite_banner ",attachment:['\n    <div class="heading-wrapper" ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['data-bind="visible: showGenres"']}]},">\n        <h3>",{type:"translate",nodelist:["Welcome, ",{type:"translateVariable",var_name:"fan_name",nodelist:[{type:"variable",name:"fan_name",filters:[["h",[]]]}]},"! What are your favorite genres?"]},"</h3>\n        <h4>",{type:"translate",nodelist:["This will help us recommend music youll love."]},"</h4>\n    </div>\n    "]},{type:"else_ncondition",attachment:['\n    <div class="heading-wrapper" ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['data-bind="visible: showGenres"']}]},">\n        <h3>",{type:"translate",nodelist:["Hi, ",{type:"translateVariable",var_name:"fan_name",nodelist:[{type:"variable",name:"fan_name",filters:[["h",[]]]}]},"! What are your favorite genres?"]},"</h3>\n        <h4>",{type:"translate",nodelist:["This will help us recommend music youll love."]},"</h4>\n    </div>\n    "]}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n    <div class="heading-wrapper mobile"data-bind="visible: showSubgenres">\n        <h3>',{type:"translate",nodelist:["Want to get more specific?"]},"<br/>",{type:"translate",nodelist:["Pick any subgenres you like."]},"</h3>\n    </div>\n    "]}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:["\n        ",{type:"include",template_name:"'fan/signup/fan_genre_picker_selected_genres'"},"\n    "]}]},'\n\n    <div class="genres-overflow-wrapper hide-scrollbar" data-bind="',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["visible: showGenres, "]}]},'style: { height: genres_overflow_wrapper_height() }" >\n        <ul class="genres clearfix" data-bind="foreach: genres">\n            <li class="genre top-level" data-bind="attr: { \'id\': cssId }, css: { ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:["'expanded': hasExpandedClass,"]}]}," 'selected': selected, 'long': isLong, 'search': isSearch }, click: expand\">\n                <div class=\"content\">\n                    \x3c!-- ko if: isSearch --\x3e\n                    <h3 class=\"search-heading\">",{type:"translate",nodelist:["Not quite finding what youre looking for?"]},'</h3>\n                    <h4 class="search-subheading">',{type:"translate",nodelist:["Try searching instead."]},'</h3>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: !isSearch --\x3e\n                    <h3 class="genre-name" data-bind="click: function () { ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:[" expanded() &amp;&amp; "]}]},' toggleSelect(false); }">\n                        <span class="genre-icon"></span><span class="genre-name-text" data-bind="text: name"></span>\n                    </h3>\n                    <ul class="subgenres" data-bind="foreach: subgenres">\n                        <li class="subgenre" data-bind="css: { \'selected\': selected }, click: function () { toggleSelect(false); }">\n                            <h3 class="subgenre-name">\n                                <span class="genre-icon"></span><span data-bind="text: name"></span>\n                            </h3>\n                        </li>\n                    </ul>\n                    \x3c!-- /ko --\x3e\n                </div>\n            </li>\n        </ul>\n        <div class="search-wrapper" data-bind="css: { \'searching\': searching }, click: searchWrapperClick">\n            <h2>',{type:"translate",nodelist:["You can also search for your favorite genres:"]},"</h2>\n            <div class=\"search-input-wrapper\">\n                <input type=\"text\" data-bind=\"css: { 'selected': searchSelectIndex() === 0 }, value: searchTerm, valueUpdate: 'input', hasFocus: searchHasFocus, click: searchClick, event: { 'keydown': searchInputKeypress, 'mouseover': searchInputMouseover }\" placeholder=\"",{type:"translate",nodelist:["Search for any genre"]},'">\n                <a class="search" data-bind="click: function () { expandSearch(); }">\n                    <span class="search-icon">&nbsp;</span>\n                    <svg class="search-spinner" width="14px" height="14px" viewBox="0 0 14 14"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#search-spinner"></use></svg>\n                </a>\n            </div>\n\n            <div class="search-results" data-bind="css: { \'results-visible\': searchResults().length > 0 }, event: { \'keydown\': searchResultsKeypress }, style: { top: search_results_top()}">\n                <ul data-bind="foreach: searchResults">\n                    \x3c!-- ko if: $data.isEmpty --\x3e\n                    <li class="empty">\n                        <span>',{type:"translate",nodelist:["Nothing here... yet!"]},'</span>\n                    </li>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: !$data.isEmpty --\x3e\n                    <li tabindex="0" data-bind="css: { \'selected\': $parent.searchSelectIndex() === ($index() + 1) }, click: function () { $parent.selectSearchResult($data); }, event: { \'mouseover\': function () { $parent.searchResultsMouseover($index()); } }">\n                        <span data-bind="html: displayName"></span>\n                        <span data-bind="text: countText" class="count"></span>\n                    </li>\n                    \x3c!-- /ko --\x3e\n                </ul>\n            </div>\n        </div>\n    </div>\n\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n        <div class="genres-overflow-wrapper mobile hide-scrollbar" data-bind="visible: showSubgenres">\n            <ul class="genres clearfix" data-bind="foreach: genres">\n                <li class="genre top-level expanded" data-bind="attr: { \'id\': cssId }, css: { \'long\': isLong, \'search\': isSearch }, click: expand">\n                    <div class="content">\n                        \x3c!-- ko if: isSearch --\x3e\n                        <h3 class="search-heading">',{type:"translate",nodelist:["Not quite finding what youre looking for?"]},'</h3>\n                        <h4 class="search-subheading">',{type:"translate",nodelist:["Try searching instead."]},'</h3>\n                        \x3c!-- /ko --\x3e\n                        \x3c!-- ko if: !isSearch --\x3e\n                        <div class=\'genre-title\'>\n                            <span data-bind="text: name"></span>\n                        </div>\n                        <ul class="subgenres mobile">\n                            <li class="subgenre selected" data-bind="css: { \'selected\': selectedSecondPane }, click: function () { expanded() &amp;&amp; toggleSelect(false); }">\n                                <h3 class="subgenre-name">\n                                    <span class="genre-icon"></span>',{type:"translate",nodelist:["all"]},' <span data-bind="text: name"></span>\n                                </h3>\n                            </li>\n                            \x3c!-- ko foreach: subgenres --\x3e\n                            <li class="subgenre" data-bind="css: { \'selected\': selected }, click: function () { toggleSelect(false); }, clickBubble: false">\n                                <h3 class="subgenre-name">\n                                    <span class="genre-icon"></span><span data-bind="text: name"></span>\n                                </h3>\n                            </li>\n                            \x3c!-- /ko --\x3e\n                        </ul>\n                        \x3c!-- /ko --\x3e\n                    </div>\n                </li>\n            </ul>\n        </div>\n\n        ',{type:"include",template_name:"'fan/signup/fan_genre_picker_selected_genres'"},"\n    "]}]},'\n\n    <div class="buttons">\n        <button class="next" data-bind="click: next, enable: submitEnabled, css: { \'disabled\': selectedGenres().length === 0 }">\n            \x3c!-- ko if: submitting() --\x3e\n            ',{type:"translate",nodelist:["Please wait..."]},"\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: !submitting() && standalone() && !isMobile--\x3e\n            ",{type:"translate",nodelist:["Submit"]},"\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: !submitting() && (!standalone() || isMobile) --\x3e\n            ",{type:"translate",nodelist:["Next"]},"\n            \x3c!-- /ko --\x3e\n        </button>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_genre_picker_selected_genres.liquid","warn"):Templ.register({"fan/signup/fan_genre_picker_selected_genres":['<div class="selected-genres-wrapper" ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['data-bind="visible: showGenres"']}]},'>\n    <div class="list-wrapper" data-bind="css: { \'has-genres\': selectedGenres().length > 0, \'no-animation\': selectedGenres.noAnimation() }">\n        <ul class="selected-genres" data-bind="foreach: selectedGenres">\n            \x3c!-- ko if: isFake --\x3e\n            <li class="selected-genre-placeholder"></li>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: !isFake --\x3e\n            <li class="selected-genre" data-bind="click: function () { toggleSelect(true); }, css: { \'visible\': visible, \'hiding\': hiding }">\n                <h3 class="genre-name">\n                    <span class="genre-icon"></span><span data-bind="text: displayName"></span>\n                </h3>\n            </li>\n            \x3c!-- /ko --\x3e\n        </ul>\n    </div>\n\n    <a data-bind="click: pageLeft, visible: showPageLeft" class="page page-left">\n        <span class="page-fade"></span>\n        <svg class="icon" viewBox= "0 0 16 16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#larr-onboarding-ico"></use></svg>\n    </a>\n    <a data-bind="click: pageRight, visible: showPageRight" class="page page-right">\n        <span class="page-fade"></span>\n        <svg class="icon" viewBox="0 0 16 16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#rarr-onboarding-ico"></use></svg>\n    </a>\n</div>\n']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_newsletter_picker_pane.liquid","warn"):Templ.register({"fan/signup/fan_newsletter_picker_pane":['<form id="signup-vm" class=\'newsletter-picker-form modern-form signup-common-form\' data-bind=\'css: { "visible": visible }\' novalidate>\n    <div class="heading-wrapper">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"!from_newsletter_invite_banner ",attachment:['\n        <div class="icon">\n            <img src="/img/fan_signup/record-2x.png">\n        </div>\n        <div class="text wide">\n            \x3c!-- ko if: hasSelectedGenres --\x3e\n            <h2>',{type:"translate",nodelist:["Great! Would you like to receive our weekly newsletter alerting you to the best new music in your favorite genres?"]},"</h2>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko if: !hasSelectedGenres --\x3e\n            <h2>",{type:"translate",nodelist:["Would you like to receive our weekly newsletter alerting you to the best new music on Bandcamp?"]},"</h2>\n            \x3c!-- /ko --\x3e\n        </div>\n        "]},{type:"else_ncondition",attachment:['\n        <div class="icon">\n            <img src="/img/fan_signup/record-2x.png">\n        </div>\n        <div class="text wide">\n            <h2>Great. We\'ll send you recommendations every Friday. Sound good?</h2>\n        </div>\n        ']}]},'\n    </div>\n\n    <div class="buttons split">\n        <button class="yes" data-bind="click: chooseBestOf, disable: submitting">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"!from_newsletter_invite_banner ",attachment:["\n                ",{type:"translate",nodelist:["Yes"]},"\n            "]},{type:"else_ncondition",attachment:["\n                Yes!\n            "]}]},'\n        </button>\n        <button class="no" data-bind="click: skip">',{type:"translate",nodelist:["No thanks"]},'</button>\n    </div>\n\n    \x3c!-- ko if: isValidEmail --\x3e\n    <div class="email-abuse">\n        ',{type:"translate",nodelist:["Emails will be sent to ",{type:"translateVariable",var_name:"email",nodelist:[{type:"variable",name:"email",filters:[["h",[]]]}]},"."]},'\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/settings?from=tp">',{type:"translate",nodelist:["Change account email address"]},"</a>\n    </div>\n    \x3c!-- /ko --\x3e\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_welcome_2_pane.liquid","warn"):Templ.register({"fan/signup/fan_welcome_2_pane":["<form id=\"signup-vm\" class='welcome-2-form modern-form signup-common-form' data-bind='css: { \"visible\": visible }' novalidate>\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"show_tooltips ",attachment:['\n        <div class="icon">\n            <img src="/img/fan_signup/tent-2x.png">\n        </div>\n        <h2 class="welcome"><div class="to-bandcamp">',{type:"translate",nodelist:["Welcome to Bandcamp!"]},"</div> ",{type:"translate",nodelist:["Lets take a quick look around."]},'</h2>\n        <div class="buttons split">\n            <button data-bind="click: submit">',{type:"translate",nodelist:["Yes, lets"]},'</button><button data-bind="click: skip">',{type:"translate",nodelist:["No thanks"]},"</button>\n        </div>\n    "]},{type:"else_ncondition",attachment:['\n        <h2 class="welcome no-tooltips">',{type:"translate",nodelist:["Thanks! Your account is now active."]},'</h2>\n        <div class="buttons">\n            <button data-bind="click: submit">',{type:"translate",nodelist:["Got it"]},"</button>\n        </div>\n    "]}]},"\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_complete_profile_pane.liquid","warn"):Templ.register({"fan/signup/fan_complete_profile_pane":['<form id="signup-vm" class=\'complete-profile-form modern-form signup-common-form\' data-bind=\'css: { "visible": visible }, submit: completeProfileVM.submit\' novalidate>\n    <div class="signup-common-inner">\n        <div class="dialog-body">\n            <div class="skinny" data-bind="with: completeProfileVM">\n                ',{type:"include",template_name:"'fan/complete_profile'"},"\n            </div>\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/login/user_picker_text.liquid","warn"):Templ.register({"login/user_picker_text":[{type:"variable",name:"username",filters:[["h",[]]]},"\n",{type:"ef",blocks:[{type:"ncondition",expression:"list.length > 4 ",attachment:["\n    ",{type:"let",variable:"num_others",expression:"(list.length - 3) "},"\n    ",{type:"capture",to:"list",nodelist:[{type:"for",collection_name:"list",nodelist:[{type:"variable",name:"name",filters:[["h",[]]]},{type:"ef",blocks:[{type:"ncondition",expression:"!forloop.last ",attachment:[", "]}]}],variable_name:"name",reversed:null,attribs:{limit:3}}]},"\n    ",{type:"translate",nodelist:["(",{type:"variable",name:"list",filters:[]}," and ",{type:"variable",name:"num_others",filters:[]}," more)"]},"\n"]},{type:"ncondition",expression:"list.length > 0 ",attachment:["\n    (",{type:"for",collection_name:"list",nodelist:[{type:"variable",name:"name",filters:[["h",[]]]},{type:"ef",blocks:[{type:"ncondition",expression:"!forloop.last ",attachment:[", "]}]}],variable_name:"name",reversed:null,attribs:{}},")\n"]}]}]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/home_2016/fan_verify_banner.liquid","warn"):Templ.register({"home_2016/fan_verify_banner":['<div class="corpbanner verify-email" ',{type:"ef",blocks:[{type:"ncondition",expression:"cc_menubar || !show_verify_banner ",attachment:['style="display: none;"']}]},' data-email="',{type:"variable",name:"verify_email",filters:[["a",[]]]},'">\n    <div class="text">\n        ',{type:"translate",nodelist:["Hey! Please verify your email by clicking the link we sent to ",{type:"translateVariable",var_name:"verify_email",nodelist:[{type:"variable",name:"verify_email",filters:[["h",[]]]}]},"."]},' <a href="#" id="resend-verification-email" class="resend-verification-email">',{type:"translate",nodelist:["Change email / Send again"]},"</a>\n    </div>\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/postcheckout/download_2016/mobile_app_button.liquid","warn"):Templ.register({"postcheckout/download_2016/mobile_app_button":[{type:"ef",blocks:[{type:"ncondition",expression:"cfg_mobile_download_fix ",attachment:['\n<div class="button-container">\n    <a class="listen-button ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_redownload ",attachment:["blue-button"]}]},'" href="',{type:"variable",name:"app_tralbum_url_redirect",filters:[["a",[]]]},'"  data-bind="click: dtdWatch.bind($data, \'fan_listen_in_app\')">\n        <div class="button-inner">\n            <svg class="icon app-play-logo" width="24px" height="31px" viewBox="0 0 24 31"><use xlink:href="#play-app-2"></svg>\n            <div class="app-play-text">',{type:"translate",nodelist:["Listen now in the Bandcamp app"]},"</div>\n        </div>\n    </a>\n</div>\n"]},{type:"else_ncondition",attachment:['\n<div class="button-container">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"probably_has_app ",attachment:['\n    <a class="listen-button blue-button" href=\'',{type:"variable",name:"app_tralbum_url",filters:[["a",[]]]},'\'>\n        <div class="button-inner">\n            <svg class="icon app-play-logo" width="44px" height="60px" viewBox="0 0 44 60"><use xlink:href="#play-app"></svg>\n            <div class="app-play-text">',{type:"translate",nodelist:["Listen now in the Bandcamp app"]},'</div>\n        </div>\n    </a>\n    <a class="download-button" href=\'',{type:"variable",name:"platform_app_url",filters:[["a",[]]]},'\'>\n        <div class="button-inner">\n            <svg class="icon app-phone-logo" width="87px" height="76px" viewBox="0 0 87 76"><use xlink:href="#grab-app"></svg>\n            <div class="missing-app">',{type:"translate",nodelist:["Dont have the Bandcamp app?"]},'<br><div class="grab-it">',{type:"translate",nodelist:["Grab it here for free."]},"</div></div>\n        </div>\n    </a>\n    "]},{type:"else_ncondition",attachment:['\n    <a class="download-button blue-button" href=\'',{type:"variable",name:"platform_app_url",filters:[["a",[]]]},'\'>\n        <div class="button-inner">\n            <svg class="icon app-phone-logo" width="87px" height="76px" viewBox="0 0 87 76"><use xlink:href="#grab-app"></svg>\n            <div class="missing-app">',{type:"translate",nodelist:["Dont have the Bandcamp app?"]},"<br>",{type:"translate",nodelist:["Grab it here for free."]},'</div>\n        </div>\n    </a>\n    <a class="listen-button" href=\'',{type:"variable",name:"app_tralbum_url",filters:[["a",[]]]},'\'>\n        <div class="button-inner">\n            <svg class="icon app-play-logo" width="44px" height="60px" viewBox="0 0 44 60"><use xlink:href="#play-app"></svg>\n            <div class="app-play-text">',{type:"translate",nodelist:["Listen now in the Bandcamp app"]},"</div>\n        </div>\n    </a>\n    "]}]},"\n</div>\n"]}]}]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/account/download_item_small.liquid","warn"):Templ.register({"account/download_item_small":['<div class="download-item-small-container">\n    <img class="download-thumbnail" ',{type:"variable",name:"download_item.art_id",filters:[["art",['"art_embedded_player_large"']]]},' title="',{type:"translate",nodelist:["",{type:"variable",name:"download_item.title",filters:[["attr",[]]]}," Cover Art"]},'" alt="',{type:"translate",nodelist:["",{type:"variable",name:"download_item.title",filters:[["attr",[]]]}," Cover Art"]},'"/>\n    \n    <div class="download-info">\n        <div class="tralbum-title">',{type:"variable",name:"download_item.title",filters:[["h",[]]]},"</div>\n        <div>",{type:"variable",name:"download_item.artist",filters:[["h",[]]]},"</div>\n    </div>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/svg_shared.liquid","warn"):Templ.register({svg_shared:['\n\n<svg height="0" width="0" style="position:absolute;margin-left:-100%">\n    <path id="tweet" d="M16.1 3.5a9.6 9.6 0 01-1.7 6c-.6.9-1.3 1.6-2.1 2.3-.8.7-1.8 1.2-2.9 1.6-1.2.4-2.4.6-3.7.6-2.2 0-4.1-.6-5.7-1.6 2.5.2 4.1-.5 5.5-1.5-1.7 0-3-1.1-3.4-2.4.5.1 1.3 0 1.7-.1-1.5-.3-3-1.7-3-3.5.3.2.9.4 1.7.4C1.5 4.8.8 3.7.8 2.4c0-.6.2-1.4.5-1.8 1.7 2 4.4 3.6 7.6 3.7C8.3 1.4 10.6 0 12.5 0c1.1 0 2 .4 2.7 1.1.8-.1 1.6-.4 2.3-.8-.3.8-.8 1.5-1.6 1.9.7-.1 1.4-.2 2.1-.5-.5.7-1.1 1.3-1.9 1.8z"/>\n    <path id="buy-for-friend" d="M3.5 4h7c1.8-.3 2.4-1.9 2-2.9S10.7-.5 9.3.5 7 3 7 3 6.1 1.5 4.7.5s-2.8-.4-3.2.6.2 2.6 2 2.9zm6.8-3c.9-.2 1.6.1 1.3 1.1-.3 1.2-2.6 1.3-3.8 1.3 0 0 1.6-2.2 2.5-2.4zM3.8 1c1.1.4 2.4 2.4 2.4 2.4-1.3 0-3.4-.3-3.8-1.3C2 1.1 3 .8 3.8 1zM0 9h6V5H0v4zm7-4v4h7V5H7zm0 9h6v-4H7v4zm-6 0h5v-4H1v4z"/>\n    <path id="edit-profile-info" d="M10 10.5c0 .3-.2.5-.5.5h-8c-.3 0-.5-.2-.5-.5v-8c0-.3.2-.5.5-.5h3.7V1H1.5C.7 1 0 1.7 0 2.5v8c0 .8.7 1.5 1.5 1.5h8c.8 0 1.5-.7 1.5-1.5V7h-1v3.5zm2-9.1L10.5 0 6.4 4.4l-.6 2.2L8 5.7l4-4.3z"/>\n    <path id="fb-logo-share-profile" d="M3.9 12V6.3h1.8L6 4.2H4V2.9c0-.6.2-1 1-1h1.1V.1C5.8.1 5.2 0 4.4 0 2.8 0 1.8 1 1.8 2.7v1.5H0v2.1h1.8V12h2.1z"/>\n    <path id="following-checkmark" d="M4.3 10.7L0 5.8l1.5-1.3 2.8 3.1L11 0l1.5 1.3z"/>\n    <path id="follow-plus" d="M8 3H5V0H3v3H0v2h3v3h2V5h3z"/>\n    <path id="share-profile" d="M10.7.2s-.1-.1 0 0l-.4-.2h-.1L2.5 4.8.3 8.1v.1s0 .1.1.1l3.3.9h.1l5.1-6.5-3.3 7 .9 2.2.1.1s.1 0 .1-.1l.9-1.5 2.8.9.1-.1L11.8 7 10.7.2z"/>\n    <path id="search-magnifier" d="M10.1 10.4l-1.4-2C9.5 7.5 10 6.3 10 5c0-2.8-2.2-5-5-5S0 2.2 0 5s2.2 5 5 5c.7 0 1.4-.1 2-.4l1.5 2c.3.4 1 .5 1.4.2.4-.3.5-.9.2-1.4zM5 9C2.8 9 1 7.2 1 5s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z"/>\n    <path id="close-search-results" d="M8 .7L7.3 0 4 3.3.7 0 0 .7 3.3 4 0 7.3l.7.7L4 4.7 7.3 8l.7-.7L4.7 4z"/>\n    <path id="camera-icon" d="M26 2h-4a2 2 0 00-2-2H8a2 2 0 00-2 2H2a2 2 0 00-2 2v14a2 2 0 002 2h24a2 2 0 002-2V4a2 2 0 00-2-2zM14 17a6 6 0 116-6 6 6 0 01-6 6zm1-10h-2v3h-3v2h3v3h2v-3h3v-2h-3z"/>\n    <g id="search-spinner">\n        <circle class="st1" cx="7" cy="1.5" r="1.5"/>\n        <circle class="st2" transform="rotate(-45 10.89 3.11)" cx="10.9" cy="3.1" r="1.5"/>\n        <circle class="st3" cx="12.5" cy="7" r="1.5"/>\n        <circle class="st4" transform="rotate(-45 10.89 10.89)" cx="10.9" cy="10.9" r="1.5"/>\n        <circle class="st5" cx="7" cy="12.5" r="1.5"/>\n        <circle class="st6" transform="rotate(-45 3.11 10.89)" cx="3.1" cy="10.9" r="1.5"/>\n        <circle class="st8" transform="rotate(-45 3.11 3.11)" cx="3.1" cy="3.1" r="1.5"/>\n        <circle class="st7" cx="1.5" cy="7" r="1.5"/>\n    </g>\n    <path id="mobile-web-collection-arrow" d="M20.3 17.3L3 0 .3 2.7 17.7 20 .3 37.3 3 40l17.3-17.3L23 20z"/>\n    <path id="homepage-mobile-arrow" d="M12.9 11L2.1.1 0 2.2l10.8 10.9L0 24l2.1 2.1 10.8-10.9 2.1-2.1z"/>\n    <path id="collect-control-wishlist" d="M10.5 20l-.8-.9s-1.9-2.3-4.6-4.7C1.8 11.2.1 8.5 0 6c0-1.6.6-3 1.8-4.3C3.4.3 5-.2 6.6.1c1.8.3 3.1 1.6 3.9 2.5.9-1 2.3-2.2 4.1-2.5 1.6-.2 3 .3 4.5 1.5 1.3 1.2 2 2.6 2 4.1 0 2.5-1.7 5.3-5.3 8.6a44.6 44.6 0 00-4.4 4.7l-.9 1zm-4-7.1c1.8 1.6 3.2 3.1 4 4 .8-.9 2.2-2.4 3.9-4 3.1-2.8 4.7-5.2 4.7-7.1 0-1-.4-1.9-1.3-2.7-1-.8-1.9-1.2-2.9-1-2 .3-3.6 2.7-3.6 2.7l-.9 1.4-.8-1.5S8.3 2.3 6.3 1.9c-1-.2-2 .2-3.1 1.1-.9.9-1.3 1.9-1.2 2.9 0 2 1.6 4.3 4.5 7z"/>\n    <path id="collect-control-purchased" d="M10.5 20l-.8-.9s-1.9-2.3-4.6-4.7C1.8 11.2.1 8.5 0 6c0-1.6.6-3 1.8-4.3C3.4.3 5-.2 6.6.1c1.8.3 3.1 1.6 3.9 2.5.9-1 2.3-2.2 4.1-2.5 1.6-.2 3 .3 4.5 1.5 1.3 1.2 2 2.6 2 4.1 0 2.5-1.7 5.3-5.3 8.6a44.6 44.6 0 00-4.4 4.7l-.9 1z"/>\n    <path id="collect-control-wishlisted" d="M10.5 20l-.8-.9s-1.9-2.3-4.6-4.7C1.8 11.2.1 8.5 0 6c0-1.6.6-3 1.8-4.3C3.4.3 5-.2 6.6.1c1.8.3 3.1 1.6 3.9 2.5.9-1 2.3-2.2 4.1-2.5 1.6-.2 3 .3 4.5 1.5 1.3 1.2 2 2.6 2 4.1 0 2.5-1.7 5.3-5.3 8.6a44.6 44.6 0 00-4.4 4.7l-.9 1z"/>\n    <path id="facebook-like" d="M2 0h12c1.15 0 2 .85 2 2v12c0 1.15-.85 2-2 2h-3.49V9.83h2.06l.34-2.52h-2.4V5.83c0-.34.12-.69.23-.8.12-.23.46-.34.92-.34h1.25V2.5c-.45-.11-1.02-.11-1.82-.11-.92 0-1.72.23-2.29.8-.57.57-.8 1.37-.8 2.4v1.83H5.94v2.4H8V16H2c-1.15 0-2-.85-2-2V2C0 .85.85 0 2 0z"/>\n    <path id="format-dropdown" d="M10 0L5 6 0 0z"/>\n    <path id="direct-download" d="M11.7 7.3c-.4-.4-1-.4-1.4 0L7 10.6V1c0-.5-.5-1-1-1S5 .5 5 1v9.6L1.7 7.3c-.4-.4-1-.4-1.4 0s-.4 1 0 1.4l5 5c.2.2.4.3.7.3.4 0 .5-.1.7-.3l5-5c.4-.4.4-1 0-1.4zM10 15H2c-.5 0-1 .5-1 1s.5 1 1 1h8c.5 0 1-.5 1-1s-.5-1-1-1z"/>\n    <path id="mobile-gift-ribbon" class="st0" d="M46.3 0C37.4 0 31.1 8.3 28 13.5 24.9 8.3 18.6 0 9.7 0 4.1 0 0 3.5 0 8.2 0 16.6 12.2 22 27.7 22 43.9 22 56 15 56 8.3c0-1.3-.3-2.6-1-3.8C53.5 1.7 50.2 0 46.3 0zM9.6 12.8c-3.1-1.6-3.9-3.1-3.9-4.6 0-1.5 1.5-3.1 4-3.1 6 0 10.8 6.6 13.4 10.9-6.9-.5-11.1-2-13.5-3.2zm37.3-.3c-2.8 1.6-7.4 3-14 3.4C35.5 11.6 40.1 5 46.1 5c2.1 0 4 .9 4 3 0 1.9-1.6 3.6-3.2 4.5z"/>\n    <path id="grab-app" d="M20.8 25c-.8-.8-2-.8-2.8 0-.8.8-.8 2 0 2.8l7.2 7.2H2a2 2 0 00-2 2c0 1.1.9 2 2 2h23.2L18 46.2c-.8.8-.8 2 0 2.8.8.8 2 .8 2.8 0l10.6-10.6c.3-.3.6-.8.6-1.4 0-.6-.3-1.1-.6-1.4L20.8 25zM77.6 0h-26C46 0 41 4 41 9.5v56C41 71 46 76 51.6 76h26c5.5 0 9.4-5 9.4-10.5v-56C87 4 83.1 0 77.6 0zM84 65.5c0 3.9-2.6 7.5-6.4 7.5h-26c-3.9 0-7.6-3.6-7.6-7.5V56h40v9.5zM84 53H44V17h40v36zm0-39H44V9.5C44 5.6 47.7 3 51.6 3h26C81.4 3 84 5.6 84 9.5V14zM64 67c1.7 0 3-1.3 3-3s-1.3-3-3-3-3 1.3-3 3 1.4 3 3 3z"/>\n    <path id="play-app" d="M1 60c-.2 0-.3 0-.5-.1-.3-.2-.5-.5-.5-.9V1C0 .6.2.3.5.1c.4-.1.8-.1 1.1.1l42 29c.3.2.4.5.4.8s-.2.6-.4.8l-42 29c-.2.2-.4.2-.6.2zM2 2.9v54.2L41.3 30 2 2.9z"/>\n    <path id="play-app-2" d="M18.55 16L2.97 5.61V26.4L18.55 16zM0 32V0l24 16L0 32z"/>\n    <g id="grab-app-opensignup" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="collection" transform="translate(-67 -505)" fill="#FFF">\n            <g id="mweb-phone-icon-outline" transform="translate(67 505)">\n                <path d="M21.16 3.99v28.02a3 3 0 003 2.99h13.99a3 3 0 003-2.99V3.99a3 3 0 00-3-2.99H24.17a3 3 0 00-3.01 2.99zm-1 0a4 4 0 014-3.99h13.99a4 4 0 014 3.99v28.02a4 4 0 01-4 3.99H24.17a4 4 0 01-4.01-3.99V3.99z" id="Rectangle-1270"/>\n                <rect id="Rectangle-1271" x="29.41" y="29.73" width="2.5" height="2.5" rx="1.25"/>\n                <path d="M20.66 8.23h21v-1h-21v1zm0 19h21v-1h-21v1z" id="Combined-Shape"/>\n                <path d="M.29 18.44c0 .36.31.67.68.67h11.62L8.86 23.3a.72.72 0 000 .99l.36.41c.26.26.68.26.94 0l5.89-6.05a.72.72 0 000-1L9.96 11.3a.66.66 0 00-.94 0l-.36.41a.72.72 0 000 1l3.9 4.43H.96a.69.69 0 00-.67.67v.63z" id=""/>\n            </g>\n        </g>\n    </g>\n    <g id="has-app">\n        <path class="has-app-phone" d="M18 56a2 2 0 002-2c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2zM29 0H7C3.1 0 0 3.1 0 7v48c0 3.9 3.1 7 7 7h22c3.9 0 7-3.1 7-7V7c0-3.9-3.1-7-7-7zm5 55c0 2.8-2.2 5-5 5H7c-2.8 0-5-2.2-5-5v-6h32v6zm0-8H2V12h32v35zm0-37H2V7c0-2.8 2.2-5 5-5h22c2.8 0 5 2.2 5 5v3z"/>\n        <path class="has-app-confirm" d="M18 18c-6.4 0-11.5 5.1-11.5 11.5S11.6 41 18 41s11.5-5.1 11.5-11.5S24.4 18 18 18zm5.3 9.6l-5.8 5.8c-.3.3-.7.4-1.1.4-.4 0-.8-.1-1.1-.4l-2.6-2.6c-.6-.6-.6-1.5 0-2.1s1.5-.6 2.1 0l1.6 1.6 4.8-4.8c.6-.6 1.5-.6 2.1 0 .6.6.6 1.6 0 2.1z"/>\n    </g>\n    <g id="no-app">\n        <path class="no-app-phone" d="M18 56a2 2 0 002-2c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2zM29 0H7C3.1 0 0 3.1 0 7v48c0 3.9 3.1 7 7 7h22c3.9 0 7-3.1 7-7V7c0-3.9-3.1-7-7-7zm5 55c0 2.8-2.2 5-5 5H7c-2.8 0-5-2.2-5-5v-6h32v6zm0-8H2V12h32v35zm0-37H2V7c0-2.8 2.2-5 5-5h22c2.8 0 5 2.2 5 5v3z"/>\n        <path class="no-app-bc-logo" d="M14 23L7 36h15l7-13z"/>\n    </g>\n    <g id="signup-promo-icon">\n        <path id="signup-phone-background" d="M25 52H5c-2.8 0-5-2.2-5-5V5c0-2.8 2.2-5 5-5h20c2.8 0 5 2.2 5 5v42c0 2.8-2.2 5-5 5z"/>\n        <g id="signup-promo-phone">\n            <path class="signup-phone-icon" d="M25 0H5C2.2 0 0 2.2 0 5v42c0 2.8 2.2 5 5 5h20c2.8 0 5-2.2 5-5V5c0-2.8-2.2-5-5-5zm3 47c0 1.7-1.3 3-3 3H5c-1.7 0-3-1.3-3-3v-6h26v6zm0-8H2V10h26v29zm0-31H2V5c0-1.7 1.3-3 3-3h20c1.7 0 3 1.3 3 3v3zM15 47a2 2 0 002-2c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2z"/>\n            <path class="signup-bc-logo" d="M11.6 19L5.7 30h12.7l5.9-11z"/>\n        </g>\n    </g>\n    <path id="format-dropdown-selected" d="M8.6.3C8.2-.1 7.5-.1 7 .3L3.4 4 2 2.5c-.4-.4-1.2-.4-1.6 0-.4.4-.4 1.2 0 1.6l2.2 2.2c.2.2.5.3.8.3.3 0 .6-.1.8-.3L8.6 2c.5-.5.5-1.2 0-1.7z"/>\n    <defs>\n        <linearGradient id="ribbon-gradient" x1="0" x2="0" y1="0" y2="1">\n            <stop offset="0%" stop-color="#00BAEF"/>\n            <stop offset="90%" stop-color="#1DA0C3"/>\n        </linearGradient>\n    </defs>\n    <path id="rarr-ico" d="M5 5L0 9l2 1 6-5-6-5-2 1 5 4z"/>\n    <path id="larr-ico" d="M5 5L0 9l2 1 6-5-6-5-2 1 5 4z" transform="rotate(-180 4 5)"/>\n    <path d="M2.57 0L.44 2.13 7.31 9 .43 15.87 2.56 18l9-9z" transform="rotate(-180 7.5 9)" id="larr-onboarding-ico"/>\n    <g id="rarr-onboarding-ico" transform="translate(3)">\n        <path id="Fill-2" d="M2.57 0L.44 2.13 7.31 9 .43 15.87 2.56 18l9-9z"/>\n    </g>\n    <path d="M0 3h3v3H0V3zm6 0l2-1-2-2-1.5 2.3L3 0 1 2l2 1h1v3h5V3H6zm-5 7h2V7H1v3zm3 0h4V7H4v3z" id="gift-card-icon"/>\n    <path id="not-shipped" d="M7.9 0L4.75 3.16 1.58 0 0 1.58l3.16 3.17L0 7.9l1.58 1.58 3.16-3.16 3.17 3.16 1.58-1.58-3.16-3.16 3.16-3.17z"/>\n    <path id="checkmark-shipped" d="M4.66 6.5L1.38 3.37 0 4.8l3.28 3.14 1.18 1.12.26.26 7.6-7.95L10.89 0z"/>\n    <path fill-rule="evenodd" d="M11.82 21.35a60.6 60.6 0 011.25 1.4 42.86 42.86 0 011.21-1.4 56.68 56.68 0 014.18-4.24c5.95-5.4 8.04-9.93 4.2-13.42-2.69-2.35-5.25-1.9-7.63.34a11.2 11.2 0 00-1.62 1.92l-.46.73-.4-.75a10.42 10.42 0 00-1.5-1.97c-2.28-2.32-4.85-2.78-7.72-.3-3.62 3.7-1.54 8.23 4.22 13.45a69.17 69.17 0 014.27 4.24zm1.21-16.6c.38-.5.82-.99 1.31-1.45 2.72-2.55 5.84-3.1 8.99-.35 4.49 4.07 2.15 9.14-4.2 14.9a55.69 55.69 0 00-5.65 5.99l-.38.49-.4-.48c-.07-.1-.21-.26-.42-.5a68.18 68.18 0 00-5.4-5.5C.74 12.28-1.57 7.24 2.64 2.94 6 .04 9.14.6 11.75 3.26A11.4 11.4 0 0113 4.79l.03-.04z" id="menubar-collection-icon"/>\n    <path fill-rule="evenodd" d="M14.4.87a1 1 0 011.77.77l-1.1 7.84h6.46a1 1 0 01.74 1.68L9.24 25.2a1 1 0 01-1.72-.85L9 15.56H4.5a1 1 0 01-.77-1.63L14.4.87zm.78.63L4.5 14.57H9a1 1 0 01.98 1.16l-1.47 8.8 13.02-14.05h-6.47a1 1 0 01-.99-1.14l1.11-7.84z" id="menubar-feed-icon"/>\n    <path d="M21.38 19.44a.13.13 0 01-.12.07H1.13a.12.12 0 01-.11-.07.33.33 0 01-.03-.09l3.27-4.15c.37-.59.57-1.27.57-1.97V7.67C4.83 4.09 7.6 1.1 11 1h.2c1.66 0 3.23.63 4.43 1.8a6.33 6.33 0 011.94 4.58v5.85c0 .7.2 1.38.6 2.01l3.2 4.05c.03.06.02.11 0 .15m-7.45 1.32a2.73 2.73 0 01-5.46 0c0-.09.03-.17.03-.25h5.4c.01.08.03.16.03.25m8.27-2.04L19 14.67a2.66 2.66 0 01-.42-1.44V7.38A7.36 7.36 0 0010.98 0C7.03.11 3.83 3.55 3.83 7.66v5.56c0 .51-.15 1-.39 1.4L.17 18.78c-.22.36-.23.79-.02 1.15.2.36.57.58.98.58H7.5c0 .08-.03.16-.03.25a3.73 3.73 0 007.46 0c0-.09-.02-.17-.03-.25h6.36a1.14 1.14 0 00.94-1.78" id="menubar-messages-icon" fill-rule="evenodd"/>\n    <path fill-rule="evenodd" d="M11.43 19.7a9.02 9.02 0 008.93-9.1c0-5.03-4-9.1-8.93-9.1a9.02 9.02 0 00-8.93 9.1c0 5.03 4 9.1 8.93 9.1zm6.95-1.9l6 6.87c.44.5-.32 1.16-.76.66l-5.98-6.85a9.78 9.78 0 01-6.21 2.22c-5.49 0-9.93-4.52-9.93-10.1S5.94.5 11.43.5c5.48 0 9.93 4.52 9.93 10.1 0 2.82-1.14 5.37-2.98 7.2z" id="menubar-search-icon"/>\n    <path d="M10.7 10.47l3.74 4.2c.44.5-.3 1.16-.75.66l-3.73-4.2c-.44-.5.3-1.16.75-.66zM6.6 11.7a5.1 5.1 0 100-10.2 5.1 5.1 0 000 10.2zm0 1A6.1 6.1 0 116.6.5a6.1 6.1 0 010 12.2z" id="menubar-search-input-icon"/>\n    <g id="menubar-cart-icon" fill-rule="evenodd">\n        <path d="M21.5 25a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"/>\n        <circle cx="8.5" cy="23.5" r="1.5" opacity=".9"/>\n        <path fill-rule="nonzero" d="M4.57 2H.5a.5.5 0 010-1h4.48a.5.5 0 01.5.4l.5 2.7 18.52.18c.31 0 .54.28.5.58l-2.28 13.72a.5.5 0 01-.49.42H8.16a.5.5 0 01-.49-.4L4.57 2zm1.6 3.1L8.57 18h13.24l2.1-12.73L6.17 5.1z"/>\n    </g>\n    <g id="bandcamp-logo-color-bcaqua">\n        <path d="M26.62 0h2.42v5.8h.04a3.96 3.96 0 013.28-1.78c3.46 0 5.14 2.73 5.14 6.05C37.5 13.12 36 16 32.76 16c-1.49 0-3.08-.37-3.8-1.87h-.05v1.57h-2.3V0m5.43 6c-2.04 0-3.08 1.6-3.08 4.02 0 2.29 1.12 4 3.08 4 2.2 0 3.04-2.02 3.04-4 0-2.06-1.05-4.02-3.04-4.02" id="b" fill="#333"/>\n        <path d="M56.26 4.05c-1.44 0-2.7.77-3.42 2.03l-.04-.05V4.36h-2.3v9.68l-1.61.01c-.45 0-.58-.24-.58-.85V7.35c0-2.4-2.25-3.3-4.4-3.3-2.42 0-4.82.86-4.99 3.78h2.42c.11-1.23 1.07-1.8 2.43-1.8.97 0 2.27.24 2.27 1.54 0 1.47-1.55 1.27-3.3 1.6-2.03.25-4.22.7-4.22 3.54 0 2.22 1.78 3.32 3.76 3.32 1.3 0 2.85-.42 3.8-1.38.2 1.03.9 1.38 1.87 1.38.4 0 1.17-.15 4.96-.28v-.03h.02v-6.7c0-1.67 1.04-2.99 2.65-2.99 1.42 0 2.1.77 2.15 2.55v7.14h2.42v-7.8c0-2.55-1.5-3.87-3.88-3.87zM45.9 11.9c0 1.58-1.66 2.15-2.72 2.15-.85 0-2.24-.33-2.24-1.45 0-1.32.94-1.71 1.98-1.89 1.06-.2 2.23-.17 2.98-.68v1.87z" id="an" fill="#333"/>\n        <path d="M72.62 15.7h-2.29v-1.54h-.04c-.64 1.3-2.02 1.84-3.4 1.84-3.47 0-5.14-2.66-5.14-6.06 0-4.12 2.35-5.92 4.76-5.92 1.38 0 2.9.53 3.65 1.78h.04V0h2.43v15.7m-5.42-1.68c2.16 0 3.08-2.04 3.08-4.02 0-2.5-1.17-4-3.04-4-2.27 0-3.08 2.09-3.08 4.13 0 1.96.93 3.9 3.04 3.9" id="d" fill="#333"/>\n        <path d="M82.25 8.16c-.19-1.38-1.17-2.13-2.5-2.13-1.26 0-3.02.68-3.02 4.13 0 1.9.8 3.9 2.9 3.9 1.41 0 2.39-.97 2.62-2.6h2.42c-.44 2.95-2.2 4.57-5.03 4.57-3.44 0-5.34-2.53-5.34-5.87 0-3.43 1.81-6.1 5.42-6.1 2.55 0 4.72 1.31 4.95 4.1h-2.41" id="c" fill="#333"/>\n        <path d="M106.44 5.94c-.5-1.3-1.75-1.89-3.09-1.89-1.74 0-2.65.77-3.37 1.9l-.07-1.59h-2.3v9.68l-1.61.01c-.45 0-.57-.24-.57-.85V7.35c0-2.4-2.26-3.3-4.4-3.3-2.42 0-4.83.86-5 3.78h2.43c.1-1.23 1.06-1.8 2.42-1.8.98 0 2.27.24 2.27 1.54 0 1.47-1.55 1.27-3.3 1.6-2.03.25-4.22.7-4.22 3.54 0 2.22 1.78 3.32 3.76 3.32 1.3 0 2.85-.42 3.8-1.38.2 1.03.9 1.38 1.88 1.38.4 0 1.16-.15 4.92-.28l.05-6.77c0-1.9 1.15-2.95 2.4-2.95 1.47 0 1.93.84 1.93 2.4v7.3h2.43V9.05c0-1.9.7-3.03 2.33-3.03 1.9 0 2 1.25 2 3.06v6.63h2.42V7.88c0-2.77-1.36-3.83-3.67-3.83-1.6 0-2.64.73-3.44 1.9zm-16.15 8.11c-.85 0-2.24-.33-2.24-1.45 0-1.32.94-1.71 1.98-1.89 1.06-.2 2.23-.17 2.98-.68v1.87c0 1.58-1.66 2.15-2.72 2.15z" id="am" fill="#333"/>\n        <path d="M118.04 4.36V5.9h.04c.68-1.3 2-1.85 3.4-1.85 3.46 0 5.14 2.73 5.14 6.05 0 3.05-1.48 5.93-4.74 5.93-1.4 0-2.9-.53-3.67-1.78h-.05v5.67h-2.42V4.36h2.3zm.04 5.7c0 2.28 1.13 4 3.08 4 2.21 0 3.04-2.03 3.04-4 0-2.07-1.04-4.03-3.04-4.03-2.04 0-3.08 1.6-3.08 4.02z" id="p" fill="#333"/>\n        <path id="rhomboid" fill="#1DA0C3" d="M0 15.63L8.47 0H26.6l-8.47 15.63z"/>\n    </g>\n    <g id="bandcamp-logo-color-white" fill="#FFF">\n        <path d="M26.62 0h2.42v5.8h.04a3.96 3.96 0 013.28-1.78c3.46 0 5.14 2.73 5.14 6.05C37.5 13.12 36 16 32.76 16c-1.49 0-3.08-.37-3.8-1.87h-.05v1.57h-2.3V0m5.43 6c-2.04 0-3.08 1.6-3.08 4.02 0 2.29 1.12 4 3.08 4 2.2 0 3.04-2.02 3.04-4 0-2.06-1.05-4.02-3.04-4.02" id="b"/>\n        <path d="M56.26 4.05c-1.44 0-2.7.77-3.42 2.03l-.04-.05V4.36h-2.3v9.68l-1.61.01c-.45 0-.58-.24-.58-.85V7.35c0-2.4-2.25-3.3-4.4-3.3-2.42 0-4.82.86-4.99 3.78h2.42c.11-1.23 1.07-1.8 2.43-1.8.97 0 2.27.24 2.27 1.54 0 1.47-1.55 1.27-3.3 1.6-2.03.25-4.22.7-4.22 3.54 0 2.22 1.78 3.32 3.76 3.32 1.3 0 2.85-.42 3.8-1.38.2 1.03.9 1.38 1.87 1.38.4 0 1.17-.15 4.96-.28v-.03h.02v-6.7c0-1.67 1.04-2.99 2.65-2.99 1.42 0 2.1.77 2.15 2.55v7.14h2.42v-7.8c0-2.55-1.5-3.87-3.88-3.87zM45.9 11.9c0 1.58-1.66 2.15-2.72 2.15-.85 0-2.24-.33-2.24-1.45 0-1.32.94-1.71 1.98-1.89 1.06-.2 2.23-.17 2.98-.68v1.87z" id="an"/>\n        <path d="M72.62 15.7h-2.29v-1.54h-.04c-.64 1.3-2.02 1.84-3.4 1.84-3.47 0-5.14-2.66-5.14-6.06 0-4.12 2.35-5.92 4.76-5.92 1.38 0 2.9.53 3.65 1.78h.04V0h2.43v15.7m-5.42-1.68c2.16 0 3.08-2.04 3.08-4.02 0-2.5-1.17-4-3.04-4-2.27 0-3.08 2.09-3.08 4.13 0 1.96.93 3.9 3.04 3.9" id="d"/>\n        <path d="M82.25 8.16c-.19-1.38-1.17-2.13-2.5-2.13-1.26 0-3.02.68-3.02 4.13 0 1.9.8 3.9 2.9 3.9 1.41 0 2.39-.97 2.62-2.6h2.42c-.44 2.95-2.2 4.57-5.03 4.57-3.44 0-5.34-2.53-5.34-5.87 0-3.43 1.81-6.1 5.42-6.1 2.55 0 4.72 1.31 4.95 4.1h-2.41" id="c"/>\n        <path d="M106.44 5.94c-.5-1.3-1.75-1.89-3.09-1.89-1.74 0-2.65.77-3.37 1.9l-.07-1.59h-2.3v9.68l-1.61.01c-.45 0-.57-.24-.57-.85V7.35c0-2.4-2.26-3.3-4.4-3.3-2.42 0-4.83.86-5 3.78h2.43c.1-1.23 1.06-1.8 2.42-1.8.98 0 2.27.24 2.27 1.54 0 1.47-1.55 1.27-3.3 1.6-2.03.25-4.22.7-4.22 3.54 0 2.22 1.78 3.32 3.76 3.32 1.3 0 2.85-.42 3.8-1.38.2 1.03.9 1.38 1.88 1.38.4 0 1.16-.15 4.92-.28l.05-6.77c0-1.9 1.15-2.95 2.4-2.95 1.47 0 1.93.84 1.93 2.4v7.3h2.43V9.05c0-1.9.7-3.03 2.33-3.03 1.9 0 2 1.25 2 3.06v6.63h2.42V7.88c0-2.77-1.36-3.83-3.67-3.83-1.6 0-2.64.73-3.44 1.9zm-16.15 8.11c-.85 0-2.24-.33-2.24-1.45 0-1.32.94-1.71 1.98-1.89 1.06-.2 2.23-.17 2.98-.68v1.87c0 1.58-1.66 2.15-2.72 2.15z" id="am"/>\n        <path d="M118.04 4.36V5.9h.04c.68-1.3 2-1.85 3.4-1.85 3.46 0 5.14 2.73 5.14 6.05 0 3.05-1.48 5.93-4.74 5.93-1.4 0-2.9-.53-3.67-1.78h-.05v5.67h-2.42V4.36h2.3zm.04 5.7c0 2.28 1.13 4 3.08 4 2.21 0 3.04-2.03 3.04-4 0-2.07-1.04-4.03-3.04-4.03-2.04 0-3.08 1.6-3.08 4.02z" id="p"/>\n        <path id="rhomboid" d="M0 15.63L8.47 0H26.6l-8.47 15.63z"/>\n    </g>\n    <g id="bandcamp-rhomboid-white">\n        <path id="rhomboid" fill="#FFF" d="M0 15.63L8.47 0H26.6l-8.47 15.63z"/>\n    </g>\n    <g id="mobile-cart-up">\n        <path fill="#fff" stroke="#eee" d="M5 12L16 1h0l11 11"/>\n        <path fill="none" id="blocking" stroke="#fff" stroke-width="2" d="M4.5 12H27"/>\n    </g>\n    <defs>\n        <linearGradient x1="50%" y1="100%" x2="50%" y2="0%" id="fanAppGradient">\n            <stop stop-color="#00BAEF" offset="0%"/>\n            <stop stop-color="#1DA0C3" offset="100%"/>\n        </linearGradient>\n    </defs>\n    <g id="fan-app-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="mobileweb-fanartist-02" transform="translate(-86 -385)">\n            <g id="Group">\n                <g id="menu" transform="translate(58 39)">\n                    <g id="fan-app-icon" transform="translate(28 346)">\n                        <rect id="bg" fill="#FFF" x="0" y="0" width="23" height="23" rx="3"/>\n                        <path id="tent" fill="url(#fanAppGradient)" d="M4 15.9l4.78-8.8h10.21l-4.77 8.8z"/>\n                    </g>\n                </g>\n            </g>\n        </g>\n    </g>\n    <g id="artist-app-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="mobileweb-fanartist-02" transform="translate(-86 -334)">\n            <g id="Group">\n                <g id="menu" transform="translate(58 39)">\n                    <g id="artist-app-icon" transform="translate(28 295)">\n                        <rect id="bg" fill="#4999AD" x="0" y="0" width="23" height="23" rx="3"/>\n                        <path id="tent" fill="#FFF" d="M4 15.9l4.78-8.8h10.21l-4.77 8.8z"/>\n                    </g>\n                </g>\n            </g>\n        </g>\n    </g>\n    <path id="embed-icon" d="M16.9 2.3L22 6.97l-5.1 4.68c-.43.43-1 .43-1.43 0-.43-.43-.4-1.13.02-1.57l3.42-3.1-3.42-3.12a1.12 1.12 0 01-.02-1.56c.43-.43 1-.43 1.43 0zm-6.48 10.76c-.14.63-.62.98-1.2.87-.58-.12-.93-.72-.8-1.35L11.47.88c.14-.62.62-.97 1.2-.86.58.12.93.72.8 1.35l-2.8 10.77-.24.92zM5.1 2.3c.43-.43 1-.43 1.43 0 .43.43.43 1.13 0 1.56L3.1 6.97l3.44 3.11c.43.44.43 1.14 0 1.57-.42.43-1 .43-1.43 0L0 6.97 5.1 2.3z"/>\n    <path id="email-link" d="M0 2C0 .9.9 0 2 0h14a2 2 0 012 2v8a2 2 0 01-2 2H2a2 2 0 01-2-2V2zm16.06 9l.94-.9-4.7-4.55L17 1.9 16.06 1 9.24 6.47h-.48L1.94 1 1 1.9l4.7 3.65L1 10.09l.94.91 4.7-4.55 2.12 1.82h.48l2.11-1.82 4.7 4.55z"/>\n    <path id="reddit-share" d="M24 11.78a2.65 2.65 0 00-4.5-1.9 13.7 13.7 0 00-6.97-2.05l1.49-4.66 4.01.94v.05a2.17 2.17 0 004.34 0 2.17 2.17 0 00-4.2-.78l-4.32-1.02a.37.37 0 00-.44.25l-1.66 5.21c-2.83.03-5.4.8-7.3 2.03a2.64 2.64 0 10-3.13 4.2c-.06.28-.09.57-.09.86 0 3.9 4.8 7.09 10.72 7.09s10.72-3.18 10.72-7.1c0-.27-.03-.54-.08-.8A2.63 2.63 0 0024 11.78zM6.78 13.6a1.58 1.58 0 013.16 0 1.58 1.58 0 01-3.16 0zm9.06 4.66c-.8.8-2.05 1.18-3.83 1.18H12c-1.78 0-3.03-.38-3.83-1.18a.37.37 0 010-.52.37.37 0 01.53 0c.65.65 1.73.96 3.3.96H12c1.57 0 2.65-.31 3.3-.96a.37.37 0 01.53 0c.14.14.14.38 0 .52zm-.2-3.1c-.86 0-1.57-.7-1.57-1.57a1.58 1.58 0 013.16 0c0 .87-.71 1.58-1.58 1.58z"/>\n    <path id="copy-icon" d="M16.95 7.05a1 1 0 010 1.41l-8.48 8.49a1 1 0 11-1.42-1.41l8.49-8.49a1 1 0 011.4 0zm-5.8 10.04A4.2 4.2 0 0110 19.2l-1.66 1.65c-1.56 1.56-3.99 1.67-5.41.24-1.43-1.43-1.33-3.86.23-5.42L4.82 14c.6-.6 1.33-.98 2.09-1.14l1.93-1.94c-1.82-.3-3.83.3-5.31 1.79l-1.66 1.66c-2.35 2.34-2.5 5.98-.36 8.12 2.15 2.15 5.79 1.99 8.12-.35l1.66-1.66a6.14 6.14 0 001.79-5.32l-1.94 1.93zm3.22-15.23L12.7 3.52a6.14 6.14 0 00-1.79 5.32l1.94-1.93c.16-.76.54-1.49 1.14-2.1l1.66-1.65c1.56-1.56 3.99-1.66 5.42-.24 1.43 1.43 1.32 3.86-.24 5.42L19.18 10c-.6.6-1.33.98-2.08 1.14l-1.94 1.94c1.82.3 3.83-.3 5.32-1.78l1.66-1.67c2.34-2.34 2.5-5.97.35-8.12-2.14-2.14-5.78-1.98-8.12.35z"/>\n    <path id="share-icon" d="M6 17A15.24 15.24 0 0117 5.33V2l7 6.64-7 6.7V12s-6.17-.17-11 5zm12 .14V20H2V8h6.6a17 17 0 012.34-2H0v16h20v-6.77l-2 1.91z"/>\n\x3c!--hubs--\x3e\n    <g transform="translate(-1036 -601)" fill-rule="nonzero" stroke="#323232" id="hub-page-next" stroke-width="1" fill="none" stroke-linecap="round" stroke-linejoin="round">\n        <path d="M1052.17 602.15l11.62 10.63-11.62-10.63zm11.83 10.88L1052 624l12-10.97zm-.32-.13l-27.18.13 27.18-.13z" id="Combined-Shape"/>\n    </g>\n    <g transform="translate(-1036 -655)" fill-rule="nonzero" stroke="#323232" id="hub-page-prev" stroke-width="1" fill="none" stroke-linecap="round" stroke-linejoin="round">\n        <path d="M1052.17 656.15l11.62 10.63-11.62-10.63zm11.83 10.88L1052 678l12-10.97zm-.32-.13l-27.18.13 27.18-.13z" id="Combined-Shape" transform="matrix(-1 0 0 1 2100 0)"/>\n    </g>\n    <g transform="translate(-1036 -601)" fill-rule="nonzero" stroke="#FFF" id="hub-page-next-light" stroke-width="1" fill="none" stroke-linecap="round" stroke-linejoin="round">\n        <path d="M1052.17 602.15l11.62 10.63-11.62-10.63zm11.83 10.88L1052 624l12-10.97zm-.32-.13l-27.18.13 27.18-.13z" id="Combined-Shape"/>\n    </g>\n    <g transform="translate(-1036 -655)" fill-rule="nonzero" stroke="#FFF" id="hub-page-prev-light" stroke-width="1" fill="none" stroke-linecap="round" stroke-linejoin="round">\n        <path d="M1052.17 656.15l11.62 10.63-11.62-10.63zm11.83 10.88L1052 678l12-10.97zm-.32-.13l-27.18.13 27.18-.13z" id="Combined-Shape" transform="matrix(-1 0 0 1 2100 0)"/>\n    </g>\n    <g id="material-close">\n        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>\n        <path d="M0 0h24v24H0z" fill="none"/>\n    </g>\n    <g id="material-add">\n        <path d="M0 0h24v24H0z" fill="none"/>\n        <path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n    </g>\n    <g id="material-arrow-fwd">\n        <path d="M0 0h24v24H0z" fill="none"/>\n        <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/>\n    </g>\n    <g id="material-done">\n        <path fill="none" d="M0 0h24v24H0z"/>\n        <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>\n    </g>\n\x3c!--<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"></svg>--\x3e\n    <g id="material-queue">\n        <path d="M0 0h24v24H0z" fill="none"/>\n        <path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18A3 3 0 1019 17V8h3V6h-5z"/>\n    </g>\n\x3c!--<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"></svg>--\x3e\n    <g id="material-vol-up">\n        <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3A4.5 4.5 0 0014 7.97v8.05A4.47 4.47 0 0016.5 12zM14 3.23v2.06a7 7 0 010 13.42v2.06a9 9 0 000-17.54z" id="Shape" fill="#333" fill-rule="nonzero"/>\n    </g>\n    <path fill="#333" d="M3 9v6h4l5 5V4L7 9z" id="material-vol-mute"/>\n    <g id="material-unlock">\n        <path d="M0 0h24v24H0z" fill="none"/>\n        <path d="M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6A5 5 0 007 6h1.9a3.1 3.1 0 016.2 0v2H6a2 2 0 00-2 2v10c0 1.1.9 2 2 2h12a2 2 0 002-2V10a2 2 0 00-2-2zm0 12H6V10h12v10z"/>\n    </g>\n\x3c!--<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 128 128" > <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#material-heart"></use> </svg>--\x3e\n    <path d="M25.75 36.06C10.4 51.72 18.82 70.11 41.2 90.41a249.17 249.17 0 0115.33 15.21c1.63 1.77 3.09 3.4 4.34 4.84.76.86 1.27 1.48 1.54 1.8l1.44 1.74 1.4-1.8 1.46-1.79A201.31 201.31 0 0185.85 90.4c23.11-21 31.63-39.47 15.27-54.3-11.46-10.04-22.82-8-32.73 1.29a44.91 44.91 0 00-4.78 5.28l-.1.13-.09-.13a41.46 41.46 0 00-4.48-5.45C53.8 32 48.12 29 42.04 29c-5.19 0-10.65 2.19-16.29 7.06z" id="material-heart"/>\n\x3c!--<svg width="16px" height="15px" viewBox="0 0 16 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">--\x3e\n    <g id="material-comment">\n        <path id="ic-comment" d="M14.93 0c.59 0 1.06.48 1.07 1.08v8.57c0 .59-.48 1.06-1.07 1.06H8V15l-4.27-4.29H1.07c-.59 0-1.06-.47-1.07-1.06V1.08C0 .48.48 0 1.07 0h13.86zM1.5 1.5V9.2h2.86l2.14 2.16V9.2h8V1.5h-13z"/>\n    </g>\n\x3c!--<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#material-keyboard-up"></use></svg>--\x3e\n    <g id="material-keyboard-up">\n        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>\n        <path d="M0 0h24v24H0z" fill="none"/>\n    </g>\n\x3c!--<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#material-keyboard-down"></use></svg>--\x3e\n    <g id="material-keyboard-down">\n        <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>\n        <path fill="none" d="M0 0h24v24H0V0z"/>\n    </g>\n    <defs>\n        <linearGradient id="pledge-processing-mask" x1="50%" x2="50%" y1="0%" y2="100%">\n            <stop offset="0%" stop-color="#F8E71C"/>\n            <stop offset="100%" stop-color="#4E8E25"/>\n        </linearGradient>\n    </defs>\n    <path d="M50.17 100.08l5.33 4.51c.49.69-.73 1.95-1.5 1.5l-8-7 8-7c.77-.44 1.99.82 1.5 1.5l-5.3 4.49a45 45 0 001.06-89.93l2.12-1.85a47 47 0 01-3.21 93.78zM45.46 6.12L40.1 1.59c-.48-.68.73-1.94 1.5-1.5l8 7-8 7c-.77.45-1.98-.81-1.5-1.5l5.29-4.47a45 45 0 00-1.03 89.9l-2.1 1.84a47 47 0 013.19-93.74zm1.14 71.27v-5.4a22.16 22.16 0 01-12.75-5.57l2.43-3.24c3.24 2.92 6.43 4.7 10.48 5.13v-13.5c-8-1.89-11.5-4.86-11.5-10.47v-.11c0-5.56 4.7-9.61 11.34-9.94v-3.13h3.45v3.24c4.05.38 7.18 1.9 10.32 4.32l-2.33 3.24c-2.59-2.21-5.29-3.4-8.15-3.89v13.29c8.2 1.89 11.66 5.02 11.66 10.47v.11c0 5.78-4.7 9.72-11.5 10.15v5.3H46.6zm.16-26.79V37.91c-4.54.16-7.35 2.76-7.35 6.05v.1c0 3.03 1.4 5.03 7.35 6.54zm3.13 17.88c4.59-.22 7.5-2.76 7.5-6.27v-.1c0-3.2-1.5-5.08-7.5-6.54v12.9z" transform="translate(0 .9)" id="pledge-processing"/>\n\x3c!--common icons--\x3e\n    <g id="help" fill="none" fill-rule="evenodd">\n        <rect width="15" height="15" fill="#B8B8B8" rx="7.5"/>\n        <path fill="#FFF" d="M6.57 9.8h1.72v1.7H6.57V9.8zM4.79 6.19c.01-.4.08-.76.2-1.1.14-.32.32-.6.55-.85.23-.24.5-.43.83-.57a3.45 3.45 0 012.4.01c.35.15.63.32.84.54a1.93 1.93 0 01.6 1.37 2.14 2.14 0 01-.93 1.86l-.47.35c-.15.11-.28.24-.4.39-.1.14-.18.33-.2.55v.42H6.7v-.5a2.25 2.25 0 01.54-1.34c.13-.15.27-.28.42-.39.14-.1.28-.22.4-.33.13-.1.23-.23.3-.36a.9.9 0 00.1-.5c0-.33-.07-.58-.24-.74a.94.94 0 00-.69-.24c-.2 0-.36.03-.5.11-.15.08-.27.18-.36.3-.1.14-.16.29-.2.46-.05.17-.07.36-.07.56H4.8z"/>\n    </g>\n    <g id="ic-add-video">\n        <path d="M88 32a8 8 0 018 8v19l24-24v69L96 80v16a8 8 0 01-8 8H16a8 8 0 01-8-8V40a8 8 0 018-8h72zM56 52h-8v12H36v8h12v12h8V72h12v-8H56V52z" id="ic-add-video"/>\n    </g>\n    <g id="ic-add-photo">\n        <path d="M104 8H88a8 8 0 00-8-8H32a8 8 0 00-8 8H8a8 8 0 00-8 8v56a8 8 0 008 8h96a8 8 0 008-8V16a8 8 0 00-8-8zM56 68a24 24 0 110-48 24 24 0 010 48zm4-40h-8v12H40v8h12v12h8V48h12v-8H60V28z" id="ic-add-photo"/>\n    </g>\n    <path fill="#1DA0C3" fill-rule="evenodd" d="M8.86 8.26H0L4.14.62H13L8.86 8.26" id="bc-logo-tent"/>\n\x3c!--<svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">--\x3e\n    <g id="contextual-dots" stroke="none" fill="none" fill-rule="evenodd">\n        <g transform="translate(7 17)" fill="#818285">\n            <circle cx="3" cy="3" r="3"/>\n            <circle cx="13" cy="3" r="3"/>\n            <circle cx="23" cy="3" r="3"/>\n        </g>\n        <path d="M0 0h40v40H0z"/>\n    </g>\n\x3c!--<svg width="128px" height="128px" viewBox="0 0 128 128" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">--\x3e\n    <g id="report-flag-icon">\n        <path fill="none" d="M0 0h128v128H0z"/>\n        <path d="M34.56 20v95.7h-7.9V20h7.9zm7.78 5.01s9.54-10 19.34 0c21.28 21.72 40.61-.65 40.61-.65v46.58s-19.33 22.37-40.61.65c-9.8-10-19.34 0-19.34 0z"/>\n    </g>\n\n    \n    \x3c!-- <svg id="icon-allow-comment" width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg> --\x3e\n    <g id="allow-comment-icon">\n        <polygon points="15.981 3 6.573 13.501 2.708 9.635 2 10.342 6.614 14.956 16.726 3.668"></polygon>\n    </g>\n\n    \x3c!-- <svg class="live-calendar-icon" viewBox="0 0 12 11"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#live-calendar-icon"></use></svg> --\x3e\n    <g id="live-calendar-icon" fill="none" fill-rule="evenodd">\n        <g id="live-calendar-icon-stroke" transform="translate(-1033 -482)" stroke-width=".9">\n            <g id="component/event-card/4-col" transform="translate(744 209.5)">\n                <g id="Group" transform="translate(289 272)">\n                    <rect id="Rectangle" x=".45" y="2.65" width="10.73" height="8.36" rx="1.8"/>\n                    <path id="Path" d="M2.91.66v3.08M8.72.66v3.08"/>\n                    <path id="Path-4" d="M.83 5.67h10.8"/>\n                </g>\n            </g>\n        </g>\n    </g>\n\n    \x3c!-- <svg class="live-clock-icon" viewBox="0 0 12 11"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#live-clock-icon"></use></svg> --\x3e\n    <g id="live-clock-icon" fill="none" fill-rule="evenodd">\n        <g id="live-clock-icon-stroke" transform="translate(-1033 -499)" >\n            <g id="component/event-card/4-col" transform="translate(744 209.5)">\n                <g id="icon/clock" transform="translate(289 289)">\n                    <circle id="Oval" cx="6" cy="6.5" r="5.5"/>\n                    <path id="Path-5" d="M6 2.53V7h3.03"/>\n                </g>\n            </g>\n        </g>\n    </g>\n\n\n\n    \x3c!-- <svg id="icon-ban" width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg> --\x3e\n    <g id="ban-user-icon">\n        <path d="M8.0002,0.0002 C3.5822,0.0002 0.0002,3.5822 0.0002,8.0002 C0.0002,12.4182 3.5822,16.0002 8.0002,16.0002 C12.4182,16.0002 16.0002,12.4182 16.0002,8.0002 C16.0002,3.5822 12.4182,0.0002 8.0002,0.0002 L8.0002,0.0002 Z M8.0002,1.0002 C11.8602,1.0002 15.0002,4.1402 15.0002,8.0002 C15.0002,11.8592 11.8602,15.0002 8.0002,15.0002 C4.1402,15.0002 1.0002,11.8592 1.0002,8.0002 C1.0002,4.1402 4.1402,1.0002 8.0002,1.0002 L8.0002,1.0002 Z M8.7072,8.0002 L11.6472,10.9402 L10.9402,11.6472 L8.0002,8.7072 L5.0592,11.6472 L4.3522,10.9402 L7.2922,8.0002 L4.3522,5.0592 L5.0592,4.3522 L8.0002,7.2932 L10.9402,4.3522 L11.6472,5.0592 L8.7072,8.0002 Z"></path>\n    </g>\n    \n\n    \x3c!-- <svg id="icon-delete-comment" fill-rule="evenodd" width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg> --\x3e\n    <g id="delete-comment-icon" fill-rule="evenodd">\n        <path d="M10.5,14.518 L11.5,14.518 L11.5,5.37 L10.5,5.37 L10.5,14.518 Z M6.5,14.518 L7.5,14.518 L7.5,5.37 L6.5,5.37 L6.5,14.518 Z M4.017,16.002 L14.017,16.002 L14.017,3.887 L4.017,3.887 L4.017,16.002 Z M6.464,2.887 L11.536,2.887 L11.536,2 L6.464,2 L6.464,2.887 Z M14.001,2.887 L12.536,2.887 L12.536,1 L5.464,1 L5.464,2.887 L3.999,2.887 L1,2.887 L1,3.887 L3,3.887 L3,15.989 C3,16.541 3.447,16.988 3.999,16.988 L14.001,16.988 C14.553,16.988 15,16.541 15,15.989 L15,3.887 L17,3.887 L17,2.887 L14.001,2.887 Z"></path>\n    </g>\n\n    \x3c!-- <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"></svg> --\x3e\n    <g id="ic-edit">\n        <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n            <path d="m12.02 6.27 1.06-1.07a.56.56 0 0 0 .17-.41c0-.16-.06-.3-.17-.41l-1.36-1.36a.56.56 0 0 0-.4-.17c-.17 0-.31.06-.42.17L9.83 4.08l2.19 2.19zm-7.09 7.08L11.4 6.9 9.2 4.7l-6.45 6.46v2.18h2.18z"/>\n        </svg>\n    </g>\n\n    \x3c!-- <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"> --\x3e\n    <g id="ic-tooltip">\n        <path d="M8 15.06a6.55 6.55 0 0 0 5.74-3.28c.61-1.04.92-2.16.92-3.38a6.55 6.55 0 0 0-3.28-5.74A6.55 6.55 0 0 0 8 1.74c-1.2 0-2.33.3-3.36.92-1 .58-1.8 1.38-2.38 2.38a6.52 6.52 0 0 0-.92 3.36c0 1.2.3 2.33.92 3.36A6.55 6.55 0 0 0 8 15.06zm0-1.32a5.2 5.2 0 0 1-2.69-.73 5.18 5.18 0 0 1-1.92-1.92 5.2 5.2 0 0 1 0-5.38A5.18 5.18 0 0 1 5.31 3.8a5.2 5.2 0 0 1 5.38 0c.8.47 1.45 1.11 1.92 1.92a5.2 5.2 0 0 1 0 5.38A5.18 5.18 0 0 1 10.69 13a5.2 5.2 0 0 1-2.69.73zm.66-3.34c0-.33.1-.64.32-.93.11-.16.34-.38.67-.68.33-.3.56-.53.69-.73.2-.3.32-.64.32-1A2.72 2.72 0 0 0 8 4.4a2.72 2.72 0 0 0-2.66 2.66h1.32c0-.37.13-.68.4-.93.26-.26.58-.39.94-.39s.68.13.94.39c.27.25.4.56.4.93 0 .24-.07.46-.2.65-.1.14-.27.3-.5.48l-.6.48a2.19 2.19 0 0 0-.7 1.73h1.32zm0 2v-1.34H7.34v1.34h1.32z" fill="#999"/>\n    </g>\n\n    \x3c!-- <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"> --\x3e\n    <g id="ic-camera-small">\n        <path d="M9.21 5.93H7.57v1.65h-.93V5.93H5V5h1.64V3.36h.93V5h1.64v.93zm-2.13 3.1A3.57 3.57 0 0 1 3.53 5.5c0-1.94 1.6-3.54 3.55-3.54 1.93 0 3.54 1.6 3.54 3.54s-1.6 3.54-3.54 3.54zm6.2-7.86h-2.75C10.53.53 10 0 9.36 0H4.68C4.03 0 3.5.53 3.5 1.17H.76a.77.77 0 0 0-.76.76v7.43c0 .4.35.76.76.76h12.46c.4 0 .76-.35.76-.76V1.93c.11-.41-.24-.76-.7-.76z"/>\n    </g>\n\n    \x3c!-- <svg width="326" height="324" xmlns="http://www.w3.org/2000/svg"> --\x3e\n    <g id="ic-spinny">\n        <g transform="translate(0 2)" opacity=".99" fill="none" fill-rule="evenodd">\n            <circle fill="#A4A4A5" cx="161" cy="287" r="35"/>\n            <circle fill="#606463" cx="161" cy="35" r="35"/>\n            <circle fill="#D2D2D1" transform="rotate(90 35 161)" cx="35" cy="161" r="35"/>\n            <circle fill="#7C7F7E" transform="rotate(90 287 161)" cx="287" cy="161" r="35"/>\n            <circle fill="#BBBAB9" transform="rotate(45 71.9 250.1)" cx="71.9" cy="250.1" r="35"/>\n            <circle fill="#717474" transform="rotate(45 250.1 71.9)" cx="250.1" cy="71.9" r="35"/>\n            <circle fill="#DCDCDC" transform="rotate(135 71.9 71.9)" cx="71.9" cy="71.9" r="35"/>\n            <circle fill="#8D8F8F" transform="rotate(135 250.1 250.1)" cx="250.1" cy="250.1" r="35"/>\n        </g>\n    </g>\n</svg>\n\n']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_action_pane.liquid","warn"):Templ.register({"fan/signup/fan_action_pane":['<form id="signup-vm" class=\'action-form modern-form signup-common-form\' data-bind=\'css: { "visible": visible }, submit: openSignup\' novalidate>\n    <a id="signup-anchor"></a>\n\n    <div class="signup-common-inner">\n        ',{type:"case",blocks:[{type:"condition",left:"action",right:"'wishlist'",operator:"==",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"action_item_type == 'a' || action_item_type == 'album' ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["To wishlist this album, please sign up for a free Bandcamp account (or log in if you already have one):"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["To wishlist this album, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one):"]},"\n                "]}]},"\n            "]},{type:"ncondition",expression:"action_item_type == 't' || action_item_type == 'track' ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["To wishlist this track, please sign up for a free Bandcamp account (or log in if you already have one):"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["To wishlist this track, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one):"]},"\n                "]}]},"\n            "]}]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'follow'",operator:"==",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"action_item_type == 'b' || !action_item_type ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["To follow this artist, please sign up for a free Bandcamp account (or log in if you already have one):"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["To follow this artist, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one):"]},"\n                "]}]},"\n            "]},{type:"ncondition",expression:"action_item_type == 'f' ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["To follow this fan, please sign up for a free Bandcamp account (or log in if you already have one):"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["To follow this fan, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one):"]},"\n                "]}]},"\n            "]},{type:"ncondition",expression:"action_item_type == 'g' ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:["\n                    ",{type:"translate",nodelist:["To follow this genre, please sign up for a free Bandcamp account (or log in if you already have one):"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["To follow this genre, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one):"]},"\n                "]}]},"\n            "]}]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'live_ticket'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> to continue your live ticket purchase."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'live_attend'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> to join this live stream."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'live_attend_immediate'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> to join this live stream."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'gift_cards'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["Please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> to continue your gift card purchase."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'redeem'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["To finish redeeming your gift card, please <a ",{type:"translateVariable",var_name:"signup_link",nodelist:['href="#" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp account (or <a ",{type:"translateVariable",var_name:"login_link",nodelist:['href="#" data-bind="click: openLogin"']},">log in</a> if you already have one)."]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'change_pledge'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["To change your pledge, please <a ",{type:"translateVariable",var_name:"signup_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp fan account (or <a ",{type:"translateVariable",var_name:"login_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openLogin"']},">log in</a> if you already have one):"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'update_pledge_payment'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["To update your payment info, please <a ",{type:"translateVariable",var_name:"signup_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp fan account (or <a ",{type:"translateVariable",var_name:"login_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openLogin"']},">log in</a> if you already have one):"]},"\n        "],child_relation:null,child_condition:null},{type:"condition",left:"action",right:"'update_pledge_address'",operator:"==",attachment:["\n            ",{type:"translate",nodelist:["To change your address, please <a ",{type:"translateVariable",var_name:"signup_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openSignup"']},">sign up</a> for a free Bandcamp fan account (or <a ",{type:"translateVariable",var_name:"login_attr",nodelist:['class="crowdfunding-signup-login-link" data-bind="click: openLogin"']},">log in</a> if you already have one):"]},"\n        "],child_relation:null,child_condition:null}]},'\n\n        <div class="buttons">\n            <button class="signup" type="submit" data-bind="click: openSignup">\n                ',{type:"translate",nodelist:["Sign up"]},'\n            </button>\n            <button class="login" type="submit" data-bind="click: openLogin">\n                ',{type:"translate",nodelist:["Log in"]},"\n            </button>\n        </div>\n    </div>\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/search_tooltip.liquid","warn"):Templ.register({"fan/tooltips/search_tooltip":[{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:['\n<div class="',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["inner-circle-wrapper"]}]},'">\n    <div class="inner-circle"></div>\n</div>\n</div>\n']}]},'\n<div class="signup-tooltip search-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["\n            ",{type:"translate",nodelist:["Search Bandcamp by artist, album or track. Browse music by genre, format, and more."]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["You can search Bandcamp by artist, album or track."]},"\n        "]}]},'\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/feed_tooltip.liquid","warn"):Templ.register({"fan/tooltips/feed_tooltip":['<div class="',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["inner-circle-wrapper"]}]},'">\n    <div class="inner-circle"></div>\n    <div class="inner-circle-contents">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:['\n        <a href="',{type:"variable",name:"fan_onboarding.feed_url",filters:[["a",[]]]},'">\n            <svg width="26px" height="26px" class="svg-icon"><use xlink:href="#menubar-feed-icon"></svg>\n        </a>\n    ']},{type:"else_ncondition",attachment:['\n        <a class="dismiss-tooltip-alt" href="',{type:"variable",name:"fan_onboarding.feed_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["feed"]},"</a>\n    "]}]},'\n    </div>\n</div>\n\n<div class="signup-tooltip feed-tooltip',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["-header-2018"]}]},'">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>\n\n        ",{type:"translate",nodelist:["Check your feed for new music in your favorite genres and from artists you follow."]},'\n\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/discover_tooltip.liquid","warn"):Templ.register({"fan/tooltips/discover_tooltip":['<div>\n    <div class="inner-circle"></div>\n    <div class="inner-circle-contents">\n        <a class="dismiss-tooltip-alt" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/#discover">',{type:"translate",nodelist:["discover"]},'</a>\n    </div>\n</div>\n\n<div class="signup-tooltip discover-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>\n        ",{type:"translate",nodelist:["Discover lets you browse music by genre, format, and more."]},'\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/follow_tooltip.liquid","warn"):Templ.register({"fan/tooltips/follow_tooltip":['<div class="signup-tooltip follow-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['<div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>"]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.band_name.length > 26 ",attachment:["\n            ",{type:"translate",nodelist:['Youre now following this artist and your email has been added to their mailing list (to undo, click "Following").']},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["Youre now following ",{type:"translateVariable",var_name:"bandname",nodelist:[{type:"variable",name:"fan_onboarding.band_name",filters:[["h",[]],["truncate",["26"]]]}]},' and your email has been added to their mailing list (to undo, click "Following").']},"\n        "]}]},'\n        \n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/genre_follow_tooltip.liquid","warn"):Templ.register({"fan/tooltips/genre_follow_tooltip":['<div class="signup-tooltip follow-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['<div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>"]}]},"\n\n        ",{type:"translate",nodelist:["Youre now following ",{type:"translateVariable",var_name:"tagname",nodelist:[{type:"variable",name:"fan_onboarding.tag_name",filters:[["h",[]],["truncate",["26"]]]}]},", which means youll get updates about the best releases from this genre in your feed."]},'\n        \n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/wishlist_tooltip.liquid","warn"):Templ.register({"fan/tooltips/wishlist_tooltip":['<div class="',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["inner-circle-wrapper"]}]},'">\n    <div class="inner-circle"></div>\n    <div class="inner-circle-contents">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:['\n            <a class="dismiss-tooltip-alt" ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.wishlist_url ",attachment:['href="',{type:"variable",name:"fan_onboarding.wishlist_url",filters:[["a",[]]]},'"']}]},'><svg width="26px" height="26px" class="svg-icon"><use xlink:href="#menubar-collection-icon"></svg></a>\n        ']},{type:"else_ncondition",attachment:['\n            <a class="dismiss-tooltip-alt" ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.wishlist_url ",attachment:['href="',{type:"variable",name:"fan_onboarding.wishlist_url",filters:[["a",[]]]},'"']}]},">",{type:"translate",nodelist:["wishlist"]},"</a>\n        "]}]},'\n    </div>\n</div>\n\n<div class="signup-tooltip wishlist-tooltip">\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['\n            <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>"]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.first_wishlisted_item_title.length > fan_onboarding.first_wishlist_item_title_length ",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.first_wishlisted_item_type == 't' ",attachment:["\n                ",{type:"translate",nodelist:["This track is now in your wishlist."]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["This album is now in your wishlist."]},"\n            "]}]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["",{type:"translateVariable",var_name:"album_title",nodelist:[{type:"variable",name:"fan_onboarding.first_wishlisted_item_title",filters:[["h",[]],["truncate",["26"]]]}]}," is now in your wishlist."]},"\n        "]}]},'\n\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/wishlist_button_tooltip.liquid","warn"):Templ.register({"fan/tooltips/wishlist_button_tooltip":['<div>\n    <div class="inner-circle"></div>\n    <div class="inner-circle-contents">\n        <div class="tralbum-wishlist-link">\n            <a class="dismiss-tooltip-alt" ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.wishlist_url ",attachment:['href="',{type:"variable",name:"fan_onboarding.wishlist_url",filters:[["a",[]]]},'"']}]},">",{type:"translate",nodelist:["view"]},'</a>\n        </div>\n\n        <div class="collection-wishlist-link">\n            <span>\n                <span>\n                    <span class="bc-ui2 collect-item-icon trigger"></span>\n                    <span class="text trigger"><a>',{type:"translate",nodelist:["in wishlist"]},'</a></span>\n                </span>\n                <span class="view"><a target="_blank" href="',{type:"variable",name:"fan_onboarding.wishlist_url",filters:[["a",[]]]},'">&raquo;</a></span>\n            </span>\n        </div>\n    </div>\n</div>\n\n<div class="signup-tooltip wishlist-button-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        <div class="signup-tooltip-body">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['\n                <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>\n            "]}]},"\n\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.first_wishlisted_item_title.length > 26 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.first_wishlisted_item_type == 't' ",attachment:["\n                    ",{type:"translate",nodelist:["This track is now in your wishlist."]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["This album is now in your wishlist."]},"\n                "]}]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["",{type:"translateVariable",var_name:"album_title",nodelist:[{type:"variable",name:"fan_onboarding.first_wishlisted_item_title",filters:[["h",[]],["truncate",["26"]]]}]}," is now in your wishlist."]},"\n            "]}]},'\n        </div>\n\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/fan_follow_tooltip.liquid","warn"):Templ.register({"fan/tooltips/fan_follow_tooltip":['<div class="following-button-wrapper">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.origin_page == 'home' ",attachment:['\n        <a class="follow-fan-btn-inactive">\n            <span class="following-msg">',{type:"translate",nodelist:["Following"]},"</span>\n        </a>\n    "]},{type:"else_ncondition",attachment:['\n        <button type="button" class="follow-unfollow-inactive following">\n            <span class="plus">\n            <svg class="icon follow-plus" width="10px" height="10px" viewBox="0 0 8 8"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#follow-plus"></use></svg>\n            </span>\n            <span class="checkmark">\n            <svg class="icon following-checkmark" width="14px" height="12px" viewBox="0 0 14 10"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#following-checkmark"></use></svg>\n            </span>\n            <div class="following-msg">',{type:"translate",nodelist:["Following"]},"</div>\n        </button>\n    "]}]},'\n</div>\n\n<div class="signup-tooltip fan-follow-tooltip">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['<div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>"]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.fan_name.length > 26 || !fan_onboarding.fan_name ",attachment:["\n            ",{type:"translate",nodelist:["Youre now following this fan, which means youll get updates about their activity in your feed."]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["Youre now following ",{type:"translateVariable",var_name:"bandname",nodelist:[{type:"variable",name:"fan_onboarding.fan_name",filters:[["h",[]],["truncate",["26"]]]}]},", which means youll get updates about their activity in your feed."]},"\n        "]}]},'\n\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/tooltips/collection_tooltip.liquid","warn"):Templ.register({"fan/tooltips/collection_tooltip":['<div>\n    <div class="inner-circle"></div>\n    <div class="inner-circle-contents">\n        <a class="dismiss-tooltip-alt" ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.collection_url ",attachment:['href="',{type:"variable",name:"fan_onboarding.collection_url",filters:[["a",[]]]},'"']}]},'>\n            <svg width="26" height="26" viewBox="0 0 26 26" class="svg-icon"><use xlink:href="#menubar-collection-icon"></svg>\n        </a>\n    </div>\n</div>\n\n<div class="signup-tooltip collection-tooltip">\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding && fan_onboarding.tooltips ",attachment:['\n    <div class="signup-tooltip-inner">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.num_tooltips > 1 ",attachment:['\n            <div class="position">',{type:"translate",nodelist:["Tip ",{type:"translateVariable",var_name:"tip_number",nodelist:[{type:"variable",name:"(fan_onboarding.tooltip_number)",filters:[["h",[]]]}]}," of ",{type:"translateVariable",var_name:"number_of_tips",nodelist:[{type:"variable",name:"fan_onboarding.num_tooltips",filters:[["h",[]]]}]},""]},"</div>"]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"!fan_onboarding.first_purchased_item_title || fan_onboarding.first_purchased_item_title.length > 26 ",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.first_purchased_item_title == 't' ",attachment:["\n                ",{type:"translate",nodelist:["This track is now in your collection."]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["This album is now in your collection."]},"\n            "]}]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["",{type:"translateVariable",var_name:"album_title",nodelist:[{type:"variable",name:"fan_onboarding.first_purchased_item_title",filters:[["h",[]],["truncate",["16"]]]}]}," is now in your collection."]},"\n        "]}]},'\n\n        <a class="dismiss-tooltip" href="#">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_onboarding.current_index == (fan_onboarding.tooltips.length - 1) ",attachment:["\n                ",{type:"translate",nodelist:["Got it, thanks!"]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Next tip"]},"\n            "]}]},"\n        </a>\n    </div>\n    "]}]},"\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/menubar.liquid","warn"):Templ.register({menubar:["\n\n\n\n",{type:"let",variable:"has_full_access",expression:"!menubar.force_no_control && (page_identities.is_page_band_member || page_identities.is_admin) "},"\n",{type:"let",variable:"has_limited_access",expression:"page_identities.page_band_parent_label_id && !page_identities.page_band.authed "},"\n",{type:"let",variable:"has_access",expression:"has_full_access || has_limited_access "},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.bands.length >= 1 ",attachment:["\n    ",{type:"let",variable:"b",expression:"page_identities.bands[0] "},"\n    ",{type:"let",variable:"artistsmenu_title",expression:"b.name "},"\n    ",{type:"let",variable:"artistsmenu_show_photo",expression:"true "},"\n    ",{type:"let",variable:"artistsmenu_photo",expression:"b.photo "},"\n    ",{type:"let",variable:"artistsmenu_show_pro",expression:"b.is_pro "},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"artistsmenu_title",expression:'"artists" '},"\n    ",{type:"let",variable:"artistsmenu_show_photo",expression:"false "},"\n    ",{type:"let",variable:"artistsmenu_photo",expression:"nil "},"\n    ",{type:"let",variable:"artistsmenu_show_pro",expression:"menubar.any_pro "},"\n"]}]},"\n\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.page_band && has_full_access ",attachment:["\n    ",{type:"let",variable:"hide_unless_has_full_access",expression:'"" '},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"hide_unless_has_full_access",expression:'"hidden-while-loading" '},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.page_band && has_access ",attachment:["\n    ",{type:"let",variable:"hide_unless_has_access",expression:'"" '},"\n    ",{type:"let",variable:"hide_if_has_access",expression:'"hidden-while-loading" '},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"hide_unless_has_access",expression:'"hidden-while-loading" '},"\n    ",{type:"let",variable:"hide_if_has_access",expression:'"" '},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.page_band && page_identities.page_band.is_label && has_full_access ",attachment:["\n    ",{type:"let",variable:"hide_if_not_logged_in_label",expression:'"" '},"\n    ",{type:"let",variable:"hide_if_logged_in_label",expression:'"hidden-while-loading" '},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"hide_if_not_logged_in_label",expression:'"hidden-while-loading" '},"\n    ",{type:"let",variable:"hide_if_logged_in_label",expression:'"" '},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.page_band && page_identities.page_band.is_label && menubar.artist_subscriptions_enabled ",attachment:["\n    ",{type:"ef",blocks:[{type:"ncondition",expression:'menubar.unshipped_order_count == "async" ',attachment:["\n        ",{type:"let",variable:"wide",expression:"false "},"\n        ",{type:"let",variable:"extra_wide",expression:"true "},"\n    "]},{type:"ncondition",expression:"menubar.unshipped_order_count && menubar.unshipped_order_count >= 10 ",attachment:["\n        ",{type:"let",variable:"wide",expression:"false "},"\n        ",{type:"let",variable:"extra_wide",expression:"true "},"\n    "]},{type:"else_ncondition",attachment:["\n        ",{type:"let",variable:"wide",expression:"true "},"\n        ",{type:"let",variable:"extra_wide",expression:"false "},"\n    "]}]},"\n"]},{type:"ncondition",expression:"!hide_search && page_identities.fan ",attachment:["\n        ",{type:"let",variable:"wide",expression:"false "},"\n        ",{type:"let",variable:"extra_wide",expression:"true "},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"wide",expression:"false "},"\n    ",{type:"let",variable:"extra_wide",expression:"false "},"\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 && page_identities.bands.length > 0 && page_identities.fan ",attachment:["\n    ",{type:"let",variable:"show_balance_number",expression:"false "},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"show_balance_number",expression:"true "},"\n"]}]},'\n\n<div id="menubar-vm" class="menubar-outer loading" data-initial-values="',{type:"variable",name:"menubar",filters:[["json",[]],["a",[]]]},'">\n<div id="menubar"\n    class="\n        menubar-2018\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"(!page_identities.page_band || menubar.force_no_control) && (!has_full_access || (is_admin && page_identities.page_band != 0)) ",attachment:["out"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"wide ",attachment:["wide"]}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"extra_wide ",attachment:["extra-wide"]}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"is_admin_impersonating ",attachment:["admin-impersonating"]}]},'\n    "\n>\n<ul id="site-nav" class="menubar-section horizontal">\n\n    \n    <li class="bclogo white"><a href="',{type:"variable",name:"siteroot_current",filters:[["a",[]]]},"/?from=",{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user) ",attachment:["menubar_logo_logged_out"]},{type:"else_ncondition",attachment:["menubar_logo_logged_in"]}]},'"><svg width="108px" height="17px" viewBox="0 0 127 20"><use xlink:href="#bandcamp-logo-color-white"></svg></a></li>\n    <li class="bclogo aqua"><a href="',{type:"variable",name:"siteroot_current",filters:[["a",[]]]},"/?from=",{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user) ",attachment:["menubar_logo_logged_out"]},{type:"else_ncondition",attachment:["menubar_logo_logged_in"]}]},'"><svg width="108px" height="17px" viewBox="0 0 127 20"><use xlink:href="#bandcamp-logo-color-bcaqua"></svg></a></li>\n\n\n    \x3c!-- ko if: showBandControls() || showLimitedAccessControls() --\x3e\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.show_dashboard_link ",attachment:['\n    <li class="menubar-item hoverable ',{type:"variable",name:"hide_unless_has_access",filters:[]},'">\n        <a data-bind="attr: {href: dashboardLinkHref()}">',{type:"translate",nodelist:["dashboard"]},'</a>\n    </li>\n    <li class="tralbum-tooltip-parent dash-link" data-bind="css: {\'show-tooltip\': dashboardTooltipVM().showing}">\n        <div class="tralbum-tooltip-outer">\n            <div class="inner-circle-wrapper">\n                <div class="inner-circle"></div>\n                <div class="inner-circle-contents">\n                    <a class="tooltip-action" data-bind="click: dashboardTooltipVM().close, attr: {href: dashboardLinkHref()}, text: dashboardTooltipVM().centralText"></a>\n                </div>\n            </div>\n            <div class="tralbum-tooltip">\n                <div class="tralbum-tooltip-inner">\n                    <span class="progress" data-bind="text: dashboardTooltipVM().progress"></span>\n                    <span data-bind="text: dashboardTooltipVM().tipText"></span>\n                    <a class="dismiss-tooltip" data-bind="click: dashboardTooltipVM().continueTips, text: dashboardTooltipVM().closeText"></a>\n                </div>\n            </div>\n        </div>\n    </li>\n    ']}]},'\n    <li class="menubar-item hoverable ',{type:"variable",name:"hide_unless_has_access",filters:[]},' add-menu">\n        <a class="menubar-add-link">',{type:"translate",nodelist:["+ add"]},'</a>\n        <ul class="menu hidden-while-loading">\n            \n            \x3c!-- ko if: showBandControls() || showLimitedAccessControls() --\x3e\n            <ol data-bind="css: {\'page-band-links\': pageBand.isLabel()}">\n                <li class="submenu-item"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_album\'}, click: addAlbumClick">',{type:"translate",nodelist:["album"]},'</a></li>\n                <li class="submenu-item"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_track\'}, click: addTrackClick">',{type:"translate",nodelist:["track"]},'</a></li>\n                <li class="submenu-item"><a id="menubar-add-merch-link" data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_merch\'}, click: addMerchClick"><span class="add-music">',{type:"translate",nodelist:["merch"]},"</span></a></li>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.show_crowdfunding_link ",attachment:['\n                    <li class="submenu-item"><a id="menubar-add-merch-link" data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_vinyl_campaign\'}"><span class="add-music">',{type:"translate",nodelist:["vinyl campaign"]},"</span></a></li>\n                "]}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.show_add_live_show ",attachment:['\n                    <li class="submenu-item"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_live_show\'}">',{type:"translate",nodelist:["live stream"]},"</a></li>\n                "]}]},'\n            </ol>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: showBandControls() && pageBand.isLabel() --\x3e\n            <ol>\n                <li class="ui-widget-content ui-menu-divider"></li>\n                <li class="submenu-item"><a data-bind="click: addNewArtist">',{type:"translate",nodelist:["new artist"]},'</a></li>\n                <li class="submenu-item"><a data-bind="click: addExistingArtist">',{type:"translate",nodelist:["existing artist"]},"</a></li>\n            </ol>\n            \x3c!-- /ko --\x3e\n        </ul>\n    </li>\n    \x3c!-- /ko --\x3e\n\n    \n\n    \x3c!-- ko if: showBandControls() || showLimitedAccessControls() --\x3e\n    \n    ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.unshipped_order_count ",attachment:['\n        <li class="menubar-item hoverable ',{type:"variable",name:"hide_unless_has_access",filters:[]},'">\n            <a data-bind="attr: {href: ordersLinkHref}"> \x3c!-- clairenote change link to not pageband --\x3e\n                ',{type:"ef",blocks:[{type:"ncondition",expression:'menubar.unshipped_order_count == "async" ',attachment:['\n                    <span class="hidden-after-loading">\n                        ',{type:"translate",nodelist:['\n                            <span class="unshipped-orders-loading">',{type:"translateVariable",var_name:"order_count",nodelist:["&hellip;"]},"</span> orders\n                        "]},'\n                    </span>\n                    <span class="hidden-while-loading" data-bind="\n                        html: unshippedOrderCountDisplay"></span>\n                ']},{type:"ncondition",expression:"menubar.unshipped_order_count == 0 ",attachment:["\n                    ",{type:"translate",nodelist:["orders"]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translatePlural",blocks:[{type:"ncondition",expression:"menubar.unshipped_order_count== 1",attachment:['\n                        <span class="num order">1</span> order\n                    ']},{type:"else_ncondition",attachment:['\n                        <span class="num order">',{type:"translateVariable",var_name:"order_count",nodelist:[{type:"variable",name:"menubar.unshipped_order_count",filters:[["h",[]]]}]},"</span> orders\n                    "]}]},"\n                "]}]},"\n            </a>\n        </li>\n    "]}]},'\n\n    \n        <li class="menubar-item hoverable ',{type:"variable",name:"hide_unless_has_access",filters:[]},'">\n            <a data-bind="attr: {href: statsLinkHref2018}">',{type:"translate",nodelist:["stats"]},"</a>\n        </li>\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.artist_subscriptions_enabled ",attachment:['\n        <li class="menubar-item ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.artist_service_active ",attachment:["hoverable"]}]},'">\n        \x3c!-- ko if: pageBand.hasService() --\x3e\n            <a><span class="subscription-name add-music has-children ',{type:"variable",name:"hide_unless_has_access",filters:[]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!menubar.artist_service_active ",attachment:["hidden-while-loading"]}]},'">',{type:"translate",nodelist:["subscription"]},'</span></a>\n            <ul class="menu subscription-menu">\n                <li class="submenu-item"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/\' + pageBand.serviceUrlFragment() + \'?from=menubar\'}"><strong data-bind="text: pageBand.serviceName">',{type:"variable",name:"menubar.artist_service_name",filters:[["h",[]]]},'</strong></a></li> \x3c!-- clairenote artist_service_name is for pageartist artist_service_has_subscribers too--\x3e\n                <li class="submenu-item"><a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/edit_subscription?from=menubar\'}">',{type:"translate",nodelist:["edit"]},'</a></li>\n                <li class="',{type:"ef",blocks:[{type:"ncondition",expression:"!menubar.artist_service_has_subscribers ",attachment:["ui-state-disabled"]}]},' submenu-item">\n                    <a ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.artist_service_has_subscribers ",attachment:["data-bind=\"attr: {href: pageBand.trackpipeLocalUrl() + '/subscribers?from=menubar'}\""]}]},">",{type:"translate",nodelist:["subscribers"]},'</a>\n                </li>\n                <li class="submenu-item">\n                    <a data-bind="attr: {href: pageBand.trackpipeLocalUrl() + \'/community?from=menubar\'}">',{type:"translate",nodelist:["message subscribers"]},"</a>\n                </li>\n            </ul>\n        \x3c!-- /ko --\x3e\n        </li>\n    "]}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.live_events ",attachment:['\n        <li class="menubar-item hoverable">\n            <a><span class="add-music has-children ',{type:"variable",name:"hide_unless_has_access",filters:[]},'">',{type:"translate",nodelist:["live streams"]},'</span></a>\n            <ul class="menu live-menu">\n                <ol class="live-events">\n                    \x3c!-- ko if: artistsMenu.liveEvents().drafts.length --\x3e\n                        <li class="submenu-label"><b>',{type:"translate",nodelist:["draft events"]},'</b></li>\n                        <ol data-bind="foreach: { data: artistsMenu.liveEvents().drafts, as: \'event\' }">\n                            <li class="submenu-item">\n                                <a data-bind="text: event.title, attr: { href: event.url }"></a>\n                            </li>\n                        </ol>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: artistsMenu.liveEvents().upcoming.length --\x3e\n                        <li class="submenu-label"><b>',{type:"translate",nodelist:["upcoming events"]},'</b></li>\n                        <ol data-bind="foreach: { data: artistsMenu.liveEvents().upcoming, as: \'event\' }">\n                            <li class="submenu-item"><a data-bind="text: event.title, attr: { href: event.url }"></a></li>\n                        </ol>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: artistsMenu.liveEvents().past.length --\x3e\n                        <li class="submenu-label"><b>',{type:"translate",nodelist:["past events"]},'</b></li>\n                        <ol data-bind="foreach: { data: artistsMenu.liveEvents().past, as: \'event\' }">\n                            <li class="submenu-item"><a data-bind="text: event.title, attr: { href: event.url }"></a></li>\n                        </ol>\n                    \x3c!-- /ko --\x3e\n                </ol>\n            </ul>\n        </li>\n    ']}]},"\n\n    \x3c!-- /ko --\x3e\n    \x3c!-- ko ifnot: showBandControls() || showLimitedAccessControls() --\x3e\n    \x3c!-- ko ifnot: showMobileAutocomplete() --\x3e\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_search ",attachment:['\n        <li id="main-search-container" class="search extended menubar-item ',{type:"variable",name:"hide_if_has_access",filters:[]},'">\n            ',{type:"include",template_name:"'_autocomplete_search_widget'"},"\n        </li>\n    "]}]},'\n    \x3c!-- /ko --\x3e\n    \x3c!-- /ko --\x3e\n</ul>\n\n<ul id="user-nav" class="menubar-section horizontal">\n\x3c!-- ko if: user() --\x3e\n\n    \n    \x3c!-- ko if: partner() --\x3e\n    <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.partner ",attachment:["hidden-while-loading"]}]},'">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/partner">',{type:"translate",nodelist:["partner"]},"</a>\n    </li>\n    \x3c!-- /ko --\x3e\n\n    \x3c!-- ko if: showBandControls() || showLimitedAccessControls() --\x3e\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_search ",attachment:['\n        \n        \n        \x3c!-- ko ifnot: showMobileAutocomplete() --\x3e\n        \x3c!-- ko if: altSearch() --\x3e\n        <li id="alt-search-container" class="search extended menubar-item ',{type:"variable",name:"hide_if_has_access",filters:[]},' hidden-while-loading" data-bind="visible: altSearch()">\n            ',{type:"include",template_name:"'_autocomplete_search_widget'"},'\n        </li>\n        \x3c!-- /ko --\x3e\n        \n        <li class="you-autocomplete-me menubar-item ',{type:"variable",name:"hide_unless_has_access",filters:[]},' hoverable" data-bind="click: showAltSearch, visible: !altSearch()">\n            <a><svg width="26px" height="26px" viewBox="0 0 26 26" class="svg-icon"><use xlink:href="#menubar-search-icon"></svg></a>\n        </li>\n        \x3c!-- /ko --\x3e\n    ']}]},"\n    \x3c!-- /ko --\x3e \x3c!-- claire minimized search for artist --\x3e\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"has_corp_header ",attachment:["\n        ",{type:"include",template_name:"'corp_hiring_banner'"},"\n    "]}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.gift_card_balance ",attachment:['\n    <li class="menubar-item hoverable menubar-gift-card-balance">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/redeem">\n            <svg class="icon gift-card-icon-bordered" width="9px" height="10px" viewBox="0 0 9 10"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#gift-card-icon"></use></svg>\n            \n            <span class="gift-card-balance">',{type:"variable",name:"menubar.gift_card_balance",filters:[["money",["1"]],["h",[]]]}," ",{type:"variable",name:"menubar.gift_card_balance.currency",filters:[["h",[]]]},"</span>\n        </a>\n    </li>\n    "]}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.user && !hide_cart_icon ",attachment:['\n    <li data-bind="visible: hasCart" class="menubar-item hoverable cart-wrapper ',{type:"ef",blocks:[{type:"ncondition",expression:"!has_cart ",attachment:["hidden-while-loading"]}]},'">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/cart" ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.is_tralbum_page ",attachment:['data-bind="click: goCart"']}]},' title="',{type:"translate",nodelist:["cart"]},'">\n            <svg width="26" height="26" class="menubar-cart-icon svg-icon">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menubar-cart-icon"></use>\n                <text data-bind="text: numCartItemsDisplay" x="15" y="12" dominant-baseline="middle" text-anchor="middle">\n                    ',{type:"variable",name:"cart_quantity",filters:[["h",[]]]},"\n                </text>\n            </svg>\n        </a>\n    </li>\n    "]}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.has_notifications && !hide_notification_center ",attachment:['\n        <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user) ",attachment:["hidden-while-loading"]}]},' notification-center-menubar-button">\n            <a href="#">\n                <span class="unread-messages-indicator ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.hide_unseen_notification_indicator ",attachment:["hide"]}]},'" data-bind="css: {\'hide\': hide_unseen_notification_indicator}"></span>\n                <svg width="26px" height="26px" class="svg-icon"><use xlink:href="#menubar-messages-icon"></svg>\n            </a>\n        </li>\n        ',{type:"include",template_name:"'_notification_center_widget'"},"\n    "]}]},"\n\n    \x3c!-- ko if: (fan() && !fan().private) --\x3e\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_feed ",attachment:['\n        <li id="feed-main" class="signup-tooltip-parent menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user && page_identities.fan && !page_identities.fan.private) ",attachment:["hidden-while-loading"]}]},'" data-tooltip-id="f">\n            <a href="',{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.fan.url ",attachment:[{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},"/feed?from=menubar"]}]},'" title="',{type:"translate",nodelist:["feed"]},'">\n                <svg width="26px" height="26px" viewBox="0 0 26 26" class="svg-icon"><use xlink:href="#menubar-feed-icon"></svg>\n            </a>\n            <div class="signup-tooltip-outer feed-tooltip-outer header-2018"></div>\n        </li>\n    ']}]},"\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_collection_wishlist ",attachment:["\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.has_collection || (!menubar.has_collection && !menubar.has_wishlist) ",attachment:['\n        <li id="collection-main" class="menubar-item hoverable signup-tooltip-parent ',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user && page_identities.fan && !page_identities.fan.private) ",attachment:["hidden-while-loading"]}]},'" data-tooltip-id="c">\n            <a href="',{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},'" title="',{type:"translate",nodelist:["collection"]},'">\n                <svg width="26" height="26" viewBox="0 0 26 26" class="svg-icon"><use xlink:href="#menubar-collection-icon"></svg>\n            </a>\n            <div class="signup-tooltip-outer collection-tooltip-outer header-2018"></div>\n        </li>\n        ']},{type:"ncondition",expression:"menubar.has_wishlist ",attachment:['\n        <li id="collection-main" class="signup-tooltip-parent menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user && page_identities.fan && !page_identities.fan.private) ",attachment:["hidden-while-loading"]}]},'" data-tooltip-id="w">\n            <a href="',{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},'/wishlist" title="',{type:"translate",nodelist:["wishlist"]},'">\n                <svg width="26" height="26" viewBox="0 0 26 26" class="svg-icon"><use xlink:href="#menubar-collection-icon"></svg>\n            </a>\n            <div class="signup-tooltip-outer wishlist-tooltip-outer header-2018"></div>\n        </li>\n        ']}]},"\n    "]}]},'\n    \x3c!-- /ko --\x3e\n        <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user) ",attachment:["hidden-while-loading"]}]},'">\n        <a>\n            <div data-bind="with: artistsMenu">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.bands[0] ",attachment:['\n                    \x3c!-- Artist (and possibly fanartist) profile pic --\x3e\n                    \x3c!-- ko if: optionsLoggedInBand() && optionsLoggedInBand().photo --\x3e\n                    <div class="userpic ',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                        <img ',{type:"variable",name:"menubar.active_profile_photo",filters:[["image",["'art_embedded_player'"]]]},' data-bind="src_image: {image_id: optionsLoggedInBand().photo, format: \'art_embedded_player\'}"\n                        >\n                    </div>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko ifnot: optionsLoggedInBand() && optionsLoggedInBand().photo --\x3e\n                    <div class="userpic ',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                        <div class="no-image-placeholder"></div>\n                    </div>\n                    \x3c!-- /ko --\x3e\n                ']},{type:"else_ncondition",attachment:['\n                    \x3c!-- Fan only profile pic --\x3e\n                    \x3c!-- ko if: $parent.loggedInFanPhoto() --\x3e\n                    <div class="userpic ',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                        <img ',{type:"variable",name:"menubar.active_profile_photo",filters:[["image",["'art_embedded_player'"]]]},' data-bind="src_image: {image_id: $parent.loggedInFanPhoto(), format: \'art_embedded_player\'}"\n                        >\n                    </div>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko ifnot: $parent.loggedInFanPhoto() --\x3e\n                    <div class="userpic ',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                        <div class="no-image-placeholder"></div>\n                    </div>\n                    \x3c!-- /ko --\x3e\n                ']}]},'\n            </div>\n        </a>\n\n        <ul class="menu user-menu hidden-while-loading" data-bind="with: artistsMenu, css: { label: (artistsMenu.loggedInLabelMemberBands().length > 0 || artistsMenu.linkedNonLabelMemberBands().length > 1) }">\n        <ol class="user-menu-wrapper">\n            \x3c!-- ARTIST --\x3e\n            \x3c!-- ko if: bmgr.bands().length >= 1 && loggedInBand() --\x3e\n                <li class="submenu-item">\n                    <a data-bind="attr: { href: loggedInBand().trackpipeLocalUrl()}" class="name">\n                        <strong class="menu-bandname" data-bind="text: optionsLoggedInBand().title, css: { long: !optionsLoggedInBand().showPro}">',{type:"variable",name:"artistsmenu_title",filters:[["h",[]]]},"</strong>\n                        ",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.fan && page_identities.bands.length >= 0 ",attachment:['\n                        \x3c!-- ko if: optionsLoggedInBand() && optionsLoggedInBand().photo --\x3e\n                        <div class="userpic menu-artistpic',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                            <img ',{type:"variable",name:"menubar.active_profile_photo",filters:[["image",["'art_embedded_player'"]]]},' data-bind="src_image: {image_id: optionsLoggedInBand().photo, format: \'art_embedded_player\'}"\n                            >\n                        </div>\n                        \x3c!-- /ko --\x3e\n                        \x3c!-- ko ifnot: optionsLoggedInBand() && optionsLoggedInBand().photo --\x3e\n                        <div class="userpic ',{type:"ef",blocks:[{type:"ncondition",expression:"is_admin ",attachment:["admin"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.active_profile_photo ",attachment:["hidden-while-loading"]}]},'">\n                            <div class="no-image-placeholder"></div>\n                        </div>\n                        \x3c!-- /ko --\x3e\n                        ']}]},'\n                        <div data-bind="visible: optionsLoggedInBand().showPro" class="menubar-badge-pro round3 ',{type:"ef",blocks:[{type:"ncondition",expression:"!artistsmenu_show_pro ",attachment:["hidden-while-loading"]}]},'">',{type:"translate",nodelist:["PRO"]},'</div>\n                        <div class="view-site">',{type:"translate",nodelist:["view site"]},'</div>              \n                    </a>\n                </li> \n\n                <li class="submenu-item">\n                    <a data-bind="\n                        attr: {href: \'',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/profile?from=menubar&id=' + loggedInBand().id},\n                        css: {admin: optionsLoggedInBand().adminAccess}\"\n                    >\n                        <span>",{type:"translate",nodelist:["edit profile"]},'</span>\n                    </a>\n                </li>\n                <li class="submenu-item">\n                    <a data-bind="\n                        attr: {href: \'',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/tools?from=menubar&id=' + loggedInBand().id},\n                        css: {admin: optionsLoggedInBand().adminAccess}\"\n                    >\n                        <span>",{type:"translate",nodelist:["tools"]},"</span>\n                    </a>\n                </li>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.band_has_items ",attachment:['\n                <li class="submenu-item">\n                    <a data-bind="click: launchPageDesign.bind($data, loggedInBand())">',{type:"translate",nodelist:["page design"]},"</a>\n                </li>\n                "]}]},'\n\n                <li class="ui-menu-item ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.page_path == '/edit_subscription' ",attachment:["disabled"]}]},' submenu-item">\n                    \x3c!-- ko ifnot: loggedInBand().hasService() --\x3e\n                        <a data-bind="attr: { href: \'',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/subscriptions?band_id=' + loggedInBand().id + '&from=menubar'}\">",{type:"translate",nodelist:["subscription"]},"</a>\n                    \x3c!-- /ko --\x3e\n                    \x3c!-- ko if: loggedInBand().hasService() --\x3e\n                        <a data-bind=\"attr: { href: loggedInBand().trackpipeLocalUrl() + '/' + loggedInBand().serviceUrlFragment() + '?from=menubar'}\">",{type:"translate",nodelist:["subscription"]},'</a>\n                    \x3c!-- /ko --\x3e\n                </li>\n            \x3c!-- /ko --\x3e\n            \n            \x3c!-- FAN --\x3e\n            \x3c!-- ko if: ($parent.fan() && !$parent.fan().private) --\x3e\n            <li class="submenu-item">\n                <a href="',{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},'" class="name">\n                    <strong class="menu-bandname long">',{type:"variable",name:"page_identities.fan.name",filters:[["h",[]]]},"</strong>\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.bands.length > 0 ",attachment:['\n                    <div class="userpic fanpic ',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.fan ",attachment:["hidden-while-loading"]}]},'">\n                        ',{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.fan.photo ",attachment:['\n                            <div class="no-image-placeholder"></div>\n                        ']},{type:"else_ncondition",attachment:["\n                            <img ",{type:"variable",name:"page_identities.fan.photo",filters:[["image",["'art_embedded_player'"]]]},">\n                        "]}]},"\n                    </div>\n                    "]}]},'\n                    <div class="view-collection">',{type:"translate",nodelist:["view collection"]},'</div>\n                </a>\n            </li>\n            <li class="submenu-item"><a href="',{type:"ef",blocks:[{type:"ncondition",expression:"page_identities.fan.url ",attachment:[{type:"variable",name:"page_identities.fan.url",filters:[["a",[]]]},"/purchases?from=menubar"]}]},'"><span>',{type:"translate",nodelist:["purchases"]},'</span></a></li>\n            \x3c!-- /ko --\x3e\n            <li class="ui-widget-content ui-menu-divider first"></li>\n\n            \x3c!-- LABEL ARTISTS --\x3e\n            \x3c!-- ko if: loggedInLabelMemberBands() && loggedInLabelMemberBands().length > 0 --\x3e\n            <li class="menu-switch ui-menu-item submenu-item ui-state-disabled" data-bind="visible: !showLinkedBands()">\n                <span data-bind="attr: {href: loggedInBand().trackpipeLocalUrl() + \'/artists?from=menubar_artist_dropdown\'}, text: loggedInLabelMemberBandsCountStr()"></span>\n            </li>\n\n            <ol class="label-artist-menu no-pro-badges ui-state-disabled ui-menu-item" data-bind="visible: !showLinkedBands()">\n            <input type="text" class="artist-filter-text" data-bind="textInput: labelMemberBandsSearchTerm, visible: loggedInLabelMemberBands().length > 10" placeholder="',{type:"translate",nodelist:["Search all artists"]},'">\n\n                \x3c!-- ko foreach: filteredLoggedInLabelMemberBands() --\x3e\n                    <li class="label-member-band submenu-item" data-bind="template: {\n                        \'name\': \'band-menuitem-template-options\'\n                    }"></li>\n                \x3c!-- /ko --\x3e\n\n                \x3c!-- ko if: filteredLoggedInLabelMemberBands().length == 0 --\x3e\n                    <li class="no-results submenu-item">',{type:"translate",nodelist:["no results"]},'</li>\n                \x3c!-- /ko --\x3e\n            </ol>\n            <li class="ui-widget-content ui-menu-divider" data-bind="visible: !showLinkedBands()"></li>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- LINKED ACCOUNTS --\x3e\n            \x3c!-- ko if: linkedNonLabelMemberBands().length > 1 --\x3e\n            <ol class="linked-accounts-wrapper">\n                <li class="menu-switch ui-menu-item submenu-item linked-accounts-menu ui-state-disabled" data-bind="click: () => showLinkedBands(!showLinkedBands())">\n                <span data-bind="text: loggedInLinkedBandsCountStr()"></span><div data-bind="css: { \'arrow-down\': showLinkedBands(), \'arrow-right\' : !showLinkedBands() }"></div>\n                </li>\n                <ol class="linked-accounts-menu-content" data-bind="visible: showLinkedBands()">\n                \x3c!-- ko foreach: linkedNonLabelMemberBands() --\x3e\n                    <li class="submenu-item" data-bind="template: {\n                        \'name\': \'band-menuitem-template\'\n                    },\n                    css: {\n                        \'hidden\': ($data.id == $root.artistsMenu.loggedInBand().id)\n                    }"></li>\n                \x3c!-- /ko --\x3e\n                </ol>\n            </ol>\n            <li class="ui-widget-content ui-menu-divider"></li>\n            \x3c!-- /ko --\x3e\n\n\n            \x3c!-- ALL USERS --\x3e\n            <ol class="all-user-option">\n                <li class="submenu-item"><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/settings?from=menubar">',{type:"translate",nodelist:["settings"]},"</a></li>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"menubar.show_guide_link ",attachment:['\n                <li class="submenu-item"><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/guide?from=artistmenu">',{type:"translate",nodelist:["guide"]},"</a></li>\n                "]}]},'\n                <li class="submenu-item"><a href="https://get.bandcamp.help">',{type:"translate",nodelist:["help"]},'</a></li>\n                <li class="submenu-item"><a class="logout-action" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout">',{type:"translate",nodelist:["log out"]},"</a></li>\n            </ol>\n        </ol>\n        </ul>\n    </li>\n\x3c!-- /ko --\x3e\n\n\x3c!-- ko ifnot: user() --\x3e\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.user && !hide_cart_icon ",attachment:['\n    <li data-bind="visible: hasCart" class="menubar-item hoverable cart-wrapper hidden-while-loading svg-icon">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/cart" ',{type:"ef",blocks:[{type:"ncondition",expression:"menubar.is_tralbum_page ",attachment:['data-bind="click: goCart"']}]},' title="',{type:"translate",nodelist:["cart"]},'">\n            <svg width="26" height="26" class="menubar-cart-icon">\n                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menubar-cart-icon"></use>\n                <text data-bind="text: numCartItemsDisplay" x="15" y="12" dominant-baseline="middle" text-anchor="middle">\n                    ',{type:"variable",name:"cart_quantity",filters:[["h",[]]]},"\n                </text>\n            </svg>\n        </a>\n    </li>\n    "]}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_login_signup ",attachment:["\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"!hide_signup ",attachment:['\n            <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.user) ",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["mobile-hidden"]}]},'">\n                <a class="all-signup-link">',{type:"translate",nodelist:["sign up"]},"</a>\n            </li>\n        "]}]},'\n        <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.user) ",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:'menubar.page_path == "/login" ',attachment:["mobile-hidden"]}]},'">\n            <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/login",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["?from=fan_page"]},{type:"else_ncondition",attachment:["?from=menubar"]}]},{type:"ef",blocks:[{type:"ncondition",expression:"menubar_login_bounce_param ",attachment:[{type:"variable",name:"menubar_login_bounce_param",filters:[["a",[]]]}]}]},'" class="login-link">',{type:"translate",nodelist:["log in"]},"</a>\n        </li>\n    "]}]},"\n\x3c!-- /ko --\x3e\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"ppp_menubar ",attachment:['\n\x3c!-- ko ifnot: fan() --\x3e\n    \x3c!-- ko ifnot: user() --\x3e\n    <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.fan) || !(!page_identities.user) ",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["mobile-hidden"]}]},'">\n        <a class="fan-signup-modal-link" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans?from=menubar"\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_signup_params ",attachment:['\n            data-from="',{type:"variable",name:"fan_signup_params.from",filters:[["a",[]]]},'"\n            data-email="',{type:"variable",name:"fan_signup_params.email",filters:[["a",[]]]},'"\n            data-token="',{type:"variable",name:"fan_signup_params.signup_token",filters:[["a",[]]]},'"\n            data-tsig="',{type:"variable",name:"fan_signup_params.tsig",filters:[["a",[]]]},'"\n            data-verified="',{type:"variable",name:"fan_signup_params.verified",filters:[["a",[]]]},'"\n            ']}]},"\n            >",{type:"translate",nodelist:["sign up"]},'</a>\n    </li>\n    \x3c!-- /ko --\x3e\n    \x3c!-- ko if: user() --\x3e\n    <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.fan) || !page_identities.user ",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["mobile-hidden"]}]},'">\n        <a class="fan-signup-modal-link" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fans?from=menubar">',{type:"translate",nodelist:["sign up as fan"]},"</a>\n    </li>\n    \x3c!-- /ko --\x3e\n</li>\n\x3c!-- /ko --\x3e\n"]}]},"\n",{type:"ef",blocks:[{type:"ncondition",expression:"ppp_menubar || cc_menubar ",attachment:['\n\x3c!-- ko ifnot: fan() --\x3e\n    \x3c!-- ko ifnot: user() --\x3e\n    <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.fan) || !(!page_identities.user)",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["mobile-hidden"]}]},'">\n       <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/login?from=menubar">',{type:"translate",nodelist:["log in"]},'</a>\n    </li>\n    \x3c!-- /ko --\x3e\n    \x3c!-- ko if: user() --\x3e\n    <li class="menubar-item hoverable ',{type:"ef",blocks:[{type:"ncondition",expression:"!(!page_identities.fan) || !page_identities.user ",attachment:["hidden-while-loading"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_fan_page ",attachment:["mobile-hidden"]}]},'">\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/logout?login=1">',{type:"translate",nodelist:["log in as fan"]},"</a>\n    </li>\n    \x3c!-- /ko --\x3e\n\x3c!-- /ko --\x3e\n"]}]},"\n\n</ul>\n</div>\n\n<div class='corp-banners'>\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home && fan_onboarding ",attachment:["\n        ",{type:"let",variable:"is_unverified_fan",expression:"page_identities.fan && !page_identities.fan.verified && !page_identities.fan.private "},"\n        ",{type:"let",variable:"show_verify_banner",expression:"fan_onboarding.show_verify_banner && is_unverified_fan && !skip_verification_banner "},"\n        ",{type:"let",variable:"verify_email",expression:"fan_onboarding.email "},"\n        ",{type:"include",template_name:"'home_2016/fan_verify_banner'"},"\n    "]}]},'\n</div>\n\n\x3c!-- Knockout template for list items in the artists menu --\x3e\n<script type="text/html" id="band-menuitem-template">\n    <a class="menu-artistitem"\n        data-bind="css: {\'is-pro\': isPro()}, attr: {href: $root.artistsMenu.isPageBand(id) ? \'\' : trackpipeLocalUrl()}"\n    >\n        <span class="menu-artistpic">\n            \x3c!-- ko if: photo() --\x3e\n            <img data-bind="src_image: {image_id: photo(), format: \'art_embedded_player\'}">\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko ifnot: photo() --\x3e\n            <div class="no-image-placeholder"></div>\n            \x3c!-- /ko --\x3e\n        </span>\n        <span data-bind="text: name()" class="menu-bandname menu-text"></span>\n        <span data-bind="visible: isPro()" class="menubar-badge-pro round3">',{type:"translate",nodelist:["PRO"]},'</span>\n    </a>\n<\/script>\n\n<script type="text/html" id="band-menuitem-template-options">\n    <a data-bind="attr: {href: trackpipeLocalUrl()}" class="menu-artistitem">\n        <span class="menu-artistpic">\n            \x3c!-- ko if: photo() --\x3e\n            <img data-bind="src_image: {image_id: photo(), format: \'art_embedded_player\'}">\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko ifnot: photo() --\x3e\n            <div class="no-image-placeholder"></div>\n            \x3c!-- /ko --\x3e\n        </span>\n        <span data-bind="text: name()" class="menu-bandname menu-text"></span>\n        <span class="show-more" data-bind="visible: $root.artistsMenu.bmgr.bandByID(id) || $root.artistsMenu.lmgr.isMemberBandAuthed(id), click: () => $root.artistsMenu.setActiveLabelMemberBand(id)"></span>\n    </a>\n    \x3c!-- ko if: ($root.artistsMenu.activeLabelMemberBand() == id) --\x3e\n    <div class="label-artist-menu-links ui-menu-item">\n        <span data-bind="visible: $root.artistsMenu.bmgr.bandByID(id) || $root.artistsMenu.lmgr.isMemberBandAuthed(id)">\n            <a data-bind="\n                attr: {href: \'',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/profile?from=menubar&id=\' + id}"\n            >\n                <span class="menu-text">',{type:"translate",nodelist:["edit profile"]},"</span>\n            </a>\n            <a data-bind=\"\n                attr: {href: '",{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/tools?from=menubar&id=\' + id}"\n            >\n                <span class="menu-text">',{type:"translate",nodelist:["tools"]},'<span>\n            </a>\n            \x3c!-- ko if: hasItems --\x3e\n                <a data-bind="click: $root.artistsMenu.launchPageDesign.bind($data)"><span class="menu-text">',{type:"translate",nodelist:["page design"]},"</span></a>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko ifnot: hasService() --\x3e\n                <a data-bind=\"attr: { href: '",{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/subscriptions?band_id=' + id + '&from=menubar'}\"><span class=\"menu-text\">",{type:"translate",nodelist:["subscription"]},'</span></a>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: hasService() --\x3e\n                <a data-bind="attr: { href: trackpipeLocalUrl() + \'/\' + serviceUrlFragment() + \'?from=menubar\'}"><span data-bind="text: serviceName()" class="menu-text">',{type:"translate",nodelist:["subscription"]},'</span></a>\n            \x3c!-- /ko --\x3e\n        </span>\n    </div>\n    \x3c!-- /ko --\x3e\n    <span class="show-less" data-bind="visible: $root.artistsMenu.activeLabelMemberBand() == id && ($root.artistsMenu.bmgr.bandByID(id) || $root.artistsMenu.lmgr.isMemberBandAuthed(id)), click: () => $root.artistsMenu.setActiveLabelMemberBand(id)">show less</span>\n<\/script>\n\n\n\x3c!-- Knockout template for the parent label --\x3e\n<script type="text/html" id="band-parentlabel-template">\n    <div data-bind="css: {\'artist-listing-with-links\': $parent.columns() > 1}">\n        <a class="menu-artistitem" data-bind="attr: {href: trackpipeUrlHttps()}">\n        \x3c!-- ko if: $parent.columns() === 1 --\x3e\n            <span class="menu-artistpic">\n                <img data-bind="src_image: {image_id: photo(), format: \'bio_navbar\'}">\n            </span>\n            <span data-bind="text: name()" class="menu-bandname"></span>\n        \x3c!-- /ko --\x3e\n        \x3c!-- ko if: $parent.columns() > 1 --\x3e\n            \x3c!-- ko if: photo() --\x3e\n                <img class="photo" data-bind="src_image: {image_id: photo(), format: \'fan_bio_thumb_small\'}">\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko ifnot: photo() --\x3e\n                <div class="photo none"></div>\n            \x3c!-- /ko --\x3e\n        \x3c!-- /ko --\x3e\n        </a>\n   \n        <div class="infobox">\n            <p class="name"><a data-bind="attr: {href: trackpipeUrl()}, text: name()"></a></p>\n            <p class="actions">\n                <a data-bind="attr: {href: \'',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/profile?from=menubar&id=' + id}\">",{type:"translate",nodelist:["profile"]},"</a> &middot;\n                <a data-bind=\"attr: {href: '",{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/tools?from=menubar&id=' + id}\">",{type:"translate",nodelist:["tools"]},"</a> &middot;\n                <a data-bind=\"attr: {href: trackpipeLocalUrl() + '/stats?from=menubar'}\">",{type:"translate",nodelist:["stats"]},"</a>\n            </p>\n        </div>\n    </div>\n<\/script>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/_notification_center_widget.liquid","warn"):Templ.register({_notification_center_widget:['<div id="notification-center-container" data-bind="with: NotificationCenterVM">\n    <div class="notification-center" data-bind="css: {\'open\': show, \'empty\': empty, \'loading\': !loaded()}">\n        <div class="messages">\n            <div class="message-container" data-bind="foreach: messages">\n                <li class="divider"></li>\n                <a class="message" data-bind="attr: { href:messageUrl }">\n                    <span class="unread-indicator" data-bind="css: {\'hide\': !unread()}"></span>\n                    <div class="message-image" data-bind="css: {\'room-for-recipient-name\': recipientName}">\n                        <div class="message-userpic">\n                            \x3c!-- ko if: fanImageId --\x3e\n                                <img data-bind="attr: {src: fanImageId}">\n                            \x3c!-- /ko --\x3e\n                            \x3c!-- ko ifnot: fanImageId --\x3e\n                                <div class="no-image-placeholder"></div>\n                            \x3c!-- /ko --\x3e\n                        </div>\n                    </div>\n                    <div class="message-text" data-bind="css: {\'room-for-recipient-name\': recipientName}">\n                        \x3c!-- ko if: recipientName --\x3e\n                            <div class="recipient-name" data-bind="text: recipientName">Artist Name</div>\n                        \x3c!-- /ko --\x3e\n                        ',{type:"translate",nodelist:["\n                            ",{type:"translateVariable",var_name:"sender_name",nodelist:['\n                                <span class="message-sender-name" data-bind="text: fanName"></span>\n                            ']}," replied to your message.\n                        "]},' \n                        <span class="message-time" data-bind="text: relative_time">just now</span>\n                    </div>\n                </a>\n            </div>\n            \x3c!-- ko if: paginating --\x3e\n                ',{type:"include",template_name:'"fan/collection/loading"'},'\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko if: empty --\x3e\n                <div class="empty-msg">\n                    ',{type:"translate",nodelist:["No notifications yet."]},'\n                </div>\n            \x3c!-- /ko --\x3e\n        </div>\n        <div class="mark-all-as-read" data-bind="click: markAllAsRead">',{type:"translate",nodelist:["Mark all as read"]},"</div>\n    </div>\n</div>\n\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/home/header_2015.liquid","warn"):Templ.register({"home/header_2015":['<div class="hd ',{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["header-rework-2018 ",{type:"ef",blocks:[{type:"ncondition",expression:"!page_identities.user ",attachment:["banner-lo"]}]}]}]}," row ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:["logged-in"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"!is_client_render ",attachment:["tooltips-hidden"]}]}," ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["corp-home"]}]},'">\n    <div class="row">\n        <div class="col col-7-12">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['\n                    <h1 class="hd-logo"><span>Bandcamp</span></h1>\n                ']},{type:"else_ncondition",attachment:['\n                    <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'"><h1 class="hd-logo"><span>Bandcamp</span></h1></a>\n                ']}]},'\n                <h2 class="hd-sub-head">',{type:"translate",nodelist:["Discover amazing new music and directly support the artists who make it."]},"</h2>\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['\n                    <h1 class="corp-bclogo"><svg width="137px" height="22px" viewBox="0 0 127 20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#bandcamp-logo-color-bcaqua">Bandcamp</use></svg></h1>\n                ']},{type:"else_ncondition",attachment:['\n                    <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'">\n                        <h1 class="corp-bclogo"><svg width="137px" height="22px" viewBox="0 0 127 20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#bandcamp-logo-color-bcaqua">Bandcamp</use></svg>\n                        </h1>\n                    </a>\n                ']}]},'\n                <h2 class="hd-sub-head ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">',{type:"translate",nodelist:["Discover amazing new music and <a ",{type:"translateVariable",var_name:"link",nodelist:['class="blue-gradient" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/fair_trade_music_policy"']},">directly support</a> the artists who make it."]},"</h2>\n            "]}]},"\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:['\n            <ul class="hd-nav user-nav">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"user_photo ",attachment:['\n                <li class="user-nav-thumb">\n                    <span class="user-nav-thumb">\n                        <img ',{type:"variable",name:"user_photo",filters:[["image",["'bio_navbar'"]]]},">\n                    </span>\n                </li>\n                "]}]},'\n                <li class="name">\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"fan_name ",attachment:["\n                        ",{type:"translate",nodelist:["Hi ",{type:"translateVariable",var_name:"name",nodelist:[{type:"variable",name:"fan_name",filters:[["h",[]]]}]},""]},"\n                    "]},{type:"else_ncondition",attachment:["\n                        ",{type:"translate",nodelist:["Hi ",{type:"translateVariable",var_name:"name",nodelist:[{type:"variable",name:"user_name",filters:[["h",[]]]}]},""]},"\n                    "]}]},"\n                </li>\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"collection_url && !identities.fan.private ",attachment:['\n                    <li class="signup-tooltip-parent" data-tooltip-id="f">\n                        <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'/feed">',{type:"translate",nodelist:["feed"]},'</a>\n                        <div class="signup-tooltip-outer feed-tooltip-outer"></div>\n                    </li>\n\n                    ',{type:"ef",blocks:[{type:"ncondition",expression:"has_wishlist && !has_collection ",attachment:['\n                        <li class="signup-tooltip-parent" data-tooltip-id="w">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'/wishlist">',{type:"translate",nodelist:["wishlist"]},'</a>\n                            <div class="signup-tooltip-outer wishlist-tooltip-outer"></div>\n                        </li>\n                    ']},{type:"ncondition",expression:"has_wishlist ",attachment:['\n                        <li class="signup-tooltip-parent" data-tooltip-id="c">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["collection"]},'</a>\n                            <div class="signup-tooltip-outer collection-tooltip-outer"></div>\n                        </li>\n                        <li class="signup-tooltip-parent" data-tooltip-id="w">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'/wishlist">',{type:"translate",nodelist:["wishlist"]},'</a>\n                            <div class="signup-tooltip-outer wishlist-tooltip-outer"></div>\n                        </li>\n                    ']},{type:"else_ncondition",attachment:['\n                        <li class="signup-tooltip-parent" data-tooltip-id="c">\n                            <a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["collection"]},'</a>\n                            <div class="signup-tooltip-outer collection-tooltip-outer"></div>\n                        </li>\n                    ']}]},"\n                "]}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"band_url ",attachment:['\n                <li><a href="',{type:"variable",name:"band_url",filters:[["a",[]]]},'">your site</a></li>\n                ']},{type:"ncondition",expression:"partner_url ",attachment:['\n                <li><a href="',{type:"variable",name:"partner_url",filters:[["a",[]]]},'">your page</a></li>\n                ']}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:['\n                <li class="cartitem">\n                    <a href="/cart">\n                        <span class="cart bc-home">&nbsp;</span>\n                        <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n                    </a>\n                </li>\n                "]}]},"\n\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"gift_card_balance ",attachment:["\n                    ",{type:"let",variable:"hide_gift_card_balance",expression:"!cfg.header_rework_2018 && (band_url || partner_url) && collection_url "},"\n                    ",{type:"include",template_name:"'home/header_gift_balance'"},"\n                "]}]},"\n            </ul>\n            "]}]},'\n        </div>\n        <div id="corphome-autocomplete-form" class="searchwidget col col-5-12">\n            ',{type:"include",template_name:"'_autocomplete_search_widget'"},'\n            <ul class="hd-nav corp-nav ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"cfg.gift_cards ",attachment:['\n                <li>\n                    <a class="gift-cards-link" href="/gift_cards?from=header">',{type:"translate",nodelist:["gift cards"]},"</a>\n                </li>\n                "]}]},'\n                <li class="signup-tooltip-parent" data-tooltip-id="d">\n                    <a class="discover-link" href="/#discover">',{type:"translate",nodelist:["discover"]},'</a>\n                    <div class="signup-tooltip-outer discover-tooltip-outer"></div>\n                </li>\n                ']}]},"\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"cfg.header_rework_2018 ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart && !identities.user ",attachment:['\n                <li class="menubar-item cart-wrapper-corp-lo svg-icon">\n                    <a href="/cart">\n                        <svg width="26" height="26" class="menubar-cart-icon">\n                            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menubar-cart-icon"></use>                    \n                            <text x="15" y="12" dominant-baseline="middle" text-anchor="middle">\n                                ',{type:"variable",name:"cart_quantity",filters:[["h",[]]]},"\n                            </text>\n                        </svg>\n                    </a>\n                </li>\n                "]}]},"\n                "]}]},"\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"!identities.user ",attachment:['\n                <li><a href="#" class="all-signup-link">',{type:"translate",nodelist:["sign up"]},"</a></li>\n                "]}]},"\n                \n                ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:['\n                <li class="log-out-link"><a class="logout-action" href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/logout",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["?corp_home=1"]}]},'" ',{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['data-logout-override="corp_home"']}]},">",{type:"translate",nodelist:["log out"]},"</a></li>\n                "]}]},'\n                <li class="log-in-link"><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/login",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["?from=home"]}]},'">',{type:"translate",nodelist:["log in"]},"</a></li>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart && !identities.user && !cfg.header_rework_2018 ",attachment:['\n                <li class="cartitem">\n                    <a href="/cart">\n                        <span class="cart bc-home">&nbsp;</span>\n                        <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n                    </a>\n                </li>\n                "]}]},"\n            </ul>\n        </div>\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"has_corp_header && !is_gift_cards_page && holiday_gc_link ",attachment:['\n            <div class="hd-banner-2018 holiday-gc-link ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                <a class="hd-banner-2018-inner blue-gradient" href="/gift_cards?from=header">',{type:"translate",nodelist:["Bandcamp Gift Cards"]},"</a>\n            </div>\n        "]},{type:"ncondition",expression:"has_corp_header && corp_hiring_banner_text && !is_jobs_page ",attachment:['\n            <div class="hd-banner-2018 wide ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                <a class="hd-banner-2018-inner blue-gradient" href="/jobs">',{type:"variable",name:"corp_hiring_banner_text",filters:[["h",[]]]},'</a>\n            </div>\n            \n            <div class="hd-banner-2018 small ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n                <a class="hd-banner-2018-inner blue-gradient" href="/jobs">',{type:"translate",nodelist:["Were hiring!"]},"</a>\n            </div>\n        "]}]},"\n\n    </div>\n\n    <div class='corp-banners'>\n        ",{type:"let",variable:"is_unverified_fan",expression:"identities.fan && !identities.fan.verified && !identities.fan.private "},"\n        ",{type:"let",variable:"show_verify_banner",expression:"fan_onboarding.show_verify_banner && is_unverified_fan && !skip_verification_banner "},"\n        ",{type:"let",variable:"verify_email",expression:"fan_onboarding.email "},"\n        ",{type:"include",template_name:"'home_2016/fan_verify_banner'"},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"show_rock_the_vote_banner && !show_verify_banner ",attachment:["\n        ",{type:"include",template_name:"'rock_the_vote_banner'"},"\n        "]}]},"\n    </div>\n</div>\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"!cfg.header_rework_2018 ",attachment:['\n<div class="hd-mobile row ',{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:["logged-in"]}]},'">    \n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:['\n        <h1 class="hd-logo"><span>Bandcamp</span></h1>\n    ']},{type:"else_ncondition",attachment:['\n        <a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'"><h1 class="hd-logo"><span>Bandcamp</span></h1></a>\n    ']}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"identities.user && user_type ",attachment:['\n    <ul class="hd-nav user-nav">\n\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"gift_card_balance ",attachment:["\n            ",{type:"let",variable:"hide_gift_card_balance",expression:"!cfg.header_rework_2018 && (band_url || partner_url) && collection_url "},"\n            ",{type:"include",template_name:"'home/header_gift_balance'"},"\n        "]},{type:"ncondition",expression:"!cfg.header_rework_2018 && cfg.gift_cards && ((collection_url && !identities.fan.private) || band_url || partner_url) ",attachment:['\n            <li><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},'/gift_cards">',{type:"translate",nodelist:["gift cards"]},"</a></li>\n        "]}]},"\n\n                \n        \n        ",{type:"ef",blocks:[{type:"ncondition",expression:"collection_url && !identities.fan.private ",attachment:['\n        <li><a href="',{type:"variable",name:"collection_url",filters:[["a",[]]]},'">',{type:"translate",nodelist:["collection"]},"</a></li>\n        "]}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"band_url ",attachment:['\n        <li><a href="',{type:"variable",name:"band_url",filters:[["a",[]]]},'">your site</a></li>\n        ']},{type:"ncondition",expression:"partner_url ",attachment:['\n        <li><a href="',{type:"variable",name:"partner_url",filters:[["a",[]]]},'">your page</a></li>\n        ']}]},"\n\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:['\n        <li>\n            <a class="home-cartitem" href="/cart">\n                <span class="cart bc-home"></span>\n                <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n            </a>\n        </li>\n        "]}]},"\n\n    </ul>\n    "]},{type:"else_ncondition",attachment:['\n    <ul class="hd-nav corp-nav ',{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:["has-cart"]}]},'">\n       <li>\n       <ul>\n            \n            ',{type:"ef",blocks:[{type:"ncondition",expression:"!has_cart ",attachment:['<li><span class="corp-nav-label">for:</span></li>']}]},'\n            <li><a href="/artists?from=hpartists">',{type:"translate",nodelist:["artists"]},'</a></li>\n            <li><a href="/fans?from=hpfans">',{type:"translate",nodelist:["fans"]},'</a></li>\n            <li><a href="/labels?from=hplabels">',{type:"translate",nodelist:["labels"]},'</a></li>\n        </ul>\n        </li>\n        <li class="log-in-link"><a href="',{type:"variable",name:"siteroot_https",filters:[["a",[]]]},"/login",{type:"ef",blocks:[{type:"ncondition",expression:"is_corp_home ",attachment:["?from=home"]}]},'">',{type:"translate",nodelist:["log in"]},"</a></li>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"has_cart ",attachment:['\n        <li>\n            <a class="home-cartitem" href="/cart">\n                <span class="cart bc-home"></span>\n                <span class="cart-item-count">',{type:"variable",name:"cart_quantity",filters:[]},"</span>\n            </a>\n        </li>\n        "]}]},"\n    </ul>\n    "]}]},'\n    <form class="searchwidget" action="/search" method="get">\n        <input name="q" type="text" placeholder="',{type:"translate",nodelist:["Search for artist, track or album"]},'" tabindex="0" autocomplete="off" maxlength="2048">\n        <input type="hidden" name="from" value="corphome">\n        <input type="hidden" name="item_type" data-bind="value: AutocompleteVM.currentFilter">\n        <button type="submit"><span class="icon bc-home"></span>',{type:"translate",nodelist:["Search"]},"</button>\n    </form>\n    <div class='corp-banners'>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"show_rock_the_vote_banner && !show_verify_banner && is_corp_home ",attachment:["\n        ",{type:"include",template_name:"'rock_the_vote_banner'"},"\n        "]}]},"\n    </div>\n</div>\n"]},{type:"ncondition",expression:"show_header_2015 && !is_phone ",attachment:["\n    ",{type:"include",template_name:"'menubar_phone'"},"\n"]}]},"\n"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/rock_the_vote_banner.liquid","warn"):Templ.register({rock_the_vote_banner:['<div class="corpbanner rock-the-vote">\n    <div class="vote-logo-container">\n        <a href="https://bandcamp.com/vote">\n        <img class="vote-logo" src="/img/icon-vote-bandcamp.png"></img>\n        </a>\n    </div>\n    <div class="text">\n        Today is election day! Do you know where to vote? <a href="https://www.rockthevote.org/voting-information/find-your-polling-place">Find out here</a>.\n    </div>\n\n    <a class="dismiss-banner" id="dismiss-rock-the-vote-notification" href="#">\n        <span class="ui-icon dismiss-icon"></span>\n    </a>\n</div>\n']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/signup/fan_app_download_banner.liquid","warn"):Templ.register({"fan/signup/fan_app_download_banner":['<div id=\'fan-app-download-banner-vm\' class="corpbanner fan-app-download">\n    <a class="dismiss-banner col" id="dismiss-fan-app-download-banner" href="#"\n        data-bind="click: dismissBanner">\n        <span class="ui-icon dismiss-icon"></span>\n    </a>\n    <div class="app-icon-container col">\n        <img class="app-icon" src="/img/app-icon-fanapp-ios.png"></img>\n    </div>\n    <div class="text col">\n        <div class=\'row title\'>Bandcamp</div>\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"isAppInstalled ",attachment:["\n            <div class='row'>",{type:"translate",nodelist:["Installed on your device"]},"</div>\n        "]},{type:"else_ncondition",attachment:["\n            <div class='row'>",{type:"translate",nodelist:["Free in the App Store"]},"</div>\n        "]}]},'\n    </div>\n    <a href="',{type:"variable",name:"redirectToAppURL",filters:[["h",[]]]},"\">\n        <button class='col'>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"isAppInstalled ",attachment:["\n                <span>",{type:"translate",nodelist:["OPEN"]},"</span>\n            "]},{type:"else_ncondition",attachment:["\n                <span>",{type:"translate",nodelist:["GET"]},"</span>\n            "]}]},"\n        </button>\n    </a>\n\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: common/layout/templates/_autocomplete_search_widget.liquid","warn"):Templ.register({_autocomplete_search_widget:["\n\n\n",{type:"capture",to:"placeholder_text",nodelist:["\n",{type:"ef",blocks:[{type:"ncondition",expression:"cfg.search_discovery_one_filter_rollout ",attachment:["\n",{type:"translate",nodelist:["Search for artist, album, or track"]},"\n"]},{type:"else_ncondition",attachment:["\n",{type:"translate",nodelist:["Search and discover music"]},"\n"]}]},"\n"]},"\n\n\x3c!-- ko if: ",{type:"variable",name:"vm_name",filters:[["h",[]]]}," --\x3e\n\x3c!-- ko with: ",{type:"variable",name:"vm_name",filters:[["h",[]]]},' --\x3e\n<form class="autocomplete-form signup-tooltip-parent" action="/search" method="get" data-tooltip-id="s" data-bind="event: { submit: trackSearchSubmit, keydown: (d, e) => handleKeyboardNav(d, e), focusin: handleFocusIn }, css: { \'is-loading\': isLoading() }">\n    <input type="hidden" name="item_type" data-bind="value: currentFilter">\n    <input class="search-field you-autocomplete-me dismiss-tooltip-alt" type="text" data-bind="textInput: searchText, event: { select: handleClearSelection }, hasFocus: searchHasFocus, css: { \'focused\': searchHasFocus }" title="" tabindex="0" autocomplete="off" maxlength="2048" name="q" placeholder="&nbsp;',{type:"variable",name:"placeholder_text",filters:[]},'&nbsp;&nbsp;&nbsp;">\n\n    \x3c!-- ko if: isLoading() --\x3e\n    <div class="loading-icon">\n        <svg class="search-spinner" width="16px" height="16px" viewBox="-1 -1 16 16">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#search-spinner"></use>\n        </svg>\n    </div>\n    \x3c!-- /ko --\x3e\n\n    <button class="left" tabindex="-1" type="submit" title="search">\n        <svg width="15" height="16" viewBox="0 0 15 16" class="svg-icon">\n            <use xlink:href="#menubar-search-input-icon">\n        </svg>\n    </button>\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"from ",attachment:['\n    <input type="hidden" name="from" value="',{type:"variable",name:"from",filters:[["h",[]]]},'">\n    ']}]},'\n    <input type="hidden" name="',{type:"ef",blocks:[{type:"ncondition",expression:"!(page_identities.user) ",attachment:["logged_out_menubar"]},{type:"else_ncondition",attachment:["logged_in_menubar"]}]},'" value="1" />\n\n    ',{type:"include",template_name:"'_autocomplete_search_results_widget'"},'\n\n    <div class="signup-tooltip-outer search-tooltip-outer header-2018"></div>\n</form>\n\x3c!-- /ko --\x3e\n\x3c!-- /ko --\x3e']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/complete_profile.liquid","warn"):Templ.register({"fan/complete_profile":['<div class="profile-pic">\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n        \x3c!-- ko switch --\x3e\n            \x3c!-- ko case: fanImageUploading() --\x3e\n                <label class="placeholder-wrapper loading">\n                    <div class="placeholder loading">\n                        <svg class="spinny-icon" viewBox="0 0 326 324"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ic-spinny"></use></svg>\n                    </div>\n                </label>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko case: $else --\x3e\n                <label class="placeholder-wrapper" for="signup-profile-pic-input" tabindex="0" data-bind="event: { \'keydown\': addProfilePicKeydown }">\n                    \x3c!-- ko if: fanImageId() --\x3e\n                        <img data-bind="src_image: { image_id: fanImageId(), format: \'art_thumb\' }">\n                    \x3c!-- /ko --\x3e\n\n                    \x3c!-- ko if: !fanImageId() --\x3e\n                        <div class="placeholder">\n                            <svg class="camera-icon" viewBox="0 0 28 20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#camera-icon"></use></svg>\n                        </div>\n                    \x3c!-- /ko --\x3e\n                </label>\n            \x3c!-- /ko --\x3e\n        \x3c!-- /ko --\x3e\n        \n    ']},{type:"else_ncondition",attachment:['\n\n        \x3c!-- ko switch --\x3e\n            \x3c!-- ko case: fanImageUploading() --\x3e\n                <label class="placeholder-wrapper loading">\n                    <div class="placeholder loading">\n                        <svg class="spinny-icon" viewBox="0 0 326 324"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ic-spinny"></use></svg>\n                    </div>\n                </label>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko case: fanImageId() --\x3e\n                <div class="profile-pic-wrapper">\n                    <img data-bind="src_image: { image_id: fanImageId(), format: \'art_thumb\' }">\n\n                    <a href="#" class="profile-pic-edit-icon" data-bind="click: toggleEditProfilePic">\n                        <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ic-edit"></use></svg> \n                    </a>\n\n                    \x3c!-- ko if: showEditProfilePic --\x3e\n                        <div class="edit-profile-menu">\n                            <a href="#" data-bind="click: deleteProfilePic">',{type:"translate",nodelist:["Delete profile photo"]},'</a>\n                            <a href="#" data-bind="click: uploadProfilePic">',{type:"translate",nodelist:["Upload new profile photo"]},'</a>\n                        </div>\n                    \x3c!-- /ko --\x3e\n                </div>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko case: !fanImageId() --\x3e\n                <label class="placeholder-wrapper" for="signup-profile-pic-input" tabindex="0" data-bind="event: { \'keydown\': addProfilePicKeydown }">\n                    <div class="placeholder">\n                        <svg class="camera-icon" viewBox="0 0 28 20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#camera-icon"></use></svg>\n                    </div>\n                </label>\n            \x3c!-- /ko --\x3e\n        \x3c!-- /ko --\x3e\n    ']}]},'\n\n    <input id="signup-profile-pic-input" type="file" name="photo" accept="image/*" style="display: none;" data-bind="value: fanImageFakePath, event: { change: addProfilePic }"></input>\n</div>\n\n<div class="item">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['\n        <label for="complete-profile-name-input" class="name-label">\n            ',{type:"translate",nodelist:["Display name"]},'\n            <span class="hover-hint-wrapper">\n                <a href="#" class="hover-hint-anchor" data-bind="\n                    event: {\n                        \'mouseover\': showNameHint,\n                        \'focus\': showNameHint,\n                        \'mouseout\': hideNameHint,\n                        \'blur\': hideNameHint,\n                    }\n                ">\n                    <svg class="tooltip-icon" viewBox="0 0 16 16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ic-tooltip"></use></svg>\n                </a>\n                <div class="hover-hint" data-bind="visible: nameHintVisible">\n                    <div class="hover-hint-arrow"></div>\n                    ',{type:"translate",nodelist:["Your display name is visible in your public profile, and in various other places across Bandcamp."]},"\n                </div>\n            </span>\n        </label>\n    "]}]},'\n    \n    <div class="name">\n        <div class="name-inner jquery-placeholder-wrapper">\n            <input\n                id="complete-profile-name-input"\n                type="text"\n                class="name-input"\n                data-test="name-input"\n                autocomplete="off"\n                data-bind="\n                    value: name,\n                    errorBubble: name.error_msg,\n                    valueUpdate: \'input\',\n                    hasfocus: name.focused,\n                    css: {\n                        \'has-validation-error\': name.error_msg()\n                    }\n            " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"translate",nodelist:["display name"]},'"']}]},'>\n        </div>\n        <div class="error-bubble" style="display: none;"><span class="message"></span></div>\n    </div>\n\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n        <div class="hint">\n            ',{type:"translate",nodelist:["Your display name is visible in your public profile, and in various other places across Bandcamp."]},"\n        </div>\n    "]}]},'\n</div>\n\n<div class="item">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"!is_phone ",attachment:['\n        <label for="location-input" class="location-label">\n            ',{type:"translate",nodelist:["Location"]},'\n            <span class="hover-hint-wrapper">\n                <a href="#" class="hover-hint-anchor" data-bind="\n                    event: {\n                        \'mouseover\': showLocationHint,\n                        \'focus\': showLocationHint,\n                        \'mouseout\': hideLocationHint,\n                        \'blur\': hideLocationHint,\n                    }\n                ">\n                    <svg class="tooltip-icon" viewBox="0 0 16 16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#ic-tooltip"></use></svg>\n                </a>\n                <div class="hover-hint" data-bind="visible: locationHintVisible">\n                    <div class="hover-hint-arrow"></div>\n                    ',{type:"translate",nodelist:["Your location is visible in your public profile."]},"\n                </div>\n            </span>\n        </label>\n    "]}]},'\n\n    <div class="location">\n        <div class="location-inner jquery-placeholder-wrapper">\n            <input\n                id="location-input"\n                type="text"\n                class="location-input"\n                data-test="location-input"\n                autocomplete="off"\n                data-bind="\n                    value: location,\n                    errorBubble: location.error_msg,\n                    valueUpdate: \'input\',\n                    hasfocus: location.focused,\n                    css: {\n                        \'has-validation-error\': location.error_msg()\n                    }\n            " ',{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['placeholder="',{type:"translate",nodelist:["location"]},'"']}]},'>\n        </div>\n        <div class="error-bubble" style="display: none;"><span class="message"></span></div>\n    </div>\n\n    <div class="location-display">\n        <span data-bind="visible: locationVM.loading">\n            ',{type:"translate",nodelist:["searching"]},'<span class="loading"></span>\n        </span>\n        <span data-bind="visible: !locationVM.isNullLocation() && !locationVM.loading()">\n            ',{type:"translate",nodelist:["(displayed: ",{type:"translateVariable",var_name:"loc_display",nodelist:['<span data-bind="text: locationVM.location"></span>']},")"]},"\n        </span>\n    </div>\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"is_phone ",attachment:['\n        <div class="hint">\n            ',{type:"translate",nodelist:["Your location is visible in your public profile."]},"\n        </div>\n    "]}]},'\n</div>\n\n<div class="item">\n    <div class="buttons">\n        <button\n            class="submit"\n            type="submit"\n            data-test="submit"\n            data-bind="enable: !submitting()"\n        >\n            <div data-bind="visible: !submitting()">',{type:"translate",nodelist:["Save profile"]},'</div>\n            <div data-bind="visible: submitting()" style="display: none;">',{type:"translate",nodelist:["Please wait"]},'&hellip;</div>\n        </button>\n    </div>\n</div>\n\n<div class="item skip-wrapper" data-bind="css: { \'hide\': submitting() }">\n    <a class="skip" href="#" data-bind="click: skip">',{type:"translate",nodelist:["Skip"]},"</a>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/widgets/image_editor_dialog.liquid","warn"):Templ.register({"widgets/image_editor_dialog":["<div class='crop-tool'></div>\n<div class='status' data-bind='animateVisible: saving() || uploading()'>\n    <div class='status-text'>Saving&hellip;</div>\n    <div class='upload-progress'></div>\n</div>\n<div class='error' data-bind='animateVisible: error'>\n    \x3c!-- ko if: error() === 'image' --\x3eThe image could not be loaded. You can try uploading it but it'll probably fail.\x3c!-- /ko --\x3e\n    \x3c!-- ko if: error() === 'network' --\x3eThere was a network error. Please try again.\x3c!-- /ko --\x3e\n</div>\n<div class='buttons'>\n    <a class='save-button' data-bind='click: save, css: {disabled: saving() || uploading()}'>Save</a>\n    <a class='cancel' data-bind='click: cancel'>Cancel</a>\n    <div class='save-progress' data-bind='animateVisible: saving() || uploading()'>&nbsp;</div>\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/widgets/bccroptool.liquid","warn"):Templ.register({"widgets/bccroptool":["\n<div class='loading-indicator' data-bind='animateVisible: imageLoading'></div>\n<div class='target'>\n    <img class='image' src='/img/blank.gif' data-bind='\n        attr: {src: imageSrc},\n        css: {hidden: imageLoading()},\n        style: {\n            left: displayLeft() + \"px\",\n            top: displayTop() + \"px\",\n            width: displayWidth() + \"px\",\n            height: displayHeight() + \"px\"\n        }'>\n    <div class='center-crosshair' data-bind='\n        visible: showZoomCenter,\n        style: {\n            left: zoomCenterLeft() + \"px\",\n            top: zoomCenterTop() + \"px\"\n        }'>\n        +\n    </div>\n    <div class='target-border'></div>\n</div>\n<div class='border'></div>\n<div class='zoom-slider'></div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/widgets/image_editor.liquid","warn"):Templ.register({"widgets/image_editor":["<div class='crop-tool'></div>\n<div class='editor-info'>\n    <div class='status' data-bind='animateVisible: saving() || uploading()'>\n        <div class='status-text'>",{type:"translate",nodelist:["Saving&hellip;"]},"</div>\n        <div class='upload-progress'></div>\n    </div>\n    <div class='error' data-bind='animateVisible: error'>\n        \x3c!-- ko if: error() === 'image' --\x3e",{type:"translate",nodelist:["The image could not be loaded. You can try uploading it but itll probably fail."]},"\x3c!-- /ko --\x3e\n        \x3c!-- ko if: error() === 'network' --\x3e",{type:"translate",nodelist:["There was a network error. Please try again."]},"\x3c!-- /ko --\x3e\n    </div>\n</div>\n"]});var Captcha=function(){"use strict";var e,t=null,n={},i=null;function a(e,i){var a=n[e];if(!a){var s=$.Deferred();a=s.promise(),n[e]=a,(t||(t=$.Deferred(),window.bcCaptchaOnloadCallback=function(){Log.debug("loaded recaptcha"),t.resolve()},Log.debug("requesting recaptcha"),$.cachedScript("https://www.google.com/recaptcha/api.js?onload=bcCaptchaOnloadCallback&render=explicit")),t.promise()).then((function(){Log.debug("rendering recaptcha for element "+e);var t=grecaptcha.render(e,i);s.resolve(t)}))}return a}return{renderInvisible:function(){return a("global-invisible-recaptcha",{sitekey:$("#pagedata").data("blob").invisible_recaptcha_public_key,size:"invisible",callback:function(t){null!==i&&($(window).scrollTop(i),i=null),e(t)}}).then((function(){$("#global-invisible-recaptcha").fadeIn()}))},execute:function(t){var a=n["global-invisible-recaptcha"];if(!a)throw"Must call Captcha.renderInvisible() before calling execute()";e=t,a.then((function(e){i=$(window).scrollTop(),$("#global-invisible-recaptcha").css("top",i+50+"px"),Log.debug("executing invisible recaptcha (scrollTopBeforeExecute = "+i+")"),grecaptcha.reset(e),grecaptcha.execute(e)}))},hideInvisible:function(){$("#global-invisible-recaptcha > div").fadeOut()}}}(),Money=function(e){"use strict";return function(e){var t,n;if(!e)throw"missing money input";if(t=e.amount,n=e.currency,"number"!=typeof t||t%1!=0)throw"invalid amount";if("string"!=typeof n||3!==n.length)throw"invalid currency"}(e),{amount:e.amount,currency:e.currency,is_money:!0,add:function(e){if(!e.is_money)throw"type mismatch";if(e.currency!==this.currency)throw"currency mismatch";return new Money({amount:this.amount+e.amount,currency:this.currency})},subtract:function(e){if(!e.is_money)throw"type mismatch";if(e.currency!==this.currency)throw"currency mismatch";return new Money({amount:this.amount-e.amount,currency:this.currency})},format:function(e){return void 0===e&&(e=6),TextFormat.money(this,e)},negate:function(){return new Money({amount:-1*this.amount,currency:this.currency})},scaleAndRound:function(e){var t=CurrencyData.info[this.currency].places;return new Money({amount:Math.round(Math.pow(10,2-t)*Math.round(e*this.amount*Math.pow(10,t-2))),currency:this.currency})}}};function QueuedUploader(e){"use strict";var t,n,i,a=e.progress||$.noop,s=e.finish||$.noop,o=e.start||$.noop,r=$.extend({},e),l=[];function c(){if(!d()){for(var e,a=0;a<l.length;a++)if("queued"===l[a].state){e=l[a];break}e?(t||(n={lastUpdated:new Date,totalSent:0,bytesPerSecond:0,secondsRemaining:NaN},i=setInterval(p,5e3),o(),t=setInterval(u,1e3)),e.state="uploading",e.trigger("start")):t&&function(){s(),l.length=0,t&&(clearInterval(t),t=null);!function(){i&&(clearInterval(i),i=null);n=null}()}()}}function d(){for(var e=0;e<l.length;e++)if(l[e].working())return!0;return!1}function u(){var e=function(){for(var e={validating:0,queued:0,uploading:0,processing:0,finished:0,failed:0},t=0,n=0,i=0;i<l.length;i++){var a=l[i],s=l[i].state;e[s]=(e[s]||0)+1,"failed"!==s&&(t+=a.sent,n+=a.size)}return $.extend(e,{bytesSent:t,totalBytes:n})}(),t=(new Date-n.lastUpdated)/1e3;e.totalJobs=l.length,e.bytesPerSecond=n.bytesPerSecond,e.secondsRemaining=Math.max(0,n.secondsRemaining-t),a(e)}this.queueFile=function(e,t){var i=(t=$.extend({},r,t)).postURL,a=t.uploaderInfo,s=function(e,t,i){var a=i.filter,s=a&&(m=a.extensions,f="^("+m.replace(/;/g,"|").replace(/\./g,"\\.").replace(/\*/g,".+")+")$",new RegExp(f,"i")),o=i.maxFileSize,r=i.validate,u={filename:e,size:t,sent:0,state:"validating",working:function(){return"uploading"===u.state||"processing"===u.state},fail:function(e,t){Log.error("Job failed",u,e,t),u.errorReason=e,u.errorMessage=t,u.state="failed",u.trigger("error")},cancel:function(){!function(e){var t=Iter.index(l,e);-1!==t&&(l.splice(t,1),n&&(n.totalSent-=e.sent,p()))}(u),u.trigger("cancel")},on:function(e,t){return $(u).on(e,t),u},trigger:function(e){return $(u).triggerHandler(e),u},processUploadResponse:function(e){u.responseData=e,e.error?u.fail(e.reason,e.message||e.exception||"Unknown error"):(u.state="finished",u.trigger("finish"))},processUploadFailure:function(e,t,n){Log.error("XHR error",e,t,n),0===e.status?u.fail("xhr","There was a network error. Please try again."):u.fail("xhr",t)}};var m,f;u.on("start",(function(){u.startDate=new Date})),u.on("progress",h),u.on("finish error cancel",c),l.push(u),d()&&p();return setTimeout((function(){function n(){u.state="queued",u.trigger("queue"),c()}a&&!s.test(e)?u.fail("extension","Type Error: "+e+" is not "+a.description):o&&t>o?u.fail("size","That file is "+TextFormat.toMb(t)+", max allowed is "+TextFormat.toMb(o)+"."):r?r(u,(function(e,t){e?u.fail(e,t):n()})):n()}),0),u}(e.name,e.size,t);return s.on("start",(function(){var t,n=new FormData;a.url,t=function(t,n){s.state="processing",s.trigger("progress");var o,r=new Date-s.startDate;if("uploader"==a.type){var l=$.parseJSON(n);o={type:a.type,filename:e.name,server:l.server,id:l.id,hash:l.hash}}else o={type:a.type,filename:e.name,key:t.key};o.duration=r,Crumb.ajax({type:"POST",url:i,data:o,context:s,success:s.processUploadResponse,error:s.processUploadFailure})};var o=function(i){for(var o in i)n.append(o,i[o]);n.append("file",e);var r=$.upload(a.url,n,a.type);r.on("progress",(function(e){s.sent=e.loaded,s.size=e.total,s.trigger("progress")})).done((function(e){t(i,e)})).fail(s.processUploadFailure),s.on("cancel",(function(){r.abort()}))};if("gcs"==a.type){var r=!1;s.on("cancel",(function(){r=!0})),BCAPI.call("GCSUploadInfo_1","get_upload_params",{filename:e.name}).done((function(e){if(!r){var t={};a.url=e.url,e.params.forEach((function(e){t[e.key]=e.value})),o(t)}})).fail(s.processUploadFailure)}else if("s3"==a.type){a.upload_index=uploadInfo.upload_index||1;var l=filename.replace(/\W/g,"_"),c=a.key_base+a.upload_index+"_"+l;a.upload_index++,a.params.key=c,o(a.params)}else o(a.params)})),s},this.working=d;function p(){for(var e=0,t=0,i=0;i<l.length;i++){var a=l[i];"failed"!==a.state&&(e+=a.sent,t+=a.size)}var s=new Date,o=s-n.lastUpdated,r=e-n.totalSent,c=1e3*r/o,d=1;0===n.totalSent?n.firstEstimateTime=s:d=o/(Math.min(s-n.firstEstimateTime,3e4)+o);n.bytesPerSecond=d*c+(1-d)*n.bytesPerSecond;var u=n.bytesPerSecond<1024||s-n.lastProgress>3e4;n.secondsRemaining=u?NaN:(t-e)/n.bytesPerSecond,n.totalSent=e,n.lastUpdated=s,Log.debug(o+" ms elapsed, "+r+" bytes, "+Math.round(.001*c)+"KB/s raw, "+.01*Math.round(100*d)+" alpha, "+Math.round(.001*n.bytesPerSecond)+"KB/s filtered, "+Time.strftime(new Date(1e3*n.secondsRemaining),"%M:%S remaining"))}function h(){n&&(n.lastProgress=new Date)}}function SimpleProgress(e){"use strict";this._element=$(e),this._unique=Math.round(1e5*Math.random()).toString(),this._element.html('<div id="progress_outer_'+this._unique+'" class="progress_outer"><div id="progress_inner_'+this._unique+'" class="progress_inner">&nbsp;</div></div>'),this.update=function(e,t,n){var i=0;i="number"==typeof n?n:100*e/t;var a=$("#progress_inner_"+this._unique);a?a.css("width",i+"%"):Log.debug("missing progress_inner")},this.done=function(){this._element.html("done.")},this.remove=function(){this._element.remove()},this.clear=function(){this._element.html("")}}function uploadImage(e,t,n){"use strict";var i=uploadImage.uploader;i||(i=uploadImage.uploader=new QueuedUploader({filter:QueuedUploader.FILTERS.image,maxFileSize:4194304,uploaderInfo:UploadInfo}));var a=e.targetURL,s=e.maxSize,o=e.file,r=e.container,l=e.errorHandler;if(!Url.isFullyQualified(a)){var c=Url.toHash(window.location.href);a=Url.fullyQualify(a,c)}var d={postURL:a,maxFileSize:s};!function(e){var i,a=elt(r),o=$(".upload-progress",a)[0],c=$(".filename",a)[0];function d(e){$(a).removeClass("uploading"),Form.setSubmitBlock(null)}e.on("queue",(function(){$(a).addClass("uploading"),Dom.setText(c,Text.escapeHtml(e.filename)),(i=new SimpleProgress(o)).update(0,e.size),n&&n(e)})).on("start",(function(){Form.dirtyForm(),Form.setSubmitBlock("Please wait until the image finishes uploading before saving.")})).on("progress",(function(){i.update(e.sent,e.size)})).on("finish",(function(){d(),t(e.responseData)})).on("error",(function(){!function(){if(l)try{l(e)}catch(e){Log.error("caught error in uploadImage error handler: "+e)}else{var t,n;if(e.responseData)t="coverarterror",n=e.responseData,"image"==e.responseData.major&&"upload_copyright_error"==e.responseData.minor&&BCAPI.call("PreviouslyUploaded_1","associate_upload_attempt",{shachecksum:e.responseData.deets,account_type:"band",account_id:BandData.id,user_id:Identities.user().id});else if("size"===e.errorReason)t="coverarterror",n={major:"image",minor:"filesize",deets:"your file is "+TextFormat.toMb(e.size)+", the maximum size is "+TextFormat.toMb(s)};else{t="upload_error";var i=e.errorMessage;n={message:i&&Text.escapeHtml(i),laconic:!i||/Network error:/.test(i)}}var a=[];a.push({text:TM("OK"),click:function(e){$(this).dialog("close")}});var o=TM("Image Upload Error");NuDialog.showTemplate(t,n,{buttons:a,title:o})}}(),d(),t(null)}))}(i.queueFile(o,d))}QueuedUploader.FILTERS={losslessAudio:{description:"a lossless audio file",extensions:"*.wav;*.aiff;*.aif;*.flac",mimetypes:["audio/wav","audio/aiff","audio/flac","audio/x-flac","application/x-flac"]},image:{description:"an image file",extensions:"*.png;*.jpg;*.gif;*.jpeg"},video:{description:"a video file",extensions:"*.*"}};var UploadImageErrors={doDialog:function(e,t){"use strict";return NuDialog.alert(e+" Upload Error",this.prepErrorString(t))},prepErrorString:function(e){"use strict";var t=e.match(/^exception\: Band(\w*)\: (\w*)\:(\w*)(\:\s*(.*))*/),n=null;if(t&&t[3])switch(t[3]){case"filesize":case"filedimensions":case"filedimensionsmax":case"aspectratio":(t[5]||t[4])&&(n=t[5].charAt(0).toUpperCase()+t[5].slice(1));break;case"bad":case"badimage":n="Error processing image file. Please verify that it's one of the supported types and try again.";break;case"upload_copyright_error":t[5]&&BCAPI.call("PreviouslyUploaded_1","associate_upload_attempt",{shachecksum:t[5],account_type:"band",account_id:BandData.id,user_id:Identities.user().id}),n="This image couldnt be uploaded because it has been identified as a copyright infringement. Please contact copyright@bandcamp.com for more information."}return n||(e?(/^Type Error\:/.test(e)&&(e="file must be .jpg, .gif,  or .png."),n="Oops, "+e):n="Oops, something unexpected happened. Please try uploading your background image again."),"."!=n.charAt(n.length-1)&&(n+="."),n}};!function(e){"use strict";var t=window.XMLHttpRequest?new XMLHttpRequest:null,n=null,i=!0;try{(n=document.createElement("input")).type="file",n.disabled&&(i=!1)}catch(e){i=!1}finally{n&&n.parentNode&&n.parentNode.removeChild(n)}i||"mac"!=Browser.platform&&"win"!=Browser.platform||Log.server("Unexpected disabling of file upload, local userAgent: "+navigator.userAgent,"WARN"),e.support.upload=t&&"upload"in t&&window.FormData&&i,e.upload=function(t,n,i){var a={url:t,type:"POST",data:n,cache:!1,contentType:!1,processData:!1,xhrFields:{withCredentials:"uploader"===i},xhr:function(){var t=new XMLHttpRequest;return e(t.upload).on("progress",o),t}},s=e.ajax(a);function o(t){var n=t.originalEvent;t.loaded=n.loaded,t.total=n.total,e(s).trigger(t)}return s.on=function(t,n){return e(this).on(t,n),this},s};var a=["margin-top","margin-right","margin-bottom","margin-left"],s=!1;e.fn.wrapFileInput=function(t){return this.each((function(n,i){!function(t,n){var i=n.select||e.noop,o=n.click||e.noop,r=n.clickStat||null,l=n.multiple||!1,c=n.accept||null,d=e(t),u=e(t).closest("html5-upload-wrapper");if(u.length>1)return;var p=e('<input type="file">').attr("multiple",l?"":null).attr("accept",c||null).on("click",(function(){var e=o.apply(this,Array.prototype.slice.apply(arguments));return null!==r&&Stats.record({kind:r}),e})).on("change",(function(){this.files&&this.files[0]&&i.call(this,this.files),e(this).val("")})).css({position:"absolute",opacity:0,"z-index":1e4,cursor:"pointer"}),h=e("<div/>").addClass("input-wrapper").append(p).css({position:"absolute",overflow:"hidden"});u=e("<div/>").addClass("html5-upload-wrapper").css({position:"relative",display:"inline-block",cursor:"pointer"});for(var m=0;m<a.length;m++){var f=a[m];u.css(f,d.css(f)),d.css(f,0)}Capabilities.hasHover()?(p.css({right:"-1em",top:"-.5em"}),h.css({width:"3px",height:"3px"}),u.on("mouseenter",(function(){s&&(Log.debug("mouseenter file wrapper"),Log.debug("element offset",d.offset())),d.addClass("hover")})).on("mouseleave",(function(){s&&Log.debug("mouseleave file wrapper"),d.removeClass("hover")})).on("mousemove",(function(e){s&&console.log("mousemove file wrapper "+e.pageX+" "+e.pageY);var t=d.offset(),n=d.outerWidth(),i=d.outerHeight(),a=Math.max(t.left,Math.min(t.left+n,e.pageX))-1,o=Math.max(t.top,Math.min(t.top+i,e.pageY))-1;h.offset({left:a,top:o})}))):(p.css({width:"100%",height:"100%","min-width":"100%","max-width":"100%"}),h.css({width:"100%",height:"100%"}));d.wrap(u).before(h)}(i,t)}))},window.bcDebugFileInputWrappers=function(){s=!0,e(".html5-upload-wrapper > .input-wrapper").css("outline","solid 2px red").css("overflow","visible").find("input").css("opacity","0.75")}}(jQuery),function(e,t,n){"use strict";e.HTML5ImageUploader=function(e){var i=this;i.uploading=n.observable(!0),i.uploadDeferred=t.Deferred(),i.uploadPromise=i.uploadDeferred.promise(),i._uploader=new QueuedUploader({filter:QueuedUploader.FILTERS.image,maxFileSize:4194304,uploaderInfo:UploadInfo,finish:function(){"finished"===i.job.state?i.uploadDeferred.resolve(i.job.responseData):i.uploadDeferred.reject(i.job.state),i.uploading(!1)},failed:function(){i.uploadDeferred.reject("upload")}}),i.uploadFromComputer=function(e,t){i.uploading(!0),i.job=i._uploader.queueFile(t,{postURL:e})},i.uploadFromURL=function(e,t,n){var i=this;i.uploading(!0);var a={photo_image_url:t,photo_image_source:n,fan_id:Identities.fan().id};Crumb.ajax({type:"POST",url:e,data:a,dataType:"json",success:function(e){e.ok?i.uploadDeferred.resolve(e):i.uploadDeferred.reject("upload"),i.uploading(!1)},error:function(e,t,n){i.uploadDeferred.reject("upload")}})}}}(window,jQuery,ko),function(){"use strict";var e=new QueuedUploader({maxFileSize:1e7,filter:QueuedUploader.FILTERS.image,uploaderInfo:UploadInfo});ko.components.register("image-upload",{viewModel:function(t){var n=this;this.imageID=t.id,this.imageHash=t.hash,this.canDelete=t.canDelete,this.imageFormat=t.format,this.postURL=t.postURL||"/upload_image",this.imageParams=ko.pureComputed((function(){return{image_id:ko.unwrap(n.imageID),format:ko.unwrap(n.imageFormat)}})),this.deleteImage=function(){n.imageID(null)},this.uploadFile=function(t,i){var a=i.target.files[0];if(i.target.value=null,a){n.uploading(!0),n.progress(0);var s={postURL:ko.unwrap(n.postURL)},o=e.queueFile(a,s).on("progress",(function(){n.progress(o.sent/o.size)})).on("finish",(function(){var e=o.responseData;n.imageID(e.id),n.imageHash(e.hash),n.uploading(!1)})).on("error",(function(){n.uploading(!1),NuDialog.alert(o.errorReason,o.errorMessage)}))}},this.uploading=ko.observable(!1),this.progress=ko.observable(0),this.progressWidth=ko.pureComputed((function(){return 100*n.progress()+"%"}))},template:'<div class="knockout-image-upload" data-bind="css: {\'knockout-image-upload-no-art\': !imageID()}">\x3c!-- ko if: imageID --\x3e   <button class="knockout-image-upload-delete" data-bind="click: deleteImage, visible: canDelete" title="delete">X</button>   <img data-bind="src_image: imageParams">\x3c!-- /ko --\x3e\x3c!-- ko ifnot: imageID --\x3e   <label class="knockout-image-upload-add" data-bind="visible: !uploading()"><input type="file" data-bind="event: {change: uploadFile}">add</label>   <div class="knockout-image-upload-progress-outer" data-bind="visible: uploading">       <div class="knockout-image-upload-progress-inner" data-bind="style: {width: progressWidth}"></div>   </div>\x3c!-- /ko --\x3e</div>'})}(),function(e,t,n){"use strict";var i=Number.MAX_VALUE;function a(e,t,a,s){var o=this;this.targetScale=s,this.targetDisplayWidth=t*this.targetScale,this.targetDisplayHeight=a*this.targetScale,this.originalImageLoaded=function(e){o.imageWidth(e.naturalWidth||e.width),o.imageHeight(e.naturalHeight||e.height),o.canvasScale(Math.min(i/o.imageWidth(),i/o.imageHeight()));var n=Math.max(t/o.imageWidth(),a/o.imageHeight());o.scaleMin(n),o.scale(n),o.displayLeft((o.targetDisplayWidth-o.displayWidth())/2),o.displayTop((o.targetDisplayHeight-o.displayHeight())/2),o.resetZoomCenter()},this.imageLoadFailed=function(){o.imageError(!0),o.imageLoading(!1),Stats.record({kind:"edit image load error"})},this.imageSrc=n.observable(e),this.imageError=n.observable(!1),this.imageWidth=n.observable(0),this.imageHeight=n.observable(0),this.imageLoading=n.observable(!0),this.canvasScale=n.observable(1),this.canvasWidth=n.computed((function(){return o.canvasScale()*o.imageWidth()})),this.canvasHeight=n.computed((function(){return o.canvasScale()*o.imageHeight()})),this.scaleMin=n.observable(1),this.scale=n.observable(1).extend({min:this.scaleMin,max:1}),this.displayWidth=n.computed((function(){return o.scale()*o.targetScale*o.imageWidth()})),this.displayHeight=n.computed((function(){return o.scale()*o.targetScale*o.imageHeight()})),this.displayLeftMin=n.computed((function(){return o.targetDisplayWidth-o.displayWidth()})),this.displayTopMin=n.computed((function(){return o.targetDisplayHeight-o.displayHeight()})),this.displayLeft=n.observable(0).extend({min:this.displayLeftMin,max:0}),this.displayTop=n.observable(0).extend({min:this.displayTopMin,max:0}),this.cropLeft=n.computed((function(){return-o.displayLeft()/o.targetScale/o.scale()})),this.cropTop=n.computed((function(){return-o.displayTop()/o.targetScale/o.scale()})),this.cropWidth=n.computed((function(){return t/o.scale()})),this.cropHeight=n.computed((function(){return a/o.scale()})),this.showZoomCenter=n.observable(!1),this.zoomCenterX=n.observable(0),this.zoomCenterY=n.observable(0),this.zoomCenterLeft=n.computed((function(){return o.scale()*o.targetScale*(o.zoomCenterX()-o.cropLeft())})),this.zoomCenterTop=n.computed((function(){return o.scale()*o.targetScale*(o.zoomCenterY()-o.cropTop())})),this.resetZoomCenter=function(){o.zoomCenterX=n.observable(o.cropLeft()+.5*o.cropWidth()),o.zoomCenterY=n.observable(o.cropTop()+.5*o.cropHeight())}}e.ImageEditorNuDialog=function(e){var i=this;t("#pagedata").data("blob").cfg;i.page=e.page,i.imgSrc=e.imgInfo.src,i.imgId=e.imgInfo.id,i.imgHash=e.imgInfo.hash,i.minWidth=e.minWidth,i.minHeight=e.minHeight,i.saving=n.observable(!1),i.uploading=n.observable(!1),i.error=n.observable(""),i.finishedDeferred=new t.Deferred,i.finishedPromise=i.finishedDeferred.promise(),i.saveDeferred=new t.Deferred,i.savePromise=i.saveDeferred.promise(),this.savePromise.always((function(){i.dialog.dialog("close")})),i.cancel=function(){i.dialog.dialog("close")},i.saving.subscribe((function(e){t(".crop-tool",i.dialog.body).bccroptool(e?"disable":"enable")})),i.save=function(){i.saving()||i.uploading()||(i.saving(!0),i.error(null),Crumb.ajax({type:"POST",url:"/edit_image",data:i.postParams(i.imgId,i.imgHash),success:function(e){e.ok?(i.finishedDeferred.resolve(e),i.saveDeferred.resolve(e)):(i.saving(!1),i.error("network"))},error:function(e){i.saving(!1),i.error("network")}}))},i.postParams=function(e,t){return{id:e,hash:t,crop_left:Math.round(i.cropViewModel.cropLeft()),crop_top:Math.round(i.cropViewModel.cropTop()),crop_width:Math.round(i.cropViewModel.cropWidth()),crop_height:Math.round(i.cropViewModel.cropHeight())}};var a={},s=TM("Crop Image",{},"Modify profile image.");"collection"===i.page?a[TM("OK",null,"Save profile image")]=i.save:"live event editor"===i.page?(a[TM("OK","dev")]=i.save,s=TM("Crop image","dev")):a[TM("Save")]=i.save,a[TM("Cancel")]=i.cancel,i.dialog=NuDialog.showTemplate("widgets/image_editor",{},{title:s,dialogClass:"image-editor-dialog",buttons:a,close:function(){i.finishedDeferred.isResolved()||i.finishedDeferred.reject("aborted"),i.dialog.remove()}}),i.cropViewModel=t(".crop-tool",i.dialog.body).bccroptool({minWidth:i.minWidth,minHeight:i.minHeight,imgSrc:i.imgSrc}).bccroptool("viewModel"),n.applyBindings(i,i.dialog.find(".editor-info")[0]),i.dialog.dialog("option","position","centre")},t.widget("bc.bccroptool",{options:{imgSrc:null,minHeight:400,minWidth:400},_viewModel:null,viewModel:function(){return this._viewModel},move:function(e,t){var n=this._viewModel;n.displayLeft(n.displayLeft()+e),n.displayTop(n.displayTop()+t),n.resetZoomCenter()},zoom:function(e,t,n){var i=this._viewModel,a=i.scale()*e;if(!(a>1||a<i.scaleMin()))if(void 0===t){i.scale(a);var s=.5*i.targetDisplayWidth-i.zoomCenterLeft(),o=.5*i.targetDisplayHeight-i.zoomCenterTop();i.displayLeft(i.displayLeft()+s),i.displayTop(i.displayTop()+o)}else{var r=e*(i.displayLeft()-t)+t,l=e*(i.displayTop()-n)+n;i.scale(a),i.displayLeft(r),i.displayTop(l)}},_setOption:function(e,t){"disabled"===e&&this._zoomSlider&&this._zoomSlider.option(e,t),this._super(e,t)},_create:function(){if(!this.options.imgSrc)throw"Must specify imgSrc option for bccroptool";var e=this;this.element.addClass("bccroptool").renderLiquid("widgets/bccroptool").find(".image").one("load",(function(){e._viewModel.originalImageLoaded(this),e._viewModel.canvasScale()<1?e._useRescaledImage(this):e._viewModel.imageLoading(!1)})).one("error",(function(t){e._viewModel.imageLoadFailed()})).end();var t=this.options.minWidth,i=this.options.minHeight,s=this.element.find(".target"),o=Math.min(s.width()/t,s.height()/i);this._$target=s,this._viewModel=new a(this.options.imgSrc,t,i,o),n.applyBindings(this._viewModel,this.element[0]),Capabilities.hasTouch()?this._initTouch():(this._initSlider(),this._initMouse())},_useRescaledImage:function(e){var n=this._viewModel,i=n.canvasWidth(),a=n.canvasHeight(),s=t("<canvas>").attr({width:i,height:a})[0],o=s.getContext("2d");function r(e){e?n.imageSrc(e):Log.error("failed to create scaled image url")}this.element.find(".image").one("load",(function(){n.imageLoading(!1)})).one("error",(function(){n.imageLoadFailed()})),o.drawImage(e,0,0,i,a),"toBlobHD"in s?s.toBlobHD(r):"toBlob"in s?s.toBlob(r):r("toDataURLHD"in s?s.toDataURLHD():s.toDataURL())},_initSlider:function(){var e=this,t=this.element.find(".zoom-slider");t.slider({orientation:"horizontal",max:1,min:0,step:.001}).on("mousedown",(function(e){e.stopPropagation()})),this._zoomSlider=t.data("ui-slider"),this._on(".zoom-slider",{slide:function(e,t){var n=t.value,i=this._viewModel.scaleMin(),a=this._viewModel.scale(),s=i+(1-i)*n;this.zoom(s/a)}}),this._viewModel.scale.subscribe((function(t){var n=e._viewModel.scaleMin();e._zoomSlider.value((t-n)/(1-n))}))},_initMouse:function(){var e,n,i=this;function a(e){var t=e.originalEvent||e,n=-t.wheelDelta||t.detail||t.deltaY;return this.zoom(Math.pow(2,n/500)),!1}this._on({mousedown:function(a){return e=a.clientX,n=a.clientY,t("body").on("mousemove.bccropdrag",(function(t){var a=t.clientX,s=t.clientY;t.altKey||t.shiftKey||t.ctrlKey?i.zoom(Math.pow(2,(n-s)/100)):i.move(a-e,s-n),e=a,n=s})).one("mouseup.bccropdrag mouseleave.bccropdrag",(function(e){t("body").off("mousemove.bccropdrag")})),!1},mousewheel:a,DOMMouseScroll:a,wheel:a})},_initTouch:function(){var e,t=this;function n(e){var n=0,i=0;Iter.each(e,(function(e){n+=e.pageX,i+=e.pageY}));var a=n/e.length,s=i/e.length,o=0;Iter.each(e,(function(e){o+=Math.pow(e.pageX-a,2)+Math.pow(e.pageY-s,2)}));var r=t._$target.offset();return{x:a-r.left,y:s-r.top,spread:Math.sqrt(o)/e.length}}this._on({touchstart:function(t){e=n(t.originalEvent.targetTouches)},touchmove:function(t){var i=n(t.originalEvent.targetTouches);this.move(i.x-e.x,i.y-e.y),i.spread&&e.spread&&this.zoom(i.spread/e.spread,i.x,i.y),e=i,t.preventDefault()}})}})}(window,jQuery,ko),function(e,t,n){"use strict";e.CompleteProfileVM=function(e){var i=this;i.fanImageId=n.observable(e.imageId),i.fanImageHash=n.observable(null),i.fanImageFakePath=n.observable(""),i.fanImageUploading=n.observable(!1),i.showEditProfilePic=n.observable(!1),i.toggleEditProfilePic=function(){i.showEditProfilePic(!i.showEditProfilePic())},i.deleteProfilePic=function(){i.showEditProfilePic(!1),i.fanImageId(!1),i.fanImageHash(!1),i.fanImageFakePath(""),i.fanImageUploading(!1)},i.uploadProfilePic=function(){document.getElementById("signup-profile-pic-input").click()},i.addProfilePicKeydown=function(e,t){return 13!==t.keyCode||(document.getElementById("signup-profile-pic-input").click(),!1)},i.addProfilePic=function(e,t){i.showEditProfilePic(!1);var n=event.target.files[0];if(n){var a=new FileReader,s=new Image;a.readAsDataURL(n),a.onload=function(e){s.src=e.target.result,s.onload=function(){var e=this.width,t=this.height;n.size>4194304?(NuDialog.alert(TM("Error","dev"),TM("Your image is too large. Please select an image that is less than 4 MB.","pre")),i.fanImageFakePath("")):e<480||t<480?(NuDialog.alert(TM("Error","dev"),TM("Your image is too small, it must be at least 480 x 480 pixels wide and tall.","pre")),i.fanImageUploading(!1),i.fanImageFakePath("")):(i.fanImageUploading(!0),i.getUploader().uploadFromComputer("/fan_photo_uploaded",n))},s.onerror=function(){NuDialog.alert(TM("Error","dev"),TM("We couldnt upload your profile image. Please try again.","pre")),i.fanImageUploading(!1),i.fanImageFakePath("")}}}};i.getUploader=function(){var e=new HTML5ImageUploader;return e.uploadPromise.done((function(e){!function(e){i.fanImageUploading(!1);var t=e.image_id,n=ImageUtils.imageURL(t,"original"),a=e.image_hash;new ImageEditorNuDialog({imgInfo:{src:n,id:t,hash:a},minWidth:800,minHeight:800,page:i.page}).finishedPromise.done((function(e){i.fanImageId(e.id),i.fanImageHash(e.hash),document.getElementById("complete-profile-name-input").focus()})).fail((function(){i.fanImageFakePath(""),i.fanImageUploading(!1),document.getElementById("complete-profile-name-input").focus()}))}(e)})).fail((function(e){i.fanImageUploading(!1),NuDialog.alert(TM("Error","pre"),TM("We couldnt upload your profile image. Please try again.","pre")),i.fanImageFakePath("")})),e},i.locationVM=new FanLocationVM(e.location,e.rawLocation),i.name=n.observable(e.name).extend({errorKeys:{tooLong:TM("That display name is too long. Please try again.","pre")}}),i.name.validate=function(){var e=t.trim(i.name());i.name.error_key(e.length>100?"tooLong":null)},i.location=i.locationVM.rawLocation.extend({errorKeys:{tooLong:TM("That location is too long. Please try again.","pre")}}),i.location.validate=function(){var e=t.trim(i.name());i.location.error_key(e.length>1e3?"tooLong":null)},i.nameHintVisible=n.observable(!1),i.showNameHint=function(){i.nameHintVisible(!0)},i.hideNameHint=function(){i.nameHintVisible(!1)},i.locationHintVisible=n.observable(!1),i.showLocationHint=function(){i.locationHintVisible(!0)},i.hideLocationHint=function(){i.locationHintVisible(!1)},i.hasErrors=n.computed((function(){var e=!1;return["name","location"].forEach((function(t){e=e||i[t].error_key()})),e})),this.validate=function(){return["name","location"].forEach((function(e){i[e].validate()})),!i.hasErrors()},i.submitting=n.observable(!1),i.submit=function(){if(i.validate()){i.submitting(!0);var n={name:i.name(),location:i.locationVM.rawLocation()};i.fanImageId()&&(n.image_id=i.fanImageId(),i.fanImageHash()&&(n.image_hash=i.fanImageHash())),e.params&&t.extend(n,e.params),SignupAPI.completeProfile(n).then((function(t){i.submitting(!1),i.fanImageHash(null),e.onSubmit&&e.onSubmit(n)}),(function(t){i.submitting(!1),e.onError&&e.onError(t&&t.error)}))}else e.onValidationError&&e.onValidationError()},i.skip=function(){e.onSubmit()}}}(window,$,ko),function(e,t,n){"use strict";var i={f:"fan/tooltips/feed_tooltip",s:"fan/tooltips/search_tooltip",d:"fan/tooltips/discover_tooltip",b:"fan/tooltips/follow_tooltip",g:"fan/tooltips/genre_follow_tooltip",w:"fan/tooltips/wishlist_tooltip",x:"fan/tooltips/wishlist_button_tooltip",o:"fan/tooltips/fan_follow_tooltip",c:"fan/tooltips/collection_tooltip"},a=function(n,i){var a=this,s=t(i);n=n||{},a.tooltips=n.tooltips,a.numTooltips=n.num_tooltips,a.tooltipNumber=n.tooltip_number,a.currentIndex=n.current_index,a.complete=n.complete,a.$root=s,a.showFirstWishlistTooltip=n.show_first_wishlist_tooltip,a.firstWishlistedItemTitle=n.first_wishlisted_item_title,a.firstWishlistedItemType=n.first_wishlisted_item_type,a.firstPurchasedItemTitle=n.first_purchased_item_title,a.firstPurchasedItemType=n.first_purchased_item_type,a.fanName=e.FanData&&e.FanData.name||Identities&&Identities.fan&&Identities.fan()&&Identities.fan().name,e.BandData&&(a.bandName=e.BandData.name),a.hasSeenTooltips=!!n.has_seen_tooltips,a.hasCollection=n.has_collection,a.bindRockTheVoteBanner(),a.bindNewsletterInviteBanner(),a.rebind(),BCEvents.subscribe("hub.dismissFanFollowTooltip",(function(){null!=a.currentIndex&&"o"===a.tooltips[a.currentIndex]&&t(".fan-reviews .signup-tooltip-parent.show-tooltip[data-tooltip-id='o'] .signup-tooltip  a.dismiss-tooltip").trigger("click.dismiss")})),BCEvents.subscribe("hub.dismissDDFollowTooltip",(function(){null!=a.currentIndex&&"o"===a.tooltips[a.currentIndex]&&t(".dig-deeper .signup-tooltip-parent.show-tooltip[data-tooltip-id='g'] .signup-tooltip  a.dismiss-tooltip").trigger("click.dismiss")}))};a.prototype.setFirstWishlistedItem=function(e,t){this.firstWishlistedItemTitle=e,this.firstWishlistedItemType=t},a.prototype.setTooltips=function(e){var t=this;t.tooltips=e,t.numTooltips=e.length,t.tooltipNumber=1,t.currentIndex=0,t.complete=!1},a.prototype.dismissTooltip=function(n,i){var a=this;if(a.tooltips){var s=t(n).closest(".signup-tooltip-parent");s.addClass("hide-tooltip"),setTimeout((function(){s.removeClass("show-tooltip"),BCEvents.publish("fanOnboarding.dismissTooltip",{})}),500);var o=a.tooltips[a.currentIndex],r=[o];return"f"===o&&r.push("b"),"b"===o&&r.push("z"),SignupAPI.dismissTooltips(r),i?setTimeout((function(){t(n).attr("href")&&(e.location.href=t(n).attr("href"))}),500):a.advance(),t(e).off("resize.adjustCss"),!1}},a.prototype.dismissCollectionBanner=function(e){Crumb.ajax({url:"/api/fansignup/1/dismiss_collection_banner",data:{},dataAs:"JSON",type:"POST",success:function(e){e.error&&Log.error("error dismissing banner")},error:function(e,t,n){Log.error("ajax error: ",t,n)}})},a.prototype.dismissFeedBanner=function(e){Crumb.ajax({url:"/api/fansignup/1/dismiss_feed_banner",data:{},dataAs:"JSON",type:"POST",success:function(e){e.error&&Log.error("error dismissing banner")},error:function(e,t,n){Log.error("ajax error: ",t,n)}})},a.prototype.advance=function(){var e=this;e.currentIndex=e.currentIndex+1;var n=e.tooltips[e.currentIndex];n?(e.tooltipNumber=e.tooltipNumber+1,e.renderCurrentTooltip(!0),["w","f","s"].indexOf(n)>-1&&t("html, body").animate({scrollTop:0},300)):t("body").removeClass("prevent-header-hiding")},a.prototype.rebind=function(){var e=this;t(".signup-tooltip a.dismiss-tooltip",e.$root).off("click.dismiss"),t(".signup-tooltip a.dismiss-tooltip",e.$root).on("click.dismiss",(function(){return e.dismissTooltip(this)})),t(".signup-tooltip-parent a.dismiss-tooltip",e.$root).off("click.dismiss"),t(".signup-tooltip-parent a.dismiss-tooltip",e.$root).on("click.dismiss",(function(){return e.dismissTooltip(this)})),t(".signup-tooltip-parent .dismiss-tooltip-alt",e.$root).off("click.dismiss"),t(".signup-tooltip-parent .dismiss-tooltip-alt",e.$root).on("click.dismiss",(function(){return e.dismissTooltip(this,!0)}))},a.prototype.dataForRender=function(){var t=this;return{tooltips:t.tooltips,num_tooltips:t.numTooltips,tooltip_number:t.tooltipNumber,current_index:t.currentIndex,band_name:t.bandName,fan_name:t.fanName,tag_name:t.tagName,feed_url:Identities.fan()?siteroot_https+"/"+Identities.fan().username+"/feed":null,wishlist_url:Identities.fan()?siteroot_https+"/"+Identities.fan().username+"/wishlist":null,first_wishlisted_item_title:t.firstWishlistedItemTitle,first_wishlist_item_title_length:16,first_wishlisted_item_type:t.firstWishlistedItemType,first_purchased_item_title:t.firstPurchasedItemTitle,first_purchased_item_type:t.firstPurchasedItemType,origin_page:e.FanSignup?FanSignup.originPage:null}},a.prototype.renderCurrentTooltip=function(n,a){var s=this,o=s.tooltips[s.currentIndex],r=t(a||".signup-tooltip-parent[data-tooltip-id='"+o+"']");if(r&&!r.hasClass("show-tooltip")){var l=n?500:0,c=i[o];if(c){if(t(".signup-tooltip-outer",r).empty(),t(".signup-tooltip-outer",r).append(Templ.render(c,{fan_onboarding:s.dataForRender(),cfg:t("#pagedata").data("blob").cfg})),"x"===o&&r.hasClass("collection-item-actions")){var d=t(".signup-tooltip-body",r),u=t(".dismiss-tooltip",r),p=d.width(),h=u.width(),m=function(){var e=t(".signup-tooltip-outer",r).offset().left;e<-(400-p)/2+12?d.css({"text-align":"left","margin-left":-e-(400-p)/2+12}):d.css({"text-align":"center","margin-left":0}),e<-(400-h)/2+12?u.css({"text-align":"left","margin-left":-e-(400-h)/2+12}):u.css({"text-align":"center","margin-left":0})};m(),t(e).on("resize.adjustCss",(function(){m()})),e.doAdjust=m}s.rebind(),setTimeout((function(){r.addClass("show-tooltip"),BCEvents.publish("fanOnboarding.showTooltip",{})}),l),SignupAPI.markTooltipsViewed([o])}}},a.prototype.initForView=function(e){var t=this;t.tooltips&&0!==t.tooltips.length&&(t.currentIndex||(t.currentIndex=0),t.renderCurrentTooltip(null,e),t.bindVerifyBanner())},a.prototype.showTooltip=function(e,t){this.setTooltips([e]),this.initForView(t)},a.prototype.skipWalkthrough=function(){SignupAPI.dismissTooltips(this.tooltips)},a.prototype.showVerifyBanner=function(){t(".corpbanner.verify-email").show()},a.prototype.bindVerifyBanner=function(){t(".corpbanner.verify-email a").off("click.verify"),t(".corpbanner.verify-email .resend-verification-email").on("click.verify",(function(){var n=t(".corpbanner.verify-email").data("email");return e.verifyNag=e.verifyNag||new VerifyNag({fan_email:n,skipToEmail:!0},(function(e,n){(e||n)&&t(".corpbanner.verify-email").addClass("hide")})),e.verifyNag.openDialog(),!1})),t(".corpbanner.verify-email .dismiss-banner").on("click.verify",(function(){return SignupAPI.dismissVerificationBanner({}),t(".corpbanner.verify-email").addClass("hide"),!1}))},a.prototype.bindRockTheVoteBanner=function(){t(".corpbanner.rock-the-vote .dismiss-banner").on("click",(function(){return t(".corpbanner.rock-the-vote").addClass("hide"),t(".bd.has-rock-the-vote-banner").removeClass("has-rock-the-vote-banner"),t(".has-menubar.has-rock-the-vote-banner").removeClass("has-rock-the-vote-banner"),SignupAPI.dismissRockTheVoteBanner({}),!1}))},a.prototype.bindNewsletterInviteBanner=function(){var e=this;t(".newsletter-invite-banner .tell-us-what-you-like").on("click",(function(){t(".newsletter-invite-banner").hide(),SignupAPI.dismissNewsletterInviteBanner({});var e={fan_id:Identities.fan().id||FanData.fan_id},n=t.Deferred();return Crumb.ajax({url:"/api/genrepreferences/1/open_genre_preferences",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?(FanSignup.updateState({followedGenres:e.result.followed_genres,fromNewsletterInvite:!0,fanUsername:Identities.fan().name||FanData.name,email:t("#pagedata").data("blob").fan_onboarding.email}),FanSignup.openPane("genre_picker",!0),n.resolve(e)):(Log.debug("failure response",e),n.reject(e))},error:function(e,t,i){return n.reject()}}),n.promise()})),t(".newsletter-invite-banner .dismiss").on("click",(function(){t(".newsletter-invite-banner").hide(),SignupAPI.dismissNewsletterInviteBanner({}),e.skipWalkthrough()}))},a.prototype.showNewsletterInviteBanner=function(){t(".newsletter-invite-banner").show()};var s=t("#pagedata").data("blob"),o=s.fan_onboarding||{},r=s.signup_params;t(document).ready((function(){var n=t("#header-wrapper"),i=t("#menubar");if(n||i){var l=new a(o,t("body")[0]);if(e.FanOnboarding=l,t("#dismiss-collection-banner").click((function(){return t(".onboarding-collection-banner").addClass("hide"),l.dismissCollectionBanner(),!1})),t("#dismiss-feed-banner").click((function(){return t(".onboarding-collection-banner").addClass("hide"),l.dismissFeedBanner(),!1})),l.tooltips&&l.tooltips.length>0){var c=Url.getQueryParam(e.location.href,"fan_action_pane");c&&"welcome_2"===c||s.show_newsletter_invite_banner||l.initForView()}l.bindVerifyBanner();var d=new Cookie.CommChannel("fan_verification");r&&r.set_fan_verified?d.send("verified",1):Identities.fan()&&Identities.fan().verified||(d.subscribe((function(e,n){"verified"==n[1]&&n[2]&&Identities.fan()&&(Identities.fan().verified=1,t(".corpbanner.verify-email").addClass("hide"))})),d.startListening())}}))}(window,$,ko),function(e,t,n){"use strict";var i=null,a={createFanAccount:function(e){var n=t.Deferred();return Identities.user()&&(e.user_id=Identities.user().id),e.email=t.trim(e.email),e.name=t.trim(e.name),e.password=t.trim(e.password),Crumb.ajax({url:"/api/fansignup/1/signup",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):(Log.debug("failure response",e),n.reject(e))},error:function(e,t,i){return n.reject()}}),n.promise()},login:function(e){var n=t.Deferred();return e.email=t.trim(e.email),e.password=t.trim(e.password),Crumb.ajax({url:"/api/fansignup/1/login",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},logout:function(){var e=t.Deferred();return Crumb.ajax({url:"/api/fansignup/1/logout",data:{},dataAs:"JSON",type:"POST",success:function(t){return t.ok?e.resolve(t):e.reject(t)},error:function(t,n,i){return e.reject()}}),e.promise()},sendForgotPasswordEmail:function(e){var n=t.Deferred();return e.email=t.trim(e.email),Crumb.ajax({url:"/api/fansignup/1/forgot_password",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},resetPassword:function(e){var n=t.Deferred();return e.token=t.trim(e.token),e.password=t.trim(e.password),Crumb.ajax({url:"/api/fansignup/1/reset_password",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},sendAppLinkEmail:function(e){var n=t.Deferred();return e.email=t.trim(e.email),e.fan_username=t.trim(e.fan_username),Crumb.ajax({url:"/api/fansignup/1/send_app_link_email",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},resendFanVerifyEmail:function(e){var n=t.Deferred();return e.email&&(e.email=t.trim(e.email)),Crumb.ajax({url:"/api/fansignup/1/resend_fan_verify_email",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},dismissTooltips:function(e){var n=t.Deferred();return Crumb.ajax({url:"/api/fansignup/1/dismiss_tooltips",data:{tooltips:e},dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},setWelcomePaneSeen:function(){var e=t.Deferred();return Crumb.ajax({url:"/api/fansignup/1/set_welcome_pane_seen",data:{},dataAs:"JSON",type:"POST",success:function(t){return t.ok?e.resolve(t):e.reject(t)},error:function(t,n,i){return e.reject()}}),e.promise()},markTooltipsViewed:function(e){var n=t.Deferred();return Crumb.ajax({url:"/api/fansignup/1/mark_tooltips_viewed",data:{tooltips:e},dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},dismissRockTheVoteBanner:function(e){var n=t.Deferred();return Crumb.ajax({url:"/corpbanner/dismiss_rock_the_vote_banner_cb",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},dismissNewsletterInviteBanner:function(e){var n=t.Deferred();return Crumb.ajax({url:"/corpbanner/dismiss_newsletter_invite_banner_cb",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},dismissVerificationBanner:function(e){var n=t.Deferred();return Crumb.ajax({url:"/api/corpbanner/1/dismiss_verification_banner",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},followGenres:function(e){var n=t.Deferred(),i={selected_genres:e};return Crumb.ajax({url:"/api/fansignup/1/follow_genres",data:i,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()},setGenrePreferences:function(e){var n={fan_id:Identities.fan().id||FanData.fan_id,toFollow:e.toFollow,toUnfollow:e.toUnfollow},i=t.Deferred();return Crumb.ajax({url:"/api/genrepreferences/1/save_genre_preferences",data:n,dataAs:"JSON",type:"POST",success:function(e){return e.ok?i.resolve(e):(Log.debug("failure response",e),i.reject(e))},error:function(e,t,n){return i.reject()}}),i.promise()},subscribeToNewsletters:function(e,n){var i=t.Deferred(),a={genre_ids:e,best_of:n};return Crumb.ajax({url:"/api/fansignup/1/subscribe_to_newsletters",data:a,dataAs:"JSON",type:"POST",success:function(e){return e.ok?i.resolve(e):i.reject(e)},error:function(e,t,n){return i.reject()}}),i.promise()},customGenreSearch:function(e,n){var i=t.Deferred();return t.post("/api/fansignup/1/search_tag",JSON.stringify({search_term:e,count:n||10})).then((function(e){return e.ok?i.resolve(e):i.reject(e)}),(function(){return i.reject()})),i.promise()},completeProfile:function(e){var n=t.Deferred();return Crumb.ajax({url:"/api/fansignup/1/complete_profile",data:e,dataAs:"JSON",type:"POST",success:function(e){return e.ok?n.resolve(e):n.reject(e)},error:function(e,t,i){return n.reject()}}),n.promise()}},s={scrollToFirstError:function(){var e=t("#signup-vm");if(e[0]){var n=e.find(".error:first");if(Dom.scrollToElement(n,-50,!0),"phone"!=MediaView.mode)try{n.focus().select()}catch(e){}}},scrollToTheTop:function(e){t("html, body").animate({scrollTop:0},e||200)},asyncLogin:function(e){Identities.initialData=e,Identities.updateFromHash(e),Identities.user(e.user),Identities.fan(e.fan),Identities.partner(e.partner),Identities.isAdmin(e.isAdmin),Identities.subscribedToPageBand(e.subscribed_to_page_band),e.fan&&e.fan.url&&t("#collect-item a.view, .collect-item a.view, .wishlisted-msg .view a").attr("href",e.fan.url+"#wishlist")},renderMenubar:function(n,i,a){var s=i||{},o=t("#pagedata").data("blob")||{},r=o.cfg||{},l=o.user_testing||{},c=t("#menubar-wrapper");0===c.length&&(t("body").prepend(t('<div id="menubar-wrapper"></div>')),c=t("#menubar-wrapper"),r.header_rework_2018&&c.addClass("header-rework-2018")),s.fan_url=n.fan&&n.fan.url,s.is_fan_page=!0,a&&"wishlist"===a.action&&(s.has_wishlist=!0);var d=n.fan&&n.fan.verified;Templ.renderElem(c[0],"menubar",{page_identities:n,menubar:s,cfg:r,user_testing:l,skip_verification_banner:d,fan_onboarding:{email:i.email,show_verify_banner:!0}}),d||FanOnboarding.bindVerifyBanner(),r.header_rework_2018&&(t("#header-wrapper").length>0&&t("#header-wrapper").hide(),t("#menubar-wrapper").addClass("header-rework-2018"),t(".bd").removeClass("corp-header-padding")),Menubar.initialize(),e.Logout&&e.Logout.initialize()},renderHeader:function(i,a,s){if(0!==t("#header-wrapper").length){var o=a||{},r=t("#pagedata").data("blob")||{},l=r.cfg||{},c=r.user_testing||{};if(o.is_corp_home=r.is_corp_home,o.has_cart=r.has_cart,o.cart_quantity=r.cart_quantity,o.identities=i,o.cfg=l,o.user_testing=c,o.is_client_render=!0,o.gift_card_balance&&(o.currency_data&&!e.CurrencyData&&(e.CurrencyData=o.currency_data),o.gift_card_balance=new Money(o.gift_card_balance)),e.FanOnboarding&&e.FanOnboarding.tooltips?o.fan_onboarding=e.FanOnboarding.dataForRender():o.skip_verification_banner=!0,s&&"wishlist"===s.action&&(o.has_wishlist=!0),o.show_rock_the_vote_banner=r.show_rock_the_vote_banner,Templ.renderElem(t("#header-wrapper")[0],"home/header_2015",o),o.show_rock_the_vote_banner&&FanOnboarding.bindRockTheVoteBanner(),e.initializeAutocomplete){e.AutocompleteVM=e.initializeAutocomplete();var d=t("#homepage-autocomplete-results"),u=AutocompleteVM;d[0]&&n.applyBindings(u,d[0])}e.Logout&&e.Logout.initialize(),t(".all-signup-link").click((function(){return FanSignup.openPane("choose_account",!0),!1}))}},cleanURL:function(){history&&history.replaceState({},"",e.location.pathname)},signupError:function(e){return i||(i={logged_in_fan:TM("Youre already logged in as a fan."),wrong_email:TM("Your email address does not match what we have on file.")}),i[e]}};e.SignupAPI=a,e.SignupUtils=s}(window,$,ko),function(e,t,n){"use strict";var i=t("#pagedata").data("blob"),a=i.cfg||{},s=Url.getQueryParam(e.location.href,"skip_redeem");e.SignupPane=function(o,r){var l=this,c=/^[a-zA-Z0-9_-]+$/,d=/^(_)\1*$/,u=o.state;Stats.record({kind:"click",click:"fan_signup_start"});var p,h=function(e){return/(^)([^\s\(\)"'\/><,@]+@\w([^\s\(\)"'\/><&,@]*\w)?\.\w[^\s\(\)"'\/><&,@]*\w)($)/.test(e)};switch(l.showGiftCardPrompt=n.observable(!1),o.originPage){case"redeem":p=TM("Sign up and redeem",null,"sign up for fan account and redeem gift card");break;case"gift_cards":p=TM("Sign up"),l.showGiftCardPrompt(!0);break;default:p=TM("Sign up for a Bandcamp fan account")}if(l.title=Identities.user()?"":p,l.pageTitle=TM("Sign up"),l.template="fan/signup/fan_signup_pane",l.resetOnClose=!0,l.signupToken=o.signupToken,l.tsig=o.tsig,l.verified=o.verified,l.width=500,l.position={my:"center center",at:"center center-60",of:e},l.visible=n.observable(!1),l.immediate=n.observable(!!r.immediate),l.afterRender=function(){t(".signup-heading").hide(),t("#signup-title").show(),l.visible(!0),"desktop"===MediaView.mode&&(l.loggedIn()?t("#username-input").focus():t("#email-input").focus())},l.close=function(e){var n=t.Deferred();return e&&o.updateState(l.exportState()),l.immediate(!1),l.visible(!1),Captcha.hideInvisible(),n.resolve(),n.promise()},this.saving=n.observable(!1),this.inlineLoginVisible=n.observable(!1),this.disableEmailField=n.pureComputed((function(){var e=Object.keys(FanSignup.CROWDFUNDING_RECEIPT_ACTIONS).map((function(e){return FanSignup.CROWDFUNDING_RECEIPT_ACTIONS[e]}));return"crowdfunding"===o.originPage&&-1!==e.indexOf(o.actionParams.action)&&!l.inlineLoginVisible()&&!l.emailEdited()&&l.email()})),l.loggedIn=n.observable(!!Identities.user()),l.usernameIsURL=n.computed((function(){return l.loggedIn()||l.inlineLoginVisible()})),l.showExistingArtist=n.computed((function(){return l.loggedIn()&&!o.portable&&(!o.actionParams||!o.actionParams.action)})),l.showLiveInviteAcceptArtistMsg=n.computed((function(){return l.loggedIn()&&o.actionParams&&"live_invite"===o.actionParams.action})),l.notifyMeBand=n.observable(!1),l.notifyMeLabel=n.observable(!1),"follow"===o.actionParams.action&&"b"==o.actionParams.itemType){var m=i.signup_params.mailing_list_info,f=t("#follow-unfollow-band_"+o.actionParams.actionBandId)[0];l.showNotifyMe=!0,l.artist=f?f.dataset.bandName:BandData&&BandData.name,m&&(l.label=m.label_name,l.labelId=m.label_id)}function g(t){var n={mode:MediaView.mode,username:l.username(),tsig:l.tsig,verified:l.verified};l.signupToken&&l.signupToken.length>0&&(n.signup_token=l.signupToken),l.saveCard()&&(n.save_card=l.saveCard()),l.enableCaptcha()&&(n.captcha_token=t),l.loggedIn()||(n.email=l.email()),l.signupToken&&(n.signup_token=l.signupToken),l.loggedIn()||(n.password=l.password()),l.selectedUser()&&(n.user_id=l.selectedUser().user_id),o.actionParams&&(n.action=o.actionParams.action,n.action_item_id=o.actionParams.actionItemId,n.action_band_id=o.actionParams.actionBandId,n.action_item_type=o.actionParams.actionItemType,n.action_url=o.actionParams.actionURL,n.action_sig=o.actionParams.actionSig),"follow"===o.actionParams.action&&(n.notify_me_band=l.notifyMeBand(),n.notify_me_label=l.notifyMeLabel(),n.action_label_id=l.labelId),!o.activationParams||"home"!==o.originPage&&"band"!==o.originPage||(n.activation_url=o.activationParams.url,n.activation_sig=o.activationParams.sig),l.email()===o.initialEmail&&o.initialEmailSignature&&(n.email_sig=o.initialEmailSignature),n.is_corp_signup="fans"===o.originPage||"home"===o.originPage||"corp"===o.originPage,s&&(n.skip_redeem=!0);var i=o.getSignupFrom();n.signup_from=i,"redeem"===i&&(n.resume_id=o.actionParams.resumeId,n.resume_buy_id=o.actionParams.resumeBuyId,n.resume_action=o.actionParams.resumeAction),n.link_band=l.inlineLoginVisible(),l.saving(!0),SignupAPI.createFanAccount(n).then((function(t){t.crumbs&&Crumb.put(t.crumbs),t.user_data&&(l.userDataForMenubar=t.user_data);var n=o.actionParams&&o.actionParams.action,a=null,s=t.identities.bands&&t.identities.bands.length>0;n?"wishlist"===n?a=s?"logged_out_wishlist_band_signup_completes":"logged_out_wishlist_new_signup_completes":"follow"===n&&"f"===o.actionParams.actionItemType?a=s?"logged_out_fan_follow_band_signup_completes":"logged_out_fan_follow_new_signup_completes":"follow"===n&&"g"===o.actionParams.actionItemType?a=s?"logged_out_genre_follow_band_signup_completes":"logged_out_genre_follow_new_signup_completes":"follow"!==n||o.actionParams.actionItemType&&"b"!==o.actionParams.actionItemType?"live_ticket"!==n&&"live_attend"!==n&&"live_attend_immediate"!==n||(a="logged_out_live_ticket_purchase_new_signup_completes"):a=s?"logged_out_follow_band_signup_completes":"logged_out_follow_new_signup_completes":"corp"===i?a="corp_header_single_signup_fan_completes":"menubar"===i&&(a="menubar_single_signup_fan_completes"),a&&(Stats.record({kind:"click",click:a}),BCEvents.publish("fanSignup."+a,o.actionParams)),l.asyncIdentities=t.identities,l.nextURL=t.next_url,l.nextAppURL=t.next_app_url,l.verificationNeeded=t.verification_needed,l.tooltips=t.tooltips,t.tooltips&&e.FanOnboarding&&e.FanOnboarding.setTooltips(t.tooltips),t.first_wishlisted_item_title&&(o.actionParams.title=t.first_wishlisted_item_title),t.first_purchased_item_title&&(FanOnboarding.firstPurchasedItemTitle=t.first_purchased_item_title),t.first_purchased_item_type&&(FanOnboarding.firstPurchasedItemType=t.first_purchased_item_type),t.action_genre_id&&(o.actionParams.genreId=t.action_genre_id),t.upload_info&&!e.UploadInfo&&(e.UploadInfo=t.upload_info),SignupUtils.asyncLogin(t.identities),o.updateState(l.exportState()),"redeem"===o.originPage&&(Redeem.rawCardData(t.gift_card_data),Redeem.rawUserBalance(t.user_balance),Redeem.showNewFan(!0));var r=o.portable&&"desktop"===MediaView.mode,c=!o.portable&&o.actionParams.action,d=c&&o.actionParams.actionURL,u=!l.verificationNeeded,p=o.isMobile&&"redeem"!==c,h=p&&c,m="crowdfunding"===o.originPage,f="gift_cards"===o.originPage,g="live_ticket"===o.actionParams.action,_="live_invite"===o.actionParams.action,b="live_attend"===o.actionParams.action,v="live_attend_immediate"===o.actionParams.action;f?o.onComplete():b?l.openCompleteProfile():g||_||v?o.onComplete():m?u?l.openWelcome2():l.openWelcome():r?l.openGenrePicker():u?h&&d?l.continueMobileOnboardingAction():c?o.onComplete():l.openWelcome():h&&d?l.continueMobileOnboardingAction():p?l.continueMobileOnboarding():l.openAlmostThere()}),(function(e){if(e&&"captcha_missing"===e.error&&(l.enableCaptcha(!0),Captcha.renderInvisible()),e&&e.errors)Iter.each(e.errors,(function(e){if(e.field&&"email"===e.field&&"existing_fan"===e.error&&l.loggedIn())l.username.error_key("existingFanLoggedIn");else if(e.field&&"email"===e.field&&"fan_already_linked_email"===e.error&&l.loggedIn())l.username.error_key("fanAlreadyLinkedEmail");else if(e.field&&"email"===e.field&&"band_member"===e.error)l.inlineLoginVisible(!0);else if(e.field&&(l[e.field].error_key(e.error),"username"===e.field&&"duplicate"===e.error&&e.error_data)){var t=e.error_data.suggested_username;t&&t.length>0&&l.suggestedUsername(t)}SignupUtils.scrollToFirstError()}));else if(e&&"many_matched_users"===e.error&&e.error_data&&e.error_data.users&&e.error_data.users.length>0)l.chooserVisible(!0),l.inlineLoginVisible(!1),l.possibleUsers(e.error_data.users);else if(e){var t=e.error&&SignupUtils.signupError(e.error)||TM("There was a problem signing up. Please try again.");NuDialog.alert(TM("Signup Error"),t)}l.saving(!1)}))}l.username=n.observable(u.fan_username),l.email=n.observable(u.email),l.password=n.observable(u.password),l.passwordMasked=n.observable(!1),l.saveCard=n.observable(i.signup_params.save_card),l.emailEdited=n.observable(!1),l.tos=n.observable(!1),l.networkError=n.observable(!1),l.email.checking=n.observable(!1),l.email.checked=n.observable(!1),l.email.extend({errorKeys:{}}),l.email.subscribe((function(){l.email.error_key(null),l.email.checked(!1),l.inlineLoginVisible(!1),l.emailEdited(!0),h(t.trim(l.email()))&&!l.networkError()&&l.email.checking(!0)})),l.email.deferred=null,l.email.check=null,l.email.validate=function(){var e=l.email();l.loggedIn()?l.email.error_key(null):l.email.error_key(h(e)?null:"invalid")},u.email&&!l.loggedIn()&&setTimeout((function(){h(t.trim(l.email()))&&!l.networkError()&&l.email.checking(!0)}),300),l.password.extend({errorKeys:{missing:TM("Please enter your password."),tooShort:TM("Your password must be at least 3 characters."),incorrect:TM("That password isnt correct. Please try again.")}}),l.password.validate=function(){if(l.loggedIn())return l.password.error_key(null);l.password.error_key(l.password()?l.password().length<3?"tooShort":null:"missing")},l.username.display=n.pureComputed({read:function(){return l.username()},write:function(e){e&&e.length>0&&l.username(e.toLowerCase())}}),l.username.extend({errorKeys:{}}),l.username.validate=function(){var e=t.trim(l.username());l.username.error_key(e?e.length<3?"tooShort":e.length>60?"tooLong":h(e)?"isEmail":c.test(e)?d.test(e)?"undies":null:"invalid":"missing")},l.username.label=n.computed((function(){return l.loggedIn()||l.inlineLoginVisible()?TM("Choose your fan URL"):TM("Username")})),l.username.placeholder=n.computed((function(){return l.loggedIn()||l.inlineLoginVisible()?TM("choose your fan URL"):TM("username")})),l.username.subscribe((function(){l.username.error_key(null)})),l.suggestedUsername=n.observable(),l.useSuggestedUsername=function(){l.username(l.suggestedUsername()),l.suggestedUsername(null),l.username.error_key(null)},this.tos.extend({errorKeys:{missingValue:TM("Ahem... please agree to the terms.",null,"don't need to translate the ahem")}}),this.tos.validate=function(){l.tos.error_key(l.tos()?null:"missingValue")},this.chooserVisible=n.observable(!1),this.possibleUsers=n.observableArray(),this.formatUser=function(e){var t=[];return e.fan_username&&t.push(e.fan_username),e.bands&&e.bands.length>0&&(t=t.concat(Iter.collect(e.bands,(function(e){return e.band_name})))),Templ.render("login/user_picker_text",{username:e.username,list:t})},this.selectedUser=n.observable(),this.bottomLinkVisible=n.computed((function(){return!l.loggedIn()&&!l.chooserVisible()})),this.artistSignupVisible=n.computed((function(){return!o.portable&&!l.loggedIn()&&!l.chooserVisible()})),this.enableCaptcha=n.observable(a.fan_signup_use_captcha),this.enableCaptcha()&&Captcha.renderInvisible(),this.has_errors=n.computed((function(){return Iter.find(["email","password","username","tos"],(function(e){return l[e].error_key()}))})),this.clear_errors=function(){Iter.each(["password","username","tos","email"],(function(e){l[e].error_key(null)}))},this.submitEnabled=n.computed((function(){return!l.saving()&&!l.has_errors()})),this.submitText=n.computed((function(){return l.saving()?TM("Please wait...",null,"waiting to complete signup"):l.chooserVisible()?TM("Go",null,"complete signup"):l.loggedIn()?TM("Complete setup"):"jeanlucpicard"===l.username()?"Make it so":TM("Sign up")})),this.validate=function(){return Iter.each(["password","username","tos","email"],(function(e){l[e].validate()})),!l.has_errors()},this.submit=function(){if(l.submitEnabled())if(l.validate())if(Stats.record({kind:"click",click:"fan_signup_signup_continue"}),l.saving(!0),l.enableCaptcha()){var e=setTimeout((function(){l.saving(!1)}),1e4);Captcha.execute((function(t){clearTimeout(e),g(t)}))}else g(null);else SignupUtils.scrollToFirstError()},this.continueMobileOnboarding=function(){e.location.href=Url.addQueryParams(siteroot_https+"?",{fan_action_pane:"genre_picker",show_download_banner:1,redirect_to_app_url:l.nextAppURL})},this.continueMobileOnboardingAction=function(){e.location.href=Url.addQueryParams(o.actionParams.actionURL+"?",{fan_action_pane:"genre_picker",show_download_banner:1,redirect_to_app_url:l.nextAppURL})},this.openLogin=function(e){Stats.record({kind:"click",click:"fan_signup_signup_login"}),l.close(e).then((function(){o.openPane("login")}))},this.openForgotPassword=function(){l.close(!0).then((function(){o.openPane("forgot_password")}))},this.openAlmostThere=function(){l.close(!0).then((function(){o.openPane("almost_there"),o._dialog&&o._dialog.parent().addClass("no-close")}))},this.openWelcome=function(){l.close(!0).then((function(){o.openPane("welcome")}))},this.openWelcome2=function(){l.close().then((function(){o.openPane("welcome_2")}))},this.openCompleteProfile=function(){l.close().then((function(){o.openPane("complete_profile")}))},this.openGenrePicker=function(){l.close(!0).then((function(){o.openPane("genre_picker")}))},l.exportState=function(){return{fanUsername:l.username(),saveCard:l.saveCard(),email:l.email(),asyncIdentities:l.asyncIdentities,nextURL:l.nextURL,userDataForMenubar:l.userDataForMenubar,verificationNeeded:l.verificationNeeded}},l.hash=function(){return{download_item:i.download_item,signup_params:i.signup_params,show_notify_me:l.showNotifyMe,artist:l.artist,label:l.label,rendered:!0,cfg:a}}}}(window,$,ko),function(e,t,n){"use strict";e.LoginPane=function(i,a){var s=this,o=i.state,r=t("#pagedata").data("blob").cfg,l="redeem"===i.originPage?TM("Log in and redeem",null,"log in and redeem gift card"):TM("Log in");function c(n){var a={username:s.email(),password:s.password()};s.twofactorVisible()&&(a.twofactor=s.twofactor(),a.twofactor_remember=s.twofactorRemember()),n&&(a.captcha_token=n),i.actionParams&&(a.action=i.actionParams.action,a.action_item_id=i.actionParams.actionItemId,a.action_band_id=i.actionParams.actionBandId,a.action_item_type=i.actionParams.actionItemType,a.action_url=i.actionParams.actionURL,a.action_sig=i.actionParams.actionSig,a.resume_id=i.actionParams.resumeId,a.resume_buy_id=i.actionParams.resumeBuyId,a.resume_action=i.actionParams.resumeAction),s.selectedUser()&&(a.user_id=s.selectedUser().id),s.submitting(!0),SignupAPI.login(a).then((function(t){t.crumbs&&Crumb.put(t.crumbs);var n=i.actionParams&&i.actionParams.action;if(n){var a=null,r=t.identities.bands&&t.identities.bands.length>0&&!t.identities.fan;"wishlist"===n?a=r?"logged_out_wishlist_login_as_band_no_fan":"logged_out_wishlist_login_as_fan":"follow"===n&&"f"===i.actionParams.actionItemType?a=r?"logged_out_fan_follow_login_as_band_no_fan":"logged_out_fan_follow_login_as_fan":"follow"!==n||i.actionParams.actionItemType&&"b"!==i.actionParams.actionItemType||(a=r?"logged_out_follow_login_as_band_no_fan":"logged_out_follow_login_as_fan"),Stats.record({kind:"click",click:a})}if(t.user_data&&(s.userDataForMenubar=t.user_data),"redeem"===i.originPage&&(Redeem.rawCardData(t.gift_card_data),Redeem.rawUserBalance(t.user_balance)),t.upload_info&&!e.UploadInfo&&(e.UploadInfo=t.upload_info),SignupUtils.asyncLogin(t.identities),t.identities.fan&&!t.identities.fan.private)s.asyncIdentities=t.identities,s.nextURL=t.next_url,s.didLogin=!0,s.email(t.email),s.subscribedToBestOf=t.subscribed_to_best_of,s.alreadyPurchased=!!t.already_purchased,i.updateState(s.exportState()),"tag"===i.originPage&&e.hub&&s.subscribedToBestOf?i.onComplete():o.nextPane?i.openPane(o.nextPane):i.onComplete();else if(i.actionParams&&i.actionParams.action)if("gift_cards"===i.actionParams.action)s.asyncIdentities=t.identities,s.nextURL=t.next_url,s.didLogin=!0,s.email(t.email),s.subscribedToBestOf=t.subscribed_to_best_of,i.updateState(s.exportState()),i.onComplete();else{i.updateState({userName:t.username,bands:t.bands||[]});var l=!1;t.affiliations&&(i.affiliations=t.affiliations,(t.affiliations.fan||t.affiliations.fan_already_linked_email)&&(l=!0)),l?s.showDupeFan():s.showExistingArtist()}else e.location.href=t.next_url||siteroot_https}),(function(e){if(e&&"captcha_missing"===e.error&&(s.enableCaptcha(!0),Captcha.renderInvisible()),e&&e.errors)Iter.each(e.errors,(function(n){if(Log.debug("error.field: "+n.field+"; error.reason: "+n.reason),"login.twofactor"==n.field&&"missingValue"==n.reason)s.twofactorVisible()?s.twofactor.error_key("missingValue"):s.twofactorVisible(!0),t("#two-factor-code-input").focus();else if("login.user"==n.field&&"matchedManyUsers"==n.reason)s.userChooserVisible(!0),s.possibleUsers(e.error_data.matched_users);else if("login.user"==n.field&&"emailVerificationRequired"==n.reason)NuDialog.alert(TM("Email confirmation required"),TM("To log in, please click the link in the email that we just sent to the address associated with your account.")),i.onComplete();else{var a={"user.name":s.email,"login.password":s.password,"login.twofactor":s.twofactor}[n.field];a||(Log.error("Unknown error field",n.field),a=s.password),a.error_key(n.reason)}})),SignupUtils.scrollToFirstError();else if(e){var n=TM("There was an error logging in. Please try again.");NuDialog.alert(TM("Login Error"),n)}s.submitting(!1)}))}s.title=s.pageTitle=l,s.template="fan/signup/fan_login_pane",s.visible=n.observable(!1),s.immediate=n.observable(!!a.immediate),s.resetOnClose=!0,s.afterRender=function(){t(".signup-heading").hide(),t("#login-title").show(),s.visible(!0),"desktop"===MediaView.mode&&t("#email-input").focus()},s.close=function(){var e=t.Deferred();return i.updateState(s.exportState()),s.immediate(!1),s.visible(!1),e.resolve(),e.promise()},s.showExisting=n.observable(!!o.email),s.email=n.observable(o.email).extend({errorKeys:{missingValue:TM("Please enter your email or username."),noMatch:TM("We couldnt find that account. Please try again.")}}),s.password=n.observable().extend({errorKeys:{missingValue:TM("Please enter your password."),tooShort:TM("Your password is at least 3 characters."),noMatch:TM("Incorrect password. Please try again.")}}),this.userChooserVisible=n.observable(!1),this.possibleUsers=n.observableArray(),this.selectedUser=n.observable(),this.formatUser=function(e){var t=[];return e.fan_username&&t.push(e.fan_username),e.bands&&e.bands.length>0&&(t=t.concat(Iter.collect(e.bands,(function(e){return e.band_name})))),Templ.render("login/user_picker_text",{username:e.name,list:t})},s.twofactor=n.observable().extend({errorKeys:{missingValue:TM("Please enter your two-factor code."),noMatch:TM("Code validation failed. Please try again.")}}),s.twofactorRemember=n.observable(!1),s.twofactorVisible=n.observable(!1),s.twofactorHelpVisible=n.observable(!1),s.showTwoFactorHelp=function(){s.twofactorHelpVisible(!0)},this.enableCaptcha=n.observable(r.login_use_captcha),this.enableCaptcha()&&Captcha.renderInvisible(),s.validate=function(){var e=t.trim(s.email());s.email.error_key(e?null:"missingValue"),s.password.error_key(s.password()?s.password().length<3?"tooShort":null:"missingValue");return s.twofactorVisible()&&s.twofactor.error_key(s.twofactor()?null:"missingValue"),!s.email.error_key()&&!s.password.error_key()&&!0},this.has_errors=n.computed((function(){return Iter.find(["email","password","twofactor"],(function(e){return s[e].error_key()}))})),this.submitting=n.observable(!1),this.submitEnabled=n.computed((function(){return!s.submitting()&&!s.has_errors()})),s.submit=function(){if(s.submitEnabled()&&!s.submitting())if(s.validate())if(s.submitting(!0),s.enableCaptcha()){var e=setTimeout((function(){s.submitting(!1)}),1e4);Captcha.execute((function(t){clearTimeout(e),c(t)}))}else c(null);else SignupUtils.scrollToFirstError()},s.showExistingArtist=function(){s.close().then((function(){i.openPane("existing_artist")}))},s.showDupeFan=function(){s.close().then((function(){i.openPane("dupe_fan")}))},s.backToSignup=function(){s.close().then((function(){i.openPane("signup")}))},s.forgotPassword=function(){s.close().then((function(){i.openPane("forgot_password")}))},s.exportState=function(){return{email:s.email(),nextURL:s.nextURL,asyncIdentities:s.asyncIdentities,userDataForMenubar:s.userDataForMenubar,didLogin:s.didLogin,subscribedToBestOf:s.subscribedToBestOf,alreadyPurchased:s.alreadyPurchased}},s.hash=function(){return{portable:i.portable,fan_signup_only:"redeem"===i.originPage||"gift_cards"===i.originPage}}}}(window,$,ko),function(e,t,n){"use strict";var i=function(){var n=this;n.template="",n.containerClass="",n.$container=t("<div></div>"),n.pageData=t("#pagedata").data("blob")||{},n.itemCount=0,n.batchSize=0,n.sequence=[],n.pendingSequence=[],n.batchFetchState={},n.$window=t(e),n.$document=t(document),n.expanded=!1,n.initialized=!1};i.prototype.itemOverflowIndex=function(){return this.$window.width()<=980?39:40},i.prototype.renderItem=function(e,n){var i=this,a={item:e,view:i.type,cfg:i.pageData.cfg,current_fan:CurrentFan,fan_read_only:!1,is_own_collection:CurrentFan.is_own_collection,fan_id:FanData.fan_id,viewing_fan_id:CurrentFan.fan_id,fan_name:FanData.name,common:{},render_hidden:n},s=t(Templ.render(i.template,a));i.$container.find("ol").append(s),i.postRender(e)},i.prototype.postRender=function(e){},i.prototype.needsPagination=function(){var e=this;return!e.error&&(e.sequence.length!==e.itemCount&&e.$window.scrollTop()+e.$window.height()+1e3>=e.$document.height())},i.prototype.onScroll=function(){var e=this;return e.sequence.length>=e.itemCount?(e.$window.off("scroll."+e.type,e.scrollFn),void(e.completeCallback&&e.completeCallback())):e.expanded&&!e.paginating&&e.needsPagination()?e.paginate():void 0},i.prototype.showButton=function(){this.$expandContainer&&this.$expandContainer.removeClass("show-loading").addClass("show-button")},i.prototype.hideButton=function(){this.$expandContainer&&this.$expandContainer.removeClass("show-button show-loading")},i.prototype.showLoading=function(){this.$expandContainer&&this.$expandContainer.removeClass("show-button").addClass("show-loading")},i.prototype.hideLoading=function(){this.$expandContainer&&this.$expandContainer.removeClass("show-button show-loading")},i.prototype.paginate=function(){return t.Deferred().promise()},i.prototype.expand=function(e){var t=this;if(t.expanded||(t.pendingSequence&&t.pendingSequence.length>0&&(t.showLoading(),Iter.each(t.pendingSequence,(function(e){var n=t.itemCache[e];t.sequence.push(e),setTimeout((function(){t.renderItem(n)}),17)})),t.pendingSequence=[]),t.expanded=!0),t.itemCount===t.sequence.length)return t.expandCallback&&t.expandCallback(),t.completeCallback&&t.completeCallback(),t.hideButton(),void setTimeout((function(){t.hideLoading()}),17);if("phone"===MediaView.mode){if(t.sequence.length>=t.itemCount)return void(t.completeCallback&&t.completeCallback());t.paginate().then((function(){t.sequence.length>=t.itemCount?t.completeCallback&&t.completeCallback():t.showButton()}))}else t.scrollFn=t.onScroll.bind(t),t.$window.on("scroll."+t.type,t.scrollFn),t.scrollFn();t.expandCallback&&t.expandCallback()},i.prototype.preload=function(e,t){var n=this;if(n.pendingSequence&&n.pendingSequence.length>0){var i=n.pendingSequence.slice(0,n.batchSize),a=n.pendingSequence.slice(n.batchSize,n.pendingSequence.length),s=null;(a.length>0||i.length!==n.itemCount)&&(s=n.itemOverflowIndex()),Iter.eachWithIndex(i,(function(i,a){var o=s&&a+1>s,r=n.itemCache[i];n.sequence.push(i),e||t&&a>=t?setTimeout((function(){n.renderItem(r,o)}),17):n.renderItem(r,o)})),n.pendingSequence=a}},i.prototype.load=function(e,t,n){var i=this;e&&i.preload(t,n),i.expanded&&i.itemCount>i.sequence.length&&"phone"!==MediaView.mode?(i.scrollFn=i.onScroll.bind(i),i.$window.off("scroll."+i.type),i.$window.on("scroll."+i.type,i.scrollFn),i.scrollFn()):i.itemCount>i.sequence.length+i.pendingSequence.length&&i.showButton(),i.$showMore&&(i.clickFn=function(){i.expand()},i.$showMore.off("click"),i.$showMore.on("click",i.clickFn)),!i.initialized&&i.initialize&&i.initialize(),i.initialized=!0},i.prototype.unload=function(){var e=this;e.$window.off("scroll."+e.type),e.$showMore.off("click")},i.prototype.collapse=function(){var e=this;if(e.expanded){if(e.expanded=!1,e.itemCount>e.batchSize){var t=e.sequence.slice(0,e.batchSize),n=e.sequence.slice(e.batchSize,e.sequence.length);e.sequence=t,e.pendingSequence=n,e.$container.find(e.containerClass+":nth-child("+e.batchSize+")").nextAll().remove(),e.showButton()}e.$window.off("scroll."+e.type,e.scrollFn),e.$showMore.off("click",e.clickFn)}else e.unload()},i.prototype.removeItem=function(e){var t=this,n=t.sequence.indexOf(e),i={};return n>-1&&(t.sequence.splice(n,1),i=t.itemCache[e],t.itemCount-=1),i},i.prototype.appendItem=function(e,t){var n=this;n.itemCache[e]=t,n.expanded?n.sequence.push(e):n.pendingSequence.push(e),n.itemCount+=1},i.prototype.prependItem=function(e,t){var n=this;n.itemCache[e]=t,n.expanded?n.sequence.unshift(e):n.pendingSequence.unshift(e),n.itemCount+=1},e.Paginate=i}(window,jQuery,ko),function(e,t,n){"use strict";var i=function(e,t,n){FollowGrid.call(this,e,t,n)};function a(){var e=t(".preference-container .open-prefs");e.prop("disabled",!e.prop("disabled")),e.toggleClass("disabled"),e.find("span").toggle()}(i.prototype=new Paginate).openGenrePicker=function(){var n=t("#pagedata").data("blob"),a=t("#fan-signup-addnl-bundle").data("url"),s={additionalBundleLoaded:!1,additionalBundle:a,additionalBundlePromise:t.cachedScript(a),state:{fanUsername:Identities.fan().name||FanData.name},isMobile:"phone"===MediaView.mode&&n.cfg.mobile_onboarding},o={genres:n.genre_picker.genres,subgenres:n.genre_picker.subgenres,standalone:!0};e.GenrePickerPaneVM=new GenrePickerPane(s,o),i.openGenrePreferences()},i.prototype.postRender=function(e){},i.prototype.paginate=function(){var e=this;if(e.sequence.length>=e.itemCount||e.paginating)return t.Deferred().resolve().promise();e.paginating=!0,e.showLoading();var n=e.$container.find(e.containerClass+":hidden"),i=n.length,a=e.batchSize-i;return FanCollectionAPI.getFollowers(FanData.fan_id,e.lastToken,e.type,a).then((function(t,a,s){e.paginating=!1,e.hideLoading(),i>0&&n.removeClass("initial-batch render-hidden");var o=e.sequence.length+t.length>=e.itemCount,r=null;o||(r=e.itemOverflowIndex()),e.lastToken=a,Iter.eachWithIndex(t,(function(t,n){var a=r&&i+n+1>r;e.itemCache[t.fan_id]=t,e.sequence.push(t.fan_id),e.renderItem(t,a)})),e.needsPagination()&&e.paginate()}))},i.openGenrePreferences=function(){a();var i={fan_id:Identities.fan().id||FanData.fan_id},s=t.Deferred();return Crumb.ajax({url:"/api/genrepreferences/1/open_genre_preferences",data:i,dataAs:"JSON",type:"POST",success:function(i){if(i.ok){var o=t("#pagedata").data("blob").templglobals&&t("#pagedata").data("blob").templglobals.is_phone,r=["nu-dialog","overflow-dialog","blank-title"];o&&(r=r.concat("mobile-onboarding"));var l=t("<div>"),c=NuDialog.alertHTML("",l,{title:null,buttons:null,closeOnEscape:!0,width:o?e.innerWidth-16:"auto",height:"auto",dialogClass:r.join(" "),close:function(){t(".genres-overflow-wrapper").scrollTop(0),c.detach(),e.GenrePickerPaneVM.close(),a(),e.GenrePickerPaneVM=null}});console.log(o?e.innerWidth-16:"auto");var d=e.GenrePickerPaneVM.hash();return l.html(Templ.render(e.GenrePickerPaneVM.template,d)),n.applyBindings(e.GenrePickerPaneVM,t("#signup-vm")[0]),e.GenrePickerPaneVM.$dialog(c),t(".genre-picker-form").toggleClass("active"),e.GenrePickerPaneVM.prefillSelectedGenres(i.result.followed_genres),e.GenrePickerPaneVM.afterRender(),e.GenrePickerPaneVM.scrollTop(),c.dialog("option","position",{my:"center center",at:"center center",of:e}),s.resolve(i)}return Log.debug("failure response",i),s.reject(i)},error:function(e,t,n){return s.reject()}}),s.promise()},i.saveGenrePreferences=function(a,s){var o={fan_id:Identities.fan().id||FanData.fan_id,toFollow:a,toUnfollow:s},r=t.Deferred();return Crumb.ajax({url:"/api/genrepreferences/1/save_genre_preferences",data:o,dataAs:"JSON",type:"POST",success:function(a){return a.ok?(e.GenrePickerPaneVM.$dialog().dialog("close"),n.cleanNode(t("#signup-vm")),e.location.href=i.urlQueryParams("from","genres"),r.resolve(a)):(Log.debug("failure response",a),r.reject(a))},error:function(e,t,n){return r.reject()}}),r.promise()},i.urlQueryParams=function(t,n,i){i=i||e.location.href;var a,s=new RegExp("([?&])"+t+"=.*?(&|#|$)(.*)","gi");if(s.test(i))return null!=n?i.replace(s,"$1"+t+"="+n+"$2$3"):(a=i.split("#"),i=a[0].replace(s,"$1$3").replace(/(&|\?)$/,""),void 0!==a[1]&&null!==a[1]&&(i+="#"+a[1]),i);if(null!=n){var o=-1!==i.indexOf("?")?"&":"?";return a=i.split("#"),i=a[0]+o+t+"="+n,void 0!==a[1]&&null!==a[1]&&(i+="#"+a[1]),i}return i},e.GenreGrid=i}(window,jQuery,ko);var Fanpage={};!function(e){"use strict";var t;$(document).ready((function(){var e=$("#pagedata").data("blob");t=$("#fan-container")[0],PopupImage.delegate(t),PopupImage.attach("a.showmeProfilePhoto"),PopupImage.attach("a.showmeJustification"),$(t).on("click",".collection-item-actions .wishlist-msg",(function(t){var n=$(this).parents(".collection-item-container"),i=n.data("tralbumid"),a=n.data("tralbumtype"),s=n.data("bandid"),o=n.data("title");!Identities.fan()||Identities.fan()&&!Identities.fan().verified?FanAction.doAction("wishlist",e.lo_querystr||"",null,i,a,s):Fanpage.collectItem(i,a,s,o,this)})),$(t).on("click",".collection-item-actions .wishlisted-msg",(function(e){var t=$(this);if(!t.closest(".signup-tooltip-parent").hasClass("show-tooltip")){var n=t.parents(".collection-item-container"),i=n.data("itemid"),a=n.data("ispurchasable");Fanpage.uncollectItem(i,this,!a)}})),$(t).on("click",".preference-container .open-prefs",(function(e){e.stopImmediatePropagation(),FollowGrids.followingGenres.openGenrePicker()})),$(".followingnoteclose").click((function(){$(".following-note").slideUp(200)})),$(t).on("click",".share-link",(function(e){var t=$(this).data("itemtype"),n=$(this).data("itemid"),i={},a={linkback:(i=$(this).data("isgiftsgiven")?CollectionGrids.giftsGiven.itemCache[t[0]+n+"g"]:CollectionGrids.collection.itemCache[t[0]+n]).item_url,is_track:"t"===i.tralbum_type,title:i.item_title,artist:i.band_name},s=TM("Share"),o=NuDialog.showTemplate("_share_tralbum_phone",a,{title:s,buttons:{}});return SocialControls.initFromDOM(o),!1})),!window.MediaView||"desktop"!=window.MediaView.mode||"iphone"!=Browser.platform&&"android"!=Browser.platform||$(".collection-grid").addClass("tablet"),"undefined"!=typeof CurrentFan&&CurrentFan.is_own_collection&&Stats.record({kind:"fan view "+("desktop"===MediaView.mode?"desktop":"mobile")})})),e.toggleAlsoCollectedBy=function(e){var t=$(e).closest(".collected-by").find(".deets");if(t.hasClass("populated"))t.toggle();else{var n=t.closest(".collection-item-container"),i=n.data("tralbumtype"),a=n.data("tralbumid"),s=$(".also-link",$(e).closest(".collected-by")),o=new FanTralbumCollectors(t,i,a,"collection");o.renderFull().then((function(){"phone"===MediaView.mode&&0===o.thumbs.length&&1===o.reviews.length&&s.closest(".collected-by-header").text(TM("supported by",null,"people that have purchased this item"))})),"phone"===MediaView.mode&&s.removeClass("item-link also-link").addClass("not-a-link")}},e.collectItem=function(e,t,n,i,s){var o={};if(null!==CurrentFan&&"undefined"!=typeof CurrentFan&&null!==CurrentFan.fan_id){if(o.fan_id=CurrentFan.fan_id,o.item_id=e,o.item_type=t,o.band_id=n,CurrentFan.is_own_collection||(o.ref_username=FanData.username),$(s).closest(".collection-item-container").find(".collection-item-actions").addClass("wishlisted").removeClass("wishlist"),a("/collect_item_cb",o,(function(){CurrentFan.collection_count++,$("#menubar-collection-count").html(CurrentFan.collection_count)})),FanOnboarding.showFirstWishlistTooltip&&0===$(".signup-tooltip-parent.show-tooltip").length&&"phone"!==MediaView.mode){FanOnboarding.setFirstWishlistedItem(i,o.item_type),FanOnboarding.showFirstWishlistTooltip=!1;var r=$(s).closest(".signup-tooltip-parent")[0];window.FanOnboarding.showTooltip("x",r)}var l={click_type:"wishlist",item_id:e,item_type:t,user_type:"fan"};BCTracker.record("click",l)}},e.uncollectItem=function(e,t,n){var i={};if(null!==CurrentFan&&"undefined"!=typeof CurrentFan&&null!==CurrentFan.fan_id){n=void 0!==n&&n,i.fan_id=CurrentFan.fan_id,i.item_id=e,$(t).closest(".collection-item-container").find(".collection-item-actions").addClass("wishlist").removeClass("wishlisted"),a("/uncollect_item_cb",i,(function(){CurrentFan.collection_count--,$("#menubar-collection-count").html(CurrentFan.collection_count),n&&$(t).closest(".collection-item-controls").empty()}));var s={click_type:"unwishlist",item_id:i.item_id,item_type:i.item_type,user_type:"fan"};BCTracker.record("click",s)}},e.showHideComments=function(e){$("#comments-container_"+e).toggleClass("hidden"),$("#collection-item-container_"+e).toggleClass("active")},e.featureAccount=function(){a("/feature_fan_cb",{fan_id:FanData.fan_id,feature:1},(function(){location.reload()}))},e.cancelSubscription=function(e){var t=$(e.target),n=t.data("sub-id"),i=t.data("band-id"),a=t.data("band-name");NuDialog.alert("Cancel Subscription","Are you sure you want to cancel this fan's subscription to "+a+"? They will keep their content but immediately lose access to other subscription features.",{buttons:{"Do it":function(){Crumb.ajax({url:"/api/artistsub/1/admin_cancel_sub",data:{fan_id:FanData.fan_id,sub_id:n,band_id:i},dataAs:"JSON",type:"POST",success:function(e){window.location.reload()},error:function(e,t,n){Log.error("Cancel subscription error: ",t,n)}}),$(this).dialog("close")},"No don't":function(){$(this).dialog("close")}}})},e.nukeSubscription=function(e){var t=$(e.target),n=t.data("sub-id"),i=t.data("band-id"),a=t.data("band-name");NuDialog.alert("Nuke Subscription","Are you sure you want to nuke this fan's subscription to "+a+"?\n This will also remove any collection items associated with this subscription.",{buttons:{"Do it":function(){Crumb.ajax({url:"/api/artistsub/1/admin_nuke",data:{fan_id:FanData.fan_id,sub_id:n,band_id:i},dataAs:"JSON",type:"POST",success:function(e){window.location.reload()},error:function(e,t,n){Log.error("Nuke subscription error: ",t,n)}}),$(this).dialog("close")},"No don't":function(){$(this).dialog("close")}}})},e.unfeatureAccount=function(){a("/feature_fan_cb",{fan_id:FanData.fan_id},(function(){location.reload()}))};var n=!1;function i(e){var t=[],n="nu-dialog mailing-list-opt-in blank-title";e.label_id?(n+=" label",t=[{text:TM("Done"),click:function(){var t=$("#notify-me-band").prop("checked"),n=$("#notify-me-label").prop("checked");if(n||t){var i={address:e.email_address};t&&(i.band_id=e.band_id),n&&(i.label_id=e.label_id),Crumb.ajax({type:"POST",url:"/band_follow_email_opt_in_cb",data:i,dataType:"json",success:function(e){},error:function(e,t,n){},complete:function(){}})}$(this).dialog("close")}}]):(n+=" band",t=[{text:TM("Yes please!"),click:function(){Crumb.ajax({type:"POST",url:"/band_follow_email_opt_in_cb",data:{address:e.email_address,band_id:e.band_id},dataType:"json",success:function(e){},error:function(e,t,n){},complete:function(){}}),$(this).dialog("close")}},{text:TM("No thanks"),click:function(){$(this).dialog("close")}}]),NuDialog.showTemplate("fan/band_follow_mailing_list_opt_in",{artist:e.band_name,label:e.label_name,email_address:e.email_address},{dialogClass:n,buttons:t})}function a(e,t,n,i){var a={type:"POST",url:e,data:t,dataType:"json",xhrFields:{withCredentials:!0}};i=i||function(){},Crumb.ajax(a).done((function(e){Trackpipe.showXHRError(e)?Log.error("XHR POST returned error JSON",e):(Log.note("XHR form submission succeeded with data",e),n(e))})).fail((function(e,t,n){if(Log.error("XHR POST failed",e,t,n),e.data)Trackpipe.showXHRError(e.data);else{var a=[];a.push({text:TM("OK"),click:function(e){$(this).dialog("close")}}),NuDialog.alert(TM("Network Error",null,"Dialog box title."),TM("There was a network error while processing your request. Please try again."),{buttons:a})}i()}))}e.followUnfollow=function(e,t,i){var s=$("#pagedata").data("blob")||{};null==e&&(e=FanData.fan_id);var o=$(i)[0];o||(o=$("#follow-unfollow_"+e)[0]);var r=$(o).hasClass("following")?"unfollow":"follow",l={fan_id:CurrentFan.fan_id,follow_id:e,action:r};!Identities.fan()||Identities.fan()&&!Identities.fan().verified?FanAction.doAction("follow",null,null,l.follow_id,"f",null,l):("undefined"!=typeof FROM_FANSUGGEST&&FROM_FANSUGGEST&&"follow"==r&&!n&&(l.from_fansuggest=!0,n=!0),$(o).toggleClass("following"),a("/fan_follow_cb",l,function(t){if(!t.ok){$(o).toggleClass("following");var n=[];n.push({text:TM("OK"),click:function(e){$(this).dialog("close")}});var i=t.reason;"read_only"===i&&(i="Fans are currently read only, please try to follow later"),NuDialog.alert(TM("Error",null,"Dialog box title."),i,{buttons:n})}if($("body").trigger("fan_"+r+"ed",[e]),!CurrentFan.is_following_any&&(!window.FanData||!FanData.is_own_page)&&"phone"==window.MediaView.mode&&s.mobile_app_compatible){CurrentFan.is_following_any=!0;var a=TM("Following!",null,"Title for dialog box suggesting the fan uses the bandcamp app."),l="";if(e==FanData.fan_id)l=FanData.name;else l=$.extend({},ItemCache.followers,ItemCache.following_fans)[e].name;var c={platform_app_url:s.platform_app_url,mobile_app_url:s.mobile_app_url,fan_name:l};NuDialog.showTemplate("fan/collection/fan_first_follow_pane",c,{width:"90%",title:a,buttons:{}})}}.bind({action:r}),function(){$(o).toggleClass("following")}.bind({action:r})),Stats.record({kind:"click",click:"fan_"+r}))},e.showMailingListDialog=i,e.followUnfollowBand=function(e){var t=$("#follow-unfollow-band_"+e)[0],n=$(t).hasClass("following")?"unfollow":"follow",s=FanData.fan_id,o={fan_id:CurrentFan.fan_id,follow_id:s,action:n};!Identities.fan()||Identities.fan()&&!Identities.fan().verified?FanAction.doAction("follow",null,null,null,null,e,o):(a("/fan_follow_band_cb",{fan_id:CurrentFan.fan_id,band_id:e,action:n},(function(n){if($(t).toggleClass("following"),n.is_following){var a=n.mailing_list_info;a.band_name=t.dataset.bandName,a.band_id=e,i(a)}})),Stats.record({kind:"click",click:"band_"+n}))},e.followUnfollowGenre=function(e){var t=$("#follow-unfollow-genre_"+e)[0],n=$(t).hasClass("following")?"unfollow":"follow";if($(t).toggleClass("following"),!$(t).hasClass("following")&&CurrentFan.fan_id==FanData.fan_id){$("#follow-grid-item-genre_"+e).remove();var i=$("#following-tabs li[data-tab='following-genres'] span.count"),a=Number(i.html());i.html(a-1)}var s={fan_id:CurrentFan.fan_id,follow_id:e,action:n};if(!Identities.fan()||Identities.fan()&&!Identities.fan().verified)FanAction.doAction("follow",null,null,e,"g",null,s);else{var o={action:n,discover_id:e},r=$.Deferred();Crumb.ajax({url:"/api/genrepreferences/1/fan_follow_genre",data:o,dataAs:"JSON",type:"POST",success:function(e){return e.ok?r.resolve(e):(Log.debug("failure response",e),r.reject(e))},error:function(e,t,n){return r.reject()}}),Stats.record({kind:"click",click:"fan_manage_genre_grid_"+n})}}}(Fanpage),function(){"use strict";window.FanLocationVM=function(e,t){var n=this;n.location=ko.observable(e||""),n.rawLocation=ko.observable(t||""),n.isNullLocation=ko.computed((function(){return!n.location()||""===n.location()})),n.geocodeTimeout=null,n.loading=ko.observable(!1),n.prevRaw=t,n.geocode=function(){n.rawLocation().length<2?(n.loading(!1),n.location("")):$.post("/geo2_cb",{location:n.rawLocation()}).done((function(e){n.loading(!1),e.raw===n.prevRaw&&n.location(e.text)}))},n.rawLocation.subscribe((function(e){e!=n.prevRaw&&(n.prevRaw=e,n.location("...."),n.loading(!0),n.geocodeTimeout&&clearTimeout(n.geocodeTimeout),0===e.length?n.geocodeTimeout=setTimeout(n.geocode,0):n.geocodeTimeout=setTimeout(n.geocode,500))})),n.reset=function(e,t){n.loading(!1),n.location(e),n.rawLocation(t),n.prevRaw=t}}}(),function(e,t,n){"use strict";e.ForgotPasswordPane=function(e,i){var a=this,s=/(^)([^\s\(\)"'\/><,@]+@\w([^\s\(\)"'\/><&,@]*\w)?\.\w[^\s\(\)"'\/><&,@]*\w)($)/,o=e.state;a.title=TM("Forgot password"),a.pageTitle=TM("Forgot Your Password?"),a.template="fan/signup/fan_forgot_password_pane",a.visible=n.observable(!1),a.immediate=n.observable(!!i.immediate),a.afterRender=function(){a.visible(!0)},a.close=function(){var n=t.Deferred();return e.updateState(a.exportState()),a.immediate(!1),a.visible(!1),n.resolve(),n.promise()},a.email=n.observable(o.email).extend({errorKeys:{empty:"Please enter your email address.",disabled:"Sorry, password reset for that account is disabled.",invalid:"That email address doesn't check out. Example: cool@guy.com",no_match:"We weren't able to find an account by that email address."}}),a.email.validate=function(){var e=t.trim(a.email());a.email.error_key(e&&0!==e.length?s.test(e)?null:"invalid":"empty")},a.email.subscribe((function(){a.email.error_key(null)})),a.validate=function(){a.email.validate()},a.has_errors=n.computed((function(){return!!a.email.error_key()})),a.submitting=n.observable(!1),a.sent=n.observable(!1),a.submitDisabled=n.computed((function(){return!a.email()||a.has_errors()||a.submitting()||a.sent()})),a.submit=function(){a.validate(),a.has_errors()?SignupUtils.scrollToFirstError():(a.submitting(!0),SignupAPI.sendForgotPasswordEmail({email:a.email()}).then((function(e){a.submitting(!1),a.sent(!0)}),(function(e){if(a.submitting(!1),e&&e.errors)Iter.each(e.errors,(function(e){a[e.field]&&a[e.field].error_key&&a[e.field].error_key(e.reason)})),SignupUtils.scrollToFirstError();else if(e){NuDialog.alert("Error",e&&e.error||"An error occurred - please try again.")}})))},a.backToSignup=function(){a.close().then((function(){e.openPane("signup")}))},a.exportState=function(){return{email:a.email()}},a.hash=function(){return{}}}}(window,$,ko),function(e,t,n){"use strict";e.ResetPasswordPane=function(e,i){var a=this;a.title=a.pageTitle=TM("Reset password"),a.template="fan/signup/fan_reset_password_pane",a.visible=n.observable(!1),a.immediate=n.observable(!!i.immediate),a.afterRender=function(){a.visible(!0)},a.close=function(){var n=t.Deferred();return e.updateState(a.exportState()),a.immediate(!1),a.visible(!1),n.resolve(),n.promise()},a.password=n.observable("").extend({errorKeys:{empty:"Please enter a new password."}}),a.password.validate=function(){var e=a.password();a.password.error_key(e&&0!==e.length?null:"empty")},a.validate=function(){a.password.validate()},a.has_errors=n.computed((function(){return!!a.password.error_key()})),a.submitDisabled=n.computed((function(){return!a.password()||a.submitting()})),a.unrecoverableError=n.observable(!1),a.reset=n.observable(!1),a.submitting=n.observable(!1),a.submit=function(){a.validate(),a.has_errors()?SignupUtils.scrollToFirstError():(a.submitting(!0),SignupUtils.resetPassword({password:a.password(),token:i.token}).then((function(e){a.reset(!0),SignupUtils.asyncLogin(e),a.backToSignup()}),(function(e){if(a.submitting(!1),e&&e.errors)Iter.each(e.errors,(function(e){"password"===e.field&&("unrecoverable_error"===e.reason?a.unrecoverableError(!0):a.password.error_key(e.reason))})),SignupUtils.scrollToFirstError();else if(e){NuDialog.alert("Error",e&&e.error_message||"An error occurred - please try again.")}})))},a.backToSignup=function(){a.close().then((function(){e.openPane("signup")}))},a.exportState=function(){return{}},a.hash=function(){return{}}}}(window,$,ko),function(e,t,n){"use strict";e.ExistingArtistPane=function(i,a){var s=this,o=i.state,r=t("#pagedata").data().blob;s.title="",s.pageTitle=TM("Sign up"),s.template="fan/signup/fan_existing_artist_pane",s.width=505,s.visible=n.observable(!1),s.immediate=n.observable(!!a.immediate),s.afterRender=function(){s.visible(!0)},s.close=function(){var e=t.Deferred();return i.updateState(s.exportState()),s.immediate(!1),s.visible(!1),e.resolve(),e.promise()},s.submit=function(){s.close(!0).then((function(){i.openPane("signup")}))},s.logout=function(){SignupAPI.logout().then((function(){i.updateState({email:null,userName:null,bands:[]}),SignupUtils.asyncLogin({}),"/"===e.location.pathname&&SignupUtils.renderHeader({}),i.resetInitial(),s.close(!0).then((function(){i.openPane("signup")}))}))},s.exportState=function(){return{}},s.hash=function(){return{action:i.actionParams.action,action_item_type:i.actionParams.actionItemType,unsupported_device:r.unsupported_device,user_name:o.userName,bands:o.bands||[]}}}}(window,$,ko),function(e,t,n){"use strict";e.ActionPane=function(i,a){var s=this;s.title="",s.template="fan/signup/fan_action_pane",s.visible=n.observable(!1),s.immediate=n.observable(!!a.immediate),s.afterRender=function(){s.visible(!0)},s.close=function(){var e=t.Deferred();return i.updateState(s.exportState()),s.immediate(!1),s.visible(!1),e.resolve(),e.promise()},this.openSignup=function(){var t=i.actionParams&&i.actionParams.action;if(t){var n=null;"wishlist"===t?n="logged_out_wishlist_signup":"follow"===t&&"f"===i.actionParams.actionItemType?n="logged_out_fan_follow_signup":"follow"===t&&"g"===i.actionParams.actionItemType?n="logged_out_genre_follow_signup":"follow"!==t||i.actionParams.actionItemType&&"b"!==i.actionParams.actionItemType?"live_ticket"===t&&(n="logged_out_live_ticket_purchase_signup"):(n="logged_out_follow_signup",HiddenParams.get("external_follow")&&Stats.record({kind:"click",click:"artist_dash_external_follow_signup"})),Stats.record({kind:"click",click:n})}if("phone"===MediaView.mode){var a={action:i.actionParams.action,from:i.actionParams.from,pane:"signup"};i.initialEmail&&(a.email=i.initialEmail,a.sig=i.initialEmailSignature);var o=siteroot_https+"/fan_signup";return i.actionParams.queryString&&(o+=i.actionParams.queryString),void(e.location.href=Url.addQueryParams(o,a))}if(Url.isCustomDomain())if(i.subdomainURL){var r={fan_action_pane:"signup"};i.actionParams.action&&(r.fan_action=i.actionParams.action,r.item_id=i.actionParams.actionItemId,r.item_type=i.actionParams.actionItemType,r.band_id=i.actionParams.actionBandId),e.location.href=Url.addQueryParams(i.subdomainURL,r)}else e.location.href=siteroot_https+"/fans";else s.close().then((function(){i.openPane("signup")}))},this.openLogin=function(){var t=i.actionParams&&i.actionParams.action;if(t){var n=null;"wishlist"===t?n="logged_out_wishlist_login":"follow"===t&&"f"===i.actionParams.actionItemType?n="logged_out_fan_follow_login":"follow"!==t||i.actionParams.actionItemType&&"b"!==i.actionParams.actionItemType?"live_ticket"===t&&(n="logged_out_live_ticket_purchase_login"):(n="logged_out_follow_login",HiddenParams.get("external_follow")&&Stats.record({kind:"click",click:"artist_dash_external_follow_login"})),Stats.record({kind:"click",click:n})}if("phone"!==MediaView.mode)if(Url.isCustomDomain())if(i.subdomainURL){var a={fan_action_pane:"login"};i.actionParams.action&&(a.fan_action=i.actionParams.action),e.location.href=Url.addQueryParams(i.subdomainURL,a)}else e.location.href=siteroot_https+"/fans";else s.close().then((function(){i.openPane("login")}));else i.actionParams.queryString?e.location.href=siteroot_https+"/fan_signup"+i.actionParams.queryString+"&action="+i.actionParams.action+"&from="+i.actionParams.from+"&pane=login":e.location.href=siteroot_https+"/fan_signup?action="+i.actionParams.action+"&from="+i.actionParams.from+"&pane=login"},s.exportState=function(){return{}},s.hash=function(){return{action:i.actionParams.action,action_item_type:i.actionParams.actionItemType,is_phone:i.isMobile}}}}(window,$,ko),function(e,t,n){"use strict";e.AlmostTherePane=function(e,i){var a=this,s=e.state;a.title=TM("Ready, set, activate!",null,"we're directing the user to activate their account"),a.pageTitle=TM("Sign up"),a.template="fan/signup/fan_almost_there_pane",a.visible=n.observable(!1),a.immediate=n.observable(!!i.immediate),a.portable=e.portable,a.is_phone="phone"===Browser.media_mode,a.noClose=!1,a.afterRender=function(){a.visible(!0),t(".signup-heading").hide(),t("#almost-there-title").show()},a.close=function(){var n=t.Deferred();return e.updateState(a.exportState()),a.immediate(!1),a.visible(!1),n.resolve(),n.promise()},a.submit=function(){Stats.record({kind:"click",click:"fan_signup_almost_there_continue"}),e.isMobile?e.onComplete():e.fanOnboarding&&a.portable?a.openWelcome2():a.portable||e.actionParams.action?e.onComplete():a.openWelcome()},a.openWelcome=function(){a.close().then((function(){e.openPane("welcome")}))},a.openWelcome2=function(){a.close().then((function(){e.openPane("welcome_2")}))},a.exportState=function(){return{}},a.hash=function(){return{email:s.email,username:s.fanUsername,portable:a.portable,is_phone:a.is_phone}}}}(window,$,ko),function(e,t,n){"use strict";e.WelcomePane=function(i,a){var s=this,o=i.state,r=t("#pagedata").data().blob;s.platform_app_url=r.platform_app_url,s.mobile_app_url=r.mobile_app_url,s.app_store_url=r.app_store_url,s.play_store_url=r.play_store_url,s.unsupported_device=r.unsupported_device,s.is_phone="phone"===Browser.media_mode,s.followOnly=r.signup_params.follow_only,s.wishlistOnly=r.signup_params.wishlist_only,s.noClose=!0,s.isActivationView="welcome"===i.initialPane&&!i.portable,s.isBandMember=Identities.bmgr.bands().length>0||i.state.asyncIdentities&&i.state.asyncIdentities.bands&&i.state.asyncIdentities.bands.length>0,i.portable&&"phone"!==MediaView.mode?s.title=TM("Welcome"):s.title="",s.pageTitle=TM("Welcome"),s.template="fan/signup/fan_welcome_pane",i.portable||t("#propOpenWrapper").addClass("welcome"),t(".bc-toplogo")&&t(".bc-toplogo").hide(),s.visible=n.observable(!1),s.immediate=n.observable(!!a.immediate),s.appLinkSent=n.observable(!1),s.appLinkEmail=o.email;s.sendAppLinkEmail=function(){s.appLinkSent(!0);var e,t=o.email;(e=t)&&-1!==e.indexOf("@")?SignupAPI.sendAppLinkEmail({fan_username:o.fanUsername,email:t}).then((function(e){e&&e.ok||(Log.error(e&&e.error),NuDialog.alert(TM("Signup Error"),TM("There was a problem sending the email. Please try again.")),s.appLinkSent(!1))})):(NuDialog.alert(TM("Signup Error"),TM("There was a problem sending the email. Please try again.")),s.appLinkSent(!1))},s.closeAppLinkModal=function(){s.$dialog.dialog("close")},s.appLinkModal=function(){o.email&&!s.appLinkSent()&&s.sendAppLinkEmail(),s.$dialog=NuDialog.showTemplate("fan/signup/fan_email_link",{},{dialogClass:"nu-dialog no-close blank-title",buttons:{}}),n.applyBindings(s,s.$dialog[0])},s.afterRender=function(){s.visible(!0),t(".signup-heading").hide(),t("#signup-title").hide(),t(".fan-signup .top-divider").hide(),"welcome"===i.initialPane?t("#sign-up-active").show():s.isBandMember?t("#sign-up-welcome-artist").show():(t("#sign-up-welcome .sign-up-welcome-fan-name").text(o.fanUsername),t("#sign-up-welcome").show())},s.close=function(){var e=t.Deferred();return t("#propOpenWrapper").removeClass("welcome"),i.updateState(s.exportState()),s.immediate(!1),s.visible(!1),e.resolve(),e.promise()},s.buttonEnabled=n.observable(!0),s.submit=function(){s.buttonEnabled(!1),i.onComplete()},s.getApp=function(){e.location.href=s.platform_app_url},s.exportState=function(){return{}},s.hash=function(){return{email:o.email,username:o.fanUsername,action:i.actionParams.action,unsupported_device:s.unsupported_device,platform_app_url:s.platform_app_url,mobile_app_url:s.mobile_app_url,app_store_url:r.app_store_url,play_store_url:r.play_store_url,is_phone:s.is_phone,portable:i.portable,is_band_member:s.isBandMember,is_activation_view:s.isActivationView}}}}(window,$,ko),function(e,t,n){"use strict";e.VerifyNag=function(e,i){var a=this;a.title=TM("Activate your account"),a.fanEmail=n.observable(e.fan_email),a.skipToEmail=e.skipToEmail,a.changingEmail=n.observable(!1),a.submitted=n.observable(!1),a.resentEmail=n.observable(!1),a.skipToEmail&&a.changingEmail(!0),a.emailError=n.observable(),a.alreadyAFanError=n.computed((function(){return"already_a_fan"==a.emailError()})),a.fanAlreadyLinkedEmailError=n.computed((function(){return"fan_already_linked_email"==a.emailError()})),a.invalidEmailError=n.computed((function(){return"invalid_email"==a.emailError()})),a.openDialog=function(){a._dialog=NuDialog.showTemplate("fan/signup/fan_verify_nag_pane",{email:a.fanEmail()},{dialogClass:"nu-dialog center-title no-close",draggable:!0,width:"phone"===MediaView.mode?"90%":500,modal:!0,title:a.title,buttons:{},closeOnEscape:!1}),n.applyBindings(a,t("#nag-vm")[0])},a.closeDialog=function(){if(a.skipToEmail||a.changingEmail(!1),a.submitted(!1),a._dialog&&(a._dialog.dialog("close"),i)){var t=a.fanEmail()!==e.fan_email?a.fanEmail():null,n=a.resentEmail();i(t,n)}},a.submit=function(){!a.changingEmail()||a.submitted()?a.closeDialog():a.resendEmail()},a.cancel=function(){a.closeDialog()},a.resendEmail=function(){a.resentEmail(!0);var e={email:a.fanEmail()};SignupAPI.resendFanVerifyEmail(e).then((function(e){e.ok&&a.submitted(!0)}),(function(e){e.errors&&e.errors[0]&&"email"==e.errors[0].field&&a.emailError(e.errors[0].reason)}))},a.changeEmail=function(){a.changingEmail(!0)}}}(window,$,ko),function(e,t,n){"use strict";e.DupeFanPane=function(i,a){var s=this,o=i.state;s.title="",s.pageTitle=TM("Signup error"),s.template="fan/signup/fan_dupe_fan_pane",s.width=505,s.visible=n.observable(!1),s.immediate=n.observable(!!a.immediate),s.afterRender=function(){s.visible(!0)},s.close=function(){var e=t.Deferred();return i.updateState(s.exportState()),s.immediate(!1),s.visible(!1),e.resolve(),e.promise()},s.submit=function(){s.close(!0)},s.email=o.email,s.logout=function(){SignupAPI.logout().then((function(){s.close(!0).then((function(){e.location.href=siteroot_https+"/login"}))}))},s.exportState=function(){return{}},s.hash=function(){return{fan:i.affiliations&&i.affiliations.fan,fan_already_linked_email:i.affiliations&&i.affiliations.fan_already_linked_email,email:s.email}}}}(window,$,ko),function(e,t,n){"use strict";e.ChooseAccountPane=function(i,a){var s=this;i.state;s.title=TM("Sign up for a Bandcamp account"),s.pageTitle=TM("Sign up for a Bandcamp account"),s.template="fan/signup/fan_choose_account_pane",s.width=500,s.visible=n.observable(!1),s.immediate=n.observable(!!a.immediate),s.afterRender=function(){var e=null;e="home"===i.originPage||"corp"===i.originPage?"corp_header_single_signup":"menubar_single_signup",s.visible(!0),Stats.record({kind:"click",click:e})},s.close=function(){var e=t.Deferred();return i.updateState(s.exportState()),s.immediate(!1),s.visible(!1),e.resolve(),e.promise()},s.openFanSignup=function(){var t=null,n=void 0!==e.SubscribeVM&&!e._community;t="home"===i.originPage||"corp"===i.originPage?"corp_header_single_signup_fan":"menubar_single_signup_fan",Stats.record({kind:"click",click:t}),s.close().then((function(){n?e.location.href=siteroot_https+"?fan_action_pane=signup":i.openPane("signup")}))},s.exportState=function(){return{}},s.hash=function(){return{fans_from:"home"===i.originPage||"corp"===i.originPage?"hpfans":"menubar",artists_from:"home"===i.originPage||"corp"===i.originPage?"hpartists":"menubar",labels_from:"home"===i.originPage||"corp"===i.originPage?"hplabels":"menubar",signup_params:{standalone:!i.portable}}}}}(window,$,ko),function(e,t,n){"use strict";var i=function(e){return e>900?540:e<=700?350:e-360},a=function(e,t){var n;return n=e>900?604:e<=700?414:e-296,t&&(n+=26),n},s=function(e){var n=t(".search-wrapper");return n.position().top+n.height()},o=function(e,i,a,s,o,r){var l=this;l.name=i.name,l.normName=i.norm_name,l.geonameName=i.geoname_name,l.format=i.format,l.displayName=n.computed({read:function(){var t,n=e.selectedGenres(),i=!1;n.forEach((function(e){e!==l&&e.name===l.name&&(i=!0)}));var s=[];return(t=i&&a?a.name+" / "+l.name:l.name)&&s.push(t),l.geonameName&&s.push(l.geonameName),l.format&&"all"!==l.format&&s.push(l.format),s.join(" / ").toLowerCase()},deferEvaluation:!0}),l.value=i.value||i.norm_name,l.id=i.id||i.tag_id||i.genre_id,l.discoverId=i.discover_id,l.parentGenre=a,l.isFake=!1,l.isCustom=!!s,l.isSearch=r,l.expanded=n.observable(s),l.selected_=n.observable(!!o),l.selected=n.computed({read:function(){return!l.expanded()&&l.subgenres&&l.subgenres().length>0&&!!Iter.find(l.subgenres(),(function(e){return e.selected()}))||l.selected_()},write:function(e){l.selected_(e)}}),l.selectedSecondPane=n.computed((function(){return l.selected_()})),l.isLong="electronic"===l.value,l.cssId=l.value+"-box",l.visible=n.observable(!1),l.hiding=n.observable(!1),l.collapsing=!1,l.toggleSelect=function(n,i){e.searchHasFocus(!1);var s=l.selected();if(l.selected(!s),e.isFirstPane&&e.isFirstPane()&&t("#signup-vm .mobile #"+l.value+"-box").toggleClass("selected",!s),s){l.hiding(!0),l.visible(!1);var o=function(){e.selectedGenres.remove(l),l.hiding(!1)};e.selectedGenres().length>1?setTimeout((function(){o()}),300):o()}else e.selectedGenres.unshift(l),setTimeout((function(){l.visible(!0)}),0);a||Iter.find(l.subgenres(),(function(e){return e.selected()}))?!a||a.selected()||Iter.find(a.subgenres(),(function(e){return e.selected()}))||(a.expanded(!1),n||(a.collapsing=!0),e.isMobile||i||e.$genres.masonry()):(n||(l.collapsing=!0),l.expanded(!1),e.isMobile||i||e.$genres.masonry())},l.expand=function(n,i){l.expanded()||l.collapsing?l.collapsing=!1:(l.selected()?t("#signup-vm .mobile #"+l.value+"-box").toggleClass("selected",l.selected()):(l.selected(!0),t("#signup-vm .mobile #"+l.value+"-box").toggleClass("selected",l.selected()),e.selectedGenres.unshift(l),setTimeout((function(){l.visible(!0)}),0)),l.expanded(!0),Iter.each(e.genres,(function(e){e!==l&&e.expanded(!1)})),e.isMobile||e.$genres.masonry())},l.hasExpandedClass=n.computed((function(){return"podcasts"!==l.normName&&"audiobooks"!==l.normName&&(!!l.isSearch||l.expanded())})),l.subgenres=n.observableArray()},r=function(l,c){var d=this,u=l.state,p=t(e).width()>768;d.isWide=p,d.title=null,d.overflowDialog=!0,d.pageTitle=TM("Choose your favorite genres"),d.template="fan/signup/fan_genre_picker_pane",d.width=p?720:555,d.standalone=n.observable(c.standalone),d.isMobile=l.isMobile;var h,m=t(e).width(),f=t(e).height(),g=d.isMobile?null:i(f)+"px",_=d.isMobile?null:a(f)+"px";if(d.genres_overflow_wrapper_height=n.observable(g),d.search_results_top=n.observable(a(_)),d.hash=function(){return{fan_name:d.isMobile?Identities.fan()&&Identities.fan().name:u.fanUsername,genres_overflow_wrapper_height:d.genres_overflow_wrapper_height(),search_results_top:d.search_results_top(),skinny:m<=768,from_newsletter_invite_banner:u.fromNewsletterInvite}},d.standalone()?(Stats.record({kind:"click",click:"fan_manage_genre_start"}),d.templateName=n.observable(d.template),d.templateHash=n.observable(d.hash()),d.$dialog=n.observable()):Stats.record({kind:"click",click:"fan_signup_genre_start"}),d.currentPane=n.observable("genres"),d.showGenres=n.computed((function(){return"genres"==d.currentPane()})),d.showSubgenres=n.computed((function(){return"subgenres"==d.currentPane()})),d.isFirstPane=n.computed((function(){return"genres"==d.currentPane()})),d.visible=n.observable(!1),d.immediate=n.observable(!!c.immediate),d.minGenres=n.observable(p?5:4),d.submitting=n.observable(!1),d.submitEnabled=n.computed((function(){return!d.submitting()})),d.genres=[],d.suggestedNewsletters=[],c.genres){var b=FanSignup.actionParams.action,v=Iter.find(c.genres,(function(e){return e.id==FanSignup.actionParams.genreId}));"follow"!==b&&"wishlist"!==b||!v||(h=new o(d,v),c.subgenres[v.value]&&Iter.each(c.subgenres[v.value],(function(e){h.subgenres.push(new o(d,e,h))})),d.genres.push(h)),Iter.eachWithIndex(c.genres,(function(e,t){v&&v.id==e.id||(h=new o(d,e),c.subgenres[e.value]&&Iter.each(c.subgenres[e.value],(function(e){h.subgenres.push(new o(d,e,h))})),d.genres.push(h))}))}d.numCustomFollows=n.observable(0),d.selectedGenres=n.observableArray(),d.selectedGenres.noAnimation=n.observable(!0),d.showPageLeft=n.observable(!1),d.showPageRight=n.observable(!1),d.selectedGenresSubscription=d.selectedGenres.subscribe((function(n){l.additionalBundlePromise.done((function(){setTimeout((function(){var i=d.$selectedGenresEl.scrollLeft(),o=d.$selectedGenresEl.width(),r=d.$selectedGenresEl[0].scrollWidth;d.showPageLeft(i>0),d.showPageRight(i+o<r),t(".search-results",d.$root).css({top:d.isMobile?s(e.innerHeight):a(t(e).height(),n.length>0)})}),200)}))})),d.prefilledGenres=n.observableArray(),d.prefillSelectedGenres=function(e){d.prefilledGenres=n.observableArray(),Object.keys(e).map((function(t){return e[t]})).forEach((function(e){var t=!0;if(e.geoname_name||e.format&&"all"!==e.format||d.genres.forEach((function(n){e.genre_id===n.id&&(0===e.tag_id?(t=!1,-1==d.selectedGenres().indexOf(n)&&(d.prefilledGenres.unshift(n),n.toggleSelect(!1,!0),setTimeout((function(){n.visible(!0)}),0))):n.subgenres&&n.subgenres().length>0&&(n.subgenres().forEach((function(n){e.norm_name===n.normName&&(t=!1,d.prefilledGenres.unshift(n),n.toggleSelect(!1,!0),setTimeout((function(){n.visible(!0)}),0))})),n.selected(!n.selected_()),n.selected(!n.selected_())))}),d),t){var n=new o(d,{name:e.name,norm_name:e.norm_name,value:e.norm_name,id:e.discover_id,discover_id:e.discover_id,geoname_name:e.geoname_name,format:e.format},null,!0,!0);d.selectedGenres.unshift(n),d.numCustomFollows(d.numCustomFollows()+1),d.prefilledGenres.unshift(n),setTimeout((function(){n.visible(!0)}),0)}}),this)},d.searchClick=function(){return d.searchTerm()&&d.searchTerm().length>0&&0===d.searchResults().length&&d.doSearch(d.searchTerm()),!1},d.searchWrapperClick=function(){d.scrollToSearch()},d.scrollToSearch=function(){d.$genresWrapper.animate({scrollTop:d.$genresWrapper[0].scrollHeight},100)},d.deselectClick=function(e,n){if(!t.contains(t(".search-input-wrapper",d.$root[0])[0],n.target)&&!t.contains(t(".search-results",d.$root[0])[0],n.target))return d.searchHasFocus(!1),d.searchSelectIndex(null),d.searchResults([]),!0},d.searchHasFocus=n.observable(!1),d.searchResults=n.observableArray([]),d.searchTerm=n.observable(),d.truncatedSearchTerm=n.computed((function(){var e=d.searchTerm();return Text.truncate(e,15,"...")})),d.searching=n.observable(!1),d.searchHasFocus.subscribe((function(n){d.isMobile&&!n&&e.scrollTo(0,d.$root.offset().top),d.isMobile&&n&&t(".search-results").css({top:s()})})),d.searchSelectIndex=n.observable(null),d.searchSelectIndex.subscribe((function(e){0===e?d.searchHasFocus(!0):d.searchHasFocus(!1)})),d.doSearch=function(e){var n=[],i={};e=t.trim(e.toString()).toLowerCase().replace(/^#+/g,""),d.searching(!0);var a=(new Date).getTime(),s=function(n){e===t.trim(d.searchTerm().toString()).toLowerCase().replace(/^#+/g,"")&&(d.searching(!1),0===n.length&&n.push({isEmpty:!0}),d.searchResults(n))};SignupAPI.customGenreSearch(e,10).then((function(o){if(e===t.trim(d.searchTerm().toString()).toLowerCase().replace(/^#+/g,""))if(o.matching_tags&&0!==o.matching_tags){Iter.each(o.matching_tags,(function(t){var a=t.tag_name.toLowerCase();if(!(n.length>=10||i[a])){var s=a.indexOf(e),o=a.slice(0,s),r=a.slice(s+e.length,a.length),l=s>=0?o+"<b>"+Text.escapeHtml(e)+"</b>"+r:a;n.push({displayName:l,name:a,normName:t.tag_norm_name,isCustom:!0,count:t.count,countText:TP("{{count}} match","{{count}} matches",t.count)}),i[t.name]=!0}}));var r=(new Date).getTime()-a;r<0?setTimeout((function(){s(n)}),0-r):s(n)}else s(n)}),(function(){var e=(new Date).getTime()-a;e<0?setTimeout((function(){s(n)}),0-e):s(n)}))},d.searchTerm.subscribe((function(e){d.searching(!1),e&&e.length>2?(d.searchResults([]),d.doSearch(e)):d.searchResults([])})),d.collapseSearch=function(e){d.searchResults([]),e&&d.searchTerm(null),d.searchHasFocus(!1),d.searchSelectIndex(0)},d.expandSearch=function(){d.searchResults([]),d.doSearch(d.searchTerm())},d.selectSearchResult=function(e){e.isCustom?d.selectCustomGenre(e.name,e.normName):(d.collapseSearch(!0),Iter.each(d.genres,(function(t){t.expanded(!1),e.parentGenreID||e.name!==t.name?e.parentGenreID===t.id?(t.expanded(!0),d.isMobile||d.$genres.masonry(),Iter.each(t.subgenres(),(function(t){e.name===t.name&&(t.selected(!0),Iter.find(d.selectedGenres(),(function(e){return e.name===t.name}))||(d.selectedGenres.unshift(t),setTimeout((function(){t.visible(!0)}),0)))}))):t.expanded(!1):(t.selected(!0),t.expanded(!0),d.isMobile||d.$genres.masonry(),Iter.find(d.selectedGenres(),(function(e){return e.name===t.name}))||(d.selectedGenres.unshift(t),setTimeout((function(){t.visible(!0)}),0)))})),d.isMobile||d.$genres.masonry())},d.onlyFollowsCustom=function(){return d.numCustomFollows()===d.selectedGenres().length},d.selectCustomGenre=function(e,t){d.collapseSearch(!0);var n=new o(d,{name:e,norm_name:t},null,!0,!0);d.selectedGenres.unshift(n),d.numCustomFollows(d.numCustomFollows()+1),setTimeout((function(){n.visible(!0)}),0)},d.searchInputKeypress=function(e,n){var i=n.keyCode||n.which;switch(d.scrollToSearch(),i){case 9:n.preventDefault(),d.searchSelectIndex(d.searchSelectIndex()+1),1===d.searchSelectIndex()&&t(".search-results li:first",d.$root[0]).focus();break;case 38:if(n.preventDefault(),0===d.searchSelectIndex())return;d.searchSelectIndex(d.searchSelectIndex()-1);break;case 40:n.preventDefault(),d.searchSelectIndex(d.searchSelectIndex()+1),1===d.searchSelectIndex()&&t(".search-results li:first",d.$root[0]).focus();break;case 13:n.preventDefault(),0===d.searchResults().length&&d.searchTerm()&&d.searchTerm().length>0&&d.expandSearch();break;case 27:return n.preventDefault(),d.searchHasFocus(!1),d.searchResults([]),!1;default:return!0}},d.searchInputMouseover=function(e,t){0!==d.searchResults().length&&(t.preventDefault(),d.searchSelectIndex(0))},d.searchResultsKeypress=function(e,n){var i=n.keyCode||n.which;switch(d.scrollToSearch(),i){case 38:n.preventDefault(),d.searchSelectIndex(d.searchSelectIndex()-1),0===d.searchSelectIndex()&&t(".search-wrapper input",d.$root[0]).focus();break;case 40:if(n.preventDefault(),d.searchSelectIndex()===d.searchResults().length)return;d.searchSelectIndex(d.searchSelectIndex()+1);break;case 13:var a=d.searchSelectIndex()-1,s=d.searchResults()[a];s&&(s.isCustom?d.selectCustomGenre(s.name,s.normName):d.selectSearchResult(s));break;case 27:d.searchResults([]);break;default:return!0}},d.searchResultsMouseover=function(e){d.searchSelectIndex(e+1)};d.pageLeft=function(){var e=d.$selectedGenresEl.width(),t=d.$selectedGenresEl[0].scrollWidth,n=d.$selectedGenresEl.scrollLeft()-.5*e;d.searchResults([]),d.$selectedGenresEl.animate({scrollLeft:n},200),setTimeout((function(){d.showPageLeft(n>0),d.showPageRight(n+e<t)}),200)},d.pageRight=function(){var e=d.$selectedGenresEl.width(),t=d.$selectedGenresEl[0].scrollWidth,n=d.$selectedGenresEl.scrollLeft()+.5*e;d.searchResults([]),d.$selectedGenresEl.animate({scrollLeft:n},200),setTimeout((function(){d.showPageLeft(n>0),d.showPageRight(n+e<t)}),200)},d.resetScroll=function(){d.searchResults([]);var e=d.$selectedGenresEl.scrollLeft(),t=d.$selectedGenresEl.width(),n=d.$selectedGenresEl[0].scrollWidth;d.$selectedGenresEl.animate({scrollLeft:0},200),d.showPageLeft(e>0),d.showPageRight(e+t<n)},d.scrollTop=function(){t(".genres-overflow-wrapper").scrollTop(0)},d.exportSelectedGenres=function(){var e=d.selectedGenres(),t=[];return Iter.each(e,(function(e){e.parentGenre?t.push({genre_norm_name:e.parentGenre.normName,name:e.name,subgenre_norm_name:e.normName}):t.push({genre_norm_name:e.normName,name:e.name,subgenre_norm_name:null})})),t},d.afterRender=function(){var n=function(){if(d.$root=t("#signup-vm"),d.isMobile||(d.$genres=t(".genres",d.$root[0]).masonry({itemSelector:".genre",stamp:".search",columnWidth:162})),d.visible(!0),d.standalone()&&!d.isMobile&&t("#signup-vm").toggleClass("standalone"),d.$selectedGenresEl=t("ul.selected-genres",d.$root[0]),d.$genresWrapper=t(".genres-overflow-wrapper",d.$root[0]),d.$selectedGenresEl.on("scroll",(function(){var e=d.$selectedGenresEl.scrollLeft(),t=d.$selectedGenresEl.width(),n=d.$selectedGenresEl[0].scrollWidth;d.searchResults([]),d.showPageLeft(e>0),d.showPageRight(e+t<n)})),d.$genresWrapper.on("scroll",(function(){d.searchResults().length>0&&d.collapseSearch(!1)})),t(e).height()>t(".ui-dialog").height()+30&&t("body").addClass("prevent-scroll"),setTimeout((function(){d.selectedGenres.noAnimation(!1)}),0),!d.isMobile){var n=e.innerHeight;t(".genres-overflow-wrapper",d.$root).css({height:i(n)}),t(".search-results",d.$root).css({top:a(n,d.selectedGenres().length>0)})}};l.additionalBundleLoaded?n():l.additionalBundlePromise.done((function(){n()})),t(e).resize((function(){if(l._pane&&!l._dialog&&!(FanSignup._pane instanceof r)||d.standalone()&&!!d.$dialog()||u.fromNewsletterInvite){var n=l._dialog||d.$dialog&&d.$dialog();if(n){d.searchResults([]);var s=e.innerWidth,o=e.innerHeight;d.isMobile||(s<=768?(d.minGenres(4),n.dialog("option","width",555),d.$root.addClass("skinny")):(d.minGenres(5),n.dialog("option","width",720),d.$root.removeClass("skinny")),t(".genres-overflow-wrapper",d.$root).css({height:i(o)}),t(".search-results",d.$root).css({top:a(o,d.selectedGenres().length>0)})),n.dialog("option","position",{my:"center center",at:"center center",of:e})}}}))},d.submitEnabled=n.computed((function(){return!d.submitting()})),d.canShowSubgenres=function(){return d.selectedGenres().length!==d.numCustomFollows()},d.exportGenrePreferences=function(){var e=[],t=[];return d.prefilledGenres().forEach((function(e){-1===d.selectedGenres().indexOf(e)&&(u.fromNewsletterInvite||Stats.record({kind:"click",click:"fan_manage_genre_picker_unfollow"}),t.unshift({genre_id:e.id||e.parentGenre&&e.parentGenre.id,genre_norm_name:e.id?e.normName:e.parentGenre&&e.parentGenre.normName,subgenre_norm_name:!e.id&&e.normName,discover_id:e.discoverId}))}),d),d.selectedGenres().forEach((function(t){-1===d.prefilledGenres().indexOf(t)&&(!u.fromNewsletterInvite&&d.standalone()&&Stats.record({kind:"click",click:"fan_manage_genre_picker_follow"}),e.unshift({genre_id:t.id||t.parentGenre&&t.parentGenre.id,genre_norm_name:t.id?t.normName:t.parentGenre&&t.parentGenre.normName,subgenre_norm_name:!t.id&&t.normName}))}),d),{toFollow:e,toUnfollow:t}},d.next=function(){if(d.standalone()&&!d.isMobile&&d.isFirstPane()||d.standalone()&&d.isMobile&&!d.isFirstPane())d.saveGenrePreferences();else{if(d.isMobile&&d.isFirstPane()){if(d.standalone())return(d.selectedGenres().length>0||d.prefilledGenres().length>0)&&d.canShowSubgenres()?void d.currentPane("subgenres"):void d.saveGenrePreferences();if(d.selectedGenres().length>0&&d.canShowSubgenres())return void d.currentPane("subgenres")}var e=d.exportGenrePreferences();if(e.toFollow.length>0||e.toUnfollow.length>0){if(d.submitting())return;d.submitting(!0),u.fromNewsletterInvite||Stats.record({kind:"click",click:"fan_signup_genre_pick"}),SignupAPI.setGenrePreferences(e).then((function(e){d.submitting(!1),e.error||(d.suggestedNewsletters=e.suggested_newsletters,d.switchPane("newsletter_picker"))}),(function(e){d.submitting(!1)}))}else d.standalone()||(u.fromNewsletterInvite||Stats.record({kind:"click",click:"fan_signup_genre_skip"}),d.switchPane("newsletter_picker"))}},d.saveGenrePreferences=function(){var i=d.exportGenrePreferences();if(i.toFollow.length>0||i.toUnfollow.length>0){if(d.submitting())return;d.submitting(!0),Stats.record({kind:"click",click:"fan_manage_genre_pick"}),SignupAPI.setGenrePreferences(i).then((function(i){d.submitting(!1),i.error||(e.GenrePickerPaneVM.$dialog().dialog("close"),n.cleanNode(t("#signup-vm")),e.location.href=GenreGrid.urlQueryParams("from","genres"))}),(function(e){d.submitting(!1)}))}},d.switchPane=function(e){d.close(!0).then((function(){l.openPane(e)}))},d.close=function(){var e=t.Deferred();return d.standalone()?(d.resetScroll(),t("body").removeClass("prevent-scroll")):l.updateState(d.exportState()),d.immediate(!1),d.visible(!1),d.selectedGenresSubscription.dispose(),e.resolve(),e.promise()},d.exportState=function(){return{selectedGenres:d.exportSelectedGenres(),suggestedNewsletters:d.suggestedNewsletters}},l.state.followedGenres&&l.state.followedGenres.length>0&&d.prefillSelectedGenres(l.state.followedGenres)};e.GenrePickerPane=r}(window,$,ko),function(e,t,n){"use strict";var i=function(e){var t=this;t.selected=n.observable(!1),t.title=e.title,t.name=e.name,t.genreId=e.genre_id,t.description=e.description};e.NewsletterPickerPane=function(a,s){var o=this,r=a.state;Stats.record({kind:"click",click:"fan_signup_newsletter_start"}),o.title=null,o.template="fan/signup/fan_newsletter_picker_pane",o.width=480,o.visible=n.observable(!1),o.immediate=n.observable(!!s.immediate),o.afterRender=function(){o.visible(!0),a.isMobile&&a._dialog.dialog("option","position",{my:"center center",at:"center center"})},o.close=function(){var e=t.Deferred();return a.updateState(o.exportState()),o.immediate(!1),o.visible(!1),e.resolve(),e.promise()},o.newsletters=[],Iter.each(r.suggestedNewsletters,(function(e){var t=new i(e);o.newsletters.push(t)})),o.selectedNewsletters=n.computed((function(){return Iter.findAll(o.newsletters,(function(e){return e.selected()}))})),o.bestOfSelected=n.observable(!1),o.hasSelectedGenres=r.selectedGenres.length>0,o.hasSuggestedNewsletters=r.suggestedNewsletters.length>0,o.hasNonNewsletterGenres=o.hasSelectedGenres&&r.selectedGenres.length!==r.suggestedNewsletters.length,o.isValidEmail=-1!==a.state.email.indexOf("@"),o.exportSelectedNewsletters=function(){var e=o.selectedNewsletters();return Iter.collect(e,(function(e){return e.genreId}))},o.skip=function(){Iter.each(o.newsletters,(function(e){e.selected(!1)})),o.submit()},o.submitting=n.observable(!1),o.submitEnabled=n.computed((function(){return!o.submitting()})),o.chooseBestOf=function(){o.bestOfSelected(!0),o.submit()},o.submit=function(){var t=function(){"tag"===a.originPage&&e.hub&&a.state.didLogin||a.isMobile&&"live_ticket_purchase"===a.getSignupFrom()?a.onComplete():a.isMobile?o.switchPane("almost_there"):o.switchPane("welcome_2")},n=o.exportSelectedNewsletters(),i=o.bestOfSelected();if(n.length>0||i){if(o.submitting())return;o.submitting(!0),Stats.record({kind:"click",click:"fan_signup_newsletter_pick"}),SignupAPI.subscribeToNewsletters(n,i).then((function(e){o.submitting(!1),e.error||t()}),(function(e){o.submitting(!1)}))}else Stats.record({kind:"click",click:"fan_signup_newsletter_skip"}),t()},o.switchPane=function(e){o.close(!0).then((function(){a.openPane(e)}))},o.exportState=function(){return{subscribedToBestOf:o.bestOfSelected()}},o.hash=function(){return{genres:r.selectedGenres,email:r.email,from_newsletter_invite_banner:r.fromNewsletterInvite}}}}(window,$,ko),function(e,t,n){"use strict";e.Welcome2Pane=function(i,a){var s=this;s.hideTitlebar=!1,s.template="fan/signup/fan_welcome_2_pane",s.title=null,s.width=e.FanOnboarding.hasSeenTooltips||e.FanOnboarding.complete?500:520,s.fromEmail=!i._pane;var o="live_ticket_purchase"===i.getSignupFrom()&&!!a.set_fan_verified;s.showTooltips=!(e.FanOnboarding.hasSeenTooltips||e.FanOnboarding.complete||a.skip_walkthrough||o),s.visible=n.observable(!1),s.immediate=n.observable(!!a.immediate),s.skipWalkthrough=a.skip_walkthrough||o,s.afterRender=function(){SignupAPI.setWelcomePaneSeen(),s.fromEmail&&s.showTooltips?Stats.record({kind:"click",click:"fan_signup_welcome_email_start"}):s.showTooltips&&Stats.record({kind:"click",click:"fan_signup_welcome_2_start"}),s.visible(!0)},s.close=function(){var e=t.Deferred();return i.updateState(s.exportState()),s.immediate(!1),s.visible(!1),e.resolve(),e.promise()},s.submit=function(){var e=this;e.fromEmail&&e.showTooltips?e.skipWalkthrough?Stats.record({kind:"click",click:"fan_signup_welcome_email_skip"}):Stats.record({kind:"click",click:"fan_signup_welcome_email_pick"}):e.showTooltips&&(e.skipWalkthrough?Stats.record({kind:"click",click:"fan_signup_welcome_2_skip"}):Stats.record({kind:"click",click:"fan_signup_welcome_2_pick"})),e.close().then((function(){e.skipWalkthrough||"corp"!==i.originPage&&"fans"!==i.originPage&&"ppp"!==i.originPage&&i.originPage?o&&"phone"===MediaView.mode?e.close(!0).then((function(){i.openPane("genre_picker")})):o?(FanOnboarding.showNewsletterInviteBanner(),i.signupFrom=null,i.closeDialog()):i.onComplete():i.openHomepageWelcome()}))},s.skip=function(){s.skipWalkthrough=!0,s.submit()},s.exportState=function(){return{skipWalkthrough:s.skipWalkthrough}},s.hash=function(){return{show_tooltips:s.showTooltips}}}}(window,$,ko),function(e,t,n){"use strict";e.CompleteProfilePane=function(e,i){var a=this;a.title=TM("Complete profile","pre",null,"asking fans to complete their profiles"),a.pageTitle=TM("Sign up","pre"),a.template="fan/signup/fan_complete_profile_pane",a.visible=n.observable(!1),a.immediate=n.observable(!!i.immediate),a.portable=e.portable,a.isPhone="phone"===Browser.media_mode,a.noClose=!1,a.completeProfileVM=new CompleteProfileVM({onSubmit:function(){a.close().then((function(){e.onComplete()}))},onError:function(e){var t=e&&SignupUtils.signupError(e)||TM("There was a problem signing up. Please try again.","pre");NuDialog.alert(TM("Signup Error","pre"),t)},onValidationError:function(){SignupUtils.scrollToFirstError()}}),a.afterRender=function(){a.visible(!0),document.getElementById("complete-profile-name-input").focus()},a.close=function(){var n=t.Deferred();return e.updateState(a.exportState()),a.immediate(!1),a.visible(!1),n.resolve(),n.promise()},a.exportState=function(){return{}},a.hash=function(){return{}}}}(window,$,ko),function(e,t,n){"use strict";var i=function(){var t=this;t.hideDownloadBanner()||(t.$root=null,t.elemId="#fan-app-download-banner-vm",t.template="fan/signup/fan_app_download_banner",t.isAppInstalled="1"===Url.getQueryParam(e.location.href,"is_app_installed"),t.redirectToAppURL=Url.getQueryParam(e.location.href,"redirect_to_app_url"),t.hash=function(){return{isAppInstalled:t.isAppInstalled,redirectToAppURL:t.redirectToAppURL}},t.bindDownloadBanner())};i.prototype={dismissBanner:function(){t(this.$root).remove()},hideDownloadBanner:function(){var n="1"!==Url.getQueryParam(e.location.href,"show_download_banner"),i=!(t("#pagedata").data("blob").templglobals&&t("#pagedata").data("blob").templglobals.is_phone);return n||i},bindDownloadBanner:function(){t("body").append(Templ.render(this.template,this.hash())),this.$root=t(this.elemId),n.applyBindings(this,this.$root[0]),e.history.replaceState({},document.title,Url.removeQueryParams(e.location.href,["show_download_banner","is_app_installed","redirect_to_app_url"]))}},t(document).ready((function(){e.FanAppDownloadBanner=new i}))}(window,$,ko),function(e,t,n){"use strict";if("/fan_signup"!==e.location.pathname){var i=U.pagedataBlob().signup_params||{},a={signup:SignupPane,login:LoginPane,forgot_password:ForgotPasswordPane,reset_password:ResetPasswordPane,existing_artist:ExistingArtistPane,almost_there:AlmostTherePane,action:ActionPane,welcome:WelcomePane,dupe_fan:DupeFanPane,choose_account:ChooseAccountPane,genre_picker:GenrePickerPane,newsletter_picker:NewsletterPickerPane,welcome_2:Welcome2Pane,complete_profile:CompleteProfilePane},s={fans:"fans",corp:"corp",ppp:"signupdwnld",band:"menubar",home:"home",fan:"collection_banner",redeem:"gift_card_redeem",live_ticket:"live_ticket_purchase",gift_cards:"gift_card_purchase"},o=new function(i){var o=this;o._dialog=null,o._element=null,o._pane=null,o.portable=!0,o.isMobile=i.isMobile,o.originPage=null;var r=U.pagedataBlob();Url.toHash(e.location.href).host===Url.toHash(siteroot_https).host?"/fans"===e.location.pathname?o.originPage="fans":"/download"===e.location.pathname?o.originPage="ppp":"/"===e.location.pathname?o.originPage="home":0===e.location.pathname.indexOf("/redeem")?o.originPage="redeem":0===e.location.pathname.indexOf("/gift_cards")?o.originPage="gift_cards":void 0!==r.collection_data?o.originPage="fan":-1!==e.location.href.indexOf(siteroot_https+"/tag/")?o.originPage="tag":o.originPage="corp":0===e.location.pathname.indexOf("/campaign")?o.originPage="crowdfunding":void 0!==r.community?o.originPage="community":o.originPage="band";var l="home"===o.originPage,c="corp"===o.originPage,d="band"===o.originPage,u="fan"===o.originPage,p="redeem"===o.originPage,h="gift_cards"===o.originPage,m="ppp"===o.originPage,f="crowdfunding"===o.originPage,g="tag"===o.originPage,_="community"===o.originPage;o.CROWDFUNDING_RECEIPT_ACTIONS={pledge:"change_pledge",payment:"update_pledge_payment",address:"update_pledge_address"},o.getSignupFrom=function(){if(!o.actionParams||!o.actionParams.action)return o.signupFrom?o.signupFrom:s[o.originPage];var e=o.actionParams.action,t=o.actionParams.actionItemType;return"wishlist"===e?"wishlist":"follow"===e&&"f"===t?"fan_follow":"follow"===e&&"g"===t?"genre_follow":"follow"===e?"follow":"redeem"===e?"gift_card_redeem":"live_ticket"===e||"live_invite"===e||"live_attend"===e||"live_attend_immediate"===e?"live_ticket_purchase":"gift_cards"===e?"gift_card_purchase":void 0},o.openHomepageWelcome=function(){l||(SignupUtils.asyncLogin(o.state.asyncIdentities),o.doAction(),e.location.href=siteroot_https,o.closeDialog())},o.onComplete=function(n){var a=o.state.asyncIdentities,s=o.state.userDataForMenubar;s&&(s.email=o.state.email),e.FanControls&&(e.FanControls._isFan=!0);var r=o.actionParams,b=function(){if(e.FanOnboarding)if(o.state.skipWalkthrough)e.FanOnboarding.skipWalkthrough();else{if(void 0===e.FanOnboarding.tooltips||!e.FanOnboarding.tooltips||0===e.FanOnboarding.tooltips.length)return;var n=null,i=null,a=!0;r&&"wishlist"===r.action&&r.title&&e.FanOnboarding.setFirstWishlistedItem(r.title,r.actionItemType),r&&r.action&&("wishlist"===r.action||"follow"===r.action)&&l&&t("body").removeClass("scroll-detected").addClass("prevent-header-hiding"),r&&r.action&&"follow"===r.action&&r.actionItemType,r&&r.action&&"follow"===r.action&&"f"===r.actionItemType&&g&&(i=t(".page.current .follow-fan[data-follow-fan="+r.actionItemId+"]").first(),FanOnboarding.fanName=i.data("fan-name"),n=i.closest(".signup-tooltip-parent"),a=!1),r&&r.action&&"follow"===r.action&&"g"===r.actionItemType&&g&&(i=t("button.following[data-discover-id="+r.actionItemId+"]"),FanOnboarding.tagName=i.data("tag-name"),n=i.closest(".signup-tooltip-parent"),a=!1),r&&r.action&&"follow"===r.action&&"g"===r.actionItemType&&u&&(i=t("button.following[data-discover-id="+r.actionItemId+"]"),FanOnboarding.tagName=i.data("tag-name"),n=i.closest(".signup-tooltip-parent"),a=!1),r&&r.action&&"follow"===r.action&&_&&(i=t(".community-band-info .follow-band:visible"),FanOnboarding.bandName=v.community.band.name,n=i.closest(".signup-tooltip-parent"),a=!1),a&&t("html, body").animate({scrollTop:0},300),setTimeout((function(){e.FanOnboarding.initForView(n)}),300)}};if(!a)return"welcome_2"!==o.currentPane()||o.isMobile||b(),m||SignupUtils.cleanURL(),void o.closeDialog();SignupUtils.asyncLogin(a);var v=U.pagedataBlob()||{},y=v.cfg||{};d||u?SignupUtils.renderMenubar(a,s,r):l||c?y.header_rework_2018?SignupUtils.renderMenubar(a,s,r):SignupUtils.renderHeader(a,s,r):p?(y.header_rework_2018?SignupUtils.renderMenubar(a,s,!1):SignupUtils.renderHeader(a,s,!1),Redeem.rawUserBalance(s.gift_card_balance),Redeem.submit()):h?(y.header_rework_2018?SignupUtils.renderMenubar(a,s,!1):SignupUtils.renderHeader(a,s,!1),GiftCards.loginComplete(o.actionParams)):t("#menubar")[0]?SignupUtils.renderMenubar(a,s,"wishlist"===r.action):t(".hd")[0]&&SignupUtils.renderHeader(a,s,r),i.email=o.state.email,Identities.fan()&&!Identities.fan().verified&&r.action&&"live_ticket"!==r.action&&"live_attend"!==r.action&&"live_attend_immediate"!==r.action&&o._pane instanceof LoginPane&&!h&&!p?(e.verifyNag=e.verifyNag||new VerifyNag({fan_email:i.email}),e.verifyNag.openDialog()):o.doAction(),o.closeDialog(),m||f||SignupUtils.cleanURL(),n||o.isMobile||b(),(m||f)&&e.location.reload(),BCEvents.publish("fanSignup.complete")},o.closeDialog=function(){o._dialog&&("HomeControl"in e&&HomeControl.feedReader&&HomeControl.feedReader.playPauseFeed(!1),o._dialog.dialog("close"))},o.openDialog=function(n){n=n||"Signup",o._element=t("<div>");var i="phone"===MediaView.mode?"90%":500,a="auto";o.isMobile&&(i=t(e).width()-16,a=t(e).height()-16),o._dialog=NuDialog.alertHTML(n,o._element,{dialogClass:"nu-dialog center-title",draggable:!0,width:i,height:a,modal:!0,title:n,buttons:{},close:function(){t("body").removeClass("prevent-scroll"),o._element.remove(),o._dialog=null,o.currentPane(null),o._pane.resetOnClose&&o.resetState(),Captcha.hideInvisible()},closeOnEscape:!1})},o.state={},o.resetState=function(){o.state={userName:i.user_name||null,bands:i.bands||[],fanUsername:i.suggested_name&&i.suggested_name.length>0?i.suggested_name:null,email:i.email||null,asyncIdentities:null,nextURL:null,nextPane:i.next_pane,userDataForMenubar:null,selectedGenres:[],verificationNeeded:!0,suggestedNewsletters:[],skipWalkthrough:!!i.skip_walkthrough,didLogin:!1,subscribedToBestOf:!1,fromNewsletterInvite:!1,followedGenres:[],alreadyPurchased:!1}},o.resetState(),o.updateState=function(e){t.each(e,(function(e,t){void 0!==o.state[e]&&void 0!==t&&(o.state[e]=t)}))},o.resetInitial=function(){i.user_name=null,i.bands=[],i.email=null},o.additionalBundle=t("#fan-signup-addnl-bundle").data("url"),o.loadAdditionalBundle=function(){!o.additionalBundleLoaded&&o.additionalBundle&&(o.additionalBundlePromise=t.cachedScript(o.additionalBundle),o.additionalBundlePromise.done((function(){Log.debug("loaded signup library on demand"),o.additionalBundleLoaded=!0})))},o.additionalBundleLoaded=!1,o.currentPane=n.observable(),o.openPane=function(s,r){if(o.currentPane(s),"HomeControl"in e&&HomeControl.feedReader&&HomeControl.feedReader.playPauseFeed(!0),a[s]){o._dialog||(o.openDialog(),o.loadAdditionalBundle());var l={};t.extend(l,i,{immediate:r}),o._pane=new a[s](o,l),o._dialog.dialog("option","title",o._pane.title);var c=["nu-dialog","fan-signup-portable"];o._pane.hideTitlebar?c.push("hide-title"):o._pane.title&&""!==o._pane.title?c.push("center-title"):c.push("blank-title"),o._pane.overflowDialog&&c.push("overflow-dialog"),o._pane.transparentBackground&&c.push("transparent-background"),o._pane.noClose&&c.push("no-close");var d="action"!=o.currentPane()&&"welcome_2"!=o.currentPane()&&"welcome"!=o.currentPane();o.isMobile&&d&&c.push("mobile-onboarding"),o._dialog.dialog("option","dialogClass",c.join(" ")),o._pane.width&&"phone"!==MediaView.mode?o._dialog.dialog("option","width",o._pane.width):"phone"!==MediaView.mode&&o._dialog.dialog("option","width",500),o._dialog.dialog("option","minHeight","auto");var u=t.extend(o._pane.hash(),{});o._element.html(Templ.render(o._pane.template,u)),n.applyBindings(o._pane,t("#signup-vm")[0]),o._dialog.dialog("option","height","auto"),"phone"===MediaView.mode?o.isMobile&&"genre_picker"===o.currentPane()?o._dialog.dialog("option","position",{my:"center center",at:"center center",of:e}):o._dialog.dialog("option","position",{my:"top",at:"top+30%"}):o._pane.position?o._dialog.dialog("option","position",o._pane.position):o._dialog.dialog("option","position",{my:"center center",at:"center center",of:e}),o._pane.afterRender(),t(e).height()>t(".fan-signup-portable:visible").height()+30?t("body").addClass("prevent-scroll"):t("body").removeClass("prevent-scroll");var p=t("a.ui-dialog-titlebar-close",o._dialog.siblings(".ui-dialog-titlebar"));p&&!o._pane.noClose&&(p.off("click.manual-close"),p.on("click.manual-close",(function(){t("body").removeClass("prevent-scroll"),t(".top-banner.welcome-non-fan").addClass("hide"),o._pane instanceof SignupPane&&Stats.record({kind:"click",click:"fan_signup_signup_close"}),o.state.skipWalkthrough=!0,o.onComplete(!0),"HomeControl"in e&&HomeControl.feedReader&&HomeControl.feedReader.playPauseFeed(!1),HiddenParams.get("external_follow")&&o._pane instanceof ActionPane&&"follow"===o.actionParams.action&&(!o.actionParams.actionItemType||"b"===o.actionParams.actionItemType)&&Stats.record({kind:"click",click:"artist_dash_external_follow_login_close"}),o._pane.resetOnClose&&o.resetState(),BCEvents.publish("fanSignup.closed")})))}},o.initialEmail=i.email,o.initialEmailSignature=i.email_sig,o.actionParams={action:i.action,actionItemId:i.action_item_id,actionItemType:i.action_item_type,actionBandId:i.action_band_id,actionURL:i.action_url,actionSig:i.action_sig},o.doAction=function(){var t=o.actionParams.action,n=o.actionParams.actionItemType,i=o.actionParams.actionItemId,a=o.actionParams.actionBandId,s=o.actionParams.collectData;if(t)if("live_ticket"===t)o.state.alreadyPurchased&&o.state.nextURL?e.location.href=o.state.nextURL:BCEvents.publish("fanSignup.actionSignup.liveTicket",{packageIndex:o.actionParams.packageIndex,isGift:o.actionParams.isGift});else if("live_attend"===t||"live_attend_immediate"===t)o.state.alreadyPurchased&&o.state.nextURL?e.location.href=o.state.nextURL:BCEvents.publish("fanSignup.actionSignup.liveAttend",{packageIndex:o.actionParams.packageIndex,email:o.state.email});else if("live_invite"===t)BCEvents.publish("fanSignup.actionSignup.liveInvite",{packageIndex:o.actionParams.packageIndex,email:o.state.email});else if("wishlist"===t)FanControls2.wishlist(n,i,a,s);else if("follow"===t){var r=n,l=i;if(r&&"b"!==r){if("f"===r)FanControls2.followFan(l,s);else if("g"===r&&"tag"===o.originPage&&e.hub){var c=e.hub.hubHeader,d=e.hub.tabs.slice(-1)[0].digDeeper.filterSettings,u=i==c.discoverId,p=i==d.discoverId();u&&p?(c.doFollowUnfollow("follow"),d.toggleFollowing()):u?c.doFollowUnfollow("follow"):d.doSpecFollow("follow")}}else FanControls2.followBand(a,!0)}},"corp"===o.originPage||"ppp"===o.originPage?o.activationParams={}:o.activationParams={url:i.activation_url,sig:i.activation_sig},o.signupFrom=i.from,o.signupToken=i.signup_token,o.tsig=i.tsig,o.verified=i.verified,i.affiliations&&(o.affiliations=i.affiliations),o.subdomainURL=i.subdomain_url,o.genres=i.genres,o.subgenres=i.subgenres}(i);e.FanSignup=o,t(document).ready((function(){t(".all-signup-link").click((function(){return o.openPane("choose_account",!0),!1})),t(".fan-signup-modal-link").click((function(){var e=t(this).data("from"),n=t(this).data("email"),i=t(this).data("token"),a=t(this).data("tsig"),s=t(this).data("verified");return void 0!==e&&(o.signupFrom=e),void 0!==n&&(o.state.email=n,o.initialEmail=n),void 0!==i&&(o.signupToken=i),void 0!==a&&(o.tsig=a),void 0!==s&&(o.verified=s),o.openPane("signup",!0),!1})),i.pane&&setTimeout((function(){e.FanSignup.openPane(i.pane,!0)}),200)}))}}(window,$,ko);const BCAPI=function(){"use strict";return{call2:function(e,t,n){return new Promise((function(i,a){BCAPI.call(e,t,n).done(i).fail((function(e,t){a("network"===e?t:e)}))}))},makeFailureAlert2:function(e){var t=BCAPI.makeFailureAlert(e);return function(e){return Array.isArray(e)?t("network",e):t(e),Promise.reject(e)}},call:function(e,t,n){var i=function(e){var t,n,i=e.match(/(.*)(_|\/)([0-9]+)/);if(!i)throw"unparsable api class name: "+e;return t=i[1],n=i[3],[t=(t=t.replace(/([^A-Z])([A-Z])/g,"$1_$2")).toLowerCase(),n]}(e),a="/api/"+i[0]+"/"+i[1]+"/"+t;if(n||(n={}),"object"!=typeof n)throw"data must be an object";console.log("calling "+a,n);var s=$.Deferred(),o=0;function r(){var e={},t=Crumb.get(a);t&&(e["X-BC-Crumb"]=t),$.ajax({url:a,data:JSON.stringify(n),contentType:"application/json; charset=UTF-8",dataAs:"JSON",type:"POST",headers:e,success:l,error:c})}function l(e,t,n){if("object"==typeof e&&null!==e&&e.__api_special__){var i=e.error_type;if(Log.warn(e.__api_special__+": ",i),function(e,t){var n=a.substring(1),i=t.getResponseHeader("X-BC-Crumb");if(-1!==e.indexOf("IdentityAccessRules::InvalidCrumbError")&&i&&0===o){console.log("retrying with new crumb",i);var s={};return s[n]=i,Crumb.put(s),o++,r(),!0}return!1}(i,n))return;s.reject(i)}else window.isDebug&&"object"==typeof e&&null!==e&&e.error&&"bad function"===e.error_message?s.reject("network",[n,t,"bad function"]):s.resolve(e)}function c(e,t,n){s.reject("network",[e,t,n])}return r(),s.promise()},makeFailureAlert:function(e){return function(t,n){switch(t){case"network":NuDialog.showNetworkError.apply(NuDialog,n);break;default:var i=e[t]||TM("Unknown error");NuDialog.alert(TM("Error"),i+" ("+t+")")}}}}}(),PublicAPI={call:BCAPI.call2,makeFailureAlert:BCAPI.makeFailureAlert2,failureAlert(e,t){"use strict";this.makeFailureAlert(t)(e)}};!function(){"use strict";var e=JSON.parse(document.currentScript.dataset.data||"null"),t=JSON.parse(document.currentScript.dataset.items||"null"),n=document.createElement("script");n.src="https://www.google-analytics.com/analytics.js",n.async=!0,document.head.appendChild(n),window.ga=window.ga||function(){var e=Array.prototype.slice.call(arguments);return(ga.q=ga.q||[]).push(e)},window.Analytics={properties:[],call_queue:[],test_ids:["UA-4189134-10","UA-4189134-13"],live_ids:["UA-4189134-2","UA-4189134-11"],environments:{0:{sample_rate:100},1:{sample_rate:100,cookie_domain:"staging.bcdevs.com"},2:{sample_rate:8,use_live_ids:!0,cookie_domain:"bandcamp.com"}},dimensions:{LOGIN_STATE:"dimension1",CLIENT_ID:"dimension2"},metrics:{RESPONSE_END_TIME:"metric1",DOM_LOAD_TIME:"metric2",WINDOW_LOAD_TIME:"metric3"},currentCurrency:"USD",data:null,inited:!1,ecommerce:!1,init:function(){if(this.data=e||window.AnalyticsData,this.data&&!this.inited){Identities.bmgr.bands().length>0?this.data.login_state="logged_in_band":Identities.user()?this.data.login_state="logged_in_user":this.data.login_state="not_logged_in";var t=this.environments[this.data.env];this.data.sample_rate=t.sample_rate,this.data.our_ids||(this.data.our_ids=t.use_live_ids?this.live_ids:this.test_ids),this.data.cookie_domain=this.data.domain_match?this.data.cookie_domain||t.cookie_domain:"auto",this.inited=!0;var n=this.data.send_full_url;this.split=window.location.href.split("?"),this.params=this.split[1]&&this.split[1].split("&");var i=[];this.params=this.params&&this.params.filter((function(e){var t="utm_"===e.substr(0,4),a="email="!==e.substr(0,6);return t&&i.push(e.split("=")[0]),n?a:t})),i.length>0&&HiddenParams.hide(i);var a=0;this.data.our_ids.forEach((function(e){this.properties.push(this.createPropertySendPageview(e,!0,a)),a++}),this),this.data.band_id&&this.createPropertySendPageview(this.data.band_id,!1,a),this.collectClientIds(),this.sendCheckoutItems(),this.sendTimings(),this.processQueuedEvents()}},createPropertySendPageview:function(e,t,n){var i=(t?"bandcamp_":"band_")+n,a={name:i};t&&(a.cookieDomain=this.data.cookie_domain,a.sampleRate=this.data.sample_rate),ga("create",e,a);var s={id:e,ours:t,name:i,call:function(){var e=Array.prototype.slice.call(arguments);e[0]=s.name+"."+e[0],ga.apply(window,e)}};if(s.call("set","anonymizeIp",!0),s.call("set","forceSSL",!0),s.call("set","transport","beacon"),t&&s.call("set",this.dimensions.LOGIN_STATE,this.data.login_state),this.params){var o=this.params.length>0?"?"+this.params.join("&"):"",r=this.data.send_full_url?window.location.pathname+o:window.location.pathname;s.call("set","page",r),s.call("set","location",this.split[0]+o)}return s.call("send","pageview"),s},collectClientIds:function(){var e=this;ga((function(){for(var t=window.Analytics.properties,n=ga.getAll(),i=0;i<n.length;i++)for(var a=n[i].get("trackingId"),s=n[i].get("clientId"),o=0;o<t.length;o++){var r=t[o];r.id===a&&r.call("set",e.dimensions.CLIENT_ID,s)}}))},sendCheckoutItems:function(){var e=t||window.AnalyticsItems;if(e&&0!=e.length){var n={};e.forEach((function(e){(n[e.payment_id]=n[e.payment_id]||[]).push(e)}));var i=!1;if("undefined"!=typeof URLSearchParams){var a=Url.parseQuery(window.location.search);i=a&&a.always_send_txns}for(var s="analytics_processed_ids",o=JSON.parse(localStorage.getItem(s)||"[]"),r=[],l=0,c=Object.keys(n);l<c.length;l++)(i||-1===o.indexOf(c[l]))&&r.push(c[l]);if(0!=r.length){var d={};r.forEach((function(e){n[e].forEach((function(e){var t=e.txn_id.slice();delete e.payment_id,delete e.txn_id,null==d[t]&&(d[t]=[]),d[t].push(e)}))})),this.requireEcommerce();var u=this;Object.keys(d).forEach((function(e){d[e].forEach((function(e){u.setCurrency(e.currency),delete e.currency,u.callOurProperties("ec:addProduct",e)})),u.callOurProperties("ec:setAction","purchase",{id:e})})),o=o.slice(Math.max(o.length-1e3,0)),localStorage.setItem(s,JSON.stringify(o.concat(r)))}}},sendTimings:function(){if(window.performance&&window.performance.timing)if("complete"==document.readyState){var e,t=performance.timing,n=t.navigationStart,i=Math.round(t.responseEnd-n),a=Math.round(t.domContentLoadedEventStart-n),s=Math.round(t.loadEventStart-n);if(e=!0,[i,a,s].forEach((function(t){(t<=0||t>=1e6)&&(e=!1)})),e){var o={eventCategory:"Navigation Timing",eventAction:"track",nonInteraction:!0};o[this.metrics.RESPONSE_END_TIME]=i,o[this.metrics.DOM_LOAD_TIME]=a,o[this.metrics.WINDOW_LOAD_TIME]=s,this.callOurProperties("send","event",o)}}else window.addEventListener("load",(function(){window.Analytics.sendTimings()}))},processQueuedEvents:function(){for(;this.call_queue.length>0;)this.callOurProperties.apply(this,this.call_queue.shift())},callOurProperties:function(){var e=Array.prototype.slice.call(arguments);this.inited?this.properties.forEach((function(t){t.ours&&t.call.apply(null,e)})):this.call_queue.push(e)},setCurrency:function(e){e&&e!=this.currentCurrency&&(this.callOurProperties("set","currencyCode",e),this.currentCurrency=e)},cartItemEvent:function(e,t){var n="add"==e;this.requireEcommerce(),this.setCurrency(t.currency),this.callOurProperties("ec:addProduct",{id:t.item_type+t.item_id,name:t.item_title,category:t.item_type,price:t.unit_price,variant:t.is_gift?"gift":"_none",quantity:t.quantity}),this.callOurProperties("ec:setAction",n?"add":"remove"),this.callOurProperties("send","event","Checkout",n?"add_to_cart":"remove_from_cart",t.item_type,t.item_id)},requireEcommerce:function(){this.ecommerce||(this.callOurProperties("require","ec"),this.ecommerce=!0)}},window.Analytics.init()}();
